(function(){"use strict";function e(){i.add("searchreplace",function(e){var t=o({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return ot(e,t),at(e,t),et(e,t)})}var t,n,r,o=function(e){var t=e,n=function(){return t},r=function(e){t=e};return{get:n,set:r}},i=tinymce.util.Tools.resolve("tinymce.PluginReceptionist"),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},u=function(e){var t=typeof e;return null===e?"null":"object"===t&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":t},c=function(e){return function(t){return u(t)===e}},f=function(e){return function(t){return typeof t===e}},l=c("string"),s=c("array"),d=f("boolean"),m=f("number"),h=function(){},g=function(e){return function(){return e}},p=function(e){return e},v=g(!1),y=g(!0),x="[!-#%-*,-\\/:;?@\\[-\\]_{}¡«·»¿;·՚-՟։֊־׀׃׆׳״؉؊،؍؛؞؟٪-٭۔܀-܍߷-߹࠰-࠾࡞।॥॰෴๏๚๛༄-༒༺-༽྅࿐-࿔࿙࿚၊-၏჻፡-፨᐀᙭᙮᚛᚜᛫-᛭᜵᜶។-៖៘-៚᠀-᠊᥄᥅᨞᨟᪠-᪦᪨-᪭᭚-᭠᯼-᯿᰻-᰿᱾᱿᳓‐-‧‰-⁃⁅-⁑⁓-⁞⁽⁾₍₎〈〉❨-❵⟅⟆⟦-⟯⦃-⦘⧘-⧛⧼⧽⳹-⳼⳾⳿⵰⸀-⸮⸰⸱、-〃〈-】〔-〟〰〽゠・꓾꓿꘍-꘏꙳꙾꛲-꛷꡴-꡷꣎꣏꣸-꣺꤮꤯꥟꧁-꧍꧞꧟꩜-꩟꫞꫟꯫﴾﴿︐-︙︰-﹒﹔-﹡﹣﹨﹪﹫！-＃％-＊，-／：；？＠［-］＿｛｝｟-･]",b=g(x),w=function(){return O},O=(t=function(e){return e()},n=p,r={fold:function(e,t){return e()},isSome:v,isNone:y,getOr:n,getOrThunk:t,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:n,orThunk:t,map:w,each:h,bind:w,exists:v,forall:y,filter:function(){return w()},toArray:function(){return[]},toString:g("none()")},r),C=function(e){var t=g(e),n=function(){return o},r=function(t){return t(e)},o={fold:function(t,n){return n(e)},isSome:y,isNone:v,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return C(t(e))},each:function(t){t(e)},bind:r,exists:r,forall:r,filter:function(t){return t(e)?o:O},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return o},T=function(e){return null==e?O:C(e)},E={some:C,none:w,from:T},N=b,k=tinymce.util.Tools.resolve("tinymce.Env"),S=tinymce.util.Tools.resolve("tinymce.util.Tools"),A=Array.prototype.slice,D=Array.prototype.push,R=function(e,t){for(var n=e.length,r=new Array(n),o=0;o<n;o++){var i=e[o];r[o]=t(i,o)}return r},B=function(e,t){for(var n=0,r=e.length;n<r;n++){var o=e[n];t(o,n)}},F=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];t(r,n)}},I=function(e,t){if(0===e.length)return[];for(var n=t(e[0]),r=[],o=[],i=0,a=e.length;i<a;i++){var u=e[i],c=t(u);c!==n&&(r.push(o),o=[]),n=c,o.push(u)}return 0!==o.length&&r.push(o),r},P=function(e,t,n){return B(e,function(e,r){n=t(n,e,r)}),n},M=function(e){for(var t=[],n=0,r=e.length;n<r;++n){if(!s(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);D.apply(t,e[n])}return t},W=function(e,t){return M(R(e,t))},j=function(e,t){var n=A.call(e,0);return n.sort(t),n},V=Object.hasOwnProperty,H=function(e,t){return V.call(e,t)};"undefined"!=typeof window?window:Function("return this;")();var L=9,U=11,$=1,_=3,z=function(e){return e.dom.nodeType},q=function(e){return function(t){return z(t)===e}},G=q(_),K=function(e,t,n){if(!(l(n)||d(n)||m(n)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(t,n+"")},J=function(e,t,n){K(e.dom,t,n)},Q=function(e,t,n){return 0!=(e.compareDocumentPosition(t)&n)},X=function(e,t){return Q(e,t,Node.DOCUMENT_POSITION_PRECEDING)},Y=function(e,t){var n=t||document,r=n.createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return te(r.childNodes[0])},Z=function(e,t){var n=t||document,r=n.createElement(e);return te(r)},ee=function(e,t){var n=t||document,r=n.createTextNode(e);return te(r)},te=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:e}},ne=function(e,t,n){return E.from(e.dom.elementFromPoint(t,n)).map(te)},re={fromHtml:Y,fromTag:Z,fromText:ee,fromDom:te,fromPoint:ne},oe=function(e){return e.nodeType!==$&&e.nodeType!==L&&e.nodeType!==U||0===e.childElementCount},ie=function(e,t){var n=void 0===t?document:t.dom;return oe(n)?[]:R(n.querySelectorAll(e),re.fromDom)},ae=function(e){return E.from(e.dom.parentNode).map(re.fromDom)},ue=function(e){return R(e.dom.childNodes,re.fromDom)},ce=function(e,t){return{element:e,offset:t}},fe=function(e,t){var n=ue(e);return n.length>0&&t<n.length?ce(n[t],0):ce(e,t)},le=function(e,t){var n=ae(e);n.each(function(n){n.dom.insertBefore(t.dom,e.dom)})},se=function(e,t){e.dom.appendChild(t.dom)},de=function(e,t){le(e,t),se(t,e)},me=function(e,t){var n=function(n){if(!e(n))throw new Error("Can only get "+t+" value of a "+t+" node");return r(n).getOr("")},r=function(t){return e(t)?E.from(t.dom.nodeValue):E.none()},o=function(n,r){if(!e(n))throw new Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r};return{get:n,getOption:r,set:o}},he=me(G,"text"),ge=function(e){return he.get(e)},pe=function(e,t){return ie(t,e)},ve=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),ye=function(e,t){return e.isBlock(t)||H(e.schema.getShortEndedElements(),t.nodeName)},xe=function(e,t){return"false"===e.getContentEditable(t)},be=function(e,t){return"true"===e.getContentEditable(t)&&"false"===e.getContentEditableParent(t.parentNode)},we=function(e,t){return!e.isBlock(t)&&H(e.schema.getWhiteSpaceElements(),t.nodeName)},Oe=function(e,t){return ye(e,t)||xe(e,t)||we(e,t)||be(e,t)},Ce=function(e){return 3===e.nodeType},Te=function(){return{sOffset:0,fOffset:0,elements:[]}},Ee=function(e,t){return fe(re.fromDom(e),t)},Ne=function(e,t,n,r,o,i){void 0===i&&(i=!0);for(var a=i?t(!1):n;a;){var u=xe(e,a);if(u||we(e,a)){var c=u?r.cef(a):r.boundary(a);if(c)break;a=t(!0)}else{if(ye(e,a)){if(r.boundary(a))break}else Ce(a)&&r.text(a);if(a===o)break;a=t(!1)}}},ke=function(e,t,n,r,o){if(!Oe(e,n)){var i=e.getParent(r,e.isBlock),a=new ve(n,i),u=o?a.next.bind(a):a.prev.bind(a);Ne(e,u,n,{boundary:y,cef:y,text:function(e){o?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(re.fromDom(e))}})}},Se=function(e,t,n,r,o,i){void 0===i&&(i=!0);var a=new ve(n,t),u=[],c=Te();ke(e,c,n,t,!1);var f=function(){return c.elements.length>0&&(u.push(c),c=Te()),!1};return Ne(e,a.next.bind(a),n,{boundary:f,cef:function(e){return f(),o&&u.push.apply(u,o.cef(e)),!1},text:function(e){c.elements.push(re.fromDom(e)),o&&o.text(e,c)}},r,i),r&&ke(e,c,r,t,!0),f(),u},Ae=function(e,t){var n=Ee(t.startContainer,t.startOffset),r=n.element.dom,o=Ee(t.endContainer,t.endOffset),i=o.element.dom;return Se(e,t.commonAncestorContainer,r,i,{text:function(e,t){e===i?t.fOffset+=e.length-o.offset:e===r&&(t.sOffset+=n.offset)},cef:function(t){var n=W(pe(re.fromDom(t),"*[contenteditable=true]"),function(t){var n=t.dom;return Se(e,n,n)});return j(n,function(e,t){return X(e.elements[0].dom,t.elements[0].dom)?1:-1})}},!1)},De=function(e,t){return t.collapsed?[]:Ae(e,t)},Re=function(e,t){var n=e.createRng();return n.selectNode(t),De(e,n)},Be=function(e,t){return W(t,function(t){return Re(e,t)})},Fe=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=e.length);var o=t.regex;o.lastIndex=n;for(var i,a=[];i=o.exec(e);){var u=i[t.matchIndex],c=i.index+i[0].indexOf(u),f=c+u.length;if(f>r)break;a.push({start:c,finish:f}),o.lastIndex=f}return a},Ie=function(e,t){var n=P(e,function(e,n){var r=ge(n),o=e.last,i=o+r.length,a=W(t,function(e,t){return e.start<i&&e.finish>o?[{element:n,start:Math.max(o,e.start)-o,finish:Math.min(i,e.finish)-o,matchId:t}]:[]});return{results:e.results.concat(a),last:i}},{results:[],last:0}).results;return I(n,function(e){return e.matchId})},Pe=function(e,t){return W(t,function(t){var n=t.elements,r=R(n,ge).join(""),o=Fe(r,e,t.sOffset,r.length-t.fOffset);return Ie(n,o)})},Me=function(e,t){F(e,function(e,n){F(e,function(e){var r=re.fromDom(t.cloneNode(!1));J(r,"data-mce-index",n);var o=e.element.dom;if(o.length===e.finish&&0===e.start)de(e.element,r);else{o.length!==e.finish&&o.splitText(e.finish);var i=o.splitText(e.start);de(re.fromDom(i),r)}})})},We=function(e,t,n,r){var o=Re(e,n),i=Pe(t,o);return Me(i,r),i.length},je=function(e,t,n,r){var o=n.getBookmark(),i=e.select("td[data-mce-selected],th[data-mce-selected]"),a=i.length>0?Be(e,i):De(e,n.getRng()),u=Pe(t,a);return Me(u,r),n.moveToBookmark(o),u.length},Ve=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},He=function(e,t,n,r){var o=e.dom.create("span",{"data-mce-bogus":1});o.className="mce-match-marker";var i=e.getBody();return Xe(e,t,!1),r?je(e.dom,n,e.selection,o):We(e.dom,n,i,o)},Le=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},Ue=function(e,t){var n=[],r=S.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(var o=0;o<r.length;o++){var i=Ve(r[o]);null!==i&&i.length&&(i===t.toString()&&n.push(r[o]))}return n},$e=function(e,t,n){var r=t.get(),o=r.index,i=e.dom;n=!1!==n,n?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,i.removeClass(Ue(e,r.index),"mce-match-marker-selected");var a=Ue(e,o);return a.length?(i.addClass(Ue(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(a[0]),o):-1},_e=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},ze=function(e,t){var n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]"),r="("+n+")";return t?"(?:^|\\s|"+N()+")"+r+"(?=$|\\s|"+N()+")":r},qe=function(e,t,n,r,o,i){var a=e.selection,u=ze(n,o),c=a.isForward(),f={regex:new RegExp(u,r?"g":"gi"),matchIndex:1},l=He(e,t,f,i);if(k.browser.isSafari()&&a.setRng(a.getRng(),c),l){var s=$e(e,t,!0);t.set({index:s,count:l,text:n,matchCase:r,wholeWord:o,inSelection:i})}return l},Ge=function(e,t){var n=$e(e,t,!0);t.set(a(a({},t.get()),{index:n}))},Ke=function(e,t){var n=$e(e,t,!1);t.set(a(a({},t.get()),{index:n}))},Je=function(e){var t=Ve(e);return null!==t&&t.length>0},Qe=function(e,t,n,r,o){var i,u=t.get(),c=u.index,f=c;r=!1!==r;for(var l=e.getBody(),s=S.grep(S.toArray(l.getElementsByTagName("span")),Je),d=0;d<s.length;d++){var m=Ve(s[d]),h=i=parseInt(m,10);if(o||h===u.index){for(n.length?(s[d].firstChild.nodeValue=n,Le(s[d])):_e(e.dom,s[d]);s[++d];){if(h=parseInt(Ve(s[d]),10),h!==i){d--;break}_e(e.dom,s[d])}r&&f--}else i>c&&s[d].setAttribute("data-mce-index",String(i-1))}return t.set(a(a({},u),{count:o?0:u.count-1,index:f})),r?Ge(e,t):Ke(e,t),!o&&t.get().count>0},Xe=function(e,t,n){for(var r,o,i=t.get(),u=S.toArray(e.getBody().getElementsByTagName("span")),c=0;c<u.length;c++){var f=Ve(u[c]);null!==f&&f.length&&(f===i.index.toString()&&(r||(r=u[c].firstChild),o=u[c].firstChild),Le(u[c]))}if(t.set(a(a({},i),{index:-1,count:0,text:""})),r&&o){var l=e.dom.createRng();return l.setStart(r,0),l.setEnd(o,o.data.length),!1!==n&&e.selection.setRng(l),l}},Ye=function(e,t){return t.get().count>1},Ze=function(e,t){return t.get().count>1},et=function(e,t){var n=function(n){return Xe(e,t,n)},r=function(n,r,o,i){return void 0===i&&(i=!1),qe(e,t,n,r,o,i)},o=function(){return Ge(e,t)},i=function(){return Ke(e,t)},a=function(n,r,o){return Qe(e,t,n,r,o)};return{done:n,find:r,next:o,prev:i,replace:a}},tt=function(e){var t=o(E.none()),n=function(){return t.get().each(e)},r=function(){n(),t.set(E.none())},i=function(){return t.get().isSome()},a=function(){return t.get()},u=function(e){n(),t.set(E.some(e))};return{clear:r,isSet:i,get:a,set:u}},nt=function(){var e=tt(h),t=function(t){return e.get().each(t)};return a(a({},e),{on:t})},rt=function(e,t){var n=nt();e.undoReceptionist.add();var r=S.trim(e.selection.getContent({format:"text"})),o=function(n){var r=Ye(e,t)?n.enable:n.disable;r("next");var o=Ze(e,t)?n.enable:n.disable;o("prev")},i=function(e){var n=e.getData(),r=t.get();t.set(a(a({},r),{matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection}))},u=function(e,t){var n=["replace","replaceall","prev","next"],r=t?e.disable:e.enable;B(n,r)},c=function(t){e.windowReceptionist.alert("Could not find the specified string.",function(){t.focus("findtext")})},f=function(e,t){k.browser.isSafari()&&k.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},l=function(n){Xe(e,t,!1),u(n,!0),o(n)},s=function(n){var r=n.getData(),i=t.get();if(r.findtext.length){if(i.text===r.findtext&&i.matchCase===r.matchcase&&i.wholeWord===r.wholewords)Ge(e,t);else{var a=qe(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);a<=0&&c(n),u(n,0===a)}o(n)}else l(n)},d=t.get(),m={findtext:r,replacetext:"",wholewords:d.wholeWord,matchcase:d.matchCase,inselection:d.inSelection},h={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace all",disabled:!0}],initialData:m,onChange:function(e,n){"findtext"===n.name&&t.get().count>0&&l(e)},onAction:function(n,r){var a=n.getData();switch(r.name){case"find":s(n);break;case"replace":Qe(e,t,a.replacetext)?o(n):l(n);break;case"replaceall":Qe(e,t,a.replacetext,!0,!0),l(n);break;case"prev":Ke(e,t),o(n);break;case"next":Ge(e,t),o(n);break;case"matchcase":case"wholewords":case"inselection":i(n),l(n)}f(n,r.name)},onSubmit:function(e){s(e),f(e,"find")},onClose:function(){e.focus(),Xe(e,t),e.undoReceptionist.add()}};n.set(e.windowReceptionist.open(h,{inline:"toolbar"}))},ot=function(e,t){e.addCommand("SearchReplace",function(){rt(e,t)})},it=function(e,t){return function(){rt(e,t)}},at=function(e,t){e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:it(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:it(e,t),icon:"search"}),e.shortcuts.add("Meta+F","",it(e,t))};e()})();