(function(){"use strict";function n(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function t(n,t,e){if(e||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return n.concat(r||Array.prototype.slice.call(t))}function e(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.concat(e);return n.apply(null,o)}}function r(n,t,e,r,o){return n(e,r)?$.some(e):C(o)&&o(e)?$.none():t(e,r,o)}function o(n){var t=_y(zh.sketch({dom:{classes:[oa("outer-container")].concat(n.classes)},containerBehaviours:ku([Mu.config({alpha:Nk,omega:Pk})])}));return Hk(t)}function i(n){var t=o({classes:[oa("android-container")]}),e=AO(),r=Kf(),i=HO(r),u=NO(),c=vk(R,n);t.add(e.wrapper),t.add(u),t.add(c.component);var a=function(n){var t=e.createGroups(n);e.setGroups(t)},f=function(n){var t=e.createGroups(n);e.setContextToolbar(t)},s=function(){e.focus()},l=function(){e.restoreToolbar()},d=function(n){r.set(bO(n))},m=function(){r.run(function(n){n.exit(),dx.remove(u,i)})},g=function(n){jO(u,i,n,t.root)};return{system:t,element:t.element,init:d,exit:m,setToolbarGroups:a,setContextToolbar:f,focusToolbar:s,restoreToolbar:l,updateMode:g,socket:u,dropup:c}}function u(n,t){var e=n.document,r=re.fromTag("div");Fr(r,oa("unfocused-selections")),Me(re.fromDom(e.documentElement),r);var o=hw(r,"touchstart",function(e){e.prevent(),Lk(n,t),c()}),i=function(n){var t=re.fromTag("span");return vy(t,[oa("layer-editor"),oa("unfocused-selection")]),xa(t,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),t},u=function(){c();var t=nO(n),e=Q(t,i);Fe(r,e)},c=function(){Ve(r)},a=function(){o.unbind(),Ie(r)},f=function(){return ke(r).length>0};return{update:u,isActive:f,destroy:a,clear:c}}function c(n){var t=_u(Xk.pure({})),e=function(e){var r=Xk.nu(function(t){return n(e).get(t)});t.set(r)},r=function(n){t.get().get(function(){n()})};return{start:e,idle:r}}function a(n){var t=o({classes:[oa("ios-container")]}),e=AO(),r=Kf(),i=HO(r),u=NO(),c=vk(function(){r.run(function(n){n.refreshStructure()})},n);t.add(e.wrapper),t.add(u),t.add(c.component);var a=function(n){var t=e.createGroups(n);e.setGroups(t)},f=function(n){var t=e.createGroups(n);e.setContextToolbar(t)},s=function(){e.focus()},l=function(){e.restoreToolbar()},d=function(n){r.set(WT(n))},m=function(){r.run(function(n){dx.remove(u,i),n.exit()})},g=function(n){jO(u,i,n,t.root)};return{system:t,element:t.element,init:d,exit:m,setToolbarGroups:a,setContextToolbar:f,focusToolbar:s,restoreToolbar:l,updateMode:g,socket:u,dropup:c}}function f(){Pu.add("mobile",nC)}var s,l,d,m=function(){return m=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},m.apply(this,arguments)},g=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},p=function(n){return function(t){return g(t)===n}},v=function(n){return function(t){return typeof t===n}},h=function(n){return function(t){return n===t}},b=p("string"),y=p("object"),x=p("array"),w=h(null),S=v("boolean"),O=h(void 0),k=function(n){return null==n},T=function(n){return!k(n)},C=v("function"),E=v("number"),R=function(){},D=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return n(t.apply(null,e))}},M=function(n,t){return function(e){return n(t(e))}},_=function(n){return function(){return n}},F=function(n){return n},V=function(n,t){return n===t},I=function(n){return function(t){return!n(t)}},B=function(n){return function(){throw new Error(n)}},A=function(n){return n()},H=_(!1),N=_(!0),P=function(){return z},z=(s=function(n){return n()},l=F,d={fold:function(n,t){return n()},isSome:H,isNone:N,getOr:l,getOrThunk:s,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:_(null),getOrUndefined:_(void 0),or:l,orThunk:s,map:P,each:R,bind:P,exists:H,forall:N,filter:function(){return P()},toArray:function(){return[]},toString:_("none()")},d),j=function(n){var t=_(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},isSome:N,isNone:H,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return j(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:z},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},L=function(n){return null==n?z:j(n)},$={some:j,none:P,from:L},G=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},U=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||r("(pointer:coarse)"),a=o||!i&&u&&r("(min-device-width:768px)"),f=i||u&&!a,s=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),l=!f&&!a&&!s;return{isiPad:_(o),isiPhone:_(i),isTablet:_(a),isPhone:_(f),isTouch:_(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:_(s),isDesktop:_(l)}},W=Array.prototype.slice,X=Array.prototype.indexOf,q=Array.prototype.push,K=function(n,t){return X.call(n,t)},Y=function(n,t){return K(n,t)>-1},J=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return!0}return!1},Q=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},Z=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},nn=function(n,t){for(var e=n.length-1;e>=0;e--){var r=n[e];t(r,e)}},tn=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},en=function(n,t,e){return nn(n,function(n,r){e=t(e,n,r)}),e},rn=function(n,t,e){return Z(n,function(n,r){e=t(e,n,r)}),e},on=function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(t(i,r))return $.some(i);if(e(i,r))break}return $.none()},un=function(n,t){return on(n,t,H)},cn=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];if(t(o,e))return $.some(e)}return $.none()},an=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!x(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);q.apply(t,n[e])}return t},fn=function(n,t){return an(Q(n,t))},sn=function(n,t){for(var e=0,r=n.length;e<r;++e){var o=n[e];if(!0!==t(o,e))return!1}return!0},ln=function(n){var t=W.call(n,0);return t.reverse(),t},dn=function(n,t){return tn(n,function(n){return!Y(t,n)})},mn=function(n){return[n]},gn=function(n,t){var e=W.call(n,0);return e.sort(t),e},pn=function(n,t){return t>=0&&t<n.length?$.some(n[t]):$.none()},vn=function(n){return pn(n,0)},hn=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return $.none()},bn=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}},yn=function(n,t){var e=bn(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return Sn(r(1),r(2))},xn=function(n,t){var e=String(t).toLowerCase();return 0===n.length?wn():yn(n,e)},wn=function(){return Sn(0,0)},Sn=function(n,t){return{major:n,minor:t}},On={nu:Sn,detect:xn,unknown:wn},kn=function(n,t){return hn(t.brands,function(t){var e=t.brand.toLowerCase();return un(n,function(n){var t;return e===(null===(t=n.brand)||void 0===t?void 0:t.toLowerCase())}).map(function(n){return{current:n.name,version:On.nu(parseInt(t.version,10),0)}})})},Tn=function(n,t){var e=String(t).toLowerCase();return un(n,function(n){return n.search(e)})},Cn=function(n,t){return Tn(n,t).map(function(n){var e=On.detect(n.versionRegexes,t);return{current:n.name,version:e}})},En=function(n,t){return Tn(n,t).map(function(n){var e=On.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Rn=function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t},Dn=function(n,t){var e=function(n){var t=typeof n;return"string"===t||"number"===t};return n.replace(/\$\{([^{}]*)\}/g,function(n,r){var o=t[r];return e(o)?o.toString():n})},Mn=function(n,t){return-1!==n.indexOf(t)},_n=function(n,t){return Rn(n,t,n.length-t.length)},Fn=function(n){return function(t){return t.replace(n,"")}},Vn=Fn(/^\s+|\s+$/g),In=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Bn=function(n){return function(t){return Mn(t,n)}},An=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Mn(n,"edge/")&&Mn(n,"chrome")&&Mn(n,"safari")&&Mn(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,In],search:function(n){return Mn(n,"chrome")&&!Mn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Mn(n,"msie")||Mn(n,"trident")}},{name:"Opera",versionRegexes:[In,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Bn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Bn("firefox")},{name:"Safari",versionRegexes:[In,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Mn(n,"safari")||Mn(n,"mobile/"))&&Mn(n,"applewebkit")}}],Hn=[{name:"Windows",search:Bn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Mn(n,"iphone")||Mn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Bn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Bn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Bn("linux"),versionRegexes:[]},{name:"Solaris",search:Bn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Bn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Bn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Nn={browsers:_(An),oses:_(Hn)},Pn="Edge",zn="Chrome",jn="IE",Ln="Opera",$n="Firefox",Gn="Safari",Un=function(){return Wn({current:void 0,version:On.unknown()})},Wn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(Pn),isChrome:r(zn),isIE:r(jn),isOpera:r(Ln),isFirefox:r($n),isSafari:r(Gn)}},Xn={unknown:Un,nu:Wn,edge:_(Pn),chrome:_(zn),ie:_(jn),opera:_(Ln),firefox:_($n),safari:_(Gn)},qn="Windows",Kn="iOS",Yn="Android",Jn="Linux",Qn="OSX",Zn="Solaris",nt="FreeBSD",tt="ChromeOS",et=function(){return rt({current:void 0,version:On.unknown()})},rt=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(qn),isiOS:r(Kn),isAndroid:r(Yn),isOSX:r(Qn),isLinux:r(Jn),isSolaris:r(Zn),isFreeBSD:r(nt),isChromeOS:r(tt)}},ot={unknown:et,nu:rt,windows:_(qn),ios:_(Kn),android:_(Yn),linux:_(Jn),osx:_(Qn),solaris:_(Zn),freebsd:_(nt),chromeos:_(tt)},it=function(n,t,e){var r=Nn.browsers(),o=Nn.oses(),i=t.bind(function(n){return kn(r,n)}).orThunk(function(){return Cn(r,n)}).fold(Xn.unknown,Xn.nu),u=En(o,n).fold(ot.unknown,ot.nu),c=U(u,i,n,e);return{browser:i,os:u,deviceType:c}},ut={detect:it},ct=function(n){return window.matchMedia(n).matches},at=G(function(){return ut.detect(navigator.userAgent,$.from(navigator.userAgentData),ct)}),ft=function(){return at()},st=_,lt=st("touchstart"),dt=st("touchmove"),mt=st("touchend"),gt=st("mousedown"),pt=st("mousemove"),vt=st("mouseup"),ht=st("mouseover"),bt=st("keydown"),yt=st("keyup"),xt=st("input"),wt=st("change"),St=st("click"),Ot=st("transitionend"),kt=st("selectstart"),Tt=function(n){return _("alloy."+n)},Ct={tap:Tt("tap")},Et=Tt("focus"),Rt=Tt("blur.post"),Dt=Tt("paste.post"),Mt=Tt("receive"),_t=Tt("execute"),Ft=Tt("focus.item"),Vt=Ct.tap,It=Tt("longpress"),Bt=Tt("system.init"),At=Tt("system.attached"),Ht=Tt("system.detached"),Nt=Tt("focusReceptionist.shifted"),Pt=Tt("highlight"),zt=Tt("dehighlight"),jt=function(n,t){Ut(n,n.element,t,{})},Lt=function(n,t,e){Ut(n,n.element,t,e)},$t=function(n){jt(n,_t())},Gt=function(n,t,e){Ut(n,t,e,{})},Ut=function(n,t,e,r){var o=m({target:t},r);n.getSystem().triggerEvent(e,t,o)},Wt=function(n,t,e,r){n.getSystem().triggerEvent(e,t,r.event)},Xt=function(n,t){n.getSystem().triggerFocus(t,n.element)},qt=9,Kt=11,Yt=1,Jt=3,Qt=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return te(r.childNodes[0])},Zt=function(n,t){var e=t||document,r=e.createElement(n);return te(r)},ne=function(n,t){var e=t||document,r=e.createTextNode(n);return te(r)},te=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},ee=function(n,t,e){return $.from(n.dom.elementFromPoint(t,e)).map(te)},re={fromHtml:Qt,fromTag:Zt,fromText:ne,fromDom:te,fromPoint:ee},oe=function(n,t){var e=n.dom;if(e.nodeType!==Yt)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},ie=function(n){return n.nodeType!==Yt&&n.nodeType!==qt&&n.nodeType!==Kt||0===n.childElementCount},ue=function(n,t){var e=void 0===t?document:t.dom;return ie(e)?[]:Q(e.querySelectorAll(n),re.fromDom)},ce=function(n,t){var e=void 0===t?document:t.dom;return ie(e)?$.none():$.from(e.querySelector(n)).map(re.fromDom)},ae=function(n,t){return n.dom===t.dom};"undefined"!=typeof window?window:Function("return this;")();var fe,se=function(n){var t=n.dom.nodeName;return t.toLowerCase()},le=function(n){return n.dom.nodeType},de=function(n){return function(t){return le(t)===n}},me=de(Yt),ge=de(Jt),pe=de(qt),ve=de(Kt),he=function(n){return re.fromDom(n.dom.ownerDocument)},be=function(n){return pe(n)?n:he(n)},ye=function(n){return re.fromDom(be(n).dom.defaultView)},xe=function(n){return $.from(n.dom.parentNode).map(re.fromDom)},we=function(n,t){for(var e=C(t)?t:H,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=re.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o},Se=function(n){var t=function(t){return tn(t,function(t){return!ae(n,t)})};return xe(n).map(ke).map(t).getOr([])},Oe=function(n){return $.from(n.dom.nextSibling).map(re.fromDom)},ke=function(n){return Q(n.dom.childNodes,re.fromDom)},Te=function(n,t){var e=n.dom.childNodes;return $.from(e[t]).map(re.fromDom)},Ce=function(n){return Te(n,0)},Ee=function(n,t){var e=xe(n);e.each(function(e){e.dom.insertBefore(t.dom,n.dom)})},Re=function(n,t){var e=Oe(n);e.fold(function(){var e=xe(n);e.each(function(n){Me(n,t)})},function(n){Ee(n,t)})},De=function(n,t){var e=Ce(n);e.fold(function(){Me(n,t)},function(e){n.dom.insertBefore(t.dom,e.dom)})},Me=function(n,t){n.dom.appendChild(t.dom)},_e=function(n,t,e){Te(n,e).fold(function(){Me(n,t)},function(n){Ee(n,t)})},Fe=function(n,t){Z(t,function(t){Me(n,t)})},Ve=function(n){n.dom.textContent="",Z(ke(n),function(n){Ie(n)})},Ie=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Be=function(n){return ve(n)&&T(n.dom.host)},Ae=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),He=_(Ae),Ne=Ae?function(n){return re.fromDom(n.dom.getRootNode())}:be,Pe=function(n){var t=Ne(n);return Be(t)?$.some(t):$.none()},ze=function(n){return re.fromDom(n.dom.host)},je=function(n){if(He()&&T(n.target)){var t=re.fromDom(n.target);if(me(t)&&Le(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return vn(e)}}return $.from(n.target)},Le=function(n){return T(n.dom.shadowRoot)},$e=function(n){var t=ge(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var e=t.ownerDocument;return Pe(re.fromDom(t)).fold(function(){return e.body.contains(t)},M($e,ze))},Ge=function(){return Ue(re.fromDom(document))},Ue=function(n){var t=n.dom.body;if(null==t)throw new Error("Body is not available yet");return re.fromDom(t)},We=function(n){jt(n,Ht());var t=n.components();Z(t,We)},Xe=function(n){var t=n.components();Z(t,Xe),jt(n,At())},qe=function(n,t){Me(n.element,t.element)},Ke=function(n){Z(n.components(),function(n){return Ie(n.element)}),Ve(n.element),n.syncComponents()},Ye=function(n,t){var e=n.components();Ke(n);var r=dn(e,t);Z(r,function(t){We(t),n.getSystem().removeFromWorld(t)}),Z(t,function(t){t.getSystem().isConnected()?qe(n,t):(n.getSystem().addToWorld(t),qe(n,t),$e(n.element)&&Xe(t)),n.syncComponents()})},Je=function(n,t){Qe(n,t,Me)},Qe=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),$e(n.element)&&Xe(t),n.syncComponents()},Ze=function(n){We(n),Ie(n.element),n.getSystem().removeFromWorld(n)},nr=function(n){var t=xe(n.element).bind(function(t){return n.getSystem().getByDom(t).toOptional()});Ze(n),t.each(function(n){n.syncComponents()})},tr=function(n,t){er(n,t,Re)},er=function(n,t,e){e(n,t.element);var r=ke(t.element);Z(r,function(n){t.getByDom(n).each(Xe)})},rr=function(n){var t=ke(n.element);Z(t,function(t){n.getByDom(t).each(We)}),Ie(n.element)},or=Object.keys,ir=Object.hasOwnProperty,ur=function(n,t){for(var e=or(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},cr=function(n,t){return ar(n,function(n,e){return{k:e,v:t(n,e)}})},ar=function(n,t){var e={};return ur(n,function(n,r){var o=t(n,r);e[o.k]=o.v}),e},fr=function(n){return function(t,e){n[e]=t}},sr=function(n,t,e,r){var o={};return ur(n,function(n,o){(t(n,o)?e:r)(n,o)}),o},lr=function(n,t){var e={};return sr(n,t,fr(e),R),e},dr=function(n,t){var e=[];return ur(n,function(n,r){e.push(t(n,r))}),e},mr=function(n,t){for(var e=or(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];if(t(u,i,n))return $.some(u)}return $.none()},gr=function(n){return dr(n,F)},pr=function(n,t){return vr(n,t)?$.from(n[t]):$.none()},vr=function(n,t){return ir.call(n,t)},hr=function(n,t){return vr(n,t)&&void 0!==n[t]&&null!==n[t]},br=function(n,t,e){if(!(b(e)||S(e)||E(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")},yr=function(n,t,e){br(n.dom,t,e)},xr=function(n,t){var e=n.dom;ur(t,function(n,t){br(e,t,n)})},wr=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},Sr=function(n,t){return $.from(wr(n,t))},Or=function(n,t){var e=n.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},kr=function(n,t){n.dom.removeAttribute(t)},Tr=function(n,t){var e=wr(n,t);return void 0===e||""===e?[]:e.split(" ")},Cr=function(n,t,e){var r=Tr(n,t),o=r.concat([e]);return yr(n,t,o.join(" ")),!0},Er=function(n,t,e){var r=tn(Tr(n,t),function(n){return n!==e});return r.length>0?yr(n,t,r.join(" ")):kr(n,t),!1},Rr=function(n){return void 0!==n.dom.classList},Dr=function(n){return Tr(n,"class")},Mr=function(n,t){return Cr(n,"class",t)},_r=function(n,t){return Er(n,"class",t)},Fr=function(n,t){Rr(n)?n.dom.classList.add(t):Mr(n,t)},Vr=function(n){var t=Rr(n)?n.dom.classList:Dr(n);0===t.length&&kr(n,"class")},Ir=function(n,t){if(Rr(n)){var e=n.dom.classList;e.remove(t)}else _r(n,t);Vr(n)},Br=function(n,t){return Rr(n)&&n.dom.classList.contains(t)},Ar=function(n,t,e){Ir(n,e),Fr(n,t)},Hr=function(n,t,e){Ar(n.element,t.alpha,t.omega)},Nr=function(n,t,e){Ar(n.element,t.omega,t.alpha)},Pr=function(n,t,e){Ir(n.element,t.alpha),Ir(n.element,t.omega)},zr=function(n,t,e){return Br(n.element,t.alpha)},jr=function(n,t,e){return Br(n.element,t.omega)},Lr=Object.freeze({__proto__:null,toAlpha:Hr,toOmega:Nr,isAlpha:zr,isOmega:jr,clear:Pr}),$r=function(n){var t=function(t){return $r(n)},e=function(t){return $r(n)},r=function(t){return $r(t(n))},o=function(t){return $r(n)},i=function(t){t(n)},u=function(t){return t(n)},c=function(t,e){return e(n)},a=function(t){return t(n)},f=function(t){return t(n)},s=function(){return $.some(n)};return{isValue:N,isError:H,getOr:_(n),getOrThunk:_(n),getOrDie:_(n),or:t,orThunk:e,fold:c,map:r,mapError:o,each:i,bind:u,exists:a,forall:f,toOptional:s}},Gr=function(n){var t=function(n){return n()},e=function(){return B(String(n))()},r=F,o=function(n){return n()},i=function(t){return Gr(n)},u=function(t){return Gr(t(n))},c=function(t){return Gr(n)},a=function(t,e){return t(n)};return{isValue:H,isError:N,getOr:F,getOrThunk:t,getOrDie:e,or:r,orThunk:o,fold:a,map:i,mapError:u,each:R,bind:c,exists:H,forall:N,toOptional:$.none}},Ur=function(n,t){return n.fold(function(){return Gr(t)},$r)},Wr={value:$r,error:Gr,fromOption:Ur};(function(n){n[n.Error=0]="Error",n[n.Value=1]="Value"})(fe||(fe={}));var Xr=function(n,t,e){return n.stype===fe.Error?t(n.serror):e(n.svalue)},qr=function(n){var t=[],e=[];return Z(n,function(n){Xr(n,function(n){return e.push(n)},function(n){return t.push(n)})}),{values:t,errors:e}},Kr=function(n,t){return n.stype===fe.Error?{stype:fe.Error,serror:t(n.serror)}:n},Yr=function(n,t){return n.stype===fe.Value?{stype:fe.Value,svalue:t(n.svalue)}:n},Jr=function(n,t){return n.stype===fe.Value?t(n.svalue):n},Qr=function(n,t){return n.stype===fe.Error?t(n.serror):n},Zr=function(n){return{stype:fe.Value,svalue:n}},no=function(n){return{stype:fe.Error,serror:n}},to=function(n){return Xr(n,Wr.error,Wr.value)},eo=function(n){return n.fold(no,Zr)},ro={fromResult:eo,toResult:to,svalue:Zr,partition:qr,serror:no,bind:Jr,bindError:Qr,map:Yr,mapError:Kr,fold:Xr},oo=function(n,t,e,r){return{tag:"field",key:n,newKey:t,presence:e,prop:r}},io=function(n,t){return{tag:"custom",newKey:n,instantiator:t}},uo=function(n,t,e){switch(n.tag){case"field":return t(n.key,n.newKey,n.presence,n.prop);case"custom":return e(n.newKey,n.instantiator)}},co=function(n,t){return t},ao=function(n,t){var e=y(n)&&y(t);return e?so(n,t):t},fo=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<t.length;o++){var i=t[o];for(var u in i)vr(i,u)&&(r[u]=n(r[u],i[u]))}return r}},so=fo(ao),lo=fo(co),mo=function(){return{tag:"required",process:{}}},go=function(n){return{tag:"defaultedThunk",process:n}},po=function(n){return go(_(n))},vo=function(){return{tag:"option",process:{}}},ho=function(n){return{tag:"mergeWithThunk",process:n}},bo=function(n){return ho(_(n))},yo=function(n,t){return n.length>0?ro.svalue(so(t,lo.apply(void 0,n))):ro.svalue(t)},xo=function(n){return D(ro.serror,an)(n)},wo=function(n,t){var e=ro.partition(n);return e.errors.length>0?xo(e.errors):yo(e.values,t)},So=function(n){var t=ro.partition(n);return t.errors.length>0?xo(t.errors):ro.svalue(t.values)},Oo={consolidateObj:wo,consolidateArr:So},ko=function(n){return y(n)&&or(n).length>100?" removed due to size":JSON.stringify(n,null,2)},To=function(n){var t=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:_("... (only showing first ten failures)")}]):n;return Q(t,function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})},Co=function(n,t){return ro.serror([{path:n,getErrorInfo:t}])},Eo=function(n,t,e){return Co(n,function(){return'Could not find valid *required* value for "'+t+'" in '+ko(e)})},Ro=function(n,t){return Co(n,function(){return'Choice schema did not contain choice key: "'+t+'"'})},Do=function(n,t,e){return Co(n,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+ko(t)})},Mo=function(n,t){return Co(n,function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"})},_o=function(n,t){return Co(n,_(t))},Fo=function(n){var t=function(t,e){return ro.bindError(n(e),function(n){return _o(t,n)})},e=_("val");return{extract:t,toString:e}},Vo=Fo(ro.svalue),Io=function(n,t,e,r){return pr(t,e).fold(function(){return Eo(n,e,t)},r)},Bo=function(n,t,e,r){var o=pr(n,t).getOrThunk(function(){return e(n)});return r(o)},Ao=function(n,t,e){return e(pr(n,t))},Ho=function(n,t,e,r){var o=pr(n,t).map(function(t){return!0===t?e(n):t});return r(o)},No=function(n,t,e,r,o){var i=function(n){return o.extract(t.concat([r]),n)},u=function(n){return n.fold(function(){return ro.svalue($.none())},function(n){var e=o.extract(t.concat([r]),n);return ro.map(e,$.some)})};switch(n.tag){case"required":return Io(t,e,r,i);case"defaultedThunk":return Bo(e,r,n.process,i);case"option":return Ao(e,r,u);case"defaultedOptionThunk":return Ho(e,r,n.process,u);case"mergeWithThunk":return Bo(e,r,_({}),function(t){var r=so(n.process(e),t);return i(r)})}},Po=function(n,t,e){for(var r={},o=[],i=0,u=e;i<u.length;i++){var c=u[i];uo(c,function(e,i,u,c){var a=No(u,n,t,e,c);ro.fold(a,function(n){o.push.apply(o,n)},function(n){r[i]=n})},function(n,e){r[n]=e(t)})}return o.length>0?ro.serror(o):ro.svalue(r)},zo=function(n){return or(lr(n,T))},jo=function(n){var t=Lo(n),e=en(n,function(n,t){return uo(t,function(t){var e;return so(n,(e={},e[t]=!0,e))},_(n))},{}),r=function(n,r){var o=S(r)?[]:zo(r),i=tn(o,function(n){return!hr(e,n)});return 0===i.length?t.extract(n,r):Mo(n,i)};return{extract:r,toString:t.toString}},Lo=function(n){var t=function(t,e){return Po(t,e,n)},e=function(){var t=Q(n,function(n){return uo(n,function(n,t,e,r){return n+" -> "+r.toString()},function(n,t){return"state("+n+")"})});return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:e}},$o=function(n){var t=function(t,e){var r=Q(e,function(e,r){return n.extract(t.concat(["["+r+"]"]),e)});return Oo.consolidateArr(r)},e=function(){return"array("+n.toString()+")"};return{extract:t,toString:e}},Go=function(n,t){var e=function(t,e){return $o(Fo(n)).extract(t,e)},r=function(n,r){var o=or(r),i=e(n,o);return ro.bind(i,function(e){var o=Q(e,function(n){return oo(n,n,mo(),t)});return Lo(o).extract(n,r)})},o=function(){return"setOf("+t.toString()+")"};return{extract:r,toString:o}},Uo=_(Vo),Wo=function(n,t){return Fo(function(e){var r=typeof e;return n(e)?ro.svalue(e):ro.serror("Expected type: "+t+" but got: "+r)})},Xo=Wo(C,"function"),qo=function(n,t,e,r){var o=pr(e,r);return o.fold(function(){return Do(n,e,r)},function(e){return e.extract(n.concat(["branch: "+r]),t)})},Ko=function(n,t){var e=function(e,r){var o=pr(r,n);return o.fold(function(){return Ro(e,n)},function(n){return qo(e,r,t,n)})},r=function(){return"chooseOn("+n+"). Possible values: "+or(t)};return{extract:e,toString:r}},Yo=function(n){return Fo(function(t){return n(t).fold(ro.serror,ro.svalue)})},Jo=function(n,t){return Go(function(t){return ro.fromResult(n(t))},t)},Qo=function(n,t,e){var r=t.extract([n],e);return ro.mapError(r,function(n){return{input:e,errors:n}})},Zo=function(n,t,e){return ro.toResult(Qo(n,t,e))},ni=function(n){return n.fold(function(n){throw new Error(ei(n))},F)},ti=function(n,t,e){return ni(Zo(n,t,e))},ei=function(n){return"Errors: \n"+To(n.errors).join("\n")+"\n\nInput object: "+ko(n.input)},ri=function(n,t){return Ko(n,cr(t,Lo))},oi=oo,ii=io,ui=function(n){return oi(n,n,mo(),Uo())},ci=function(n,t){return oi(n,n,mo(),t)},ai=function(n,t){return oi(n,n,vo(),Fo(function(e){return ro.serror("The field: "+n+" is forbidden. "+t)}))},fi=function(n,t){return oi(n,n,mo(),Lo(t))},si=function(n){return oi(n,n,vo(),Uo())},li=function(n,t){return oi(n,n,vo(),t)},di=function(n,t){return li(n,Lo(t))},mi=function(n,t){return li(n,jo(t))},gi=function(n,t){return oi(n,n,po(t),Uo())},pi=function(n,t,e){return oi(n,n,po(t),e)},vi=function(n,t){return pi(n,t,Xo)},hi=function(n,t,e){return pi(n,t,Lo(e))},bi=[ui("alpha"),ui("omega")],yi=function(n){if(!x(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return Z(n,function(r,o){var i=or(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=r[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!x(c))throw new Error("case arguments must be an array");t.push(u),e[u]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);var a=function(n){var r=or(n);if(t.length!==r.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+r.join(","));var o=sn(t,function(n){return Y(r,n)});if(!o)throw new Error("Not all branches were specified when using match. Specified: "+r.join(", ")+"\nRequired: "+t.join(", "));return n[u].apply(null,e)};return{fold:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var i=t[o];return i.apply(null,e)},match:a,log:function(n){console.log(n,{constructors:t,constructor:u,params:e})}}}}),e},xi={generate:yi};xi.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var wi,Si=function(n){var t=[],e=[];return Z(n,function(n){n.fold(function(n){t.push(n)},function(n){e.push(n)})}),{errors:t,values:e}},Oi=function(n,t){var e={};return ur(n,function(n,r){Y(t,r)||(e[r]=n)}),e},ki=function(n,t){var e;return e={},e[n]=t,e},Ti=function(n){var t={};return Z(n,function(n){t[n.key]=n.value}),t},Ci=function(n,t){return Oi(n,t)},Ei=function(n,t){return ki(n,t)},Ri=function(n){return Ti(n)},Di=function(n,t){return 0===n.length?Wr.value(t):Wr.value(so(t,lo.apply(void 0,n)))},Mi=function(n){return Wr.error(an(n))},_i=function(n,t){var e=Si(n);return e.errors.length>0?Mi(e.errors):Di(e.values,t)},Fi=function(n,t,e){return void 0===e&&(e=V),n.exists(function(n){return e(n,t)})},Vi=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e);return t},Ii=function(n){for(var t=[],e=0;e<n.length;e++){var r=n[e];if(!r.isSome())return $.none();t.push(r.getOrDie())}return $.some(t)},Bi=function(n,t,e){return n.isSome()&&t.isSome()?$.some(e(n.getOrDie(),t.getOrDie())):$.none()},Ai=function(n,t){return n?$.some(t):$.none()},Hi=function(n){return C(n)?n:H},Ni=function(n,t,e){for(var r=n.dom,o=Hi(e);r.parentNode;){r=r.parentNode;var i=re.fromDom(r),u=t(i);if(u.isSome())return u;if(o(i))break}return $.none()},Pi=function(n,t,e){var r=t(n),o=Hi(e);return r.orThunk(function(){return o(n)?$.none():Ni(n,t,o)})},zi=function(n,t){return ae(n.element,t.event.target)},ji={can:N,abort:H,run:R},Li=function(n){if(!hr(n,"can")&&!hr(n,"abort")&&!hr(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return m(m({},ji),n)},$i=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return rn(n,function(n,r){return n&&t(r).apply(void 0,e)},!0)}},Gi=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return rn(n,function(n,r){return n||t(r).apply(void 0,e)},!1)}},Ui=function(n){return C(n)?{can:N,abort:H,run:n}:n},Wi=function(n){var t=$i(n,function(n){return n.can}),e=Gi(n,function(n){return n.abort}),r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Z(n,function(n){n.run.apply(void 0,t)})};return{can:t,abort:e,run:r}},Xi=function(n){return Ri(n)},qi=function(n,t){return{key:n,value:Li({abort:t})}},Ki=function(n,t){return{key:n,value:Li({can:t})}},Yi=function(n,t){return{key:n,value:Li({run:t})}},Ji=function(n,t,e){return{key:n,value:Li({run:function(n,r){t.apply(void 0,[n,r].concat(e))}})}},Qi=function(n){return function(t){return Yi(n,t)}},Zi=function(n){return function(t){return{key:n,value:Li({run:function(n,e){zi(n,e)&&t(n,e)}})}}},nu=function(n,t){return Yi(n,function(e,r){e.getSystem().getByUid(t).each(function(t){Wt(t,t.element,n,r)})})},tu=function(n,t,e){var r=t.partUids[e];return nu(n,r)},eu=function(n){return Yi(n,function(n,t){t.cut()})},ru=function(n){
return Yi(n,function(n,t){t.stop()})},ou=function(n,t){return Zi(n)(t)},iu=Zi(At()),uu=Zi(Ht()),cu=Zi(Bt()),au=Qi(_t()),fu=function(n,t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:su(u.slice(0,1).concat(u.slice(3)))}},n},su=function(n){return Q(n,function(n){return _n(n,"/*")?n.substring(0,n.length-"/*".length):n})},lu=function(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:su(i)}},n},du=function(n,t){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:su(i.slice(1))}},n},mu=function(n){return{classes:O(n.classes)?[]:n.classes,attributes:O(n.attributes)?{}:n.attributes,styles:O(n.styles)?{}:n.styles}},gu=function(n,t){return m(m({},n),{attributes:m(m({},n.attributes),t.attributes),styles:m(m({},n.styles),t.styles),classes:n.classes.concat(t.classes)})},pu=function(n,t,e){return au(function(r){e(r,n,t)})},vu=function(n,t,e){return cu(function(r,o){e(r,n,t)})},hu=function(n,t,e,r,o,i){var u=jo(n),c=di(t,[mi("config",n)]);return wu(u,c,t,e,r,o,i)},bu=function(n,t,e,r,o,i){var u=n,c=di(t,[li("config",n)]);return wu(u,c,t,e,r,o,i)},yu=function(n,t,e){var r=function(r){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[r].concat(o);return r.config({name:_(n)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)},function(n){var e=Array.prototype.slice.call(u,1);return t.apply(void 0,[r,n.config,n.state].concat(e))})};return fu(r,e,t)},xu=function(n){return{key:n,value:void 0}},wu=function(n,t,r,o,i,u,c){var a=function(n){return hr(n,r)?n[r]():$.none()},f=cr(i,function(n,t){return yu(r,n,t)}),s=cr(u,function(n,t){return lu(n,t)}),l=m(m(m({},s),f),{revoke:e(xu,r),config:function(t){var e=ti(r+"-config",n,t);return{key:r,value:{config:e,me:l,configAsRaw:G(function(){return ti(r+"-config",n,t)}),initialConfig:t,state:c}}},schema:_(t),exhibit:function(n,t){return Bi(a(n),pr(o,"exhibit"),function(n,e){return e(t,n.config,n.state)}).getOrThunk(function(){return mu({})})},name:_(r),handlers:function(n){return a(n).map(function(n){var t=pr(o,"events").getOr(function(){return{}});return t(n.config,n.state)}).getOr({})}});return l},Su={init:function(){return Ou({readState:_("No State required")})}},Ou=function(n){return n},ku=function(n){return Ri(n)},Tu=jo([ui("fields"),ui("name"),gi("active",{}),gi("apis",{}),gi("state",Su),gi("extra",{})]),Cu=function(n){var t=ti("Creating behaviour: "+n.name,Tu,n);return hu(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Eu=jo([ui("branchKey"),ui("branches"),ui("name"),gi("active",{}),gi("apis",{}),gi("state",Su),gi("extra",{})]),Ru=function(n){var t=ti("Creating behaviour: "+n.name,Eu,n);return bu(ri(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Du=_(void 0),Mu=Cu({fields:bi,name:"swapping",apis:Lr}),_u=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},Fu=function(){return re.fromDom(document)},Vu=function(n){return n.dom.focus()},Iu=function(n){return n.dom.blur()},Bu=function(n){var t=Ne(n).dom;return n.dom===t.activeElement},Au=function(n){return void 0===n&&(n=Fu()),$.from(n.dom.activeElement).map(re.fromDom)},Hu=function(n){return Au(Ne(n)).filter(function(t){return n.dom.contains(t.dom)})},Nu=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Pu=tinymce.util.Tools.resolve("tinymce.ThemeReceptionist"),zu=function(n){var t=document.createElement("a");t.target="_blank",t.href=n.href,t.rel="noreferrer noopener";var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(t),t.dispatchEvent(e),document.body.removeChild(t)},ju=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Lu=["undo","bold","italic","link","image","bullist","styleselect"],$u=function(n){return!1===n.getParam("skin")},Gu=function(n){return!1},Uu=function(n){return n.getParam("toolbar",Lu,"array")},Wu=function(n){return n.getParam("style_formats",ju,"array")},Xu=function(n){return n.getParam("skin_url")},qu="formatChanged",Ku="orientationChanged",Yu="dropupDismissed",Ju=function(n,t){var e=t||document,r=e.createElement("div");return r.innerHTML=n,ke(re.fromDom(r))},Qu=function(n){return n.dom.innerHTML},Zu=function(n,t){var e=he(n),r=e.dom,o=re.fromDom(r.createDocumentFragment()),i=Ju(t,r);Fe(o,i),Ve(n),Me(n,o)},nc=function(n){var t=re.fromTag("div"),e=re.fromDom(n.dom.cloneNode(!0));return Me(t,e),Qu(t)},tc=function(n,t){return re.fromDom(n.dom.cloneNode(t))},ec=function(n){return tc(n,!1)},rc=function(n){if(Be(n))return"#shadow-root";var t=ec(n);return nc(t)},oc=function(n){return rc(n)},ic=function(n,t){return t.universal?n:tn(n,function(n){return Y(t.channels,n)})},uc=function(n){return Xi([Yi(Mt(),function(t,e){var r=n.channels,o=or(r),i=e,u=ic(o,i);Z(u,function(n){var e=r[n],o=e.schema,u=ti("channel["+n+"] data\nReceiver: "+oc(t.element),o,i.data);e.onReceive(t,u)})})])},cc=Object.freeze({__proto__:null,events:uc}),ac="unknown";(function(n){n[n.STOP=0]="STOP",n[n.NORMAL=1]="NORMAL",n[n.LOGGING=2]="LOGGING"})(wi||(wi={}));var fc=_u({}),sc=function(n,t){var e=[],r=(new Date).getTime();return{logEventCut:function(n,t,r){e.push({outcome:"cut",target:t,purpose:r})},logEventStopped:function(n,t,r){e.push({outcome:"stopped",target:t,purpose:r})},logNoParent:function(n,t,r){e.push({outcome:"no-parent",target:t,purpose:r})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,r){e.push({outcome:"response",purpose:r,target:t})},write:function(){var o=(new Date).getTime();Y(["mousemove","mouseover","mouseout",Bt()],n)||console.log(n,{event:n,time:o-r,target:t.dom,sequence:Q(e,function(n){return Y(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+oc(n.target)+")":n.outcome})})}}},lc=function(n,t,e){var r=pr(fc.get(),n).orThunk(function(){var t=or(fc.get());return hn(t,function(t){return n.indexOf(t)>-1?$.some(fc.get()[t]):$.none()})}).getOr(wi.NORMAL);switch(r){case wi.NORMAL:return e(vc());case wi.LOGGING:var o=sc(n,t),i=e(o);return o.write(),i;case wi.STOP:return!0}},dc=["alloy/data/Fields","alloy/debugging/Debugging"],mc=function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return un(t,function(n){return n.indexOf("alloy")>0&&!J(dc,function(t){return n.indexOf(t)>-1})}).getOr(ac)}return ac},gc={logEventCut:R,logEventStopped:R,logNoParent:R,logEventNoHandlers:R,logEventResponse:R,write:R},pc=function(n,t,e){return lc(n,t,e)},vc=_(gc),hc=_([ui("menu"),ui("selectedMenu")]),bc=_([ui("item"),ui("selectedItem")]);_(Lo(bc().concat(hc())));var yc,xc=_(Lo(bc())),wc=fi("initSize",[ui("numColumns"),ui("numRows")]),Sc=function(){return ci("markers",xc())},Oc=function(){return fi("markers",[ui("backgroundMenu")].concat(hc()).concat(bc()))},kc=function(n){return fi("markers",Q(n,ui))},Tc=function(n,t,e){return mc(),oi(t,t,e,Yo(function(n){return Wr.value(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)})}))},Cc=function(n){return Tc("onHandler",n,po(R))},Ec=function(n){return Tc("onKeyboardHandler",n,po($.none))},Rc=function(n){return Tc("onHandler",n,mo())},Dc=function(n){return Tc("onKeyboardHandler",n,mo())},Mc=function(n,t){return ii(n,_(t))},_c=function(n){return ii(n,F)},Fc=_(wc),Vc=[ci("channels",Jo(Wr.value,jo([Rc("onReceive"),gi("schema",Uo())])))],Ic=Cu({fields:Vc,name:"receiving",active:cc}),Bc=function(n){var t=function(){var t=_u(n),e=function(){return t.get()},r=function(n){return t.set(n)},o=function(){return t.set(n)},i=function(){return t.get()};return{get:e,set:r,clear:o,readState:i}};return{init:t}},Ac=function(n,t,e){var r=t.aria;r.update(n,r,e.get())},Hc=function(n,t,e){t.toggleClass.each(function(t){e.get()?Fr(n.element,t):Ir(n.element,t)})},Nc=function(n,t,e){jc(n,t,e,!e.get())},Pc=function(n,t,e){e.set(!0),Hc(n,t,e),Ac(n,t,e)},zc=function(n,t,e){e.set(!1),Hc(n,t,e),Ac(n,t,e)},jc=function(n,t,e,r){var o=r?Pc:zc;o(n,t,e)},Lc=function(n,t,e){return e.get()},$c=function(n,t,e){jc(n,t,e,t.selected)},Gc=Object.freeze({__proto__:null,onLoad:$c,toggle:Nc,isOn:Lc,on:Pc,off:zc,set:jc}),Uc=function(){return mu({})},Wc=function(n,t){var e=pu(n,t,Nc),r=vu(n,t,$c);return Xi(an([n.toggleOnExecute?[e]:[],[r]]))},Xc=Object.freeze({__proto__:null,exhibit:Uc,events:Wc}),qc=function(n,t,e){yr(n.element,"aria-pressed",e),t.syncWithExpanded&&Jc(n,t,e)},Kc=function(n,t,e){yr(n.element,"aria-selected",e)},Yc=function(n,t,e){yr(n.element,"aria-checked",e)},Jc=function(n,t,e){yr(n.element,"aria-expanded",e)},Qc=[gi("selected",!1),si("toggleClass"),gi("toggleOnExecute",!0),pi("aria",{mode:"none"},ri("mode",{pressed:[gi("syncWithExpanded",!1),Mc("update",qc)],checked:[Mc("update",Yc)],expanded:[Mc("update",Jc)],selected:[Mc("update",Kc)],none:[Mc("update",R)]}))],Zc=Cu({fields:Qc,name:"toggling",active:Xc,apis:Gc,state:Bc(!1)}),na=function(n,t){return Ic.config({channels:Ei(qu,{onReceive:function(e,r){r.command===n&&t(e,r.state)}})})},ta=function(n){return Ic.config({channels:Ei(Ku,{onReceive:n})})},ea=function(n,t){return{key:n,value:{onReceive:t}}},ra="tinymce-mobile",oa=function(n){return ra+"-"+n},ia=function(){var n=function(n,t){t.stop(),$t(n)};return[Yi(St(),n),Yi(Vt(),n),eu(lt()),eu(gt())]},ua=function(n){var t=function(n){return au(function(t,e){n(t),e.stop()})};return Xi(an([n.map(t).toArray(),ia()]))},ca=function(n,t){t.ignore||(Vu(n.element),t.onFocus(n))},aa=function(n,t){t.ignore||Iu(n.element)},fa=function(n){return Bu(n.element)},sa=Object.freeze({__proto__:null,focus:ca,blur:aa,isFocused:fa}),la=function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return mu(e)},da=function(n){return Xi([Yi(Et(),function(t,e){ca(t,n),e.stop()})].concat(n.stopMousedown?[Yi(gt(),function(n,t){t.event.prevent()})]:[]))},ma=Object.freeze({__proto__:null,exhibit:la,events:da}),ga=[Cc("onFocus"),gi("stopMousedown",!1),gi("ignore",!1)],pa=Cu({fields:ga,name:"focusing",active:ma,apis:sa}),va=function(n){return void 0!==n.style&&C(n.style.getPropertyValue)},ha=function(n,t,e){if(!b(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);va(n)&&n.style.setProperty(t,e)},ba=function(n,t){va(n)&&n.style.removeProperty(t)},ya=function(n,t,e){var r=n.dom;ha(r,t,e)},xa=function(n,t){var e=n.dom;ur(t,function(n,t){ha(e,t,n)})},wa=function(n,t){var e=n.dom,r=window.getComputedStyle(e),o=r.getPropertyValue(t);return""!==o||$e(n)?o:Sa(e,t)},Sa=function(n,t){return va(n)?n.style.getPropertyValue(t):""},Oa=function(n,t){var e=n.dom,r=Sa(e,t);return $.from(r).filter(function(n){return n.length>0})},ka=function(n,t){var e=n.dom;ba(e,t),Fi(Sr(n,"style").map(Vn),"")&&kr(n,"style")},Ta=function(n){return n.dom.offsetWidth},Ca=function(n,t){var e=function(t,e){if(!E(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var r=t.dom;va(r)&&(r.style[n]=e+"px")},r=function(e){var r=t(e);if(r<=0||null===r){var o=wa(e,n);return parseFloat(o)||0}return r},o=r,i=function(n,t){return rn(t,function(t,e){var r=wa(n,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?t:t+o},0)},u=function(n,t,e){var r=i(n,e),o=t>r?t-r:0;return o};return{set:e,get:r,getOuter:o,aggregate:i,max:u}},Ea=Ca("height",function(n){var t=n.dom;return $e(n)?t.getBoundingClientRect().height:t.offsetHeight}),Ra=function(n){return Ea.get(n)},Da=function(n,t,e){return tn(we(n,e),t)},Ma=function(n,t){return tn(Se(n),t)},_a=function(n){return ue(n)},Fa=function(n,t,e){return Da(n,function(n){return oe(n,t)},e)},Va=function(n,t){return Ma(n,function(n){return oe(n,t)})},Ia=function(n,t){return ue(t,n)},Ba=function(n,t,e){for(var r=n.dom,o=C(e)?e:H;r.parentNode;){r=r.parentNode;var i=re.fromDom(r);if(t(i))return $.some(i);if(o(i))break}return $.none()},Aa=function(n,t,e){var o=function(n,t){return t(n)};return r(o,Ba,n,t,e)},Ha=function(n,t){var e=function(n){for(var r=0;r<n.childNodes.length;r++){var o=re.fromDom(n.childNodes[r]);if(t(o))return $.some(o);var i=e(n.childNodes[r]);if(i.isSome())return i}return $.none()};return e(n.dom)},Na=function(n){return ce(n)},Pa=function(n,t,e){return Ba(n,function(n){return oe(n,t)},e)},za=function(n,t){return ce(t,n)},ja=function(n,t,e){var o=function(n,t){return oe(n,t)};return r(o,Pa,n,t,e)},La=[8],$a=[9],Ga=[13],Ua=[27],Wa=[32],Xa=[37],qa=[38],Ka=[39],Ya=[40],Ja=function(n,t,e){var r=ln(n.slice(0,t)),o=ln(n.slice(t+1));return un(r.concat(o),e)},Qa=function(n,t,e){var r=ln(n.slice(0,t));return un(r,e)},Za=function(n,t,e){var r=n.slice(0,t),o=n.slice(t+1);return un(o.concat(r),e)},nf=function(n,t,e){var r=n.slice(t+1);return un(r,e)},tf=function(n){return function(t){var e=t.raw;return Y(n,e.which)}},ef=function(n){return function(t){return sn(n,function(n){return n(t)})}},rf=function(n){var t=n.raw;return!0===t.shiftKey},of=function(n){var t=n.raw;return!0===t.ctrlKey},uf=I(rf),cf=function(n,t){return{matches:n,classification:t}},af=function(n,t){var e=un(n,function(n){return n.matches(t)});return e.map(function(n){return n.classification})},ff=function(n,t,e,r){var o=n+t;return o>r?e:o<e?r:o},sf=function(n,t,e){return Math.min(Math.max(n,t),e)},lf=function(n,t,e,r){var o=Ia(n.element,"."+t.highlightClass);Z(o,function(e){J(r,function(n){return n.element===e})||(Ir(e,t.highlightClass),n.getSystem().getByDom(e).each(function(e){t.onDehighlight(n,e),jt(e,zt())}))})},df=function(n,t,e){return lf(n,t,e,[])},mf=function(n,t,e,r){yf(n,t,e,r)&&(Ir(r.element,t.highlightClass),t.onDehighlight(n,r),jt(r,zt()))},gf=function(n,t,e,r){lf(n,t,e,[r]),yf(n,t,e,r)||(Fr(r.element,t.highlightClass),t.onHighlight(n,r),jt(r,Pt()))},pf=function(n,t,e){Sf(n,t).each(function(r){gf(n,t,e,r)})},vf=function(n,t,e){Of(n,t).each(function(r){gf(n,t,e,r)})},hf=function(n,t,e,r){wf(n,t,e,r).fold(function(n){throw n},function(r){gf(n,t,e,r)})},bf=function(n,t,e,r){var o=Ef(n,t),i=un(o,r);i.each(function(r){gf(n,t,e,r)})},yf=function(n,t,e,r){return Br(r.element,t.highlightClass)},xf=function(n,t,e){return za(n.element,"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},wf=function(n,t,e,r){var o=Ia(n.element,"."+t.itemClass);return $.from(o[r]).fold(function(){return Wr.error(new Error("No element found with index "+r))},n.getSystem().getByDom)},Sf=function(n,t,e){return za(n.element,"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOptional()})},Of=function(n,t,e){var r=Ia(n.element,"."+t.itemClass),o=r.length>0?$.some(r[r.length-1]):$.none();return o.bind(function(t){return n.getSystem().getByDom(t).toOptional()})},kf=function(n,t,e,r){var o=Ia(n.element,"."+t.itemClass),i=cn(o,function(n){return Br(n,t.highlightClass)});return i.bind(function(t){var e=ff(t,r,0,o.length-1);return n.getSystem().getByDom(o[e]).toOptional()})},Tf=function(n,t,e){return kf(n,t,e,-1)},Cf=function(n,t,e){return kf(n,t,e,1)},Ef=function(n,t,e){var r=Ia(n.element,"."+t.itemClass);return Vi(Q(r,function(t){return n.getSystem().getByDom(t).toOptional()}))},Rf=Object.freeze({__proto__:null,dehighlightAll:df,dehighlight:mf,highlight:gf,highlightFirst:pf,highlightLast:vf,highlightAt:hf,highlightBy:bf,isHighlighted:yf,getHighlighted:xf,getFirst:Sf,getLast:Of,getPrevious:Tf,getNext:Cf,getCandidates:Ef}),Df=[ui("highlightClass"),ui("itemClass"),Cc("onHighlight"),Cc("onDehighlight")],Mf=Cu({fields:Df,name:"highlighting",apis:Rf}),_f=function(n,t,e){var r=t.exists(function(n){return e.exists(function(t){return ae(t,n)})});r||Lt(n,Nt(),{prevFocus:t,newFocus:e})},Ff=function(){var n=function(n){return Hu(n.element)},t=function(t,e){var r=n(t);t.getSystem().triggerFocus(e,t.element);var o=n(t);_f(t,r,o)};return{get:n,set:t}},Vf=function(){var n=function(n){return Mf.getHighlighted(n).map(function(n){return n.element})},t=function(t,e){var r=n(t);t.getSystem().getByDom(e).fold(R,function(n){Mf.highlight(t,n)});var o=n(t);_f(t,r,o)};return{get:n,set:t}};(function(n){n.OnFocusMode="onFocus",n.OnEnterOrSpaceMode="onEnterOrSpace",n.OnApiMode="onApi"})(yc||(yc={}));var If=function(n,t,e,r,o){var i=function(){return n.concat([gi("focusReceptionist",Ff()),pi("focusInside","onFocus",Yo(function(n){return Y(["onFocus","onEnterOrSpace","onApi"],n)?Wr.value(n):Wr.error("Invalid value for focusInside")})),Mc("handler",a),Mc("state",t),Mc("sendFocusIn",o)])},u=function(n,t,e,r,o){var i=e(n,t,r,o);return af(i,t.event).bind(function(e){return e(n,t,r,o)})},c=function(n,t){var i=n.focusInside!==yc.OnFocusMode?$.none():o(n).map(function(e){return Yi(Et(),function(r,o){e(r,n,t),o.stop()})}),c=function(e,r){var i=tf(Wa.concat(Ga))(r.event);n.focusInside===yc.OnEnterOrSpaceMode&&i&&zi(e,r)&&o(n).each(function(o){o(e,n,t),r.stop()})},a=[Yi(bt(),function(r,o){u(r,o,e,n,t).fold(function(){c(r,o)},function(n){o.stop()})}),Yi(yt(),function(e,o){u(e,o,r,n,t).each(function(n){o.stop()})})];return Xi(i.toArray().concat(a))},a={schema:i,processKey:u,toEvents:c};return a},Bf=function(n){var t=[si("onEscape"),si("onEnter"),gi("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),gi("firstTabstop",0),gi("useTabstopAt",N),si("visibilitySelector")].concat([n]),r=function(n,t){var e=n.visibilitySelector.bind(function(n){return ja(t,n)}).getOr(t);return Ra(e)>0},o=function(n,t){var e=Ia(n.element,t.selector),o=tn(e,function(n){return r(t,n)});return $.from(o[t.firstTabstop])},i=function(n,t){return t.focusReceptionist.get(n).bind(function(n){return ja(n,t.selector)})},u=function(n,t){return r(n,t)&&n.useTabstopAt(t)},c=function(n,t,e){o(n,t).each(function(e){t.focusReceptionist.set(n,e)})},a=function(n,t,e,r,o){return o(t,e,function(n){return u(r,n)}).fold(function(){return r.cyclic?$.some(!0):$.none()},function(t){return r.focusReceptionist.set(n,t),$.some(!0)})},f=function(n,t,r,o){var u=Ia(n.element,r.selector);return i(n,r).bind(function(t){var i=cn(u,e(ae,t));return i.bind(function(t){return a(n,u,t,r,o)})})},s=function(n,t,e){var r=e.cyclic?Ja:Qa;return f(n,t,e,r)},l=function(n,t,e){var r=e.cyclic?Za:nf;return f(n,t,e,r)},d=function(n,t,e){return e.onEnter.bind(function(e){return e(n,t)})},m=function(n,t,e){return e.onEscape.bind(function(e){return e(n,t)})},g=_([cf(ef([rf,tf($a)]),s),cf(tf($a),l),cf(tf(Ua),m),cf(ef([uf,tf(Ga)]),d)]),p=_([]);return If(t,Su.init,g,p,function(){return $.some(c)})},Af=Bf(ii("cyclic",H)),Hf=Bf(ii("cyclic",N)),Nf=function(n){return"input"===se(n)&&"radio"!==wr(n,"type")||"textarea"===se(n)},Pf=function(n,t,e){return Gt(n,e,_t()),$.some(!0)},zf=function(n,t,e){var r=Nf(e)&&tf(Wa)(t.event);return r?$.none():Pf(n,t,e)},jf=function(n,t){return $.some(!0)},Lf=[gi("execute",zf),gi("useSpace",!1),gi("useEnter",!0),gi("useControlEnter",!1),gi("useDown",!1)],$f=function(n,t,e){return e.execute(n,t,n.element)},Gf=function(n,t,e,r){var o=e.useSpace&&!Nf(n.element)?Wa:[],i=e.useEnter?Ga:[],u=e.useDown?Ya:[],c=o.concat(i).concat(u);return[cf(tf(c),$f)].concat(e.useControlEnter?[cf(ef([of,tf(Ga)]),$f)]:[])},Uf=function(n,t,e,r){return e.useSpace&&!Nf(n.element)?[cf(tf(Wa),jf)]:[]},Wf=If(Lf,Su.init,Gf,Uf,function(){return $.none()}),Xf=function(n){var t=_u($.none()),e=function(){return t.get().each(n)},r=function(){e(),t.set($.none())},o=function(){return t.get().isSome()},i=function(){return t.get()},u=function(n){e(),t.set($.some(n))};return{clear:r,isSet:o,get:i,set:u}},qf=function(){return Xf(function(n){return n.destroy()})},Kf=function(){var n=qf(),t=function(t){return n.get().each(t)};return m(m({},n),{run:t})},Yf=function(){var n=Xf(R),t=function(t){return n.get().each(t)};return m(m({},n),{on:t})},Jf=function(){var n=Yf(),t=function(t,e){n.set({numRows:t,numColumns:e})},e=function(){return n.get().map(function(n){return n.numRows})},r=function(){return n.get().map(function(n){return n.numColumns})};return Ou({readState:function(){return n.get().map(function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:e,getNumColumns:r})},Qf=function(n){return n.state(n)},Zf=Object.freeze({__proto__:null,flatgrid:Jf,init:Qf}),ns=function(n,t){return function(e){return"rtl"===ts(e)?t:n}},ts=function(n){return"rtl"===wa(n,"direction")?"rtl":"ltr"},es=function(n){return function(t,e,r,o){var i=n(t.element);return us(i,t,e,r,o)}},rs=function(n,t){var e=ns(n,t);return es(e)},os=function(n,t){var e=ns(t,n);return es(e)},is=function(n){return function(t,e,r,o){return us(n,t,e,r,o)}},us=function(n,t,e,r,o){var i=r.focusReceptionist.get(t).bind(function(e){return n(t.element,e,r,o)});return i.map(function(n){return r.focusReceptionist.set(t,n),!0})},cs=is,as=is,fs=is,ss=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0},ls=function(n){return!ss(n.dom)},ds=function(n,t){return cn(n,t).map(function(t){return{index:t,candidates:n}})},ms=function(n,t,e){var r=function(n){return ae(n,t)},o=Ia(n,e),i=tn(o,ls);return ds(i,r)},gs=function(n,t){return cn(n,function(n){return ae(t,n)})},ps=function(n,t,e,r){var o=Math.floor(t/e),i=t%e;return r(o,i).bind(function(t){var r=t.row*e+t.column;return r>=0&&r<n.length?$.some(n[r]):$.none()})},vs=function(n,t,e,r,o){return ps(n,t,r,function(t,i){var u=t===e-1,c=u?n.length-t*r:r,a=ff(i,o,0,c-1);return $.some({row:t,column:a})})},hs=function(n,t,e,r,o){return ps(n,t,r,function(t,i){var u=ff(t,o,0,e-1),c=u===e-1,a=c?n.length-u*r:r,f=sf(i,0,a-1);return $.some({row:u,column:f})})},bs=function(n,t,e,r){return vs(n,t,e,r,1)},ys=function(n,t,e,r){return vs(n,t,e,r,-1)},xs=function(n,t,e,r){return hs(n,t,e,r,-1)},ws=function(n,t,e,r){return hs(n,t,e,r,1)},Ss=[ui("selector"),gi("execute",zf),Ec("onEscape"),gi("captureTab",!1),Fc()],Os=function(n,t,e){za(n.element,t.selector).each(function(e){t.focusReceptionist.set(n,e)})},ks=function(n,t){return t.focusReceptionist.get(n).bind(function(n){return ja(n,t.selector)})},Ts=function(n,t,e,r){return ks(n,e).bind(function(r){return e.execute(n,t,r)})},Cs=function(n){return function(t,e,r,o){return ms(t,e,r.selector).bind(function(t){return n(t.candidates,t.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))})}},Es=function(n,t,e){return e.captureTab?$.some(!0):$.none()},Rs=function(n,t,e){return e.onEscape(n,t)},Ds=Cs(ys),Ms=Cs(bs),_s=Cs(xs),Fs=Cs(ws),Vs=_([cf(tf(Xa),rs(Ds,Ms)),cf(tf(Ka),os(Ds,Ms)),cf(tf(qa),cs(_s)),cf(tf(Ya),as(Fs)),cf(ef([rf,tf($a)]),Es),cf(ef([uf,tf($a)]),Es),cf(tf(Ua),Rs),cf(tf(Wa.concat(Ga)),Ts)]),Is=_([cf(tf(Wa),jf)]),Bs=If(Ss,Jf,Vs,Is,function(){return $.some(Os)}),As=function(n,t,e,r){var o=function(n){return"button"===se(n)&&"disabled"===wr(n,"disabled")},i=function(n,t,e){var u=ff(t,r,0,e.length-1);return u===n?$.none():o(e[u])?i(n,u,e):$.from(e[u])};return ms(n,e,t).bind(function(n){var t=n.index,e=n.candidates;return i(t,t,e)})},Hs=[ui("selector"),gi("getInitial",$.none),gi("execute",zf),Ec("onEscape"),gi("executeOnMove",!1),gi("allowVertical",!0)],Ns=function(n,t){return t.focusReceptionist.get(n).bind(function(n){return ja(n,t.selector)})},Ps=function(n,t,e){return Ns(n,e).bind(function(r){return e.execute(n,t,r)})},zs=function(n,t,e){t.getInitial(n).orThunk(function(){return za(n.element,t.selector)}).each(function(e){t.focusReceptionist.set(n,e)})},js=function(n,t,e){return As(n,e.selector,t,-1)},Ls=function(n,t,e){return As(n,e.selector,t,1)},$s=function(n){return function(t,e,r,o){return n(t,e,r,o).bind(function(){return r.executeOnMove?Ps(t,e,r):$.some(!0)})}},Gs=function(n,t,e){return e.onEscape(n,t)},Us=function(n,t,e,r){var o=Xa.concat(e.allowVertical?qa:[]),i=Ka.concat(e.allowVertical?Ya:[]);return[cf(tf(o),$s(rs(js,Ls))),cf(tf(i),$s(os(js,Ls))),cf(tf(Ga),Ps),cf(tf(Wa),Ps),cf(tf(Ua),Gs)]},Ws=_([cf(tf(Wa),jf)]),Xs=If(Hs,Su.init,Us,Ws,function(){return $.some(zs)}),qs=function(n,t,e){return $.from(n[t]).bind(function(n){return $.from(n[e]).map(function(n){return{rowIndex:t,columnIndex:e,cell:n}})})},Ks=function(n,t,e,r){var o=n[t],i=o.length,u=ff(e,r,0,i-1);return qs(n,t,u)},Ys=function(n,t,e,r){var o=ff(e,r,0,n.length-1),i=n[o].length,u=sf(t,0,i-1);return qs(n,o,u)},Js=function(n,t,e,r){var o=n[t],i=o.length,u=sf(e+r,0,i-1);return qs(n,t,u)},Qs=function(n,t,e,r){var o=sf(e+r,0,n.length-1),i=n[o].length,u=sf(t,0,i-1);return qs(n,o,u)},Zs=function(n,t,e){return Ks(n,t,e,1)},nl=function(n,t,e){return Ks(n,t,e,-1)},tl=function(n,t,e){return Ys(n,e,t,-1)},el=function(n,t,e){return Ys(n,e,t,1)},rl=function(n,t,e){return Js(n,t,e,-1)},ol=function(n,t,e){return Js(n,t,e,1)},il=function(n,t,e){return Qs(n,e,t,-1)},ul=function(n,t,e){return Qs(n,e,t,1)},cl=[fi("selectors",[ui("row"),ui("cell")]),gi("cycles",!0),gi("previousSelector",$.none),gi("execute",zf)],al=function(n,t,e){var r=t.previousSelector(n).orThunk(function(){var e=t.selectors;return za(n.element,e.cell)});r.each(function(e){t.focusReceptionist.set(n,e)})},fl=function(n,t,e){return Hu(n.element).bind(function(r){return e.execute(n,t,r)})},sl=function(n,t){return Q(n,function(n){return Ia(n,t.selectors.cell)})},ll=function(n,t){return function(e,r,o){var i=o.cycles?n:t;return ja(r,o.selectors.row).bind(function(n){var t=Ia(n,o.selectors.cell);return gs(t,r).bind(function(t){var r=Ia(e,o.selectors.row);return gs(r,n).bind(function(n){var e=sl(r,o);return i(e,n,t).map(function(n){return n.cell})})})})}},dl=ll(nl,rl),ml=ll(Zs,ol),gl=ll(tl,il),pl=ll(el,ul),vl=_([cf(tf(Xa),rs(dl,ml)),cf(tf(Ka),os(dl,ml)),cf(tf(qa),cs(gl)),cf(tf(Ya),as(pl)),cf(tf(Wa.concat(Ga)),fl)]),hl=_([cf(tf(Wa),jf)]),bl=If(cl,Su.init,vl,hl,function(){return $.some(al)}),yl=[ui("selector"),gi("execute",zf),gi("moveOnTab",!1)],xl=function(n,t,e){return e.focusReceptionist.get(n).bind(function(r){return e.execute(n,t,r)})},wl=function(n,t,e){za(n.element,t.selector).each(function(e){t.focusReceptionist.set(n,e)})},Sl=function(n,t,e){return As(n,e.selector,t,-1)},Ol=function(n,t,e){return As(n,e.selector,t,1)},kl=function(n,t,e,r){return e.moveOnTab?fs(Sl)(n,t,e,r):$.none()},Tl=function(n,t,e,r){return e.moveOnTab?fs(Ol)(n,t,e,r):$.none()},Cl=_([cf(tf(qa),fs(Sl)),cf(tf(Ya),fs(Ol)),cf(ef([rf,tf($a)]),kl),cf(ef([uf,tf($a)]),Tl),cf(tf(Ga),xl),cf(tf(Wa),xl)]),El=_([cf(tf(Wa),jf)]),Rl=If(yl,Su.init,Cl,El,function(){return $.some(wl)}),Dl=[Ec("onSpace"),Ec("onEnter"),Ec("onShiftEnter"),Ec("onLeft"),Ec("onRight"),Ec("onTab"),Ec("onShiftTab"),Ec("onUp"),Ec("onDown"),Ec("onEscape"),gi("stopSpaceKeyup",!1),si("focusIn")],Ml=function(n,t,e){return[cf(tf(Wa),e.onSpace),cf(ef([uf,tf(Ga)]),e.onEnter),cf(ef([rf,tf(Ga)]),e.onShiftEnter),cf(ef([rf,tf($a)]),e.onShiftTab),cf(ef([uf,tf($a)]),e.onTab),cf(tf(qa),e.onUp),cf(tf(Ya),e.onDown),cf(tf(Xa),e.onLeft),cf(tf(Ka),e.onRight),cf(tf(Wa),e.onSpace),cf(tf(Ua),e.onEscape)]},_l=function(n,t,e){return e.stopSpaceKeyup?[cf(tf(Wa),jf)]:[]},Fl=If(Dl,Su.init,Ml,_l,function(n){return n.focusIn}),Vl=Af.schema(),Il=Hf.schema(),Bl=Xs.schema(),Al=Bs.schema(),Hl=bl.schema(),Nl=Wf.schema(),Pl=Rl.schema(),zl=Fl.schema(),jl=Object.freeze({__proto__:null,acyclic:Vl,cyclic:Il,flow:Bl,flatgrid:Al,matrix:Hl,execution:Nl,menu:Pl,special:zl}),Ll=function(n){return hr(n,"setGridSize")},$l=Ru({branchKey:"mode",branches:jl,name:"keying",active:{events:function(n,t){var e=n.handler;return e.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold(function(){n.getSystem().triggerFocus(n.element,n.element)},function(r){r(n,t,e)})},setGridSize:function(n,t,e,r,o){Ll(e)?e.setGridSize(r,o):console.error("Layout does not support setGridSize")}},state:Zf}),Gl=function(n,t){return hi(n,{},Q(t,function(t){return ai(t.name(),"Cannot configure "+t.name()+" for "+n)}).concat([ii("dump",F)]))},Ul=function(n){return n.dump},Wl=function(n,t){return m(m({},ku(t)),n.dump)},Xl={field:Gl,augment:Wl,get:Ul},ql="placeholder",Kl=xi.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Yl=function(n){return vr(n,"uiType")},Jl=function(n,t,e,r){return n.exists(function(n){return n!==e.owner})?Kl.single(!0,_(e)):pr(r,e.name).fold(function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+or(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))},function(n){return n.replace()})},Ql=function(n,t,e,r){return Yl(e)&&e.uiType===ql?Jl(n,t,e,r):Kl.single(!1,_(e))},Zl=function(n,t,e,r){var o=Ql(n,t,e,r);return o.fold(function(o,i){var u=Yl(e)?i(t,e.config,e.validated):i(t),c=pr(u,"components").getOr([]),a=fn(c,function(e){return Zl(n,t,e,r)});return[m(m({},u),{components:a})]},function(n,r){if(Yl(e)){var o=r(t,e.config,e.validated),i=e.validated.preprocess.getOr(F);return i(o)}return r(t)})},nd=function(n,t,e,r){return fn(e,function(e){return Zl(n,t,e,r)})},td=function(n,t){var e=!1,r=function(){return e},o=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t},i=function(){return t.fold(function(n,t){return n},function(n,t){return n})};return{name:_(n),required:i,used:r,replace:o}},ed=function(n,t,e,r){var o=cr(r,function(n,t){return td(t,n)}),i=nd(n,t,e,o);return ur(o,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))}),i},rd=Kl.single,od=Kl.multiple,id=_(ql),ud=0,cd=function(n){var t=new Date,e=t.getTime(),r=Math.floor(1e9*Math.random());return ud++,n+"_"+r+ud+String(e)},ad=xi.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),fd=gi("factory",{sketch:F}),sd=gi("schema",[]),ld=ui("name"),dd=oi("pname","pname",go(function(n){return"<alloy."+cd(n.name)+">"}),Uo()),md=ii("schema",function(){return[si("preprocess")]}),gd=gi("defaults",_({})),pd=gi("overrides",_({})),vd=Lo([fd,sd,ld,dd,gd,pd]),hd=Lo([fd,sd,ld,gd,pd]),bd=Lo([fd,sd,ld,dd,gd,pd]),yd=Lo([fd,md,ld,ui("unit"),dd,gd,pd]),xd=function(n){return n.fold($.some,$.none,$.some,$.some)},wd=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},Sd=function(n,t){return function(e){var r=ti("Converting part type",t,e);return n(r)}},Od=Sd(ad.required,vd);Sd(ad.external,hd);var kd=Sd(ad.optional,bd),Td=Sd(ad.group,yd),Cd=_("entirety"),Ed=function(n,t,e,r){return so(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))},Rd=function(n,t,e){var r={},o={};return Z(e,function(n){n.fold(function(n){r[n.pname]=rd(!0,function(t,e,r){return n.factory.sketch(Ed(t,n,e,r))})},function(n){var e=t.parts[n.name];o[n.name]=_(n.factory.sketch(Ed(t,n,e[Cd()]),e))},function(n){r[n.pname]=rd(!1,function(t,e,r){return n.factory.sketch(Ed(t,n,e,r))})},function(n){r[n.pname]=od(!0,function(t,e,r){var o=t[n.name];return Q(o,function(e){return n.factory.sketch(so(n.defaults(t,e,r),e,n.overrides(t,e)))})})})}),{internals:_(r),externals:_(o)}},Dd=function(n,t){var e={};return Z(t,function(t){xd(t).each(function(t){var r=Md(n,t.pname)
;e[t.name]=function(e){var o=ti("Part: "+t.name+" in "+n,Lo(t.schema),e);return m(m({},r),{config:e,validated:o})}})}),e},Md=function(n,t){return{uiType:id(),owner:n,name:t}},_d=function(n,t,e){return{uiType:id(),owner:n,name:t,config:e,validated:{}}},Fd=function(n){return fn(n,function(n){return n.fold($.none,$.some,$.none,$.none).map(function(n){return fi(n.name,n.schema.concat([_c(Cd())]))}).toArray()})},Vd=function(n){return Q(n,wd)},Id=function(n,t,e){return Rd(n,t,e)},Bd=function(n,t,e){return ed($.some(n),t,t.components,e)},Ad=function(n,t,e){var r=t.partUids[e];return n.getSystem().getByUid(r).toOptional()},Hd=function(n,t,e){return Ad(n,t,e).getOrDie("Could not find part: "+e)},Nd=function(n,t){var e=n.getSystem();return cr(t.partUids,function(n,t){return _(e.getByUid(n))})},Pd=function(n,t){var e=Vd(t);return Ri(Q(e,function(t){return{key:t,value:n+"-"+t}}))},zd=function(n){return oi("partUids","partUids",ho(function(t){return Pd(t.uid,n)}),Uo())},jd=cd("alloy-premade"),Ld=function(n){return Ei(jd,n)},$d=function(n){return pr(n,jd)},Gd=function(n){return du(function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return n.apply(void 0,t([e.getApis(),e],r,!1))},n)},Ud=_("alloy-id-"),Wd=_("data-alloy-id"),Xd=Ud(),qd=Wd(),Kd=function(n,t){var e=cd(Xd+n);return Yd(t,e),e},Yd=function(n,t){Object.defineProperty(n.dom,qd,{value:t,writable:!0})},Jd=function(n){var t=me(n)?n.dom[qd]:null;return $.from(t)},Qd=function(n){return cd(n)},Zd=function(n,t){var e=n.length>0?[fi("parts",n)]:[];return e.concat([ui("uid"),gi("dom",{}),gi("components",[]),_c("originalSpec"),gi("debug.sketcher",{})]).concat(t)},nm=function(n,t,e,r,o){var i=Zd(r,o);return ti(n+" [SpecSchema]",jo(i.concat(t)),e)},tm=function(n,t,e,r){var o=om(r),i=nm(n,t,o,[],[]);return e(i,o)},em=function(n,t,e,r,o){var i=om(o),u=Fd(e),c=zd(e),a=nm(n,t,i,u,[c]),f=Id(n,a,e),s=Bd(n,a,f.internals());return r(a,s,i,f.externals())},rm=function(n){return vr(n,"uid")},om=function(n){return rm(n)?n:m(m({},n),{uid:Qd("uid")})},im=function(n){return void 0!==n.uid},um=jo([ui("name"),ui("factory"),ui("configFields"),gi("apis",{}),gi("extraApis",{})]),cm=jo([ui("name"),ui("factory"),ui("configFields"),ui("partFields"),gi("apis",{}),gi("extraApis",{})]),am=function(n){var t=ti("Sketcher for "+n.name,um,n),e=function(n){return tm(t.name,t.configFields,t.factory,n)},r=cr(t.apis,Gd),o=cr(t.extraApis,function(n,t){return lu(n,t)});return m(m({name:t.name,configFields:t.configFields,sketch:e},r),o)},fm=function(n){var t=ti("Sketcher for "+n.name,cm,n),e=function(n){return em(t.name,t.configFields,t.partFields,t.factory,n)},r=Dd(t.name,t.partFields),o=cr(t.apis,Gd),i=cr(t.extraApis,function(n,t){return lu(n,t)});return m(m({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:e,parts:r},o),i)},sm=function(n){var t=ua(n.action),e=n.dom.tag,r=function(t){return pr(n.dom,"attributes").bind(function(n){return pr(n,t)})},o=function(){if("button"===e){var n=r("type").getOr("button"),t=r("role").map(function(n){return{role:n}}).getOr({});return m({type:n},t)}var o=r("role").getOr("button");return{role:o}};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Xl.augment(n.buttonBehaviours,[pa.config({}),$l.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o()},eventOrder:n.eventOrder}},lm=am({name:"Button",factory:sm,configFields:[gi("uid",void 0),ui("dom"),gi("components",[]),Xl.field("buttonBehaviours",[pa,$l]),si("action"),si("role"),gi("eventOrder",{})]}),dm=function(){return mu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},mm=function(){return Xi([qi(kt(),N)])},gm=Object.freeze({__proto__:null,events:mm,exhibit:dm}),pm=Cu({fields:[],name:"unselecting",active:gm}),vm=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[];return rn(t,function(n,t){var e;return"class"===t.name?n:m(m({},n),(e={},e[t.name]=t.value,e))},{})},hm=function(n){return Array.prototype.slice.call(n.dom.classList,0)},bm=function(n){var t=re.fromHtml(n),e=ke(t),r=vm(t),o=hm(t),i=0===e.length?{}:{innerHtml:Qu(t)};return m({tag:se(t),classes:o,attributes:r},i)},ym=function(n){var t=Dn(n,{prefix:ra});return bm(t)},xm=function(n){return{dom:ym(n)}},wm=function(n,t){return Cm(t,function(){n.execCommand(t)},{},n)},Sm=function(n){return ku([Zc.config({toggleClass:oa("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),na(n,function(n,t){var e=t?Zc.on:Zc.off;e(n)})])},Om=function(n,t){var e=Sm(t);return Cm(t,function(){n.execCommand(t)},e,n)},km=function(n,t,e,r){var o=Sm(e);return Cm(t,r,o,n)},Tm=function(n,t){var e=t.ui.registry.getAll().icons,r=$.from(e[n]);return r.fold(function(){return ym('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')},function(n){return ym('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")})},Cm=function(n,t,e,r){return lm.sketch({dom:Tm(n,r),action:t,buttonBehaviours:so(ku([pm.config({})]),e)})},Em=kd({schema:[ui("dom")],name:"label"}),Rm=function(n){return kd({name:n+"-edge",overrides:function(t){var e=t.model.Receptionist.edgeActions[n];return e.fold(function(){return{}},function(n){return{events:Xi([Ji(lt(),function(t,e,r){return n(t,r)},[t]),Ji(gt(),function(t,e,r){return n(t,r)},[t]),Ji(pt(),function(t,e,r){r.mouseIsDown.get()&&n(t,r)},[t])])}})}})},Dm=Rm("top-left"),Mm=Rm("top"),_m=Rm("top-right"),Fm=Rm("right"),Vm=Rm("bottom-right"),Im=Rm("bottom"),Bm=Rm("bottom-left"),Am=Rm("left"),Hm=Od({name:"thumb",defaults:_({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Xi([tu(lt(),n,"spectrum"),tu(dt(),n,"spectrum"),tu(mt(),n,"spectrum"),tu(gt(),n,"spectrum"),tu(pt(),n,"spectrum"),tu(vt(),n,"spectrum")])}}}),Nm=Od({schema:[ii("mouseIsDown",function(){return _u(!1)})],name:"spectrum",overrides:function(n){var t=n.model,e=t.Receptionist,r=function(t,r){return e.getValueFromEvent(r).map(function(r){return e.setValueFrom(t,n,r)})};return{behaviours:ku([$l.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),pa.config({})]),events:Xi([Yi(lt(),r),Yi(dt(),r),Yi(gt(),r),Yi(pt(),function(t,e){n.mouseIsDown.get()&&r(t,e)})])}}}),Pm=[Em,Am,Fm,Mm,Im,Dm,_m,Bm,Vm,Hm,Nm],zm=function(n,t,e){t.store.Receptionist.onLoad(n,t,e)},jm=function(n,t,e){t.store.Receptionist.onUnload(n,t,e)},Lm=function(n,t,e,r){t.store.Receptionist.setValue(n,t,e,r)},$m=function(n,t,e){return t.store.Receptionist.getValue(n,t,e)},Gm=function(n,t,e){return e},Um=Object.freeze({__proto__:null,onLoad:zm,onUnload:jm,setValue:Lm,getValue:$m,getState:Gm}),Wm=function(n,t){var e=n.resetOnDom?[iu(function(e,r){zm(e,n,t)}),uu(function(e,r){jm(e,n,t)})]:[vu(n,t,zm)];return Xi(e)},Xm=Object.freeze({__proto__:null,events:Wm}),qm=function(){var n=_u(null),t=function(){return{mode:"memory",value:n.get()}},e=function(){return null===n.get()},r=function(){n.set(null)};return Ou({set:n.set,get:n.get,isNotSet:e,clear:r,readState:t})},Km=function(){var n=R;return Ou({readState:n})},Ym=function(){var n=_u({}),t=_u({}),e=function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},r=function(){n.set({}),t.set({})},o=function(e){return pr(n.get(),e).orThunk(function(){return pr(t.get(),e)})},i=function(e){var r=n.get(),o=t.get(),i={},u={};Z(e,function(n){i[n.value]=n,pr(n,"meta").each(function(t){pr(t,"text").each(function(t){u[t]=n})})}),n.set(m(m({},r),i)),t.set(m(m({},o),u))};return Ou({readState:e,lookup:o,update:i,clear:r})},Jm=function(n){return n.store.Receptionist.state(n)},Qm=Object.freeze({__proto__:null,memory:qm,dataset:Ym,manual:Km,init:Jm}),Zm=function(n,t,e,r){var o=t.store;e.update([r]),o.setValue(n,r),t.onSetValue(n,r)},ng=function(n,t,e){var r=t.store,o=r.getDataKey(n);return e.lookup(o).getOrThunk(function(){return r.getFallbackEntry(o)})},tg=function(n,t,e){var r=t.store;r.initialValue.each(function(r){Zm(n,t,e,r)})},eg=function(n,t,e){e.clear()},rg=[si("initialValue"),ui("getFallbackEntry"),ui("getDataKey"),ui("setValue"),Mc("Receptionist",{setValue:Zm,getValue:ng,onLoad:tg,onUnload:eg,state:Ym})],og=function(n,t,e){return t.store.getValue(n)},ig=function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},ug=function(n,t,e){t.store.initialValue.each(function(e){t.store.setValue(n,e)})},cg=[ui("getValue"),gi("setValue",R),si("initialValue"),Mc("Receptionist",{setValue:ig,getValue:og,onLoad:ug,onUnload:R,state:Su.init})],ag=function(n,t,e,r){e.set(r),t.onSetValue(n,r)},fg=function(n,t,e){return e.get()},sg=function(n,t,e){t.store.initialValue.each(function(n){e.isNotSet()&&e.set(n)})},lg=function(n,t,e){e.clear()},dg=[si("initialValue"),Mc("Receptionist",{setValue:ag,getValue:fg,onLoad:sg,onUnload:lg,state:qm})],mg=[pi("store",{mode:"memory"},ri("mode",{memory:dg,manual:cg,dataset:rg})),Cc("onSetValue"),gi("resetOnDom",!1)],gg=Cu({fields:mg,name:"representing",active:Xm,apis:Um,extra:{setValueFrom:function(n,t){var e=gg.getValue(t);gg.setValue(n,e)}},state:Qm}),pg=Ca("width",function(n){return n.dom.offsetWidth}),vg=function(n,t){return pg.set(n,t)},hg=function(n){return pg.get(n)},bg=function(n,t){var e=function(e,r){return bg(n+e,t+r)};return{left:n,top:t,translate:e}},yg=bg,xg="slider.change.value",wg=_(xg),Sg=function(n){return-1!==n.type.indexOf("touch")},Og=function(n){var t=n.event.raw;if(Sg(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?$.some(e.touches[0]).map(function(n){return yg(n.clientX,n.clientY)}):$.none()}var r=t;return void 0!==r.clientX?$.some(r).map(function(n){return yg(n.clientX,n.clientY)}):$.none()},kg="top",Tg="right",Cg="bottom",Eg="left",Rg=function(n){return n.model.minX},Dg=function(n){return n.model.minY},Mg=function(n){return n.model.minX-1},_g=function(n){return n.model.minY-1},Fg=function(n){return n.model.maxX},Vg=function(n){return n.model.maxY},Ig=function(n){return n.model.maxX+1},Bg=function(n){return n.model.maxY+1},Ag=function(n,t,e){return t(n)-e(n)},Hg=function(n){return Ag(n,Fg,Rg)},Ng=function(n){return Ag(n,Vg,Dg)},Pg=function(n){return Hg(n)/2},zg=function(n){return Ng(n)/2},jg=function(n){return n.stepSize},Lg=function(n){return n.snapToGrid},$g=function(n){return n.snapStart},Gg=function(n){return n.rounded},Ug=function(n,t){return void 0!==n[t+"-edge"]},Wg=function(n){return Ug(n,Eg)},Xg=function(n){return Ug(n,Tg)},qg=function(n){return Ug(n,kg)},Kg=function(n){return Ug(n,Cg)},Yg=function(n){return n.model.value.get()},Jg=function(n){return{x:n}},Qg=function(n){return{y:n}},Zg=function(n,t){return{x:n,y:t}},np=function(n,t){Lt(n,wg(),{value:t})},tp=function(n,t){np(n,Zg(Mg(t),_g(t)))},ep=function(n,t){np(n,Qg(_g(t)))},rp=function(n,t){np(n,Zg(Pg(t),_g(t)))},op=function(n,t){np(n,Zg(Ig(t),_g(t)))},ip=function(n,t){np(n,Jg(Ig(t)))},up=function(n,t){np(n,Zg(Ig(t),zg(t)))},cp=function(n,t){np(n,Zg(Ig(t),Bg(t)))},ap=function(n,t){np(n,Qg(Bg(t)))},fp=function(n,t){np(n,Zg(Pg(t),Bg(t)))},sp=function(n,t){np(n,Zg(Mg(t),Bg(t)))},lp=function(n,t){np(n,Jg(Mg(t)))},dp=function(n,t){np(n,Zg(Mg(t),zg(t)))},mp=function(n,t,e,r){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-r)},gp=function(n,t,e,r){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+r)},pp=function(n,t,e){return Math.max(t,Math.min(e,n))},vp=function(n,t,e,r,o){return o.fold(function(){var o=n-t,i=Math.round(o/r)*r;return pp(t+i,t-1,e+1)},function(t){var o=(n-t)%r,i=Math.round(o/r),u=Math.floor((n-t)/r),c=Math.floor((e-t)/r),a=Math.min(c,u+i),f=t+a*r;return Math.max(t,f)})},hp=function(n,t,e){return Math.min(e,Math.max(n,t))-t},bp=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?t-1:t,p=s?e+1:e;if(o<l)return g;if(o>d)return p;var v=hp(o,l,d),h=pp(v/m*r+t,g,p);return u&&h>=t&&h<=e?vp(h,t,e,i,c):a?Math.round(h):h},yp=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge;return o<t?i?0:f:o>e?u?c:s:(o-t)/r*a},xp="top",wp="right",Sp="bottom",Op="left",kp="width",Tp="height",Cp=function(n){return n.element.dom.getBoundingClientRect()},Ep=function(n,t){return n[t]},Rp=function(n){var t=Cp(n);return Ep(t,Op)},Dp=function(n){var t=Cp(n);return Ep(t,wp)},Mp=function(n){var t=Cp(n);return Ep(t,xp)},_p=function(n){var t=Cp(n);return Ep(t,Sp)},Fp=function(n){var t=Cp(n);return Ep(t,kp)},Vp=function(n){var t=Cp(n);return Ep(t,Tp)},Ip=function(n,t,e){return(n+t)/2-e},Bp=function(n,t){var e=Cp(n),r=Cp(t),o=Ep(e,Op),i=Ep(e,wp),u=Ep(r,Op);return Ip(o,i,u)},Ap=function(n,t){var e=Cp(n),r=Cp(t),o=Ep(e,xp),i=Ep(e,Sp),u=Ep(r,xp);return Ip(o,i,u)},Hp=function(n,t){Lt(n,wg(),{value:t})},Np=function(n){return{x:n}},Pp=function(n,t,e){var r={min:Rg(t),max:Fg(t),range:Hg(t),value:e,step:jg(t),snap:Lg(t),snapStart:$g(t),rounded:Gg(t),hasMinEdge:Wg(t),hasMaxEdge:Xg(t),minBound:Rp(n),maxBound:Dp(n),screenRange:Fp(n)};return bp(r)},zp=function(n,t,e){var r=Pp(n,t,e),o=Np(r);return Hp(n,o),r},jp=function(n,t){var e=Rg(t);Hp(n,Np(e))},Lp=function(n,t){var e=Fg(t);Hp(n,Np(e))},$p=function(n,t,e){var r=n>0?gp:mp,o=r(Yg(e).x,Rg(e),Fg(e),jg(e));return Hp(t,Np(o)),$.some(o)},Gp=function(n){return function(t,e){return $p(n,t,e).map(N)}},Up=function(n){var t=Og(n);return t.map(function(n){return n.left})},Wp=function(n,t,e,r,o){var i=0,u=Fp(n),c=r.bind(function(t){return $.some(Bp(t,n))}).getOr(i),a=o.bind(function(t){return $.some(Bp(t,n))}).getOr(u),f={min:Rg(t),max:Fg(t),range:Hg(t),value:e,hasMinEdge:Wg(t),hasMaxEdge:Xg(t),minBound:Rp(n),minOffset:i,maxBound:Dp(n),maxOffset:u,centerMinEdge:c,centerMaxEdge:a};return yp(f)},Xp=function(n,t,e,r,o,i){var u=Wp(t,i,e,r,o);return Rp(t)-Rp(n)+u},qp=function(n,t,e,r){var o=Yg(e),i=Xp(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=hg(t.element)/2;ya(t.element,"left",i-u+"px")},Kp=Gp(-1),Yp=Gp(1),Jp=$.none,Qp=$.none,Zp={"top-left":$.none(),top:$.none(),"top-right":$.none(),right:$.some(ip),"bottom-right":$.none(),bottom:$.none(),"bottom-left":$.none(),left:$.some(lp)},nv=Object.freeze({__proto__:null,setValueFrom:zp,setToMin:jp,setToMax:Lp,findValueOfOffset:Pp,getValueFromEvent:Up,findPositionOfValue:Xp,setPositionFromValue:qp,onLeft:Kp,onRight:Yp,onUp:Jp,onDown:Qp,edgeActions:Zp}),tv=function(n,t){Lt(n,wg(),{value:t})},ev=function(n){return{y:n}},rv=function(n,t,e){var r={min:Dg(t),max:Vg(t),range:Ng(t),value:e,step:jg(t),snap:Lg(t),snapStart:$g(t),rounded:Gg(t),hasMinEdge:qg(t),hasMaxEdge:Kg(t),minBound:Mp(n),maxBound:_p(n),screenRange:Vp(n)};return bp(r)},ov=function(n,t,e){var r=rv(n,t,e),o=ev(r);return tv(n,o),r},iv=function(n,t){var e=Dg(t);tv(n,ev(e))},uv=function(n,t){var e=Vg(t);tv(n,ev(e))},cv=function(n,t,e){var r=n>0?gp:mp,o=r(Yg(e).y,Dg(e),Vg(e),jg(e));return tv(t,ev(o)),$.some(o)},av=function(n){return function(t,e){return cv(n,t,e).map(N)}},fv=function(n){var t=Og(n);return t.map(function(n){return n.top})},sv=function(n,t,e,r,o){var i=0,u=Vp(n),c=r.bind(function(t){return $.some(Ap(t,n))}).getOr(i),a=o.bind(function(t){return $.some(Ap(t,n))}).getOr(u),f={min:Dg(t),max:Vg(t),range:Ng(t),value:e,hasMinEdge:qg(t),hasMaxEdge:Kg(t),minBound:Mp(n),minOffset:i,maxBound:_p(n),maxOffset:u,centerMinEdge:c,centerMaxEdge:a};return yp(f)},lv=function(n,t,e,r,o,i){var u=sv(t,i,e,r,o);return Mp(t)-Mp(n)+u},dv=function(n,t,e,r){var o=Yg(e),i=lv(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),u=Ra(t.element)/2;ya(t.element,"top",i-u+"px")},mv=$.none,gv=$.none,pv=av(-1),vv=av(1),hv={"top-left":$.none(),top:$.some(ep),"top-right":$.none(),right:$.none(),"bottom-right":$.none(),bottom:$.some(ap),"bottom-left":$.none(),left:$.none()},bv=Object.freeze({__proto__:null,setValueFrom:ov,setToMin:iv,setToMax:uv,findValueOfOffset:rv,getValueFromEvent:fv,findPositionOfValue:lv,setPositionFromValue:dv,onLeft:mv,onRight:gv,onUp:pv,onDown:vv,edgeActions:hv}),yv=function(n,t){Lt(n,wg(),{value:t})},xv=function(n,t){return{x:n,y:t}},wv=function(n,t,e){var r=Pp(n,t,e.left),o=rv(n,t,e.top),i=xv(r,o);return yv(n,i),i},Sv=function(n,t,e,r){var o=n>0?gp:mp,i=t?Yg(r).x:o(Yg(r).x,Rg(r),Fg(r),jg(r)),u=t?o(Yg(r).y,Dg(r),Vg(r),jg(r)):Yg(r).y;return yv(e,xv(i,u)),$.some(i)},Ov=function(n,t){return function(e,r){return Sv(n,t,e,r).map(N)}},kv=function(n,t){var e=Rg(t),r=Dg(t);yv(n,xv(e,r))},Tv=function(n,t){var e=Fg(t),r=Vg(t);yv(n,xv(e,r))},Cv=function(n){return Og(n)},Ev=function(n,t,e,r){var o=Yg(e),i=Xp(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=lv(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),c=hg(t.element)/2,a=Ra(t.element)/2;ya(t.element,"left",i-c+"px"),ya(t.element,"top",u-a+"px")},Rv=Ov(-1,!1),Dv=Ov(1,!1),Mv=Ov(-1,!0),_v=Ov(1,!0),Fv={"top-left":$.some(tp),top:$.some(rp),"top-right":$.some(op),right:$.some(up),"bottom-right":$.some(cp),bottom:$.some(fp),"bottom-left":$.some(sp),left:$.some(dp)},Vv=Object.freeze({__proto__:null,setValueFrom:wv,setToMin:kv,setToMax:Tv,getValueFromEvent:Cv,setPositionFromValue:Ev,onLeft:Rv,onRight:Dv,onUp:Mv,onDown:_v,edgeActions:Fv}),Iv=[gi("stepSize",1),gi("onChange",R),gi("onChoose",R),gi("onInit",R),gi("onDragStart",R),gi("onDragEnd",R),gi("snapToGrid",!1),gi("rounded",!0),si("snapStart"),ci("model",ri("mode",{x:[gi("minX",0),gi("maxX",100),ii("value",function(n){return _u(n.mode.minX)}),ui("getInitialValue"),Mc("Receptionist",nv)],y:[gi("minY",0),gi("maxY",100),ii("value",function(n){return _u(n.mode.minY)}),ui("getInitialValue"),Mc("Receptionist",bv)],xy:[gi("minX",0),gi("maxX",100),gi("minY",0),gi("maxY",100),ii("value",function(n){return _u({x:n.mode.minX,y:n.mode.minY})}),ui("getInitialValue"),Mc("Receptionist",Vv)]})),Gl("sliderBehaviours",[$l,gg]),ii("mouseIsDown",function(){return _u(!1)})],Bv=_("mouse.released"),Av=function(n,t,e,r){var o,i=function(t){return Hd(t,n,"thumb")},u=function(t){return Hd(t,n,"spectrum")},c=function(t){return Ad(t,n,"left-edge")},a=function(t){return Ad(t,n,"right-edge")},f=function(t){return Ad(t,n,"top-edge")},s=function(t){return Ad(t,n,"bottom-edge")},l=n.model,d=l.Receptionist,m=function(t,e){d.setPositionFromValue(t,e,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:u})},g=function(n,t){l.value.set(t);var e=i(n);m(n,e)},p=function(t,e){g(t,e);var r=i(t);return n.onChange(t,r,e),$.some(!0)},v=function(t){d.setToMin(t,n)},h=function(t){d.setToMax(t,n)},b=function(t){var e=function(){Ad(t,n,"thumb").each(function(e){var r=l.value.get();n.onChoose(t,e,r)})},r=n.mouseIsDown.get();n.mouseIsDown.set(!1),r&&e()},y=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},x=function(t,e){e.stop(),n.onDragEnd(t,i(t)),b(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Wl(n.sliderBehaviours,[$l.config({mode:"special",focusIn:function(t){return Ad(t,n,"spectrum").map($l.focusIn).map(N)}}),gg.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),Ic.config({channels:(o={},o[Bv()]={onReceive:b},o)})]),events:Xi([Yi(wg(),function(n,t){p(n,t.event.value)}),iu(function(t,e){var r=l.getInitialValue();l.value.set(r);var o=i(t);m(t,o);var c=u(t);n.onInit(t,o,c,l.value.get())}),Yi(lt(),y),Yi(mt(),x),Yi(gt(),y),Yi(vt(),x)]),apis:{resetToMin:v,resetToMax:h,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},Hv=fm({name:"Slider",configFields:Iv,partFields:Pm,factory:Av,apis:{setValue:function(n,t,e){n.setValue(t,e)},resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),Nv=function(n,t,e,r){return Cm(t,function(){var r=e();n.setContextToolbar([{label:t+" group",items:r}])},{},r)},Pv=-1,zv=function(n){var t=function(n){return n<0?"black":n>360?"white":"hsl("+n+", 100%, 50%)"},e=function(n,e,r,o){var i=t(o.x());ya(e.element,"background-color",i)},r=function(e,r,o){var i=t(o.x());ya(r.element,"background-color",i),n.onChange(e,r,i)};return Hv.sketch({dom:ym('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Hv.parts["left-edge"](xm('<div class="${prefix}-hue-slider-black"></div>')),Hv.parts.spectrum({dom:ym('<div class="${prefix}-slider-gradient-container"></div>'),components:[xm('<div class="${prefix}-slider-gradient"></div>')],behaviours:ku([Zc.config({toggleClass:oa("thumb-active")})])}),Hv.parts["right-edge"](xm('<div class="${prefix}-hue-slider-white"></div>')),Hv.parts.thumb({dom:ym('<div class="${prefix}-slider-thumb"></div>'),behaviours:ku([Zc.config({toggleClass:oa("thumb-active")})])})],onChange:r,onDragStart:function(n,t){Zc.on(t)},onDragEnd:function(n,t){Zc.off(t)},onInit:e,stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:n.getInitialValue()}}},sliderBehaviours:ku([ta(Hv.refresh)])})},jv=function(n){return[zv(n)]},Lv=function(n,t){var e={onChange:function(n,e,r){t.undoReceptionist.transact(function(){t.formatter.apply("forecolor",{value:r}),t.nodeChanged()})},getInitialValue:_(Pv)};return Nv(n,"color-levels",function(){return jv(e)},t)},$v=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],Gv="medium",Uv=2,Wv=function(n){return $.from($v[n])},Xv=function(n){return cn($v,function(t){return t===n})},qv=function(n,t){var e=me(t)?$.some(t):xe(t).filter(me);return e.map(function(t){var e=Aa(t,function(n){return Oa(n,"font-size").isSome()},n).bind(function(n){return Oa(n,"font-size")});return e.getOrThunk(function(){return wa(t,"font-size")})}).getOr("")},Kv=function(n){var t=n.selection.getStart(),e=re.fromDom(t),r=re.fromDom(n.getBody()),o=function(n){return ae(r,n)},i=qv(o,e);return un($v,function(n){return i===n}).getOr(Gv)},Yv=function(n,t){var e=Kv(n);e!==t&&n.execCommand("fontSize",!1,t)},Jv=function(n){var t=Kv(n);return Xv(t).getOr(Uv)},Qv=function(n,t){Wv(t).each(function(t){Yv(n,t)})},Zv=_($v),nh=jo([ui("getInitialValue"),ui("onChange"),ui("category"),ui("sizes")]),th=function(n){var t=ti("SizeSlider",nh,n),e=function(n){return n>=0&&n<t.sizes.length},r=function(n,r,o){var i=o.x();e(i)&&t.onChange(i)};return Hv.sketch({dom:{tag:"div",classes:[oa("slider-"+t.category+"-size-container"),oa("slider"),oa("slider-size-container")]},onChange:r,onDragStart:function(n,t){Zc.on(t)},onDragEnd:function(n,t){Zc.off(t)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:t.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:ku([ta(Hv.refresh)]),components:[Hv.parts.spectrum({dom:ym('<div class="${prefix}-slider-size-container"></div>'),components:[xm('<div class="${prefix}-slider-size-line"></div>')]}),Hv.parts.thumb({dom:ym('<div class="${prefix}-slider-thumb"></div>'),behaviours:ku([Zc.config({toggleClass:oa("thumb-active")})])})]})},eh=Zv(),rh=function(n){return th({onChange:n.onChange,sizes:eh,category:"font",getInitialValue:n.getInitialValue})},oh=function(n){return[xm('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),rh(n),xm('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]},ih=function(n,t){var e={onChange:function(n){Qv(t,n)},getInitialValue:function(){return Jv(t)}};return Nv(n,"font-size",function(){return oh(e)},t)},uh=function(n){var t=im(n)&&hr(n,"uid")?n.uid:Qd("memento"),e=function(n){return n.getSystem().getByUid(t).getOrDie()},r=function(n){return n.getSystem().getByUid(t).toOptional()},o=function(){return m(m({},n),{uid:t})};return{get:e,getOpt:r,asSpec:o}},ch={},ah={exports:ch};(function(n,t,e,r){(function(r,o){"object"==typeof t&&void 0!==e?e.exports=o():"function"==typeof n&&n.amd?n(o):(r="undefined"!=typeof globalThis?globalThis:r||self,r.EphoxContactWrapper=o())})(this,function(){var n,t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={exports:{}};n=e,function(t){function e(){}function r(n,t){return function(){n.apply(t,arguments)}}function o(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(n,this)}function i(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,o._immediateFn(function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var r;try{r=e(n._value)}catch(n){return void c(t.promise,n)}u(t.promise,r)}else(1===n._state?u:c)(t.promise,n._value)})):n._deferreds.push(t)}function u(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof o)return n._state=3,n._value=t,void a(n);if("function"==typeof e)return void s(r(e,t),n)}n._state=1,n._value=t,a(n)}catch(t){c(n,t)}}function c(n,t){n._state=2,n._value=t,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&o._immediateFn(function(){n._handled||o._unhandledRejectionFn(n._value)});for(var t=0,e=n._deferreds.length;t<e;t++)i(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function s(n,t){var e=!1;try{n(function(n){e||(e=!0,u(t,n))},function(n){e||(e=!0,c(t,n))})}catch(n){if(e)return;e=!0,c(t,n)}}var l=setTimeout;o.prototype.catch=function(n){return this.then(null,n)},o.prototype.then=function(n,t){var r=new this.constructor(e);return i(this,new f(n,t,r)),r},o.all=function(n){var t=Array.prototype.slice.call(n);return new o(function(n,e){function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,function(n){r(i,n)},e)}t[i]=u,0==--o&&n(t)}catch(n){e(n)}}if(0===t.length)return n([]);for(var o=t.length,i=0;i<t.length;i++)r(i,t[i])})},o.resolve=function(n){return n&&"object"==typeof n&&n.constructor===o?n:new o(function(t){t(n)})},o.reject=function(n){return new o(function(t,e){e(n)})},o.race=function(n){return new o(function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)})},o._immediateFn="function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){l(n,0)},o._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},o._setImmediateFn=function(n){o._immediateFn=n},o._setUnhandledRejectionFn=function(n){o._unhandledRejectionFn=n},n.exports?n.exports=o:t.Promise||(t.Promise=o)}(t);var r=e.exports,o="undefined"!=typeof window?window:Function("return this;")(),i={boltExport:o.Promise||r};return i})})(void 0,ch,ah);var fh,sh=ah.exports.boltExport,lh=function(n){return new sh(function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})},dh=function(n){return lh(n).then(function(n){return n.split(",")[1]})},mh=function(n){return dh(n)},gh=function(n,t){mh(t).then(function(e){n.undoReceptionist.transact(function(){var r=n.editorUpload.blobCache,o=r.create(cd("mceu"),t,e);r.add(o);var i=n.dom.createHTML("img",{src:o.blobUri()});n.insertContent(i)})})},ph=function(n){var t=n.event.raw,e=t.target.files||t.dataTransfer.files;return $.from(e[0])},vh=function(n){var t={tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},e=uh({dom:t,events:Xi([eu(St()),Yi(wt(),function(t,e){ph(e).each(function(t){gh(n,t)})})])});return lm.sketch({dom:Tm("image",n),components:[e.asSpec()],action:function(n){var t=e.get(n);t.element.dom.click()}})},hh=function(n){return n.dom.textContent},bh=function(n,t){n.dom.textContent=t},yh=function(n){return n.length>0},xh=function(n){return null==n?"":n},wh=function(n){var t=n.selection.getContent({format:"text"});return{url:"",text:t,title:"",target:"",link:$.none()}},Sh=function(n){var t=hh(n),e=wr(n,"href"),r=wr(n,"title"),o=wr(n,"target");return{url:xh(e),text:t!==e?xh(t):"",title:xh(r),target:xh(o),link:$.some(n)}},Oh=function(n){return Dh(n).fold(function(){return wh(n)},function(n){return Sh(n)})},kh=function(n){var t=wr(n,"href"),e=hh(n);return t===e},Th=function(n,t,e){return e.text.toOptional().filter(yh).fold(function(){return kh(n)?$.some(t):$.none()},$.some)},Ch=function(n,t){var e=t.link.bind(F);e.each(function(t){n.execCommand("unlink")})},Eh=function(n,t){var e={};return e.href=n,t.title.toOptional().filter(yh).each(function(n){e.title=n}),t.target.toOptional().filter(yh).each(function(n){e.target=n}),e},Rh=function(n,t){t.url.toOptional().filter(yh).fold(function(){Ch(n,t)},function(e){var r=Eh(e,t),o=t.link.bind(F);o.fold(function(){var o=t.text.toOptional().filter(yh).getOr(e);n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))},function(n){var o=Th(n,e,t);xr(n,r),o.each(function(t){bh(n,t)})})})},Dh=function(n){var t=re.fromDom(n.selection.getStart());return ja(t,"a")},Mh=ft(),_h=function(n,t){var e=t.selection.getRng();n(),t.selection.setRng(e)},Fh=function(n,t){var e=Mh.os.isAndroid()?_h:A;e(t,n)},Vh=function(n,t){var e=Xi(t);return Cu({fields:[ui("enabled")],name:n,active:{events:_(e)}})},Ih=function(n,t){var e=Vh(n,t);return{key:n,value:{config:{},me:e,configAsRaw:_({}),initialConfig:{},state:Su}}},Bh=function(n,t,e){return t.find(n)},Ah=Object.freeze({__proto__:null,getCurrent:Bh}),Hh=[ui("find")],Nh=Cu({fields:Hh,name:"composing",apis:Ah}),Ph=function(t){var e=t.dom,r=e.attributes,o=n(e,["attributes"]);return{uid:t.uid,dom:m({tag:"div",attributes:m({role:"presentation"},r)},o),components:t.components,behaviours:Ul(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},zh=am({name:"Container",factory:Ph,configFields:[gi("components",[]),Gl("containerBehaviours",[]),gi("events",{}),gi("domModification",{}),gi("eventOrder",{})]}),jh=function(n){return{uid:n.uid,dom:n.dom,behaviours:Xl.augment(n.dataBehaviours,[gg.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),Nh.config({find:$.some})]),events:Xi([iu(function(t,e){gg.setValue(t,n.getInitialValue())})])}},Lh=am({name:"DataField",factory:jh,configFields:[ui("uid"),ui("dom"),ui("getInitialValue"),Xl.field("dataBehaviours",[gg,Nh])]}),$h=function(n){return n.dom.value},Gh=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom.value=t},Uh=_([si("data"),gi("inputAttributes",{}),gi("inputStyles",{}),gi("tag","input"),gi("inputClasses",[]),Cc("onSetValue"),gi("styles",{}),gi("eventOrder",{}),Gl("inputBehaviours",[gg,pa]),gi("selectOnFocus",!0)]),Wh=function(n){return ku([pa.config({onFocus:n.selectOnFocus?function(n){var t=n.element,e=$h(t);t.dom.setSelectionRange(0,e.length)}:R})])},Xh=function(n){return m(m({},Wh(n)),Wl(n.inputBehaviours,[gg.config({store:m(m({mode:"manual"},n.data.map(function(n){return{initialValue:n}}).getOr({})),{getValue:function(n){return $h(n.element)},setValue:function(n,t){var e=$h(n.element);e!==t&&Gh(n.element,t)}}),onSetValue:n.onSetValue})]))},qh=function(n){return{tag:n.tag,attributes:m({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},Kh=function(n,t){return{uid:n.uid,dom:qh(n),components:[],behaviours:Xh(n),eventOrder:n.eventOrder}},Yh=am({name:"Input",configFields:Uh(),factory:Kh}),Jh=function(n,t){return mu({attributes:Ri([{key:t.tabAttr,value:"true"}])})},Qh=Object.freeze({__proto__:null,exhibit:Jh}),Zh=[gi("tabAttr","data-alloy-tabstop")],nb=Cu({fields:Zh,name:"tabstopping",active:Qh}),tb=tinymce.util.Tools.resolve("tinymce.util.I18n"),eb="input-clearing",rb=function(n,t){var e=uh(Yh.sketch({inputAttributes:{placeholder:tb.translate(t)},onSetValue:function(n,t){jt(n,xt())},inputBehaviours:ku([Nh.config({find:$.some}),nb.config({}),$l.config({mode:"execution"})]),selectOnFocus:!1})),r=uh(lm.sketch({dom:ym('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var t=e.get(n);gg.setValue(t,"")}}));return{name:n,spec:zh.sketch({
dom:ym('<div class="${prefix}-input-container"></div>'),components:[e.asSpec(),r.asSpec()],containerBehaviours:ku([Zc.config({toggleClass:oa("input-container-empty")}),Nh.config({find:function(n){return $.some(e.get(n))}}),Ih(eb,[Yi(xt(),function(n){var t=e.get(n),r=gg.getValue(t),o=r.length>0?Zc.off:Zc.on;o(n)})])])})}},ob=function(n){return{name:n,spec:Lh.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return $.none()}})}},ib=["input","button","textarea","select"],ub=function(n,t,e){var r=t.disabled()?gb:pb;r(n,t)},cb=function(n,t){return!0===t.useNative&&Y(ib,se(n.element))},ab=function(n){return Or(n.element,"disabled")},fb=function(n){yr(n.element,"disabled","disabled")},sb=function(n){kr(n.element,"disabled")},lb=function(n){return"true"===wr(n.element,"aria-disabled")},db=function(n){yr(n.element,"aria-disabled","true")},mb=function(n){yr(n.element,"aria-disabled","false")},gb=function(n,t,e){t.disableClass.each(function(t){Fr(n.element,t)});var r=cb(n,t)?fb:db;r(n),t.onDisabled(n)},pb=function(n,t,e){t.disableClass.each(function(t){Ir(n.element,t)});var r=cb(n,t)?sb:mb;r(n),t.onEnabled(n)},vb=function(n,t){return cb(n,t)?ab(n):lb(n)},hb=function(n,t,e,r){var o=r?gb:pb;o(n,t)},bb=Object.freeze({__proto__:null,enable:pb,disable:gb,isDisabled:vb,onLoad:ub,set:hb}),yb=function(n,t){return mu({classes:t.disabled()?t.disableClass.toArray():[]})},xb=function(n,t){return Xi([qi(_t(),function(t,e){return vb(t,n)}),vu(n,t,ub)])},wb=Object.freeze({__proto__:null,exhibit:yb,events:xb}),Sb=[vi("disabled",H),gi("useNative",!0),si("disableClass"),Cc("onDisabled"),Cc("onEnabled")],Ob=Cu({fields:Sb,name:"disabling",active:wb,apis:bb}),kb="form",Tb=[Gl("formBehaviours",[gg])],Cb=function(n){return"<alloy.field."+n+">"},Eb=function(n){var t,e,r=(t=[],e=function(n,e){return t.push(n),_d(kb,Cb(n),e)},{field:e,record:_(t)}),o=n(r),i=r.record(),u=Q(i,function(n){return Od({name:n,pname:Cb(n)})});return em(kb,Tb,u,Db,o)},Rb=function(n,t){return n.fold(function(){return Wr.error(t)},Wr.value)},Db=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Wl(n.formBehaviours,[gg.config({store:{mode:"manual",getValue:function(t){var e=Nd(t,n);return cr(e,function(n,t){return n().bind(function(n){var e=Nh.getCurrent(n);return Rb(e,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+oc(n.element)))}).map(gg.getValue)})},setValue:function(t,e){ur(e,function(e,r){Ad(t,n,r).each(function(n){Nh.getCurrent(n).each(function(n){gg.setValue(n,e)})})})}}})]),apis:{getField:function(t,e){return Ad(t,n,e).bind(Nh.getCurrent)}}}},Mb={getField:Gd(function(n,t,e){return n.getField(t,e)}),sketch:Eb},_b=1,Fb=-1,Vb=0,Ib=function(n){return{xValue:n,points:[]}},Bb=function(n,t){if(t===n.xValue)return n;var e=t-n.xValue>0?_b:Fb,r={direction:e,xValue:t},o=function(){if(0===n.points.length)return[];var t=n.points[n.points.length-1];return t.direction===e?n.points.slice(0,n.points.length-1):n.points}();return{xValue:t,points:o.concat([r])}},Ab=function(n){if(0===n.points.length)return Vb;var t=n.points[0].direction,e=n.points[n.points.length-1].direction;return t===Fb&&e===Fb?Fb:t===_b&&e===_b?_b:Vb},Hb=function(n){var t="navigateEvent",e="serializer-wrapper-events",r="form-events",o=Lo([ui("fields"),gi("maxFieldIndex",n.fields.length-1),ui("onExecute"),ui("getInitialValue"),ii("state",function(){return{dialogSwipeState:Yf(),currentScreen:_u(0)}})]),i=ti("SerialisedDialog",o,n),u=function(n,e,r){return lm.sketch({dom:ym('<span class="${prefix}-icon-'+e+' ${prefix}-icon"></span>'),action:function(e){Lt(e,t,{direction:n})},buttonBehaviours:ku([Ob.config({disableClass:oa("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},c=function(n,t){za(n.element,"."+oa("serialised-dialog-chain")).each(function(n){ya(n,"left",-i.state.currentScreen.get()*t.width+"px")})},a=function(n,t){var e=Ia(n.element,"."+oa("serialised-dialog-screen"));za(n.element,"."+oa("serialised-dialog-chain")).each(function(n){i.state.currentScreen.get()+t>=0&&i.state.currentScreen.get()+t<e.length&&(Oa(n,"left").each(function(r){var o=parseInt(r,10),i=hg(e[0]);ya(n,"left",o-t*i+"px")}),i.state.currentScreen.set(i.state.currentScreen.get()+t))})},f=function(n){var t=Ia(n.element,"input"),e=$.from(t[i.state.currentScreen.get()]);e.each(function(t){n.getSystem().getByDom(t).each(function(t){Xt(n,t.element)})});var r=d.get(n);Mf.highlightAt(r,i.state.currentScreen.get())},s=function(){i.state.currentScreen.set(0),i.state.dialogSwipeState.clear()},l=uh(Mb.sketch(function(n){return{dom:ym('<div class="${prefix}-serialised-dialog"></div>'),components:[zh.sketch({dom:ym('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:Q(i.fields,function(t,e){return e<=i.maxFieldIndex?zh.sketch({dom:ym('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[u(-1,"previous",e>0),n.field(t.name,t.spec),u(1,"next",e<i.maxFieldIndex)]}):n.field(t.name,t.spec)})})],formBehaviours:ku([ta(function(n,t){c(n,t)}),$l.config({mode:"special",focusIn:function(n,t){f(n)},onTab:function(n,t){return a(n,1),$.some(!0)},onShiftTab:function(n,t){return a(n,-1),$.some(!0)}}),Ih(r,[iu(function(n,t){s();var e=d.get(n);Mf.highlightFirst(e),i.getInitialValue(n).each(function(t){gg.setValue(n,t)})}),au(i.onExecute),Yi(Ot(),function(n,t){var e=t.event;"left"===e.raw.propertyName&&f(n)}),Yi(t,function(n,t){var e=t.event,r=e.direction;a(n,r)})])])}})),d=uh({dom:ym('<div class="${prefix}-dot-container"></div>'),behaviours:ku([Mf.config({highlightClass:oa("dot-active"),itemClass:oa("dot-item")})]),components:fn(i.fields,function(n,t){return t<=i.maxFieldIndex?[xm('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]})});return{dom:ym('<div class="${prefix}-serializer-wrapper"></div>'),components:[l.asSpec(),d.asSpec()],behaviours:ku([$l.config({mode:"special",focusIn:function(n){var t=l.get(n);$l.focusIn(t)}}),Ih(e,[Yi(lt(),function(n,t){var e=t.event;i.state.dialogSwipeState.set(Ib(e.raw.touches[0].clientX))}),Yi(dt(),function(n,t){var e=t.event;i.state.dialogSwipeState.on(function(n){t.event.prevent(),i.state.dialogSwipeState.set(Bb(n,e.raw.touches[0].clientX))})}),Yi(mt(),function(n,t){i.state.dialogSwipeState.on(function(t){var e=l.get(n),r=-1*Ab(t);a(e,r)})})])])}},Nb=G(function(n,t){return[{label:"the link group",items:[Hb({fields:[rb("url","Type or paste URL"),rb("text","Link text"),rb("title","Link title"),rb("target","Link target"),ob("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return $.some(Oh(t))},onExecute:function(e,r){var o=gg.getValue(e);Rh(t,o),n.restoreToolbar(),t.focus()}})]}]}),Pb=function(n,t){return km(t,"link","link",function(){var e=Nb(n,t);n.setContextToolbar(e),Fh(t,function(){n.focusToolbar()}),Dh(t).each(function(n){t.selection.select(n.dom)})})},zb=function(n,t,e){return ae(t,n.element)&&!ae(t,e)},jb=Xi([Ki(Et(),function(n,t){var e=t.event,r=e.originator,o=e.target;return!zb(n,r,o)||(console.warn(Et()+" did not get interpreted by the desired target. \nOriginator: "+oc(r)+"\nTarget: "+oc(o)+"\nCheck the "+Et()+" event handlers"),!1)})]),Lb=Object.freeze({__proto__:null,events:jb}),$b=F,Gb=function(n){var t=function(t){return"The component must be in a context to execute: "+t+(n?"\n"+oc(n().element)+" is not in context.":"")},e=function(n){return function(){throw new Error(t(n))}},r=function(n){return function(){console.warn(t(n))}};return{debugInfo:_("fake"),triggerEvent:r("triggerEvent"),triggerFocus:r("triggerFocus"),triggerEscape:r("triggerEscape"),broadcast:r("broadcast"),broadcastOn:r("broadcastOn"),broadcastEvent:r("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:H}},Ub=Gb(),Wb=function(n,t){var e=Q(t,function(n){return di(n.name(),[ui("config"),gi("state",Su)])}),r=Zo("component.behaviours",Lo(e),n.behaviours).fold(function(t){throw new Error(ei(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))},F);return{list:t,data:cr(r,function(n){var t=n.map(function(n){return{config:n.config,state:n.state.init(n.config)}});return _(t)})}},Xb=function(n){return n.list},qb=function(n){return n.data},Kb=function(n,t){var e={};return ur(n,function(n,r){ur(n,function(n,o){var i=pr(e,o).getOr([]);e[o]=i.concat([t(r,n)])})}),e},Yb=function(n,t,e,r){var o=m({},t);Z(e,function(t){o[t.name()]=t.exhibit(n,r)});var i=Kb(o,function(n,t){return{name:n,modification:t}}),u=function(n){return en(n,function(n,t){return m(m({},t.modification),n)},{})},c=en(i.classes,function(n,t){return t.modification.concat(n)},[]),a=u(i.attributes),f=u(i.styles);return mu({classes:c,attributes:a,styles:f})},Jb=function(n,t,e,r){try{var o=gn(e,function(e,o){var i=e[t],u=o[t],c=r.indexOf(i),a=r.indexOf(u);if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return c<a?-1:a<c?1:0});return Wr.value(o)}catch(n){return Wr.error([n])}},Qb=function(n,t){return{handler:n,purpose:t}},Zb=function(n,t){return{cHandler:n,purpose:t}},ny=function(n,t){return Zb(e.apply(void 0,[n.handler].concat(t)),n.purpose)},ty=function(n){return n.cHandler},ey=function(n,t){return{name:n,handler:t}},ry=function(n,t){var e={};return Z(n,function(n){e[n.name()]=n.handlers(t)}),e},oy=function(n,t,e){var r=m(m({},e),ry(t,n));return Kb(r,ey)},iy=function(n,t,e,r){var o=oy(n,e,r);return fy(o,t)},uy=function(n){var t=Ui(n);return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[n,e].concat(r);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},cy=function(n,t){return Wr.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(Q(t,function(n){return n.name}),null,2)])},ay=function(n,t,e){var r=t[e];return r?Jb("Event: "+e,"name",n,r).map(function(n){var t=Q(n,function(n){return n.handler});return Wi(t)}):cy(e,n)},fy=function(n,t){var e=dr(n,function(n,e){var r=1===n.length?Wr.value(n[0].handler):ay(n,t,e);return r.map(function(r){var o=uy(r),i=n.length>1?tn(t[e],function(t){return J(n,function(n){return n.name===t})}).join(" > "):n[0].name;return Ei(e,Qb(o,i))})});return _i(e,{})},sy="alloy.base.behaviour",ly=Lo([oi("dom","dom",mo(),Lo([ui("tag"),gi("styles",{}),gi("classes",[]),gi("attributes",{}),si("value"),si("innerHtml")])),ui("components"),ui("uid"),gi("events",{}),gi("apis",{}),oi("eventOrder","eventOrder",bo((fh={},fh[_t()]=["disabling",sy,"toggling","typeaheadevents"],fh[Et()]=[sy,"focusing","keying"],fh[Bt()]=[sy,"disabling","toggling","representing"],fh[xt()]=[sy,"representing","streaming","invalidating"],fh[Ht()]=[sy,"representing","item-events","tooltipping"],fh[gt()]=["focusing",sy,"item-type-events"],fh[lt()]=["focusing",sy,"item-type-events"],fh[ht()]=["item-type-events","tooltipping"],fh[Mt()]=["receiving","reflecting","tooltipping"],fh)),Uo()),si("domModification")]),dy=function(n){return Zo("custom.definition",ly,n)},my=function(n){return m(m({},n.dom),{uid:n.uid,domChildren:Q(n.components,function(n){return n.element})})},gy=function(n){return n.domModification.fold(function(){return mu({})},mu)},py=function(n){return n.events},vy=function(n,t){Z(t,function(t){Fr(n,t)})},hy=function(n,t){Z(t,function(t){Ir(n,t)})},by=function(n){var t=re.fromTag(n.tag);xr(t,n.attributes),vy(t,n.classes),xa(t,n.styles),n.innerHtml.each(function(n){return Zu(t,n)});var e=n.domChildren;return Fe(t,e),n.value.each(function(n){Gh(t,n)}),n.uid,Yd(t,n.uid),t},yy=function(n){var t=pr(n,"behaviours").getOr({});return fn(or(t),function(n){var e=t[n];return T(e)?[e.me]:[]})},xy=function(n,t){return Wb(n,t)},wy=function(n){var t=yy(n);return xy(n,t)},Sy=function(n,t,e){var r=my(n),o=gy(n),i={"alloy.base.modification":o},u=t.length>0?Yb(e,i,t,r):o;return gu(r,u)},Oy=function(n,t,e){var r={"alloy.base.behaviour":py(n)};return iy(e,n.eventOrder,t,r).getOrDie()},ky=function(n){var t=function(){return b},e=_u(Ub),r=ni(dy(n)),o=wy(n),i=Xb(o),u=qb(o),c=Sy(r,i,u),a=by(c),f=Oy(r,i,u),s=_u(r.components),l=function(n){e.set(n)},d=function(){e.set(Gb(t))},m=function(){var n=ke(a),t=fn(n,function(n){return e.get().getByDom(n).fold(function(){return[]},mn)});s.set(t)},g=function(t){var e=u,r=C(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))};return r()},p=function(n){return C(u[n.name()])},v=function(){return r.apis},h=function(n){return u[n]().map(function(n){return n.state.readState()}).getOr("not enabled")},b={uid:n.uid,getSystem:e.get,config:g,hasConfigured:p,spec:n,readState:h,getApis:v,connect:l,disconnect:d,element:a,syncComponents:m,components:s.get,events:f};return b},Ty=function(n){var t=pr(n,"components").getOr([]);return Q(t,_y)},Cy=function(t){var e=$b(t),r=e.events,o=n(e,["events"]),i=Ty(o),u=m(m({},o),{events:m(m({},Lb),r),components:i});return Wr.value(ky(u))},Ey=function(n){var t=re.fromText(n);return Ry({element:t})},Ry=function(n){var t=ti("external.component",jo([ui("element"),si("uid")]),n),e=_u(Gb()),r=function(n){e.set(n)},o=function(){e.set(Gb(function(){return u}))},i=t.uid.getOrThunk(function(){return Qd("external")});Yd(t.element,i);var u={uid:i,getSystem:e.get,config:$.none,hasConfigured:H,connect:r,disconnect:o,getApis:function(){return{}},element:t.element,spec:n,readState:_("No state"),syncComponents:R,components:_([]),events:{}};return Ld(u)},Dy=Qd,My=function(n){return vr(n,"uid")},_y=function(n){return $d(n).getOrThunk(function(){var t=My(n)?n:m({uid:Dy("")},n);return Cy(t).getOrDie()})},Fy=Ld,Vy="alloy.item-hover",Iy="alloy.item-focus",By=function(n){(Hu(n.element).isNone()||pa.isFocused(n))&&(pa.isFocused(n)||pa.focus(n),Lt(n,Vy,{item:n}))},Ay=function(n){Lt(n,Iy,{item:n})},Hy=_(Vy),Ny=_(Iy),Py=function(n){return{dom:n.dom,domModification:m(m({},n.domModification),{attributes:m(m(m({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Xl.augment(n.itemBehaviours,[n.toggling.fold(Zc.revoke,function(n){return Zc.config(m({aria:{mode:"checked"}},n))}),pa.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Ay(n)}}),$l.config({mode:"execution"}),gg.config({store:{mode:"memory",initialValue:n.data}}),Ih("item-type-events",t(t([],ia(),!0),[Yi(ht(),By),Yi(Ft(),pa.focus)],!1))]),components:n.components,eventOrder:n.eventOrder}},zy=[ui("data"),ui("components"),ui("dom"),gi("hasSubmenu",!1),si("toggling"),Xl.field("itemBehaviours",[Zc,pa,$l,gg]),gi("ignoreFocus",!1),gi("domModification",{}),Mc("builder",Py),gi("eventOrder",{})],jy=function(n){return{dom:n.dom,components:n.components,events:Xi([ru(Ft())])}},Ly=[ui("dom"),ui("components"),Mc("builder",jy)],$y=_("item-widget"),Gy=_([Od({name:"widget",overrides:function(n){return{behaviours:ku([gg.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:R}})])}}})]),Uy=function(n){var t=Id($y(),n,Gy()),e=Bd($y(),n,t.internals()),r=function(t){return Ad(t,n,"widget").map(function(n){return $l.focusIn(n),n})},o=function(t,e){return Nf(e.event.target)?$.none():n.autofocus?(e.setSource(t.element),$.none()):$.none()};return{dom:n.dom,components:e,domModification:n.domModification,events:Xi([au(function(n,t){r(n).each(function(n){t.stop()})}),Yi(ht(),By),Yi(Ft(),function(t,e){n.autofocus?r(t):pa.focus(t)})]),behaviours:Xl.augment(n.widgetBehaviours,[gg.config({store:{mode:"memory",initialValue:n.data}}),pa.config({ignore:n.ignoreFocus,onFocus:function(n){Ay(n)}}),$l.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:Du(),onLeft:o,onRight:o,onEscape:function(t,e){return pa.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),$.none()):$.none():(pa.focus(t),$.some(!0))}})])}},Wy=[ui("uid"),ui("data"),ui("components"),ui("dom"),gi("autofocus",!1),gi("ignoreFocus",!1),Xl.field("widgetBehaviours",[gg,pa,$l]),gi("domModification",{}),zd(Gy()),Mc("builder",Uy)],Xy=ri("type",{widget:Wy,item:zy,separator:Ly}),qy=function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusReceptionist:n.focusReceptionist}},Ky=function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusReceptionist:n.focusReceptionist}},Yy=function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusReceptionist:n.focusReceptionist}},Jy=_([Td({factory:{sketch:function(n){var t=ti("menu.spec item",Xy,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return vr(t,"uid")?t:m(m({},t),{uid:Qd("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Qy=_([ui("value"),ui("items"),ui("dom"),ui("components"),gi("eventOrder",{}),Gl("menuBehaviours",[Mf,gg,Nh,$l]),pi("movement",{mode:"menu",moveOnTab:!0},ri("mode",{grid:[Fc(),Mc("config",qy)],matrix:[Mc("config",Ky),ui("rowSelector")],menu:[gi("moveOnTab",!0),Mc("config",Yy)]})),Sc(),gi("fakeFocus",!1),gi("focusReceptionist",Ff()),Cc("onHighlight")]),Zy=_("alloy.menu-focus"),nx=function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Wl(n.menuBehaviours,[Mf.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),gg.config({store:{mode:"memory",initialValue:n.value}}),Nh.config({find:$.some}),$l.config(n.movement.config(n,n.movement))]),events:Xi([Yi(Ny(),function(n,t){var e=t.event;n.getSystem().getByDom(e.target).each(function(e){Mf.highlight(n,e),t.stop(),Lt(n,Zy(),{menu:n,item:e})})}),Yi(Hy(),function(n,t){var e=t.event.item;Mf.highlight(n,e)})]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}},tx=fm({name:"Menu",configFields:Qy(),partFields:Jy(),factory:nx}),ex=function(n,t){var e=Ne(t),r=Au(e).bind(function(n){var e=function(t){return ae(n,t)};return e(t)?$.some(t):Ha(t,e)}),o=n(t);return r.each(function(n){Au(e).filter(function(t){return ae(t,n)}).fold(function(){Vu(n)},R)}),o},rx=function(n,t,e,r){ex(function(){var t=Q(r,n.getSystem().build);Ye(n,t)},n.element)},ox=function(n,t,e,r){var o=n.getSystem().build(r);Qe(n,o,e)},ix=function(n,t,e,r){ox(n,t,Me,r)},ux=function(n,t,e,r){ox(n,t,De,r)},cx=function(n,t,e,r){var o=ax(n),i=un(o,function(n){return ae(r.element,n.element)});i.each(nr)},ax=function(n,t){return n.components()},fx=function(n,t,e,r,o){var i=ax(n);return $.from(i[r]).map(function(i){return cx(n,t,e,i),o.each(function(e){ox(n,t,function(n,t){_e(n,t,r)},e)}),i})},sx=function(n,t,e,r,o){var i=ax(n);return cn(i,r).bind(function(r){return fx(n,t,e,r,o)})},lx=Object.freeze({__proto__:null,append:ix,prepend:ux,remove:cx,replaceAt:fx,replaceBy:sx,set:rx,contents:ax}),dx=Cu({fields:[],name:"replacing",apis:lx}),mx=function(n){return ar(n,function(n,t){return{k:n,v:t}})},gx=function(n,t,e,r){return pr(e,r).bind(function(r){return pr(n,r).bind(function(r){var o=gx(n,t,e,r);return $.some([r].concat(o))})}).getOr([])},px=function(n,t){var e={};ur(n,function(n,t){Z(n,function(n){e[n]=t})});var r=t,o=mx(t),i=cr(o,function(n,t){return[t].concat(gx(e,r,o,t))});return cr(e,function(n){return pr(i,n).getOr([n])})},vx=function(){var n=_u({}),t=_u({}),e=_u({}),r=Yf(),o=_u({}),i=function(){n.set({}),t.set({}),e.set({}),r.clear()},u=function(){return r.get().isNone()},c=function(n,e){var r;t.set(m(m({},t.get()),(r={},r[n]={type:"prepared",menu:e},r)))},a=function(i,u,c,a){r.set(i),n.set(c),t.set(u),o.set(a);var f=px(a,c);e.set(f)},f=function(t){return mr(n.get(),function(n,e){return n===t})},s=function(n,t,e){return v(n).bind(function(r){return f(n).bind(function(n){return t(n).map(function(n){return{triggeredMenu:r,triggeringItem:n,triggeringPath:e}})})})},l=function(n,t){var o=tn(b(n).toArray(),function(n){return v(n).isSome()});return pr(e.get(),n).bind(function(n){var e=ln(o.concat(n)),i=fn(e,function(n,o){return s(n,t,e.slice(0,o+1)).fold(function(){return Fi(r.get(),n)?[]:[$.none()]},function(n){return[$.some(n)]})});return Ii(i)})},d=function(t){return pr(n.get(),t).map(function(n){var r=pr(e.get(),t).getOr([]);return[n].concat(r)})},g=function(n){return pr(e.get(),n).bind(function(n){return n.length>1?$.some(n.slice(1)):$.none()})},p=function(n){return pr(e.get(),n)},v=function(n){return h(n).bind(hx)},h=function(n){return pr(t.get(),n)},b=function(t){return pr(n.get(),t)},y=function(n){var t=o.get();return dn(or(t),n)},x=function(){return r.get().bind(v)},w=function(){return t.get()};return{setMenuBuilt:c,setContents:a,expand:d,refresh:p,collapse:g,lookupMenu:h,lookupItem:b,otherMenus:y,getPrimary:x,getMenus:w,clear:i,isClear:u,getTriggeringPath:l}},hx=function(n){return"prepared"===n.type?$.some(n.menu):$.none()},bx={init:vx,extractPreparedMenu:hx},yx=function(n,t){var e,r=Yf(),o=function(t,e,r){return cr(r,function(r,o){var i=function(){return tx.sketch(m(m({},r),{value:o,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusReceptionist:n.fakeFocus?Vf():Ff()}))};return o===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})},i=bx.init(),u=function(t){var e=o(t,n.data.primary,n.data.menus),r=f();return i.setContents(n.data.primary,e,n.data.expansions,r),i.getPrimary()},c=function(n){return gg.getValue(n).value},a=function(n,t,e){return hn(t,function(n){if(!n.getSystem().isConnected())return $.none();var t=Mf.getCandidates(n);return un(t,function(n){return c(n)===e})})},f=function(t){return cr(n.data.menus,function(n,t){return fn(n.items,function(n){return"separator"===n.type?[]:[n.data.value]})})},s=function(n,t){Mf.highlight(n,t),Mf.getHighlighted(t).orThunk(function(){return Mf.getFirst(t)}).each(function(t){Gt(n,t.element,Ft())})},l=function(n,t){return Vi(Q(t,function(t){return n.lookupMenu(t).bind(function(n){return"prepared"===n.type?$.some(n.menu):$.none()})}))},d=function(t,e,r){var o=l(e,e.otherMenus(r));Z(o,function(e){hy(e.element,[n.markers.backgroundMenu]),n.stayInDom||dx.remove(t,e)})},g=function(t){return r.get().getOrThunk(function(){var e={},o=Ia(t.element,"."+n.markers.item),i=tn(o,function(n){return"true"===wr(n,"aria-haspopup")});return Z(i,function(n){t.getSystem().getByDom(n).each(function(n){var t=c(n);e[t]=n})}),r.set(e),e})},p=function(n,t){var e=g(n);ur(e,function(n,e){var r=Y(t,e);yr(n.element,"aria-expanded",r)})},v=function(t,e,r){return $.from(r[0]).bind(function(o){return e.lookupMenu(o).bind(function(o){if("notbuilt"===o.type)return $.none();var i=o.menu,u=l(e,r.slice(1));return Z(u,function(t){Fr(t.element,n.markers.backgroundMenu)}),$e(i.element)||dx.append(t,Fy(i)),hy(i.element,[n.markers.backgroundMenu]),s(t,i),d(t,e,r),$.some(i)})})};(function(n){n[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent"})(e||(e={}));var h=function(n,t,e){if("notbuilt"===e.type){var r=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,r),r}return e.menu},b=function(t,r,o){if(void 0===o&&(o=e.HighlightSubmenu),r.hasConfigured(Ob)&&Ob.isDisabled(r))return $.some(r);var u=c(r);return i.expand(u).bind(function(u){return p(t,u),$.from(u[0]).bind(function(c){return i.lookupMenu(c).bind(function(a){var f=h(t,c,a);return $e(f.element)||dx.append(t,Fy(f)),n.onOpenSubmenu(t,r,f,ln(u)),o===e.HighlightSubmenu?(Mf.highlightFirst(f),v(t,i,u)):(Mf.dehighlightAll(f),$.some(r))})})})},y=function(t,e){var r=c(e);return i.collapse(r).bind(function(r){return p(t,r),v(t,i,r).map(function(r){return n.onCollapseMenu(t,e,r),r})})},x=function(n,t){var e=c(t);return i.refresh(e).bind(function(t){return p(n,t),v(n,i,t)})},w=function(n,t){return Nf(t.element)?$.none():b(n,t,e.HighlightSubmenu)},S=function(n,t){return Nf(t.element)?$.none():y(n,t)},O=function(t,e){return y(t,e).orThunk(function(){return n.onEscape(t,e).map(function(){return t})})},k=function(t){return function(e,r){return ja(r.getSource(),"."+n.markers.item).bind(function(n){return e.getSystem().getByDom(n).toOptional().bind(function(n){return t(e,n).map(N)})})}},T=Xi([Yi(Zy(),function(n,t){var e=t.event.item;i.lookupItem(c(e)).each(function(){var e=t.event.menu;Mf.highlight(n,e);var r=c(t.event.item);i.refresh(r).each(function(t){return d(n,i,t)})})}),au(function(t,r){var o=r.event.target;t.getSystem().getByDom(o).each(function(r){var o=c(r);0===o.indexOf("collapse-item")&&y(t,r),b(t,r,e.HighlightSubmenu).fold(function(){n.onExecute(t,r)},R)})}),iu(function(t,e){u(t).each(function(e){dx.append(t,Fy(e)),n.onOpenMenu(t,e),n.highlightImmediately&&s(t,e)})})].concat(n.navigateOnHover?[Yi(Hy(),function(t,r){var o=r.event.item;x(t,o),b(t,o,e.HighlightParent),n.onHover(t,o)})]:[])),C=function(n){return Mf.getHighlighted(n).bind(Mf.getHighlighted)},E=function(n){C(n).each(function(t){y(n,t)})},D=function(n){i.getPrimary().each(function(t){s(n,t)})},M=function(n){return $.from(n.components()[0]).filter(function(n){return"menu"===wr(n.element,"role")})},_=function(t){var e=i.getPrimary().bind(function(n){return C(t).bind(function(n){var e=c(n),r=gr(i.getMenus()),o=Vi(Q(r,bx.extractPreparedMenu));return i.getTriggeringPath(e,function(n){return a(t,o,n)})}).map(function(t){return{primary:n,triggeringPath:t}})});e.fold(function(){M(t).each(function(e){n.onRepositionMenu(t,e,[])})},function(e){var r=e.primary,o=e.triggeringPath;n.onRepositionMenu(t,r,o)})},F={collapseMenu:E,highlightPrimary:D,repositionMenus:_};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Wl(n.tmenuBehaviours,[$l.config({mode:"special",onRight:k(w),onLeft:k(S),onEscape:k(O),focusIn:function(n,t){i.getPrimary().each(function(t){Gt(n,t.element,Ft())})}}),Mf.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Nh.config({find:function(n){return Mf.getHighlighted(n)}}),dx.config({})]),eventOrder:n.eventOrder,apis:F,events:T}},xx=_("collapse-item"),wx=function(n,t,e){return{primary:n,menus:t,expansions:e}},Sx=function(n,t){return{primary:n,menus:Ei(n,t),expansions:{}}},Ox=function(n){return{value:cd(xx()),meta:{text:n}}},kx=am({name:"TieredMenu",configFields:[Dc("onExecute"),Dc("onEscape"),Rc("onOpenMenu"),Rc("onOpenSubmenu"),Cc("onRepositionMenu"),Cc("onCollapseMenu"),gi("highlightImmediately",!0),fi("data",[ui("primary"),ui("menus"),ui("expansions")]),gi("fakeFocus",!1),Cc("onHighlight"),Cc("onHover"),Oc(),ui("dom"),gi("navigateOnHover",!0),gi("stayInDom",!1),Gl("tmenuBehaviours",[$l,Mf,Nh,dx]),gi("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:yx,extraApis:{tieredData:wx,singleData:Sx,collapseItem:Ox}}),Tx=function(n,t,e,r){return pr(t.routes,r.start).bind(function(n){return pr(n,r.destination)})},Cx=function(n,t,e){var r=Mx(n,t);return r.bind(function(r){return Ex(n,t,e,r)})},Ex=function(n,t,e,r){return Tx(n,t,e,r).bind(function(n){return n.transition.map(function(t){return{transition:t,route:n}})})},Rx=function(n,t,e){Cx(n,t,e).each(function(e){var r=e.transition;Ir(n.element,r.transitionClass),kr(n.element,t.destinationAttr)})},Dx=function(n,t,e,r){return{start:wr(n.element,t.stateAttr),destination:r}},Mx=function(n,t,e){var r=n.element;return Sr(r,t.destinationAttr).map(function(e){return{start:wr(n.element,t.stateAttr),destination:e}})},_x=function(n,t,e,r){Rx(n,t,e),Or(n.element,t.stateAttr)&&wr(n.element,t.stateAttr)!==r&&t.onFinish(n,r),yr(n.element,t.stateAttr,r)},Fx=function(n,t,e,r){Or(n.element,t.destinationAttr)&&(Sr(n.element,t.destinationAttr).each(function(e){yr(n.element,t.stateAttr,e)}),kr(n.element,t.destinationAttr))},Vx=function(n,t,e,r){Fx(n,t);var o=Dx(n,t,e,r);Ex(n,t,e,o).fold(function(){_x(n,t,e,r)},function(o){Rx(n,t,e);var i=o.transition;Fr(n.element,i.transitionClass),yr(n.element,t.destinationAttr,r)})},Ix=function(n,t,e){return Sr(n.element,t.stateAttr)},Bx=Object.freeze({__proto__:null,findRoute:Tx,disableTransition:Rx,getCurrentRoute:Mx,jumpTo:_x,progressTo:Vx,getState:Ix}),Ax=function(n,t){return Xi([Yi(Ot(),function(e,r){var o=r.event.raw;Mx(e,n).each(function(r){Tx(e,n,t,r).each(function(i){i.transition.each(function(i){o.propertyName===i.property&&(_x(e,n,t,r.destination),n.onTransition(e,r))})})})}),iu(function(e,r){_x(e,n,t,n.initialState)})])},Hx=Object.freeze({__proto__:null,events:Ax}),Nx=[gi("destinationAttr","data-transitioning-destination"),gi("stateAttr","data-transitioning-state"),ui("initialState"),Cc("onTransition"),Cc("onFinish"),ci("routes",Jo(Wr.value,Jo(Wr.value,jo([mi("transition",[ui("property"),ui("transitionClass")])]))))],Px=function(n){var t={};return ur(n,function(n,e){var r=e.split("<->");t[r[0]]=Ei(r[1],n),t[r[1]]=Ei(r[0],n)}),t},zx=function(n,t,e){return Ri([{key:n,value:Ei(t,e)},{key:t,value:Ei(n,e)}])},jx=function(n,t,e,r){return Ri([{key:n,value:Ri([{key:t,value:r},{key:e,value:r}])},{key:t,value:Ri([{key:n,value:r},{key:e,value:r}])},{key:e,value:Ri([{key:n,value:r},{key:t,value:r}])}])},Lx=Cu({fields:Nx,name:"transitioning",active:Hx,apis:Bx,extra:{createRoutes:Px,createBistate:zx,createTristate:jx}}),$x=oa("scrollable"),Gx=function(n){Fr(n,$x)},Ux=function(n){Ir(n,$x)},Wx=$x,Xx=function(n){return pr(n,"format").getOr(n.title)},qx=function(n,t){var e=Yx("Styles",[].concat(Q(n.items,function(t){return Kx(Xx(t),t.title,t.isSelected(),t.getPreview(),hr(n.expansions,Xx(t)))})),t,!1),r=cr(n.menus,function(e,r){var o=Q(e,function(t){return Kx(Xx(t),t.title,void 0!==t.isSelected&&t.isSelected(),void 0!==t.getPreview?t.getPreview():"",hr(n.expansions,Xx(t)))});return Yx(r,o,t,!0)}),o=so(r,Ei("styles",e)),i=kx.tieredData("styles",o,n.expansions);return{tmenu:i}},Kx=function(n,t,e,r,o){return{data:{value:n,text:t},type:"item",dom:{tag:"div",classes:o?[oa("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:oa("format-matches"),selected:e},itemBehaviours:ku(o?[]:[na(n,function(n,t){var e=t?Zc.on:Zc.off;e(n)})]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},Yx=function(n,t,e,r){return{value:n,dom:{tag:"div"},components:[lm.sketch({dom:{tag:"div",classes:[oa("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[oa("styles-collapse-icon")]}},Ey(n)]:[Ey(n)],action:function(n){if(r){var t=e().get(n);kx.collapseMenu(t)}}}),{dom:{tag:"div",classes:[oa("styles-menu-items-container")]},components:[tx.parts.items({})],behaviours:ku([Ih("adhoc-scrollable-menu",[iu(function(n,t){ya(n.element,"overflow-y","auto"),ya(n.element,"-webkit-overflow-scrolling","touch"),Gx(n.element)}),uu(function(n){ka(n.element,"overflow-y"),ka(n.element,"-webkit-overflow-scrolling"),Ux(n.element)})])])}],items:t,menuBehaviours:ku([Lx.config({initialState:"after",routes:Lx.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Jx=function(n){var t=qx(n.formats,function(){return e}),e=uh(kx.sketch({dom:{tag:"div",classes:[oa("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(t,e){var r=gg.getValue(e);return n.handle(e,r.value),$.none()},onEscape:function(){return $.none()},onOpenMenu:function(n,t){var e=hg(n.element);vg(t.element,e),Lx.jumpTo(t,"current")},onOpenSubmenu:function(n,t,e){var r=hg(n.element),o=Pa(t.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie();vg(e.element,r),Lx.progressTo(i,"before"),Lx.jumpTo(e,"after"),Lx.progressTo(e,"current")},onCollapseMenu:function(n,t,e){var r=Pa(t.element,'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie();Lx.progressTo(o,"after"),Lx.progressTo(e,"current")},navigateOnHover:!1,highlightImmediately:!0,data:t.tmenu,
markers:{backgroundMenu:oa("styles-background-menu"),menu:oa("styles-menu"),selectedMenu:oa("styles-selected-menu"),item:oa("styles-item"),selectedItem:oa("styles-selected-item")}}));return e.asSpec()},Qx=function(n){var t=so(Ci(n,["items"]),{menu:!0}),e=nw(n.items),r=so(e.menus,Ei(n.title,e.items)),o=so(e.expansions,Ei(n.title,n.title));return{item:t,menus:r,expansions:o}},Zx=function(n){return hr(n,"items")?Qx(n):{item:n,menus:{},expansions:{}}},nw=function(n){return en(n,function(n,t){var e=Zx(t);return{menus:so(n.menus,e.menus),items:[e.item].concat(n.items),expansions:so(n.expansions,e.expansions)}},{menus:{},expansions:{},items:[]})},tw=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){return n.formatter.getCssText(t)}},r=function(n){return so(n,{isSelected:t(n.format),getPreview:e(n.format)})},o=function(n){return so(n,{isSelected:H,getPreview:_("")})},i=function(r){var o=cd(r.title),i=so(r,{format:o,isSelected:t(o),getPreview:e(o)});return n.formatter.register(o,i),i},u=function(n){return Q(n,function(n){if(hr(n,"items")){var t=u(n.items);return so(o(n),{items:t})}return hr(n,"format")?r(n):i(n)})};return u(Wu(n))},ew=function(n,t){var e=function(t){return fn(t,function(t){if(void 0!==t.items){var r=e(t.items);return r.length>0?[t]:[]}var o=!hr(t,"format")||n.formatter.canApply(t.format);return o?[t]:[]})},r=e(t);return nw(r)},rw=function(n,t,e){var r=ew(n,t);return Jx({formats:r,handle:function(t,r){n.undoReceptionist.transact(function(){Zc.isOn(t)?n.formatter.remove(r):n.formatter.apply(r)}),e()}})},ow=function(n){var t=n.replace(/\|/g," ").trim();return t.length>0?t.split(/\s+/):[]},iw=function(n){return fn(n,function(n){return x(n)?iw(n):ow(n)})},uw=function(n){var t=Uu(n);return x(t)?iw(t):ow(t)},cw=function(n,t){var e=function(n){return function(){return wm(t,n)}},r=function(n){return function(){return Om(t,n)}},o=function(n,e,r){return function(){return km(t,n,e,r)}},i=e("undo"),u=e("redo"),c=r("bold"),a=r("italic"),f=r("underline"),s=e("removeformat"),l=function(){return Pb(n,t)},d=o("unlink","link",function(){t.execCommand("unlink",null,!1)}),m=function(){return vh(t)},g=o("unordered-list","ul",function(){t.execCommand("InsertUnorderedList",null,!1)}),p=o("ordered-list","ol",function(){t.execCommand("InsertOrderedList",null,!1)}),v=function(){return ih(n,t)},h=function(){return Lv(n,t)},b=tw(t),y=function(){return rw(t,b,function(){t.fire("scrollIntoView")})},x=function(){return Cm("style-formats",function(e){t.fire("toReading"),n.dropup.appear(y,Zc.on,e)},ku([Zc.config({toggleClass:oa("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Ic.config({channels:Ri([ea(Ku,Zc.off),ea(Yu,Zc.off)])})]),t)},w=function(n,e){return{isSupported:function(){var e=t.ui.registry.getAll().buttons;return n.forall(function(n){return hr(e,n)})},sketch:e}};return{undo:w($.none(),i),redo:w($.none(),u),bold:w($.none(),c),italic:w($.none(),a),underline:w($.none(),f),removeformat:w($.none(),s),link:w($.none(),l),unlink:w($.none(),d),image:w($.none(),m),bullist:w($.some("bullist"),g),numlist:w($.some("numlist"),p),fontsizeselect:w($.none(),v),forecolor:w($.none(),h),styleselect:w($.none(),x)}},aw=function(n,t){var e=uw(n),r={};return fn(e,function(n){var e=!hr(r,n)&&hr(t,n)&&t[n].isSupported()?[t[n].sketch()]:[];return r[n]=!0,e})},fw=function(n,t,e,r,o,i,u){return{target:n,x:t,y:e,stop:r,prevent:o,kill:i,raw:u}},sw=function(n){var t=re.fromDom(je(n).getOr(n.target)),e=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},o=D(r,e);return fw(t,n.clientX,n.clientY,e,r,o,n)},lw=function(n,t){return function(e){n(e)&&t(sw(e))}},dw=function(n,t,r,o,i){var u=lw(r,o);return n.dom.addEventListener(t,u,i),{unbind:e(pw,n,t,u,i)}},mw=function(n,t,e,r){return dw(n,t,e,r,!1)},gw=function(n,t,e,r){return dw(n,t,e,r,!0)},pw=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},vw=N,hw=function(n,t,e){return mw(n,t,vw,e)},bw=function(n,t,e){return gw(n,t,vw,e)},yw=tinymce.util.Tools.resolve("tinymce.util.Delay"),xw=50,ww=1e3/xw,Sw=function(n){var t=n.matchMedia("(orientation: portrait)").matches;return{isPortrait:_(t)}},Ow=function(n){var t=ft().os.isiOS(),e=Sw(n).isPortrait();return t&&!e?n.screen.height:n.screen.width},kw=function(n,t){var e=re.fromDom(n),r=null,o=function(){yw.clearInterval(r);var e=Sw(n);t.onChange(e),u(function(){t.onReady(e)})},i=hw(e,"orientationchange",o),u=function(t){yw.clearInterval(r);var e=n.innerHeight,o=0;r=yw.setInterval(function(){e!==n.innerHeight?(yw.clearInterval(r),t($.some(n.innerHeight))):o>ww&&(yw.clearInterval(r),t($.none())),o++},xw)},c=function(){i.unbind()};return{onAdjustment:u,destroy:c}},Tw=function(n,t){t.fold(function(t){n.setStartBefore(t.dom)},function(t,e){n.setStart(t.dom,e)},function(t){n.setStartAfter(t.dom)})},Cw=function(n,t){t.fold(function(t){n.setEndBefore(t.dom)},function(t,e){n.setEnd(t.dom,e)},function(t){n.setEndAfter(t.dom)})},Ew=function(n,t,e){var r=n.document.createRange();return Tw(r,t),Cw(r,e),r},Rw=function(n,t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},Dw=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Mw=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?$.some(e).map(Dw):$.none()},_w=xi.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Fw=function(n,t,e){return t(re.fromDom(e.startContainer),e.startOffset,re.fromDom(e.endContainer),e.endOffset)},Vw=function(n,t){return t.match({domRange:function(n){return{ltr:_(n),rtl:$.none}},relative:function(t,e){return{ltr:G(function(){return Ew(n,t,e)}),rtl:G(function(){return $.some(Ew(n,e,t))})}},exact:function(t,e,r,o){return{ltr:G(function(){return Rw(n,t,e,r,o)}),rtl:G(function(){return $.some(Rw(n,r,o,t,e))})}}})},Iw=function(n,t){var e=t.ltr();if(e.collapsed){var r=t.rtl().filter(function(n){return!1===n.collapsed});return r.map(function(n){return _w.rtl(re.fromDom(n.endContainer),n.endOffset,re.fromDom(n.startContainer),n.startOffset)}).getOrThunk(function(){return Fw(n,_w.ltr,e)})}return Fw(n,_w.ltr,e)},Bw=function(n,t){var e=Vw(n,t);return Iw(n,e)},Aw=function(n,t){var e=Bw(n,t);return e.match({ltr:function(t,e,r,o){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},rtl:function(t,e,r,o){var i=n.document.createRange();return i.setStart(r.dom,o),i.setEnd(t.dom,e),i}})};_w.ltr,_w.rtl;var Hw=function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}},Nw={create:Hw},Pw=function(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return r(e).getOr("")},r=function(t){return n(t)?$.from(t.dom.nodeValue):$.none()},o=function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom.nodeValue=r};return{get:e,getOption:r,set:o}},zw=Pw(ge,"text"),jw=function(n){return zw.getOption(n)},Lw=function(n){return"img"===se(n)?1:jw(n).fold(function(){return ke(n).length},function(n){return n.length})},$w=xi.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Gw=function(n,t,e,r){return n.fold(t,e,r)},Uw=function(n){return n.fold(F,F,F)},Ww=$w.before,Xw=$w.on,qw=$w.after,Kw={before:Ww,on:Xw,after:qw,cata:Gw,getStart:Uw},Yw=xi.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Jw=function(n){return Yw.exact(n.start,n.soffset,n.finish,n.foffset)},Qw=function(n){return n.match({domRange:function(n){return re.fromDom(n.startContainer)},relative:function(n,t){return Kw.getStart(n)},exact:function(n,t,e,r){return n}})},Zw=Yw.domRange,nS=Yw.relative,tS=Yw.exact,eS=function(n){var t=Qw(n);return ye(t)},rS=Nw.create,oS={domRange:Zw,relative:nS,exact:tS,exactFromRange:Jw,getWin:eS,range:rS},iS=function(n,t){var e=se(n);return"input"===e?Kw.after(n):Y(["br","img"],e)?0===t?Kw.before(n):Kw.after(n):Kw.on(n,t)},uS=function(n,t,e,r){var o=iS(n,t),i=iS(e,r);return oS.relative(o,i)},cS=function(n,t,e,r){var o=he(n),i=o.dom.createRange();return i.setStart(n.dom,t),i.setEnd(e.dom,r),i},aS=function(n,t,e,r){var o=cS(n,t,e,r),i=ae(n,e)&&t===r;return o.collapsed&&!i},fS=function(n){return $.from(n.getSelection())},sS=function(n,t){fS(n).each(function(n){n.removeAllRanges(),n.addRange(t)})},lS=function(n,t,e,r,o){var i=Rw(n,t,e,r,o);sS(n,i)},dS=function(n,t,e,r,o,i){t.collapse(e.dom,r),t.extend(o.dom,i)},mS=function(n,t){return Bw(n,t).match({ltr:function(t,e,r,o){lS(n,t,e,r,o)},rtl:function(t,e,r,o){fS(n).each(function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,e,r.dom,o);else if(i.extend)try{dS(n,i,t,e,r,o)}catch(i){lS(n,r,o,t,e)}else lS(n,r,o,t,e)})}})},gS=function(n,t,e,r,o){var i=uS(t,e,r,o);mS(n,i)},pS=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return $.some(Nw.create(re.fromDom(t.startContainer),t.startOffset,re.fromDom(e.endContainer),e.endOffset))}return $.none()},vS=function(n){if(null===n.anchorNode||null===n.focusNode)return pS(n);var t=re.fromDom(n.anchorNode),e=re.fromDom(n.focusNode);return aS(t,n.anchorOffset,e,n.focusOffset)?$.some(Nw.create(t,n.anchorOffset,e,n.focusOffset)):pS(n)},hS=function(n){return fS(n).filter(function(n){return n.rangeCount>0}).bind(vS)},bS=function(n){return hS(n).map(function(n){return oS.exact(n.start,n.soffset,n.finish,n.foffset)})},yS=function(n,t){var e=Aw(n,t);return Mw(e)},xS=function(n){fS(n).each(function(n){return n.removeAllRanges()})},wS=function(n){return $.some(re.fromDom(n.dom.contentWindow.document.body))},SS=function(n){return $.some(re.fromDom(n.dom.contentWindow.document))},OS=function(n){return $.from(n.dom.contentWindow)},kS=function(n){var t=OS(n);return t.bind(hS)},TS=function(n){return n.getFrame()},CS=function(n,t){return function(e){var r=e[n].getOrThunk(function(){var n=TS(e);return function(){return t(n)}});return r()}},ES=function(n,t,e,r){return n[e].getOrThunk(function(){return function(n){return hw(t,r,n)}})},RS=function(n){var t=TS(n),r=function(n){var t=function(n){return ae(n.start,n.finish)&&n.soffset===n.foffset},e=function(n){var t=n.start.dom.getBoundingClientRect();return t.width>0||t.height>0?$.some(t):$.none()};return hS(n).filter(t).bind(e)};return wS(t).bind(function(o){return SS(t).bind(function(i){return OS(t).map(function(u){var c=re.fromDom(i.dom.documentElement),a=n.getCursorBox.getOrThunk(function(){return function(){return bS(u).bind(function(n){return yS(u,n).orThunk(function(){return r(u)})})}}),f=n.setSelection.getOrThunk(function(){return function(n,t,e,r){gS(u,n,t,e,r)}}),s=n.clearSelection.getOrThunk(function(){return function(){xS(u)}});return{body:o,doc:i,win:u,html:c,getSelection:e(kS,t),setSelection:f,clearSelection:s,frame:t,onKeyup:ES(n,i,"onKeyup","keyup"),onNodeChanged:ES(n,i,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:a}})})})},DS=CS("getWin",OS),MS=function(){var n=Na("head").getOrDie(),t=function(){var t=re.fromTag("meta");return yr(t,"name","viewport"),Me(n,t),t},e=Na('meta[name="viewport"]').getOrThunk(t),r=wr(e,"content"),o=function(){yr(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},i=function(){null!=r&&r.length>0?yr(e,"content",r):yr(e,"content","user-scalable=yes")};return{maximize:o,restore:i}},_S="data-ephox-mobile-fullscreen-style",FS="display:none!important;",VS="position:absolute!important;",IS="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",BS="background-color:rgb(255,255,255)!important;",AS=ft().os.isAndroid(),HS=function(n){var t=wa(n,"background-color");return void 0!==t&&""!==t?"background-color:"+t+"!important":BS},NS=function(n,t){var e=function(n){return Va(n,"*")},r=function(n){return function(t){var e=wr(t,"style"),r=void 0===e?"no-styles":e.trim();r!==n&&(yr(t,_S,r),yr(t,"style",n))}},o=Fa(n,"*"),i=fn(o,e),u=HS(t);Z(i,r(FS)),Z(o,r(VS+IS+u));var c=!0===AS?"":VS;r(c+IS+u)(n)},PS=function(){var n=_a("["+_S+"]");Z(n,function(n){var t=wr(n,_S);"no-styles"!==t?yr(n,"style",t):kr(n,"style"),kr(n,_S)})},zS=function(n,t){var e=null,r=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e=setTimeout(function(){n.apply(null,r),e=null},t)},o=function(){null!==e&&(clearTimeout(e),e=null)};return{cancel:o,schedule:r}},jS=5,LS=400,$S=function(n){var t=n.raw;return void 0===t.touches||1!==t.touches.length?$.none():$.some(t.touches[0])},GS=function(n,t){var e=Math.abs(n.clientX-t.x),r=Math.abs(n.clientY-t.y);return e>jS||r>jS},US=function(n){var t=Yf(),e=_u(!1),r=zS(function(t){n.triggerEvent(It(),t),e.set(!0)},LS),o=function(n){return $S(n).each(function(o){r.cancel();var i={x:o.clientX,y:o.clientY,target:n.target};r.schedule(n),e.set(!1),t.set(i)}),$.none()},i=function(n){return r.cancel(),$S(n).each(function(n){t.on(function(e){GS(n,e)&&t.clear()})}),$.none()},u=function(o){r.cancel();var i=function(n){return ae(n.target,o.target)};return t.get().filter(i).map(function(t){return e.get()?(o.prevent(),!1):n.triggerEvent(Vt(),o)})},c=Ri([{key:lt(),value:o},{key:dt(),value:i},{key:mt(),value:u}]),a=function(n,t){return pr(c,t).bind(function(t){return t(n)})};return{fireIfReady:a}},WS=function(n){var t=US({triggerEvent:function(t,e){n.onTapContent(e)}}),e=function(){return hw(n.body,"touchend",function(n){t.fireIfReady(n,"touchend")})},r=function(){return hw(n.body,"touchmove",function(n){t.fireIfReady(n,"touchmove")})},o=function(n){t.fireIfReady(n,"touchstart")};return{fireTouchstart:o,onTouchend:e,onTouchmove:r}},XS=ft().os.version.major>=6,qS=function(n,t,e){var r=WS(n),o=he(t),i=function(n){return!ae(n.start,n.finish)||n.soffset!==n.foffset},u=function(){return Au(o).filter(function(n){return"input"===se(n)}).exists(function(n){return n.dom.selectionStart!==n.dom.selectionEnd})},c=function(){var r=n.doc.dom.hasFocus()&&n.getSelection().exists(i);e.getByDom(t).each(!0===(r||u())?Zc.on:Zc.off)},a=[hw(n.body,"touchstart",function(t){n.onTouchContent(),r.fireTouchstart(t)}),r.onTouchmove(),r.onTouchend(),hw(t,"touchstart",function(t){n.onTouchToolstrip()}),n.onToReading(function(){Iu(n.body)}),n.onToEditing(R),n.onScrollToCursor(function(t){t.preventDefault(),n.getCursorBox().each(function(t){var e=n.win,r=t.top>e.innerHeight||t.bottom>e.innerHeight,o=r?t.bottom-e.innerHeight+50:0;0!==o&&e.scrollTo(e.pageXOffset,e.pageYOffset+o)})})].concat(!0===XS?[]:[hw(re.fromDom(n.win),"blur",function(){e.getByDom(t).each(Zc.off)}),hw(o,"select",c),hw(n.doc,"selectionchange",c)]),f=function(){Z(a,function(n){n.unbind()})};return{destroy:f}},KS=function(n,t){var e=parseInt(wr(n,t),10);return isNaN(e)?0:e},YS=2,JS=function(n){return m(m({},n),{width:YS})},QS=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},ZS=function(n){if(n.collapsed){var t=re.fromDom(n.startContainer);return xe(t).bind(function(e){var r=oS.exact(t,n.startOffset,e,Lw(e)),o=yS(n.startContainer.ownerDocument.defaultView,r);return o.map(JS).map(mn)}).getOr([])}return Q(n.getClientRects(),QS)},nO=function(n){var t=n.getSelection();return void 0!==t&&t.rangeCount>0?ZS(t.getRangeAt(0)):[]},tO=function(){return function(n){yw.setTimeout(function(){n()},0)}},eO=function(n){n.focus();var t=re.fromDom(n.document.body),e=Au().exists(function(n){return Y(["input","textarea"],se(n))}),r=e?tO():A;r(function(){Au().each(Iu),Vu(t)})},rO=50,oO="data-"+oa("last-outer-height"),iO=function(n,t){yr(n,oO,t)},uO=function(n){return KS(n,oO)},cO=function(n){return{top:n.top,bottom:n.top+n.height}},aO=function(n){var t=nO(n);return t.length>0?$.some(t[0]).map(cO):$.none()},fO=function(n,t){var e=uO(t),r=n.innerHeight;return e>r?$.some(e-r):$.none()},sO=function(n,t,e){var r=t.top>n.innerHeight||t.bottom>n.innerHeight;return r?Math.min(e,t.bottom-n.innerHeight+rO):0},lO=function(n,t){var e=re.fromDom(t.document.body),r=function(){eO(t)},o=hw(re.fromDom(n),"resize",function(){fO(n,e).each(function(n){aO(t).each(function(e){var r=sO(t,e,n);0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)})}),iO(e,n.innerHeight)});iO(e,n.innerHeight);var i=function(){o.unbind()};return{toEditing:r,destroy:i}},dO=function(n,t){var e=MS(),r=Kf(),o=Kf(),i=function(){t.hide(),Fr(n.container,oa("fullscreen-maximized")),Fr(n.container,oa("android-maximized")),e.maximize(),Fr(n.body,oa("android-scroll-reload")),r.set(lO(n.win,DS(n.editor).getOrDie("no"))),RS(n.editor).each(function(t){NS(n.container,t.body),o.set(qS(t,n.toolstrip,n.alloy))})},u=function(){e.restore(),t.show(),Ir(n.container,oa("fullscreen-maximized")),Ir(n.container,oa("android-maximized")),PS(),Ir(n.body,oa("android-scroll-reload")),o.clear(),r.clear()};return{enter:i,exit:u}},mO=function(n,t){var e=null,r=function(){w(e)||(clearTimeout(e),e=null)},o=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];w(e)&&(e=setTimeout(function(){e=null,n.apply(null,r)},t))};return{cancel:r,throttle:o}},gO=function(n,t){var e=null,r=function(){w(e)||(clearTimeout(e),e=null)},o=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r(),e=setTimeout(function(){e=null,n.apply(null,o)},t)};return{cancel:r,throttle:o}},pO=function(n,t){var e=uh(zh.sketch({dom:ym('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:ku([Zc.config({toggleClass:oa("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=mO(n,200);return zh.sketch({dom:ym('<div class="${prefix}-disabled-mask"></div>'),components:[zh.sketch({dom:ym('<div class="${prefix}-content-container"></div>'),components:[lm.sketch({dom:ym('<div class="${prefix}-content-tap-section"></div>'),components:[e.asSpec()],action:function(n){r.throttle()},buttonBehaviours:ku([Zc.config({toggleClass:oa("mask-tap-icon-selected")})])})]})]})},vO=_({unbind:R}),hO=Lo([fi("editor",[ui("getFrame"),si("getBody"),si("getDoc"),si("getWin"),si("getSelection"),si("setSelection"),si("clearSelection"),si("cursorSaver"),si("onKeyup"),si("onNodeChanged"),si("getCursorBox"),ui("onDomChanged"),gi("onTouchContent",R),gi("onTapContent",R),gi("onTouchToolstrip",R),gi("onScrollToCursor",vO),gi("onScrollToElement",vO),gi("onToEditing",vO),gi("onToReading",vO),gi("onToolbarScrollStart",F)]),ui("socket"),ui("toolstrip"),ui("dropup"),ui("toolbar"),ui("container"),ui("alloy"),ii("win",function(n){return he(n.socket).dom.defaultView}),ii("body",function(n){return re.fromDom(n.socket.dom.ownerDocument.body)}),gi("translate",F),gi("setReadOnly",R),gi("readOnlyOnInit",N)]),bO=function(n){var t=ti("Getting AndroidWebapp schema",hO,n);ya(t.toolstrip,"width","100%");var e=function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()},r=_y(pO(e,t.translate));t.alloy.add(r);var o={show:function(){t.alloy.add(r)},hide:function(){t.alloy.remove(r)}};Me(t.container,r.element);var i=dO(t,o);return{setReadOnly:t.setReadOnly,refreshStructure:R,enter:i.enter,exit:i.exit,destroy:R}},yO=_([ui("dom"),gi("shell",!0),Gl("toolbarBehaviours",[dx])]),xO=function(){return{behaviours:ku([dx.config({})])}},wO=_([kd({name:"groups",overrides:xO})]),SO=function(n,t,e,r){var o=function(n,t){i(n).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(n){dx.set(n,t)})},i=function(t){return n.shell?$.some(t):Ad(t,n,"groups")},u=n.shell?{behaviours:[dx.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Wl(n.toolbarBehaviours,u.behaviours),apis:{setGroups:o},domModification:{attributes:{role:"group"}}}},OO=fm({name:"Toolbar",configFields:yO(),partFields:wO(),factory:SO,apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),kO=_([ui("items"),kc(["itemSelector"]),Gl("tgroupBehaviours",[$l])]),TO=_([Td({name:"items",unit:"item"})]),CO=function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:Wl(n.tgroupBehaviours,[$l.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},EO=fm({name:"ToolbarGroup",configFields:kO(),partFields:TO(),factory:CO}),RO="data-"+oa("horizontal-scroll"),DO=function(n){n.dom.scrollTop=1;var t=0!==n.dom.scrollTop;return n.dom.scrollTop=0,t},MO=function(n){n.dom.scrollLeft=1;var t=0!==n.dom.scrollLeft;return n.dom.scrollLeft=0,t},_O=function(n){return n.dom.scrollTop>0||DO(n)},FO=function(n){return n.dom.scrollLeft>0||MO(n)},VO=function(n){yr(n,RO,"true")},IO=function(n){return"true"===wr(n,RO)?FO(n):_O(n)},BO=function(n,t){return hw(n,"touchmove",function(n){ja(n.target,t).filter(IO).fold(function(){n.prevent()},R)})},AO=function(){var n=function(n){var t=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:ym('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:ku([Ih("adhoc-scrollable-toolbar",!0===n.scrollable?[cu(function(n,t){ya(n.element,"overflow-x","auto"),VO(n.element),Gx(n.element)})]:[])]),components:[zh.sketch({components:[EO.parts.items({})]})],markers:{itemSelector:"."+oa("toolbar-group-item")},items:n.items}},t=_y(OO.sketch({dom:ym('<div class="${prefix}-toolbar"></div>'),components:[OO.parts.groups({})],toolbarBehaviours:ku([Zc.config({toggleClass:oa("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),$l.config({mode:"cyclic"})]),shell:!0})),e=_y(zh.sketch({dom:{classes:[oa("toolstrip")]},components:[Fy(t)],containerBehaviours:ku([Zc.config({toggleClass:oa("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){OO.setGroups(t,o.get()),Zc.off(t)},o=_u([]),i=function(n){o.set(n),r()},u=function(t){return Q(t,D(EO.sketch,n))},c=function(){},a=function(n){Zc.on(t),OO.setGroups(t,n)},f=function(){Zc.isOn(t)&&r()},s=function(){$l.focusIn(t)};return{wrapper:e,toolbar:t,createGroups:u,setGroups:i,setContextToolbar:a,restoreToolbar:f,refresh:c,focus:s}},HO=function(n){return _y(lm.sketch({dom:ym('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run(function(n){n.setReadOnly(!1)})}}))},NO=function(){return _y(zh.sketch({dom:ym('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:ku([dx.config({})])}))},PO=function(n,t){dx.append(n,Fy(t))},zO=function(n,t){dx.remove(n,t)},jO=function(n,t,e,r){var o=!0===e?Mu.toAlpha:Mu.toOmega;o(r);var i=e?PO:zO;i(n,t)},LO=function(n,t){return t.getAnimationRoot.fold(function(){return n.element},function(t){return t(n)})},$O=function(n){return n.dimension.property},GO=function(n,t){return n.dimension.getDimension(t)},UO=function(n,t){var e=LO(n,t);hy(e,[t.shrinkingClass,t.growingClass])},WO=function(n,t){Ir(n.element,t.openClass),Fr(n.element,t.closedClass),ya(n.element,$O(t),"0px"),Ta(n.element)},XO=function(n,t){Ir(n.element,t.closedClass),Fr(n.element,t.openClass),ka(n.element,$O(t))},qO=function(n,t,e,r){e.setCollapsed(),ya(n.element,$O(t),GO(t,n.element)),Ta(n.element),UO(n,t),WO(n,t),t.onStartShrink(n),t.onShrunk(n)},KO=function(n,t,e,r){var o=r.getOrThunk(function(){return GO(t,n.element)});e.setCollapsed(),ya(n.element,$O(t),o),Ta(n.element);var i=LO(n,t);Ir(i,t.growingClass),Fr(i,t.shrinkingClass),WO(n,t),t.onStartShrink(n)},YO=function(n,t,e){var r=GO(t,n.element),o="0px"===r?qO:KO;o(n,t,e,$.some(r))},JO=function(n,t,e){var r=LO(n,t),o=Br(r,t.shrinkingClass),i=GO(t,n.element);XO(n,t);var u=GO(t,n.element),c=function(){ya(n.element,$O(t),i),Ta(n.element)},a=function(){WO(n,t)},f=o?c:a;f(),Ir(r,t.shrinkingClass),Fr(r,t.growingClass),XO(n,t),ya(n.element,$O(t),u),e.setExpanded(),t.onStartGrow(n)},QO=function(n,t,e){if(e.isExpanded()){ka(n.element,$O(t));var r=GO(t,n.element);ya(n.element,$O(t),r)}},ZO=function(n,t,e){e.isExpanded()||JO(n,t,e)},nk=function(n,t,e){e.isExpanded()&&YO(n,t,e)},tk=function(n,t,e){e.isExpanded()&&qO(n,t,e)},ek=function(n,t,e){return e.isExpanded()},rk=function(n,t,e){return e.isCollapsed()},ok=function(n,t,e){var r=LO(n,t);return!0===Br(r,t.growingClass)},ik=function(n,t,e){var r=LO(n,t);return!0===Br(r,t.shrinkingClass)},uk=function(n,t,e){return ok(n,t)||ik(n,t)},ck=function(n,t,e){var r=e.isExpanded()?YO:JO;r(n,t,e)},ak=Object.freeze({__proto__:null,refresh:QO,grow:ZO,shrink:nk,immediateShrink:tk,hasGrown:ek,hasShrunk:rk,isGrowing:ok,isShrinking:ik,isTransitioning:uk,toggleGrow:ck,disableTransitions:UO}),fk=function(n,t,e){var r=t.expanded;return mu(r?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Ei(t.dimension.property,"0px")})},sk=function(n,t){return Xi([ou(Ot(),function(e,r){var o=r.event.raw;if(o.propertyName===n.dimension.property){UO(e,n),t.isExpanded()&&ka(e.element,n.dimension.property);var i=t.isExpanded()?n.onGrown:n.onShrunk;i(e)}})])},lk=Object.freeze({__proto__:null,exhibit:fk,events:sk}),dk=[ui("closedClass"),ui("openClass"),ui("shrinkingClass"),ui("growingClass"),si("getAnimationRoot"),Cc("onShrunk"),Cc("onStartShrink"),Cc("onGrown"),Cc("onStartGrow"),gi("expanded",!1),ci("dimension",ri("property",{width:[Mc("property","width"),Mc("getDimension",function(n){return hg(n)+"px"})],height:[Mc("property","height"),Mc("getDimension",function(n){return Ra(n)+"px"})]}))],mk=function(n){var t=_u(n.expanded),r=function(){return"expanded: "+t.get()};return Ou({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:e(t.set,!1),setExpanded:e(t.set,!0),readState:r})},gk=Object.freeze({__proto__:null,init:mk}),pk=Cu({fields:dk,name:"sliding",active:lk,apis:ak,state:gk}),vk=function(n,t){var e=_y(zh.sketch({dom:{tag:"div",classes:[oa("dropup")]},components:[],containerBehaviours:ku([dx.config({}),pk.config({closedClass:oa("dropup-closed"),openClass:oa("dropup-open"),shrinkingClass:oa("dropup-shrinking"),growingClass:oa("dropup-growing"),dimension:{property:"height"},onShrunk:function(e){n(),t(),dx.set(e,[])},onGrown:function(e){n(),t()}}),ta(function(n,t){o(R)})])})),r=function(n,t,r){!0===pk.hasShrunk(e)&&!1===pk.isTransitioning(e)&&window.requestAnimationFrame(function(){t(r),dx.set(e,[n()]),pk.grow(e)})},o=function(n){window.requestAnimationFrame(function(){n(),pk.shrink(e)})};return{appear:r,disappear:o,component:e,element:e.element}},hk=function(n,t,e){return ja(n,t,e).isSome()},bk=function(n){var t=n.raw;return t.which===La[0]&&!Y(["input","textarea"],se(n.target))&&!hk(n.target,'[contenteditable="true"]')},yk=function(){return ft().browser.isFirefox()},xk=function(n,t){return yk()?bw(n,"focus",t):hw(n,"focusin",t)},wk=function(n,t){return yk()?bw(n,"blur",t):hw(n,"focusout",t)},Sk=function(n,t){var e=m({stopBackspace:!0},t),r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],o=US(e),i=Q(r.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return hw(n,t,function(n){o.fireIfReady(n,t).each(function(t){t&&n.kill()});var r=e.triggerEvent(t,n);r&&n.kill()})}),u=Yf(),c=hw(n,"paste",function(n){o.fireIfReady(n,"paste").each(function(t){t&&n.kill()});var t=e.triggerEvent("paste",n);t&&n.kill(),u.set(setTimeout(function(){e.triggerEvent(Dt(),n)},0))}),a=hw(n,"keydown",function(n){var t=e.triggerEvent("keydown",n);t?n.kill():e.stopBackspace&&bk(n)&&n.prevent()}),f=xk(n,function(n){var t=e.triggerEvent("focusin",n);t&&n.kill()}),s=Yf(),l=wk(n,function(n){var t=e.triggerEvent("focusout",n);t&&n.kill(),s.set(setTimeout(function(){e.triggerEvent(Rt(),n)},0))}),d=function(){Z(i,function(n){n.unbind()}),a.unbind(),f.unbind(),l.unbind(),c.unbind(),u.on(clearTimeout),s.on(clearTimeout)};return{unbind:d}},Ok=function(n,t){var e=pr(n,"target").getOr(t);return _u(e)},kk=function(n,t){var e=_u(!1),r=_u(!1),o=function(){e.set(!0)},i=function(){r.set(!0)};return{stop:o,cut:i,isStopped:e.get,isCut:r.get,event:n,setSource:t.set,getSource:t.get}},Tk=function(n){var t=_u(!1),e=function(){t.set(!0)};return{stop:e,cut:R,isStopped:t.get,isCut:H,event:n,setSource:B("Cannot set source of a broadcasted event"),getSource:B("Cannot get source of a broadcasted event")}},Ck=xi.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),Ek=function(n,t,e,r,o,i){var u=n(t,r),c=kk(e,o);return u.fold(function(){return i.logEventNoHandlers(t,r),Ck.complete()},function(n){var e=n.descHandler,r=ty(e);return r(c),c.isStopped()?(i.logEventStopped(t,n.element,e.purpose),Ck.stopped()):c.isCut()?(i.logEventCut(t,n.element,e.purpose),Ck.complete()):xe(n.element).fold(function(){return i.logNoParent(t,n.element,e.purpose),Ck.complete()},function(r){return i.logEventResponse(t,n.element,e.purpose),Ck.resume(r)})})},Rk=function(n,t,e,r,o,i){return Ek(n,t,e,r,o,i).fold(N,function(r){return Rk(n,t,e,r,o,i)},H)},Dk=function(n,t,e,r,o){var i=Ok(e,r);return Ek(n,t,e,r,i,o)},Mk=function(n,t,e){var r=Tk(t);return Z(n,function(n){var t=n.descHandler,e=ty(t);e(r)}),r.isStopped()},_k=function(n,t,e,r){return Fk(n,t,e,e.target,r)},Fk=function(n,t,e,r,o){var i=Ok(e,r);return Rk(n,t,e,r,i,o)},Vk=function(n,t){return{element:n,descHandler:t}},Ik=function(n,t){return{id:n,descHandler:t}},Bk=function(){var n={},t=function(t,e,r){ur(r,function(r,o){var i=void 0!==n[o]?n[o]:{};i[e]=ny(r,t),n[o]=i})},e=function(n,t){return Jd(t).bind(function(t){return pr(n,t)}).map(function(n){return Vk(t,n)})},r=function(t){return pr(n,t).map(function(n){return dr(n,function(n,t){return Ik(t,n)})}).getOr([])},o=function(t,r,o){return pr(n,r).bind(function(n){return Pi(o,function(t){return e(n,t)},t)})},i=function(t){ur(n,function(n,e){vr(n,t)&&delete n[t]})};return{registerId:t,unregisterId:i,filterByType:r,find:o}},Ak=function(){var n=Bk(),t={},e=function(n){var t=n.element;return Jd(t).getOrThunk(function(){return Kd("uid-",n.element)})},r=function(n,e){var r=t[e];if(r!==n)throw new Error('The tagId "'+e+'" is already used by: '+oc(r.element)+"\nCannot use it for: "+oc(n.element)+"\nThe conflicting element is"+($e(r.element)?" ":" not ")+"already in the DOM");i(n)},o=function(o){var i=e(o);hr(t,i)&&r(o,i);var u=[o];n.registerId(u,i,o.events),t[i]=o},i=function(e){Jd(e.element).each(function(e){delete t[e],n.unregisterId(e)})},u=function(t){return n.filterByType(t)},c=function(t,e,r){return n.find(t,e,r)},a=function(n){return pr(t,n)};return{find:c,filter:u,register:o,unregister:i,getById:a}},Hk=function(n){var t=function(t){return xe(n.element).fold(N,function(n){return ae(t,n)})},e=Ak(),r=function(n,r){return e.find(t,n,r)},o=Sk(n.element,{triggerEvent:function(n,t){return pc(n,t.target,function(e){return _k(r,n,t,e)})}}),i={debugInfo:_("real"),triggerEvent:function(n,t,e){pc(n,t,function(o){return Fk(r,n,e,t,o)})},triggerFocus:function(n,t){Jd(n).fold(function(){Vu(n)},function(e){pc(Et(),n,function(e){return Dk(r,Et(),{originator:t,kill:R,prevent:R,target:n},n,e),!1})})},triggerEscape:function(n,t){i.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return p(n)},getByDom:function(n){return v(n)},build:_y,addToGui:function(n){a(n)},removeFromGui:function(n){f(n)},addToWorld:function(n){u(n)},removeFromWorld:function(n){c(n)},broadcast:function(n){d(n)},broadcastOn:function(n,t){m(n,t)},broadcastEvent:function(n,t){g(n,t)},isConnected:N},u=function(n){n.connect(i),ge(n.element)||(e.register(n),Z(n.components(),u),i.triggerEvent(Bt(),n.element,{target:n.element}))},c=function(n){ge(n.element)||(Z(n.components(),c),e.unregister(n)),n.disconnect()},a=function(t){Je(n,t)},f=function(n){nr(n)},s=function(){o.unbind(),Ie(n.element)},l=function(n){var t=e.filter(Mt());Z(t,function(t){var e=t.descHandler,r=ty(e);r(n)})},d=function(n){l({
universal:!0,data:n})},m=function(n,t){l({universal:!1,channels:n,data:t})},g=function(n,t){var r=e.filter(n);return Mk(r,t)},p=function(n){return e.getById(n).fold(function(){return Wr.error(new Error('Could not find component with uid: "'+n+'" in system.'))},Wr.value)},v=function(n){var t=Jd(n).getOr("not found");return p(t)};return u(n),{root:n,element:n.element,destroy:s,add:a,remove:f,getByUid:p,getByDom:v,addToWorld:u,removeFromWorld:c,broadcast:d,broadcastOn:m,broadcastEvent:g}},Nk=oa("readonly-mode"),Pk=oa("edit-mode"),zk=function(n,t){var e=re.fromTag("input");xa(e,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),Me(n,e),Vu(e),t(e),Ie(e)},jk=function(n){var t=n.getSelection();if(t.rangeCount>0){var e=t.getRangeAt(0),r=n.document.createRange();r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(r)}},Lk=function(n,t){Au().each(function(n){ae(n,t)||Iu(n)}),n.focus(),Vu(re.fromDom(n.document.body)),jk(n)},$k=function(n,t,e,r){var o=function(){Lk(t,r)},i=function(){zk(n,Iu)},u=hw(e,"keydown",function(n){Y(["input","textarea"],se(n.target))||o()}),c=R,a=function(){u.unbind()};return{toReading:i,toEditing:o,onToolbarTouch:c,destroy:a}},Gk=function(n,t,e,r,o){var i=function(){t.run(function(n){n.highlightSelection()})},u=function(){t.run(function(n){n.refreshSelection()})},c=function(n,e){var o=n-r.dom.scrollTop;t.run(function(n){n.scrollIntoView(o,o+e)})},a=function(n){c(t,r)},f=function(){n.getCursorBox().each(function(n){c(n.top,n.height)})},s=function(){t.run(function(n){n.clearSelection()})},l=function(){s(),b.throttle()},d=function(){f(),t.run(function(n){n.syncHeight()})},m=function(){var n=Ra(e);t.run(function(t){t.setViewportOffset(n)}),u(),d()},g=function(){t.run(function(n){n.toEditing()})},p=function(){t.run(function(n){n.toReading()})},v=function(n){t.run(function(t){t.onToolbarTouch(n)})},h=WS(n),b=gO(d,300),y=[n.onKeyup(l),n.onNodeChanged(u),n.onDomChanged(b.throttle),n.onDomChanged(u),n.onScrollToCursor(function(n){n.preventDefault(),b.throttle()}),n.onScrollToElement(function(n){a(n.element)}),n.onToEditing(g),n.onToReading(p),hw(n.doc,"touchend",function(t){ae(n.html,t.target)||ae(n.body,t.target)}),hw(e,"transitionend",function(n){"height"===n.raw.propertyName&&m()}),bw(e,"touchstart",function(t){i(),v(t),n.onTouchToolstrip()}),hw(n.body,"touchstart",function(t){s(),n.onTouchContent(),h.fireTouchstart(t)}),h.onTouchmove(),h.onTouchend(),hw(n.body,"click",function(n){n.kill()}),hw(e,"touchmove",function(){n.onToolbarScrollStart()})],x=function(){Z(y,function(n){n.unbind()})};return{destroy:x}},Uk=function(n){var t=$.none(),e=[],r=function(n){return Uk(function(t){o(function(e){t(n(e))})})},o=function(n){u()?a(n):e.push(n)},i=function(n){u()||(t=$.some(n),c(e),e=[])},u=function(){return t.isSome()},c=function(n){Z(n,a)},a=function(n){t.each(function(t){setTimeout(function(){n(t)},0)})};return n(i),{get:o,map:r,isReady:u}},Wk=function(n){return Uk(function(t){t(n)})},Xk={nu:Uk,pure:Wk},qk=function(n){setTimeout(function(){throw n},0)},Kk=function(n){var t=function(t){n().then(t,qk)},e=function(t){return Kk(function(){return n().then(t)})},r=function(t){return Kk(function(){return n().then(function(n){return t(n).toPromise()})})},o=function(t){return Kk(function(){return n().then(function(){return t.toPromise()})})},i=function(){return Xk.nu(t)},u=function(){var t=null;return Kk(function(){return null===t&&(t=n()),t})},c=n;return{map:e,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:c,get:t}},Yk=function(n){return Kk(function(){return new sh(n)})},Jk=function(n){return Kk(function(){return sh.resolve(n)})},Qk={nu:Yk,pure:Jk},Zk=function(n,t,e){return Math.abs(n-t)<=e?$.none():n<t?$.some(n+e):$.some(n-e)},nT=function(){var n=null,t=function(t,e,r,o,i,u){var c=!1,a=function(n){c=!0,i(n)};yw.clearInterval(n);var f=function(t){yw.clearInterval(n),a(t)};n=yw.setInterval(function(){var i=t();Zk(i,e,r).fold(function(){yw.clearInterval(n),a(e)},function(r){if(o(r,f),!c){var u=t();(u!==r||Math.abs(u-e)>Math.abs(i-e))&&(yw.clearInterval(n),a(e))}})},u)};return{animate:t}},tT=function(n,t){var e=[{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}];return hn(e,function(e){return Ai(n<=e.width&&t<=e.height,e.keyboard)}).getOr({portrait:t/5,landscape:n/4})},eT=function(n){return tT(n.screen.width,n.screen.height)},rT=function(n){var t=Sw(n).isPortrait(),e=eT(n),r=t?e.portrait:e.landscape,o=t?n.screen.height:n.screen.width;return o-n.innerHeight>r?0:r},oT=function(n,t){var e=he(n).dom.defaultView,r=Ra(n)+Ra(t),o=rT(e);return r-o},iT=function(n,t,e){var r=oT(t,e),o=Ra(t)+Ra(e)-r;ya(n,"padding-bottom",o+"px")},uT=xi.generate([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),cT="data-"+oa("position-y-fixed"),aT="data-"+oa("y-property"),fT="data-"+oa("scrolling"),sT="data-"+oa("last-window-height"),lT=function(n){return KS(n,cT)},dT=function(n){return wr(n,aT)},mT=function(n){return KS(n,sT)},gT=function(n,t){var e=dT(n);return uT.fixed(n,e,t)},pT=function(n,t){return uT.scroller(n,t)},vT=function(n){var t=lT(n),e="true"===wr(n,fT)?pT:gT;return e(n,t)},hT=function(n){var t=Ia(n,"["+cT+"]");return Q(t,vT)},bT=function(n){var t=wr(n,"style");xa(n,{position:"absolute",top:"0px"}),yr(n,cT,"0px"),yr(n,aT,"top");var e=function(){yr(n,"style",t||""),kr(n,cT),kr(n,aT)};return{restore:e}},yT=function(n,t,e){var r=wr(e,"style");Gx(e),xa(e,{position:"absolute",height:t+"px",width:"100%",top:n+"px"}),yr(e,cT,n+"px"),yr(e,fT,"true"),yr(e,aT,"top");var o=function(){Ux(e),yr(e,"style",r||""),kr(e,cT),kr(e,fT),kr(e,aT)};return{restore:o}},xT=function(n){var t=wr(n,"style");xa(n,{position:"absolute",bottom:"0px"}),yr(n,cT,"0px"),yr(n,aT,"bottom");var e=function(){yr(n,"style",t||""),kr(n,cT),kr(n,aT)};return{restore:e}},wT=function(n,t,e){var r=he(n).dom.defaultView,o=r.innerHeight;return yr(n,sT,o+"px"),o-t-e},ST=function(n,t,e,r){var o=he(n).dom.defaultView,i=bT(e),u=Ra(e),c=Ra(r),a=wT(n,u,c),f=yT(u,a,n),s=xT(r),l=!0,d=function(){l=!1,i.restore(),f.restore(),s.restore()},m=function(){var t=o.innerHeight,e=mT(n);return t>e},g=function(){if(l){var o=Ra(e),i=Ra(r),u=wT(n,o,i);yr(n,cT,o+"px"),ya(n,"height",u+"px"),iT(t,n,r)}},p=function(t){var e=t+"px";yr(n,cT,e),g()};return iT(t,n,r),{setViewportOffset:p,isExpanding:m,isShrinking:I(m),refresh:g,restore:d}},OT=nT(),kT=15,TT=10,CT=10,ET="data-"+oa("last-scroll-top"),RT=function(n){var t=Oa(n,"top").getOr("0");return parseInt(t,10)},DT=function(n){return parseInt(n.dom.scrollTop,10)},MT=function(n,t,r){return Qk.nu(function(o){var i=e(DT,n),u=function(t){n.dom.scrollTop=t,ya(n,"top",RT(n)+kT+"px")},c=function(){n.dom.scrollTop=t,ya(n,"top",r+"px"),o(t)};OT.animate(i,t,kT,u,c,CT)})},_T=function(n,t){return Qk.nu(function(r){var o=e(DT,n);yr(n,ET,o());var i=function(t,e){var r=KS(n,ET);r!==n.dom.scrollTop?e(n.dom.scrollTop):(n.dom.scrollTop=t,yr(n,ET,t))},u=function(){n.dom.scrollTop=t,yr(n,ET,t),r(t)},c=Math.abs(t-o()),a=Math.ceil(c/TT);OT.animate(o,t,a,i,u,CT)})},FT=function(n,t){return Qk.nu(function(r){var o=e(RT,n),i=function(t){ya(n,"top",t+"px")},u=function(){i(t),r(t)},c=Math.abs(t-o()),a=Math.ceil(c/TT);OT.animate(o,t,a,i,u,CT)})},VT=function(n,t){var e=t+lT(n)+"px";ya(n,"top",e)},IT=function(n,t,e){var r=he(n).dom.defaultView;return Qk.nu(function(o){VT(n,e),VT(t,e),r.scrollTo(0,e),o(e)})},BT=function(n,t,r,o,i){var u=oT(t,r),c=e(jk,n);o>u||i>u?_T(t,t.dom.scrollTop-u+i).get(c):o<0&&_T(t,t.dom.scrollTop+o).get(c)},AT=function(n,t){return t(function(t){var e=[],r=0,o=function(o){return function(i){e[o]=i,r++,r>=n.length&&t(e)}};0===n.length?t([]):Z(n,function(n,t){n.get(o(t))})})},HT=function(n){return AT(n,Qk.nu)},NT=function(n,t,e,r){var o=e+r;return ya(n,t,o+"px"),Qk.pure(r)},PT=function(n,t,e){var r=t+e,o=Oa(n,"top").getOr(e),i=r-parseInt(o,10),u=n.dom.scrollTop+i;return MT(n,u,r)},zT=function(n,t){return n.fold(function(n,e,r){return NT(n,e,t,r)},function(n,e){return PT(n,t,e)})},jT=function(n,t){var e=hT(n),r=Q(e,function(n){return zT(n,t)});return HT(r)},LT=5,$T=function(n,t,e,r,o,i){var u=c(function(e){return IT(n,t,e)}),a=function(){var n=nO(i);return $.from(n[0]).bind(function(n){var e=n.top-t.dom.scrollTop,o=e>r.innerHeight+LT||e<-LT;return o?$.some({top:e,bottom:e+n.height}):$.none()})},f=gO(function(){u.idle(function(){jT(e,r.pageYOffset).get(function(){var n=a();n.each(function(n){t.dom.scrollTop=t.dom.scrollTop+n.top}),u.start(0),o.refresh()})})},1e3),s=hw(re.fromDom(r),"scroll",function(){r.pageYOffset<0||f.throttle()});return jT(e,r.pageYOffset).get(F),{unbind:s.unbind}},GT=function(n){var t=n.cWin,e=n.ceBody,r=n.socket,o=n.toolstrip,i=n.contentElement,c=n.keyboardType,a=n.outerWindow,f=n.dropup,s=n.outerBody,l=ST(r,e,o,f),d=c(s,t,Ge(),i),m=function(){d.toEditing(),S()},g=function(){d.toReading()},p=function(n){d.onToolbarTouch()},v=kw(a,{onChange:R,onReady:l.refresh});v.onAdjustment(function(){l.refresh()});var h=hw(re.fromDom(a),"resize",function(){l.isExpanding()&&l.refresh()}),b=$T(o,r,s,a,l,t),y=u(t,i),x=function(){y.isActive()&&y.update()},w=function(){y.update()},S=function(){y.clear()},O=function(n,e){BT(t,r,f,n,e)},k=function(){ya(i,"height",i.dom.contentWindow.document.body.scrollHeight+"px")},T=function(n){l.setViewportOffset(n),FT(r,n).get(F)},C=function(){l.restore(),v.destroy(),b.unbind(),h.unbind(),d.destroy(),y.destroy(),zk(Ge(),Iu)};return{toEditing:m,toReading:g,onToolbarTouch:p,refreshSelection:x,clearSelection:S,highlightSelection:w,scrollIntoView:O,updateToolbarPadding:R,setViewportOffset:T,syncHeight:k,refreshStructure:l.refresh,destroy:C}},UT=function(n,t){var e=MS(),r=Yf(),o=Yf(),i=Kf(),u=Kf(),c=function(){t.hide();var c=re.fromDom(document);RS(n.editor).each(function(t){r.set({socketHeight:Oa(n.socket,"height"),iframeHeight:Oa(t.frame,"height"),outerScroll:document.body.scrollTop}),o.set({exclusives:BO(c,"."+Wx)}),Fr(n.container,oa("fullscreen-maximized")),NS(n.container,t.body),e.maximize(),ya(n.socket,"overflow","scroll"),ya(n.socket,"-webkit-overflow-scrolling","touch"),Vu(t.body),i.set(GT({cWin:t.win,ceBody:t.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:t.frame,outerBody:n.body,outerWindow:n.win,keyboardType:$k})),i.run(function(n){n.syncHeight()}),u.set(Gk(t,i,n.toolstrip,n.socket,n.dropup))})},a=function(){e.restore(),u.clear(),i.clear(),t.show(),r.on(function(t){t.socketHeight.each(function(t){ya(n.socket,"height",t)}),t.iframeHeight.each(function(t){ya(n.editor.getFrame(),"height",t)}),document.body.scrollTop=t.scrollTop}),r.clear(),o.on(function(n){n.exclusives.unbind()}),o.clear(),Ir(n.container,oa("fullscreen-maximized")),PS(),Ux(n.toolbar),ka(n.socket,"overflow"),ka(n.socket,"-webkit-overflow-scrolling"),Iu(n.editor.getFrame()),RS(n.editor).each(function(n){n.clearSelection()})},f=function(){i.run(function(n){n.refreshStructure()})};return{enter:c,refreshStructure:f,exit:a}},WT=function(n){var t=ti("Getting IosWebapp schema",hO,n);ya(t.toolstrip,"width","100%"),ya(t.container,"position","relative");var e=function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()},r=_y(pO(e,t.translate));t.alloy.add(r);var o={show:function(){t.alloy.add(r)},hide:function(){t.alloy.remove(r)}},i=UT(t,o);return{setReadOnly:t.setReadOnly,refreshStructure:i.refreshStructure,enter:i.enter,exit:i.exit,destroy:R}},XT=tinymce.util.Tools.resolve("tinymce.EditorReceptionist"),qT=function(n){var t=$.from(Xu(n)).getOrThunk(function(){return XT.baseURL+"/skins/ui/oxide"});return{content:t+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"}},KT=function(n,t,e){n.system.broadcastOn([qu],{command:t,state:e})},YT=function(n,t){var e=or(t.formatter.get());Z(e,function(e){t.formatter.formatChanged(e,function(t){KT(n,e,t)})}),Z(["ul","ol"],function(e){t.selection.selectorChanged(e,function(t,r){KT(n,e,t)})})},JT=function(n){return function(){var t=function(){n._skinLoaded=!0,n.fire("SkinLoaded")};n.initialized?t():n.on("init",t)}},QT="toReading",ZT="toEditing",nC=function(n){var t=function(){var t=n.getElement(),e=qT(n);if(!1===$u(n)){var r=Nu.DOM.styleSheetLoader;n.contentCSS.push(e.content),r.load(e.ui,JT(n)),n.on("remove",function(){return r.unload(e.ui)})}else JT(n)();var o=function(){n.fire("ScrollIntoView")},u=ft().os.isAndroid()?i(o):a(o),c=re.fromDom(t);tr(c,u.system);var f=function(n){return Hu(n).bind(function(n){return u.system.getByDom(n).toOptional()})},s=t.ownerDocument.defaultView,l=kw(s,{onChange:function(){var n=u.system;n.broadcastOn([Ku],{width:Ow(s)})},onReady:R}),d=function(t,e,r,o){!1===o&&n.selection.collapse();var i=m(t,e,r);u.setToolbarGroups(!0===o?i.readOnly:i.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?QT:ZT),u.updateMode(o)},m=function(n,t,e){var r=n.get(),o={readOnly:r.backToMask.concat(t.get()),main:r.backToMask.concat(e.get())};return o},g=function(t,e){return n.on(t,e),{unbind:function(){n.off(t)}}};return n.on("init",function(){u.init({editor:{getFrame:function(){return re.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:R}},onToReading:function(n){return g(QT,n)},onToEditing:function(n){return g(ZT,n)},onScrollToCursor:function(t){n.on("ScrollIntoView",function(n){t(n)});var e=function(){n.off("ScrollIntoView"),l.destroy()};return{unbind:e}},onTouchToolstrip:function(){t()},onTouchContent:function(){var e=re.fromDom(n.editorContainer.querySelector("."+oa("toolbar")));f(e).each($t),u.restoreToolbar(),t()},onTapContent:function(t){var e=t.target;if("img"===se(e))n.selection.select(e.dom),t.kill();else if("a"===se(e)){var r=u.system.getByDom(re.fromDom(n.editorContainer));r.each(function(n){Mu.isAlpha(n)&&zu(e.dom)})}}},container:re.fromDom(n.editorContainer),socket:re.fromDom(n.contentAreaContainer),toolstrip:re.fromDom(n.editorContainer.querySelector("."+oa("toolstrip"))),toolbar:re.fromDom(n.editorContainer.querySelector("."+oa("toolbar"))),dropup:u.dropup,alloy:u.system,translate:R,setReadOnly:function(n){d(v,p,m,n)},readOnlyOnInit:function(){return Gu()}});var t=function(){u.dropup.disappear(function(){u.system.broadcastOn([Yu],{})})},e={label:"The first group",scrollable:!1,items:[Cm("back",function(){n.selection.collapse(),u.exit()},{},n)]},r={label:"Back to read only",scrollable:!1,items:[Cm("readonly-back",function(){d(v,p,m,!0)},{},n)]},o={label:"The read only mode group",scrollable:!0,items:[]},i=cw(u,n),c=aw(n,i),a={label:"the action group",scrollable:!0,items:c},s={label:"The extra group",scrollable:!1,items:[]},m=_u([a,s]),p=_u([o,s]),v=_u({backToMask:[e],backToReadOnly:[r]});YT(u,n)}),n.on("remove",function(){u.exit()}),n.on("detach",function(){rr(u.system),u.system.destroy()}),{iframeContainer:u.socket.element.dom,editorContainer:u.element.dom}};return{getNotificationReceptionistImpl:function(){return{open:_({progressBar:{value:R},close:R,text:R,getEl:_(null),moveTo:R,moveRel:R,settings:{}}),close:R,reposition:R,getArgs:_({})}},renderUI:t}};f()})();