(function(){"use strict";function n(n,t,e){if(e||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return n.concat(r||Array.prototype.slice.call(t))}function t(){i.add("lists",function(n){return!1===n.hasPlugin("rtc",!0)?(go(n),po(n)):mo(n),ho(n),yo(n),no(n)})}var e,r,o,i=tinymce.util.Tools.resolve("tinymce.PluginReceptionist"),u=function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},a=function(n){return function(t){return u(t)===n}},s=function(n){return function(t){return typeof t===n}},c=a("string"),f=a("object"),l=a("array"),d=s("boolean"),m=s("function"),p=s("number"),v=function(){},g=function(n){return function(){return n}},h=function(n){return n},y=function(n,t){return n===t},S=function(n){return function(t){return!n(t)}},C=g(!1),b=g(!0),N=function(){return O},O=(e=function(n){return n()},r=h,o={fold:function(n,t){return n()},isSome:C,isNone:b,getOr:r,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:r,orThunk:e,map:N,each:v,bind:N,exists:C,forall:b,filter:function(){return N()},toArray:function(){return[]},toString:g("none()")},o),L=function(n){var t=g(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},isSome:b,isNone:C,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return L(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:O},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},T=function(n){return null==n?O:L(n)},w={some:L,none:N,from:T},x=Array.prototype.slice,D=Array.prototype.push,k=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o];r[o]=t(i,o)}return r},A=function(n,t){for(var e=0,r=n.length;e<r;e++){var o=n[e];t(o,e)}},R=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r];t(i,r)&&e.push(i)}return e},E=function(n,t){if(0===n.length)return[];for(var e=t(n[0]),r=[],o=[],i=0,u=n.length;i<u;i++){var a=n[i],s=t(a);s!==e&&(r.push(o),o=[]),e=s,o.push(a)}return 0!==o.length&&r.push(o),r},P=function(n,t,e){return A(n,function(n,r){e=t(e,n,r)}),e},B=function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r];if(t(i,r))return w.some(i);if(e(i,r))break}return w.none()},I=function(n,t){return B(n,t,C)},M=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!l(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);D.apply(t,n[e])}return t},U=function(n,t){return M(k(n,t))},_=function(n){var t=x.call(n,0);return t.reverse(),t},$=function(n,t){return t>=0&&t<n.length?w.some(n[t]):w.none()},F=function(n){return $(n,0)},H=function(n){return $(n,n.length-1)},j=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e);if(r.isSome())return r}return w.none()},K=function(){return K=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n},K.apply(this,arguments)},V=function(n){var t,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,t=n.apply(null,r)),t}},W=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),a=u||r("(pointer:coarse)"),s=o||!i&&u&&r("(min-device-width:768px)"),c=i||u&&!s,f=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),l=!c&&!s&&!f;return{isiPad:g(o),isiPhone:g(i),isTablet:g(s),isPhone:g(c),isTouch:g(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:g(f),isDesktop:g(l)}},Q=function(n,t){for(var e=0;e<n.length;e++){var r=n[e];if(r.test(t))return r}},q=function(n,t){var e=Q(n,t);if(!e)return{major:0,minor:0};var r=function(n){return Number(t.replace(e,"$"+n))};return Y(r(1),r(2))},z=function(n,t){var e=String(t).toLowerCase();return 0===n.length?X():q(n,e)},X=function(){return Y(0,0)},Y=function(n,t){return{major:n,minor:t}},Z={nu:Y,detect:z,unknown:X},G=function(n,t){return j(t.brands,function(t){var e=t.brand.toLowerCase();return I(n,function(n){var t;return e===(null===(t=n.brand)||void 0===t?void 0:t.toLowerCase())}).map(function(n){return{current:n.name,version:Z.nu(parseInt(t.version,10),0)}})})},J=function(n,t){var e=String(t).toLowerCase();return I(n,function(n){return n.search(e)})},nn=function(n,t){return J(n,t).map(function(n){var e=Z.detect(n.versionRegexes,t);return{current:n.name,version:e}})},tn=function(n,t){return J(n,t).map(function(n){var e=Z.detect(n.versionRegexes,t);return{current:n.name,version:e}})},en=function(n,t){return-1!==n.indexOf(t)},rn=function(n){return function(t){return t.replace(n,"")}},on=rn(/^\s+|\s+$/g),un=function(n){return n.length>0},an=function(n){return!un(n)},sn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,cn=function(n){return function(t){return en(t,n)}},fn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return en(n,"edge/")&&en(n,"chrome")&&en(n,"safari")&&en(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,sn],search:function(n){return en(n,"chrome")&&!en(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return en(n,"msie")||en(n,"trident")}},{name:"Opera",versionRegexes:[sn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:cn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:cn("firefox")},{name:"Safari",versionRegexes:[sn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(en(n,"safari")||en(n,"mobile/"))&&en(n,"applewebkit")}}],ln=[{name:"Windows",search:cn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return en(n,"iphone")||en(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:cn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:cn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:cn("linux"),versionRegexes:[]},{name:"Solaris",search:cn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:cn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:cn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],dn={browsers:g(fn),oses:g(ln)},mn="Edge",pn="Chrome",vn="IE",gn="Opera",hn="Firefox",yn="Safari",Sn=function(){return Cn({current:void 0,version:Z.unknown()})},Cn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:r(mn),isChrome:r(pn),isIE:r(vn),isOpera:r(gn),isFirefox:r(hn),isSafari:r(yn)}},bn={unknown:Sn,nu:Cn,edge:g(mn),chrome:g(pn),ie:g(vn),opera:g(gn),firefox:g(hn),safari:g(yn)},Nn="Windows",On="iOS",Ln="Android",Tn="Linux",wn="OSX",xn="Solaris",Dn="FreeBSD",kn="ChromeOS",An=function(){return Rn({current:void 0,version:Z.unknown()})},Rn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:r(Nn),isiOS:r(On),isAndroid:r(Ln),isOSX:r(wn),isLinux:r(Tn),isSolaris:r(xn),isFreeBSD:r(Dn),isChromeOS:r(kn)}},En={unknown:An,nu:Rn,windows:g(Nn),ios:g(On),android:g(Ln),linux:g(Tn),osx:g(wn),solaris:g(xn),freebsd:g(Dn),chromeos:g(kn)},Pn=function(n,t,e){var r=dn.browsers(),o=dn.oses(),i=t.bind(function(n){return G(r,n)}).orThunk(function(){return nn(r,n)}).fold(bn.unknown,bn.nu),u=tn(o,n).fold(En.unknown,En.nu),a=W(u,i,n,e);return{browser:i,os:u,deviceType:a}},Bn={detect:Pn},In=function(n){return window.matchMedia(n).matches},Mn=V(function(){return Bn.detect(navigator.userAgent,w.from(navigator.userAgentData),In)}),Un=function(){return Mn()},_n=function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)},$n=function(n,t){return _n(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)},Fn=1,Hn=function(n,t){var e=t||document,r=e.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Vn(r.childNodes[0])},jn=function(n,t){var e=t||document,r=e.createElement(n);return Vn(r)},Kn=function(n,t){var e=t||document,r=e.createTextNode(n);return Vn(r)},Vn=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Wn=function(n,t,e){return w.from(n.dom.elementFromPoint(t,e)).map(Vn)},Qn={fromHtml:Hn,fromTag:jn,fromText:Kn,fromDom:Vn,fromPoint:Wn},qn=function(n,t){var e=n.dom;if(e.nodeType!==Fn)return!1;var r=e;if(void 0!==r.matches)return r.matches(t);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},zn=function(n,t){return n.dom===t.dom},Xn=function(n,t){var e=n.dom,r=t.dom;return e!==r&&e.contains(r)},Yn=function(n,t){return $n(n.dom,t.dom)},Zn=function(n,t){return Un().browser.isIE()?Yn(n,t):Xn(n,t)},Gn=qn,Jn=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),nt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),tt=tinymce.util.Tools.resolve("tinymce.util.VK"),et=Object.keys,rt=function(n,t){for(var e=et(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i];t(u,i)}},ot=function(n){return function(t,e){n[e]=t}},it=function(n,t,e,r){var o={};return rt(n,function(n,o){(t(n,o)?e:r)(n,o)}),o},ut=function(n,t){var e={};return it(n,t,ot(e),v),e};"undefined"!=typeof window?window:Function("return this;")();var at=function(n){var t=n.dom.nodeName;return t.toLowerCase()},st=function(n){return n.dom.nodeType},ct=function(n){return function(t){return st(t)===n}},ft=ct(Fn),lt=function(n){return function(t){return ft(t)&&at(t)===n}},dt=function(n,t,e){if(!(c(e)||d(e)||p(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")},mt=function(n,t){var e=n.dom;rt(t,function(n,t){dt(e,t,n)})},pt=function(n){return P(n.dom.attributes,function(n,t){return n[t.name]=t.value,n},{})},vt=function(n){return w.from(n.dom.parentNode).map(Qn.fromDom)},gt=function(n){return k(n.dom.childNodes,Qn.fromDom)},ht=function(n,t){var e=n.dom.childNodes;return w.from(e[t]).map(Qn.fromDom)},yt=function(n){return ht(n,0)},St=function(n){return ht(n,n.dom.childNodes.length-1)},Ct=function(n,t){var e=vt(n);e.each(function(e){e.dom.insertBefore(t.dom,n.dom)})},bt=function(n,t){n.dom.appendChild(t.dom)},Nt=function(n,t){A(t,function(t){Ct(n,t)})},Ot=function(n,t){A(t,function(t){bt(n,t)})},Lt=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Tt=function(n,t){return Qn.fromDom(n.dom.cloneNode(t))},wt=function(n){return Tt(n,!0)},xt=function(n,t){var e=Qn.fromTag(t),r=pt(n);return mt(e,r),e},Dt=function(n,t){var e=xt(n,t);Ct(n,e);var r=gt(n);return Ot(e,r),Lt(n),e},kt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),At=tinymce.util.Tools.resolve("tinymce.util.Tools"),Rt=function(n){return function(t){return t&&t.nodeName.toLowerCase()===n}},Et=function(n){return function(t){return t&&n.test(t.nodeName)}},Pt=function(n){return n&&3===n.nodeType},Bt=Et(/^(OL|UL|DL)$/),It=Et(/^(OL|UL)$/),Mt=Rt("ol"),Ut=Et(/^(LI|DT|DD)$/),_t=Et(/^(DT|DD)$/),$t=Et(/^(TH|TD)$/),Ft=Rt("br"),Ht=function(n){return n.parentNode.firstChild===n},jt=function(n,t){return t&&!!n.schema.getTextBlockElements()[t.nodeName]},Kt=function(n,t){return n&&n.nodeName in t},Vt=function(n,t){return!!Ft(t)&&(n.isBlock(t.nextSibling)&&!Ft(t.previousSibling))},Wt=function(n,t,e){var r=n.isEmpty(t);return!(e&&n.select("span[data-mce-type=bookmark]",t).length>0)&&r},Qt=function(n,t){return n.isChildOf(t,n.getRoot())},qt=function(n){return n.getParam("lists_indent_on_tab",!0)},zt=function(n){var t=n.getParam("forced_root_block","p");return!1===t?"":!0===t?"p":t},Xt=function(n){return n.getParam("forced_root_block_attrs",{})},Yt=function(n,t){var e,r,o,i=n.dom,u=n.schema.getBlockElements(),a=i.createFragment(),s=zt(n);if(s&&(r=i.create(s),r.tagName===s.toUpperCase()&&i.setAttribs(r,Xt(n)),Kt(t.firstChild,u)||a.appendChild(r)),t)for(;e=t.firstChild;){var c=e.nodeName;o||"SPAN"===c&&"bookmark"===e.getAttribute("data-mce-type")||(o=!0),Kt(e,u)?(a.appendChild(e),r=null):s?(r||(r=i.create(s),a.appendChild(r)),r.appendChild(e)):a.appendChild(e)}return s?o||r.appendChild(i.create("br",{"data-mce-bogus":"1"})):a.appendChild(i.create("br")),a},Zt=kt.DOM,Gt=function(n,t,e){var r=function(n){At.each(o,function(t){n.parentNode.insertBefore(t,e.parentNode)}),Zt.remove(n)},o=Zt.select('span[data-mce-type="bookmark"]',t),i=Yt(n,e),u=Zt.createRng();u.setStartAfter(e),u.setEndAfter(t);for(var a=u.extractContents(),s=a.firstChild;s;s=s.firstChild)if("LI"===s.nodeName&&n.dom.isEmpty(s)){Zt.remove(s);break}n.dom.isEmpty(a)||Zt.insertAfter(a,t),Zt.insertAfter(i,t),Wt(n.dom,e.parentNode)&&r(e.parentNode),Zt.remove(e),Wt(n.dom,t)&&Zt.remove(t)},Jt=lt("dd"),ne=lt("dt"),te=function(n,t){Jt(t)?Dt(t,"dt"):ne(t)&&vt(t).each(function(e){return Gt(n,e.dom,t.dom)})},ee=function(n){ne(n)&&Dt(n,"dd")},re=function(n,t,e){A(e,"Indent"===t?ee:function(t){return te(n,t)})},oe=function(n,t){if(Pt(n))return{container:n,offset:t};var e=Jn.getNode(n,t);return Pt(e)?{container:e,offset:t>=n.childNodes.length?e.data.length:0}:e.previousSibling&&Pt(e.previousSibling)?{container:e.previousSibling,offset:e.previousSibling.data.length}:e.nextSibling&&Pt(e.nextSibling)?{container:e.nextSibling,offset:0}:{container:n,offset:t}},ie=function(n){var t=n.cloneRange(),e=oe(n.startContainer,n.startOffset);t.setStart(e.container,e.offset);var r=oe(n.endContainer,n.endOffset);return t.setEnd(r.container,r.offset),t},ue=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),ae=function(n,t){var e=t||n.selection.getStart(!0);return n.dom.getParent(e,"OL,UL,DL",pe(n,e))},se=function(n,t){return n&&1===t.length&&t[0]===n},ce=function(n){return R(n.querySelectorAll("ol,ul,dl"),Bt)},fe=function(n){var t=ae(n),e=n.selection.getSelectedBlocks();return se(t,e)?ce(t):R(e,function(n){return Bt(n)&&t!==n})},le=function(n,t){var e=At.map(t,function(t){var e=n.dom.getParent(t,"li,dd,dt",pe(n,t));return e||t});return ue.unique(e)},de=function(n){var t=n.selection.getSelectedBlocks();return R(le(n,t),Ut)},me=function(n){return R(de(n),_t)},pe=function(n,t){var e=n.dom.getParents(t,"TD,TH");return e.length>0?e[0]:n.getBody()},ve=function(n,t){var e=n.dom.getParents(t,"ol,ul",pe(n,t));return H(e)},ge=function(n){var t=ve(n,n.selection.getStart()),e=R(n.selection.getSelectedBlocks(),It);return t.toArray().concat(e)},he=function(n){var t=ge(n);return ye(n,t)},ye=function(n,t){var e=k(t,function(t){return ve(n,t).getOr(t)});return ue.unique(e)},Se=function(n,t,e){return void 0===e&&(e=y),n.exists(function(n){return e(n,t)})},Ce=function(n,t,e){return n.isSome()&&t.isSome()?w.some(e(n.getOrDie(),t.getOrDie())):w.none()},be=function(n,t){var e=t||document,r=e.createDocumentFragment();return A(n,function(n){r.appendChild(n.dom)}),Qn.fromDom(r)},Ne=function(n,t,e){return n.fire("ListMutation",{action:t,element:e})},Oe=function(n){return void 0!==n.style&&m(n.style.getPropertyValue)},Le=function(n,t,e){if(!c(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);Oe(n)&&n.style.setProperty(t,e)},Te=function(n,t,e){var r=n.dom;Le(r,t,e)},we=function(n,t){bt(n.item,t.list)},xe=function(n){for(var t=1;t<n.length;t++)we(n[t-1],n[t])},De=function(n,t){Ce(H(n),F(t),we)},ke=function(n,t){var e={list:Qn.fromTag(t,n),item:Qn.fromTag("li",n)};return bt(e.list,e.item),e},Ae=function(n,t,e){for(var r=[],o=0;o<e;o++)r.push(ke(n,t.listType));return r},Re=function(n,t){for(var e=0;e<n.length-1;e++)Te(n[e].item,"list-style-type","none");H(n).each(function(n){mt(n.list,t.listAttributes),mt(n.item,t.itemAttributes),Ot(n.item,t.content)})},Ee=function(n,t){at(n.list)!==t.listType&&(n.list=Dt(n.list,t.listType)),mt(n.list,t.listAttributes)},Pe=function(n,t,e){var r=Qn.fromTag("li",n);return mt(r,t),Ot(r,e),r},Be=function(n,t){bt(n.list,t),n.item=t},Ie=function(n,t,e){var r=t.slice(0,e.depth);return H(r).each(function(t){var r=Pe(n,e.itemAttributes,e.content);Be(t,r),Ee(t,e)}),r},Me=function(n,t,e){var r=Ae(n,e,e.depth-t.length);return xe(r),Re(r,e),De(t,r),t.concat(r)},Ue=function(n,t){var e=P(t,function(t,e){return e.depth>t.length?Me(n,t,e):Ie(n,t,e)},[]);return F(e).map(function(n){return n.list})},_e=function(n){return Gn(n,"OL,UL")},$e=function(n){return yt(n).exists(_e)},Fe=function(n){return St(n).exists(_e)},He=function(n){return n.depth>0},je=function(n){return n.isSelected},Ke=function(n){var t=gt(n),e=Fe(n)?t.slice(0,-1):t;return k(e,wt)},Ve=function(n,t,e){return vt(n).filter(ft).map(function(r){return{depth:t,dirty:!1,isSelected:e,content:Ke(n),itemAttributes:pt(n),listAttributes:pt(r),listType:at(r)}})},We=function(n,t){switch(n){case"Indent":t.depth++;break;case"Outdent":t.depth--;break;case"Flatten":t.depth=0}t.dirty=!0},Qe=function(n,t){n.listType=t.listType,n.listAttributes=K({},t.listAttributes)},qe=function(n){n.listAttributes=ut(n.listAttributes,function(n,t){return"start"!==t})},ze=function(n,t){var e=n[t].depth,r=function(n){return n.depth===e&&!n.dirty},o=function(n){return n.depth<e};return B(_(n.slice(0,t)),r,o).orThunk(function(){return B(n.slice(t+1),r,o)})},Xe=function(n){return A(n,function(t,e){ze(n,e).fold(function(){t.dirty&&qe(t)},function(n){return Qe(t,n)})}),n},Ye=function(n){var t=n,e=function(){return t},r=function(n){t=n};return{get:e,set:r}},Ze=function(n,t,e,r){return yt(r).filter(_e).fold(function(){t.each(function(n){zn(n.start,r)&&e.set(!0)});var o=Ve(r,n,e.get());t.each(function(n){zn(n.end,r)&&e.set(!1)});var i=St(r).filter(_e).map(function(r){return Ge(n,t,e,r)}).getOr([]);return o.toArray().concat(i)},function(r){return Ge(n,t,e,r)})},Ge=function(n,t,e,r){return U(gt(r),function(r){var o=_e(r)?Ge:Ze,i=n+1;return o(i,t,e,r)})},Je=function(n,t){var e=Ye(!1),r=0;return k(n,function(n){return{sourceList:n,entries:Ge(r,t,e,n)}})},nr=function(n,t){var e=Xe(t);return k(e,function(t){var e=be(t.content);return Qn.fromDom(Yt(n,e.dom))})},tr=function(n,t){var e=Xe(t);return Ue(n.contentDocument,e).toArray()},er=function(n,t){return U(E(t,He),function(t){var e=F(t).exists(He);return e?tr(n,t):nr(n,t)})},rr=function(n,t){A(R(n,je),function(n){return We(t,n)})},or=function(n){var t=k(de(n),Qn.fromDom);return Ce(I(t,S($e)),I(_(t),S($e)),function(n,t){return{start:n,end:t}})},ir=function(n,t,e){var r=Je(t,or(n));A(r,function(t){rr(t.entries,e);var r=er(n,t.entries);A(r,function(t){Ne(n,"Indent"===e?"IndentList":"OutdentList",t.dom)}),Nt(t.sourceList,r),Lt(t.sourceList)})},ur=function(n,t){var e=k(he(n),Qn.fromDom),r=k(me(n),Qn.fromDom),o=!1;if(e.length||r.length){var i=n.selection.getBookmark();ir(n,e,t),re(n,t,r),n.selection.moveToBookmark(i),n.selection.setRng(ie(n.selection.getRng())),n.nodeChanged(),o=!0}return o},ar=function(n){return ur(n,"Indent")},sr=function(n){return ur(n,"Outdent")},cr=function(n){return ur(n,"Flatten")},fr=tinymce.util.Tools.resolve("tinymce.dom.BookmarkReceptionist"),lr=kt.DOM,dr=function(n){var t={},e=function(e){var r=n[e?"startContainer":"endContainer"],o=n[e?"startOffset":"endOffset"];if(1===r.nodeType){var i=lr.create("span",{"data-mce-type":"bookmark"});r.hasChildNodes()?(o=Math.min(o,r.childNodes.length-1),e?r.insertBefore(i,r.childNodes[o]):lr.insertAfter(i,r.childNodes[o])):r.appendChild(i),r=i,o=0}t[e?"startContainer":"endContainer"]=r,t[e?"startOffset":"endOffset"]=o};return e(!0),n.collapsed||e(),t},mr=function(n){var t=function(t){var e,r=function(n){for(var t=n.parentNode.firstChild,e=0;t;){if(t===n)return e;1===t.nodeType&&"bookmark"===t.getAttribute("data-mce-type")||e++,t=t.nextSibling}return-1},o=e=n[t?"startContainer":"endContainer"],i=n[t?"startOffset":"endOffset"];o&&(1===o.nodeType&&(i=r(o),o=o.parentNode,lr.remove(e),!o.hasChildNodes()&&lr.isBlock(o)&&o.appendChild(lr.create("br"))),n[t?"startContainer":"endContainer"]=o,n[t?"startOffset":"endOffset"]=i)};t(!0),t();var e=lr.createRng();return e.setStart(n.startContainer,n.startOffset),n.endContainer&&e.setEnd(n.endContainer,n.endOffset),ie(e)},pr=function(n){switch(n){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},vr=function(n){return/\btox\-/.test(n.className)},gr=function(n,t,e){var r=function(n){var r=B(n.parents,Bt,$t).filter(function(n){return n.nodeName===t&&!vr(n)}).isSome();e(r)},o=n.dom.getParents(n.selection.getNode());return r({parents:o}),n.on("NodeChange",r),function(){return n.off("NodeChange",r)}},hr=function(n,t,e){var r=e["list-style-type"]?e["list-style-type"]:null;n.setStyle(t,"list-style-type",r)},yr=function(n,t){At.each(t,function(t,e){n.setAttribute(e,t)})},Sr=function(n,t,e){yr(t,e["list-attributes"]),At.each(n.select("li",t),function(n){yr(n,e["list-item-attributes"])})},Cr=function(n,t,e){hr(n,t,e),Sr(n,t,e)},br=function(n,t,e){At.each(e,function(e){var r;return n.setStyle(t,(r={},r[e]="",r))})},Nr=function(n,t,e,r){var o=t[e?"startContainer":"endContainer"],i=t[e?"startOffset":"endOffset"];for(1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!e&&Ft(o.nextSibling)&&(o=o.nextSibling);o.parentNode!==r;){if(jt(n,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},Or=function(n,t,e){for(var r,o=[],i=n.dom,u=Nr(n,t,!0,e),a=Nr(n,t,!1,e),s=[],c=u;c&&(s.push(c),c!==a);c=c.nextSibling);return At.each(s,function(t){if(jt(n,t))return o.push(t),void(r=null);if(i.isBlock(t)||Ft(t))return Ft(t)&&i.remove(t),void(r=null);var u=t.nextSibling;fr.isBookmarkNode(t)&&(Bt(u)||jt(n,u)||!u&&t.parentNode===e)?r=null:(r||(r=i.create("p"),t.parentNode.insertBefore(r,t),o.push(r)),r.appendChild(t))}),o},Lr=function(n,t,e){var r=n.getStyle(t,"list-style-type"),o=e?e["list-style-type"]:"";return o=null===o?"":o,r===o},Tr=function(n,t,e){var r=n.selection.getRng(),o="LI",i=pe(n,n.selection.getStart(!0)),u=n.dom;if("false"!==u.getContentEditable(n.selection.getNode())){t=t.toUpperCase(),"DL"===t&&(o="DT");var a=dr(r),s=Or(n,r,i);At.each(s,function(r){var i,a=r.previousSibling,s=r.parentNode;Ut(s)||(a&&Bt(a)&&a.nodeName===t&&Lr(u,a,e)?(i=a,r=u.rename(r,o),a.appendChild(r)):(i=u.create(t),r.parentNode.insertBefore(i,r),i.appendChild(r),r=u.rename(r,o)),br(u,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),Cr(u,i,e),Ar(n.dom,i))}),n.selection.setRng(mr(a))}},wr=function(n,t){return n&&t&&Bt(n)&&n.nodeName===t.nodeName},xr=function(n,t,e){var r=n.getStyle(t,"list-style-type",!0),o=n.getStyle(e,"list-style-type",!0);return r===o},Dr=function(n,t){return n.className===t.className},kr=function(n,t,e){return wr(t,e)&&xr(n,t,e)&&Dr(t,e)},Ar=function(n,t){var e,r;if(e=t.nextSibling,kr(n,t,e)){for(;r=e.firstChild;)t.appendChild(r);n.remove(e)}if(e=t.previousSibling,kr(n,t,e)){for(;r=e.lastChild;)t.insertBefore(r,t.firstChild);n.remove(e)}},Rr=function(n,t,e,r){if(t.nodeName!==e){var o=n.dom.rename(t,e);Cr(n.dom,o,r),Ne(n,pr(e),o)}else Cr(n.dom,t,r),Ne(n,pr(e),t)},Er=function(t,e,r,o,i){var u=Bt(e);if(u&&e.nodeName===o&&!Pr(i))cr(t);else{Tr(t,o,i);var a=dr(t.selection.getRng()),s=u?n([e],r,!0):r;At.each(s,function(n){Rr(t,n,o,i)}),t.selection.setRng(mr(a))}},Pr=function(n){return"list-style-type"in n},Br=function(n,t,e,r){if(t!==n.getBody())if(t)if(t.nodeName!==e||Pr(r)||vr(t)){var o=dr(n.selection.getRng());Cr(n.dom,t,r);var i=n.dom.rename(t,e);Ar(n.dom,i),n.selection.setRng(mr(o)),Tr(n,e,r),Ne(n,pr(e),i)}else cr(n);else Tr(n,e,r),Ne(n,pr(e),t)},Ir=function(n,t,e){var r=ae(n),o=fe(n),i=f(e)?e:{};o.length>0?Er(n,r,o,t,i):Br(n,r,t,i)},Mr=kt.DOM,Ur=function(n,t){var e=t.parentNode;if("LI"===e.nodeName&&e.firstChild===t){var r=e.previousSibling;r&&"LI"===r.nodeName?(r.appendChild(t),Wt(n,e)&&Mr.remove(e)):Mr.setStyle(e,"listStyleType","none")}if(Bt(e)){r=e.previousSibling;r&&"LI"===r.nodeName&&r.appendChild(t)}},_r=function(n,t){var e=At.grep(n.select("ol,ul",t));At.each(e,function(t){Ur(n,t)})},$r=function(n,t,e,r){var o=t.startContainer,i=t.startOffset;if(Pt(o)&&(e?i<o.data.length:i>0))return o;var u=n.schema.getNonEmptyElements();1===o.nodeType&&(o=Jn.getNode(o,i));var a=new nt(o,r);for(e&&Vt(n.dom,o)&&a.next();o=a[e?"next":"prev2"]();){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(Pt(o)&&o.data.length>0)return o}},Fr=function(n,t){var e=t.childNodes;return 1===e.length&&!Bt(e[0])&&n.isBlock(e[0])},Hr=function(n,t){Fr(n,t)&&n.remove(t.firstChild,!0)},jr=function(n,t,e){var r,o=Fr(n,e)?e.firstChild:e;if(Hr(n,t),!Wt(n,t,!0))for(;r=t.firstChild;)o.appendChild(r)},Kr=function(n,t,e){var r,o=t.parentNode;if(Qt(n,t)&&Qt(n,e)){Bt(e.lastChild)&&(r=e.lastChild),o===e.lastChild&&Ft(o.previousSibling)&&n.remove(o.previousSibling);var i=e.lastChild;i&&Ft(i)&&t.hasChildNodes()&&n.remove(i),Wt(n,e,!0)&&n.$(e).empty(),jr(n,t,e),r&&e.appendChild(r);var u=Zn(Qn.fromDom(e),Qn.fromDom(t)),a=u?n.getParents(t,Bt,e):[];n.remove(t),A(a,function(t){Wt(n,t)&&t!==n.getRoot()&&n.remove(t)})}},Vr=function(n,t,e){n.dom.$(e).empty(),Kr(n.dom,t,e),n.selection.setCursorLocation(e,0)},Wr=function(n,t,e,r){var o=n.dom;if(o.isEmpty(r))Vr(n,e,r);else{var i=dr(t);Kr(o,e,r),n.selection.setRng(mr(i))}},Qr=function(n,t,e,r){var o=dr(t);Kr(n.dom,e,r);var i=mr(o);n.selection.setRng(i)},qr=function(n,t){var e=n.dom,r=n.selection,o=r.getStart(),i=pe(n,o),u=e.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===n.getBody()&&Wt(e,a))return!0;var s=ie(r.getRng()),c=e.getParent($r(n,s,t,i),"LI",i);if(c&&c!==u)return n.undoReceptionist.transact(function(){t?Wr(n,s,c,u):Ht(u)?sr(n):Qr(n,s,u,c)}),!0;if(!c&&!t&&0===s.startOffset&&0===s.endOffset)return n.undoReceptionist.transact(function(){cr(n)}),!0}return!1},zr=function(n,t,e){var r=n.getParent(t.parentNode,n.isBlock,e);n.remove(t),r&&n.isEmpty(r)&&n.remove(r)},Xr=function(n,t){var e=n.dom,r=n.selection.getStart(),o=pe(n,r),i=e.getParent(r,e.isBlock,o);if(i&&e.isEmpty(i)){var u=ie(n.selection.getRng()),a=e.getParent($r(n,u,t,o),"LI",o);if(a)return n.undoReceptionist.transact(function(){zr(e,i,o),Ar(e,a.parentNode),n.selection.select(a,!0),n.selection.collapse(t)}),!0}return!1},Yr=function(n,t){return qr(n,t)||Xr(n,t)},Zr=function(n){var t=n.selection.getStart(),e=pe(n,t),r=n.dom.getParent(t,"LI,DT,DD",e);return!!(r||de(n).length>0)&&(n.undoReceptionist.transact(function(){n.execCommand("Delete"),_r(n.dom,n.getBody())}),!0)},Gr=function(n,t){return n.selection.isCollapsed()?Yr(n,t):Zr(n)},Jr=function(n){n.on("keydown",function(t){t.keyCode===tt.BACKSPACE?Gr(n,!1)&&t.preventDefault():t.keyCode===tt.DELETE&&Gr(n,!0)&&t.preventDefault()})},no=function(n){return{backspaceDelete:function(t){Gr(n,t)}}},to=function(n,t){var e=ae(n);n.undoReceptionist.transact(function(){f(t.styles)&&n.dom.setStyles(e,t.styles),f(t.attrs)&&rt(t.attrs,function(t,r){return n.dom.setAttrib(e,r,t)})})},eo=function(n){var t=_(on(n).split("")),e=k(t,function(n,t){var e=n.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,t)*e});return P(e,function(n,t){return n+t},0)},ro=function(n){if(n--,n<0)return"";var t=n%26,e=Math.floor(n/26),r=ro(e),o=String.fromCharCode("A".charCodeAt(0)+t);return r+o},oo=function(n){return/^[A-Z]+$/.test(n)},io=function(n){return/^[a-z]+$/.test(n)},uo=function(n){return/^[0-9]+$/.test(n)},ao=function(n){return uo(n)?2:oo(n)?0:io(n)?1:an(n)?3:4},so=function(n){switch(ao(n)){case 2:return w.some({listStyleType:w.none(),start:n});case 0:return w.some({listStyleType:w.some("upper-alpha"),start:eo(n).toString()});case 1:return w.some({listStyleType:w.some("lower-alpha"),start:eo(n).toString()});case 3:return w.some({listStyleType:w.none(),start:""});case 4:return w.none()}},co=function(n){var t=parseInt(n.start,10);return Se(n.listStyleType,"upper-alpha")?ro(t):Se(n.listStyleType,"lower-alpha")?ro(t).toLowerCase():n.start},fo=function(n){var t=ae(n);Mt(t)&&n.windowReceptionist.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:co({start:n.dom.getAttrib(t,"start","1"),listStyleType:w.some(n.dom.getStyle(t,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(t){var e=t.getData();so(e.start).each(function(t){n.execCommand("mceListUpdate",!1,{attrs:{start:"1"===t.start?"":t.start},styles:{"list-style-type":t.listStyleType.getOr("")}})}),t.close()}})},lo=function(n,t){return function(){var e=ae(n);return e&&e.nodeName===t}},mo=function(n){n.addCommand("mceListProps",function(){fo(n)})},po=function(n){n.on("BeforeExecCommand",function(t){var e=t.command.toLowerCase();"indent"===e?ar(n):"outdent"===e&&sr(n)}),n.addCommand("InsertUnorderedList",function(t,e){Ir(n,"UL",e)}),n.addCommand("InsertOrderedList",function(t,e){Ir(n,"OL",e)}),n.addCommand("InsertDefinitionList",function(t,e){Ir(n,"DL",e)}),n.addCommand("RemoveList",function(){cr(n)}),mo(n),n.addCommand("mceListUpdate",function(t,e){f(e)&&to(n,e)}),n.addQueryStateHandler("InsertUnorderedList",lo(n,"UL")),n.addQueryStateHandler("InsertOrderedList",lo(n,"OL")),n.addQueryStateHandler("InsertDefinitionList",lo(n,"DL"))},vo=function(n){n.on("keydown",function(t){t.keyCode!==tt.TAB||tt.metaKeyPressed(t)||n.undoReceptionist.transact(function(){(t.shiftKey?sr(n):ar(n))&&t.preventDefault()})})},go=function(n){qt(n)&&vo(n),Jr(n)},ho=function(n){var t=function(t){return function(){return n.execCommand(t)}};n.hasPlugin("advlist")||(n.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:t("InsertOrderedList"),onSetup:function(t){return gr(n,"OL",t.setActive)}}),n.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:t("InsertUnorderedList"),onSetup:function(t){return gr(n,"UL",t.setActive)}}))},yo=function(n){var t={text:"List properties...",icon:"ordered-list",onAction:function(){return n.execCommand("mceListProps")},onSetup:function(t){return gr(n,"OL",function(n){return t.setDisabled(!n)})}};n.ui.registry.addMenuItem("listprops",t),n.ui.registry.addContextMenu("lists",{update:function(t){var e=ae(n,t);return Mt(e)?["listprops"]:[]}})};t()})();