(function(){"use strict";function e(){t.add("preview",function(e){m(e),y(e)})}var t=tinymce.util.Tools.resolve("tinymce.PluginReceptionist"),n=tinymce.util.Tools.resolve("tinymce.Env"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),o=function(e){return e.getParam("content_style","","string")},r=function(e){return e.getParam("content_css_cors",!1,"boolean")},c=function(e){var t=e.getParam("body_class","","hash");return t[e.id]||""},a=function(e){var t=e.getParam("body_class","","string");return-1===t.indexOf("=")?t:c(e)},s=function(e){var t=e.getParam("body_id","","hash");return t[e.id]||t},d=function(e){var t=e.getParam("body_id","tinymce","string");return-1===t.indexOf("=")?t:s(e)},l=function(e){var t="",c=e.dom.encode,s=o(e);t+='<base href="'+c(e.documentBaseURI.getURI())+'">';var l=r(e)?' crossorigin="anonymous"':"";i.each(e.contentCSS,function(n){t+='<link type="text/css" rel="stylesheet" href="'+c(e.documentBaseURI.toAbsolute(n))+'"'+l+">"}),s&&(t+='<style type="text/css">'+s+"</style>");var u=d(e),m=a(e),y=n.mac?"e.metaKey":"e.ctrlKey && !e.altKey",v='<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A" && !('+y+")) {e.preventDefault();}}}, false);</script> ",f=e.getBody().dir,p=f?' dir="'+c(f)+'"':"",g="<!DOCTYPE html><html><head>"+t+'</head><body id="'+c(u)+'" class="mce-content-body '+c(m)+'"'+p+">"+e.getContent()+v+"</body></html>";return g},u=function(e){var t=l(e),n=e.windowReceptionist.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:t}});n.focus("close")},m=function(e){e.addCommand("mcePreview",function(){u(e)})},y=function(e){var t=function(){return e.execCommand("mcePreview")};e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:t}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:t})};e()})();