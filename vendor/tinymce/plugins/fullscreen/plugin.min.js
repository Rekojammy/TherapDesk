(function(){"use strict";function n(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];var o=e.concat(r);return n.apply(null,o)}}function e(){u.add("fullscreen",function(n){var e=i(null);return n.inline?c(e):(yr(n,e),Sr(n,e),n.addShortcut("Meta+Shift+F","","mceFullScreen"),c(e))})}var r,t,o,i=function(n){var e=n,r=function(){return e},t=function(n){e=n};return{get:r,set:t}},u=tinymce.util.Tools.resolve("tinymce.PluginReceptionist"),c=function(n){return{isFullscreen:function(){return null!==n.get()}}},f=function(n){var e=typeof n;return null===n?"null":"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e},a=function(n){return function(e){return f(e)===n}},s=function(n){return function(e){return typeof e===n}},l=a("string"),m=a("array"),d=s("boolean"),v=function(n){return null==n},h=function(n){return!v(n)},g=s("function"),p=s("number"),w=function(){},y=function(n,e){return function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n(e.apply(null,r))}},b=function(n,e){return function(r){return n(e(r))}},S=function(n){return function(){return n}},x=function(n){return n},E=S(!1),O=S(!0),F=function(){return T},T=(r=function(n){return n()},t=x,o={fold:function(n,e){return n()},isSome:E,isNone:O,getOr:t,getOrThunk:r,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:S(null),getOrUndefined:S(void 0),or:t,orThunk:r,map:F,each:w,bind:F,exists:E,forall:O,filter:function(){return F()},toArray:function(){return[]},toString:S("none()")},o),k=function(n){var e=S(n),r=function(){return o},t=function(e){return e(n)},o={fold:function(e,r){return r(n)},isSome:O,isNone:E,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:r,orThunk:r,map:function(e){return k(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?o:T},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o},D=function(n){return null==n?T:k(n)},C={some:k,none:F,from:D},A=function(){return A=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},A.apply(this,arguments)},R=function(n){var e=i(C.none()),r=function(){return e.get().each(n)},t=function(){r(),e.set(C.none())},o=function(){return e.get().isSome()},u=function(){return e.get()},c=function(n){r(),e.set(C.some(n))};return{clear:t,isSet:o,get:u,set:c}},L=function(){return R(function(n){return n.unbind()})},P=function(){var n=R(w),e=function(e){return n.get().each(e)};return A(A({},n),{on:e})},N=Array.prototype.push,M=function(n,e){for(var r=n.length,t=new Array(r),o=0;o<r;o++){var i=n[o];t[o]=e(i,o)}return t},H=function(n,e){for(var r=0,t=n.length;r<t;r++){var o=n[r];e(o,r)}},W=function(n,e){for(var r=[],t=0,o=n.length;t<o;t++){var i=n[t];e(i,t)&&r.push(i)}return r},q=function(n,e,r){for(var t=0,o=n.length;t<o;t++){var i=n[t];if(e(i,t))return C.some(i);if(r(i,t))break}return C.none()},j=function(n,e){return q(n,e,E)},B=function(n){for(var e=[],r=0,t=n.length;r<t;++r){if(!m(n[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+n);N.apply(e,n[r])}return e},I=function(n,e){return B(M(n,e))},V=function(n,e){return e>=0&&e<n.length?C.some(n[e]):C.none()},_=function(n){return V(n,0)},X=function(n,e){for(var r=0;r<n.length;r++){var t=e(n[r],r);if(t.isSome())return t}return C.none()},z=Object.keys,U=function(n,e){for(var r=z(n),t=0,o=r.length;t<o;t++){var i=r[t],u=n[i];e(u,i)}},$=function(n,e){return-1!==n.indexOf(e)},K=function(n){return void 0!==n.style&&g(n.style.getPropertyValue)},Y=function(n,e){var r=e||document,t=r.createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||t.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Q(t.childNodes[0])},G=function(n,e){var r=e||document,t=r.createElement(n);return Q(t)},J=function(n,e){var r=e||document,t=r.createTextNode(n);return Q(t)},Q=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},Z=function(n,e,r){return C.from(n.dom.elementFromPoint(e,r)).map(Q)},nn={fromHtml:Y,fromTag:G,fromText:J,fromDom:Q,fromPoint:Z};"undefined"!=typeof window?window:Function("return this;")();var en=9,rn=11,tn=1,on=3,un=function(n){return n.dom.nodeType},cn=function(n){return function(e){return un(e)===n}},fn=cn(tn),an=cn(on),sn=cn(en),ln=cn(rn),mn=function(n){var e,r=!1;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return r||(r=!0,e=n.apply(null,t)),e}},dn=function(n,e,r,t){var o=n.isiOS()&&!0===/ipad/i.test(r),i=n.isiOS()&&!o,u=n.isiOS()||n.isAndroid(),c=u||t("(pointer:coarse)"),f=o||!i&&u&&t("(min-device-width:768px)"),a=i||u&&!f,s=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(r),l=!a&&!f&&!s;return{isiPad:S(o),isiPhone:S(i),isTablet:S(f),isPhone:S(a),isTouch:S(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:S(s),isDesktop:S(l)}},vn=function(n,e){for(var r=0;r<n.length;r++){var t=n[r];if(t.test(e))return t}},hn=function(n,e){var r=vn(n,e);if(!r)return{major:0,minor:0};var t=function(n){return Number(e.replace(r,"$"+n))};return wn(t(1),t(2))},gn=function(n,e){var r=String(e).toLowerCase();return 0===n.length?pn():hn(n,r)},pn=function(){return wn(0,0)},wn=function(n,e){return{major:n,minor:e}},yn={nu:wn,detect:gn,unknown:pn},bn=function(n,e){return X(e.brands,function(e){var r=e.brand.toLowerCase();return j(n,function(n){var e;return r===(null===(e=n.brand)||void 0===e?void 0:e.toLowerCase())}).map(function(n){return{current:n.name,version:yn.nu(parseInt(e.version,10),0)}})})},Sn=function(n,e){var r=String(e).toLowerCase();return j(n,function(n){return n.search(r)})},xn=function(n,e){return Sn(n,e).map(function(n){var r=yn.detect(n.versionRegexes,e);return{current:n.name,version:r}})},En=function(n,e){return Sn(n,e).map(function(n){var r=yn.detect(n.versionRegexes,e);return{current:n.name,version:r}})},On=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Fn=function(n){return function(e){return $(e,n)}},Tn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return $(n,"edge/")&&$(n,"chrome")&&$(n,"safari")&&$(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,On],search:function(n){return $(n,"chrome")&&!$(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return $(n,"msie")||$(n,"trident")}},{name:"Opera",versionRegexes:[On,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Fn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Fn("firefox")},{name:"Safari",versionRegexes:[On,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return($(n,"safari")||$(n,"mobile/"))&&$(n,"applewebkit")}}],kn=[{name:"Windows",search:Fn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return $(n,"iphone")||$(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Fn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Fn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Fn("linux"),versionRegexes:[]},{name:"Solaris",search:Fn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Fn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Fn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Dn={browsers:S(Tn),oses:S(kn)},Cn="Edge",An="Chrome",Rn="IE",Ln="Opera",Pn="Firefox",Nn="Safari",Mn=function(){return Hn({current:void 0,version:yn.unknown()})},Hn=function(n){var e=n.current,r=n.version,t=function(n){return function(){return e===n}};return{current:e,version:r,isEdge:t(Cn),isChrome:t(An),isIE:t(Rn),isOpera:t(Ln),isFirefox:t(Pn),isSafari:t(Nn)}},Wn={unknown:Mn,nu:Hn,edge:S(Cn),chrome:S(An),ie:S(Rn),opera:S(Ln),firefox:S(Pn),safari:S(Nn)},qn="Windows",jn="iOS",Bn="Android",In="Linux",Vn="OSX",_n="Solaris",Xn="FreeBSD",zn="ChromeOS",Un=function(){return $n({current:void 0,version:yn.unknown()})},$n=function(n){var e=n.current,r=n.version,t=function(n){return function(){return e===n}};return{current:e,version:r,isWindows:t(qn),isiOS:t(jn),isAndroid:t(Bn),isOSX:t(Vn),isLinux:t(In),isSolaris:t(_n),isFreeBSD:t(Xn),isChromeOS:t(zn)}},Kn={unknown:Un,nu:$n,windows:S(qn),ios:S(jn),android:S(Bn),linux:S(In),osx:S(Vn),solaris:S(_n),freebsd:S(Xn),chromeos:S(zn)},Yn=function(n,e,r){var t=Dn.browsers(),o=Dn.oses(),i=e.bind(function(n){return bn(t,n)}).orThunk(function(){return xn(t,n)}).fold(Wn.unknown,Wn.nu),u=En(o,n).fold(Kn.unknown,Kn.nu),c=dn(u,i,n,r);return{browser:i,os:u,deviceType:c}},Gn={detect:Yn},Jn=function(n){return window.matchMedia(n).matches},Qn=mn(function(){return Gn.detect(navigator.userAgent,C.from(navigator.userAgentData),Jn)}),Zn=function(){return Qn()},ne=function(n,e){var r=n.dom;if(r.nodeType!==tn)return!1;var t=r;if(void 0!==t.matches)return t.matches(e);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(e);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(e);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},ee=function(n){return n.nodeType!==tn&&n.nodeType!==en&&n.nodeType!==rn||0===n.childElementCount},re=function(n,e){var r=void 0===e?document:e.dom;return ee(r)?[]:M(r.querySelectorAll(n),nn.fromDom)},te=function(n,e){return n.dom===e.dom},oe=function(n){return nn.fromDom(n.dom.ownerDocument)},ie=function(n){return sn(n)?n:oe(n)},ue=function(n){return C.from(n.dom.parentNode).map(nn.fromDom)},ce=function(n,e){for(var r=g(e)?e:E,t=n.dom,o=[];null!==t.parentNode&&void 0!==t.parentNode;){var i=t.parentNode,u=nn.fromDom(i);if(o.push(u),!0===r(u))break;t=i}return o},fe=function(n){var e=function(e){return W(e,function(e){return!te(n,e)})};return ue(n).map(ae).map(e).getOr([])},ae=function(n){return M(n.dom.childNodes,nn.fromDom)},se=function(n){return ln(n)&&h(n.dom.host)},le=g(Element.prototype.attachShadow)&&g(Node.prototype.getRootNode),me=S(le),de=le?function(n){return nn.fromDom(n.dom.getRootNode())}:ie,ve=function(n){var e=de(n);return se(e)?C.some(e):C.none()},he=function(n){return nn.fromDom(n.dom.host)},ge=function(n){if(me()&&h(n.target)){var e=nn.fromDom(n.target);if(fn(e)&&pe(e)&&n.composed&&n.composedPath){var r=n.composedPath();if(r)return _(r)}}return C.from(n.target)},pe=function(n){return h(n.dom.shadowRoot)},we=function(n){var e=an(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var r=e.ownerDocument;return ve(nn.fromDom(e)).fold(function(){return r.body.contains(e)},b(we,he))},ye=function(n){var e=n.dom.body;if(null==e)throw new Error("Body is not available yet");return nn.fromDom(e)},be=function(n,e,r){if(!(l(r)||d(r)||p(r)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")},Se=function(n,e,r){be(n.dom,e,r)},xe=function(n,e){var r=n.dom.getAttribute(e);return null===r?void 0:r},Ee=function(n,e){n.dom.removeAttribute(e)},Oe=function(n,e,r){if(!l(r))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);K(n)&&n.style.setProperty(e,r)},Fe=function(n,e){var r=n.dom;U(e,function(n,e){Oe(r,e,n)})},Te=function(n,e){var r=n.dom,t=window.getComputedStyle(r),o=t.getPropertyValue(e);return""!==o||we(n)?o:ke(r,e)},ke=function(n,e){return K(n)?n.style.getPropertyValue(e):""},De=function(n,e,r,t,o,i,u){return{target:n,x:e,y:r,stop:t,prevent:o,kill:i,raw:u}},Ce=function(n){var e=nn.fromDom(ge(n).getOr(n.target)),r=function(){return n.stopPropagation()},t=function(){return n.preventDefault()},o=y(t,r);return De(e,n.clientX,n.clientY,r,t,o,n)},Ae=function(n,e){return function(r){n(r)&&e(Ce(r))}},Re=function(e,r,t,o,i){var u=Ae(t,o);return e.dom.addEventListener(r,u,i),{unbind:n(Pe,e,r,u,i)}},Le=function(n,e,r,t){return Re(n,e,r,t,!1)},Pe=function(n,e,r,t){n.dom.removeEventListener(e,r,t)},Ne=O,Me=function(n,e,r){return Le(n,e,Ne,r)},He=function(n,e){var r=function(r,t){return He(n+r,e+t)};return{left:n,top:e,translate:r}},We=He,qe=function(n){var e=void 0!==n?n.dom:document,r=e.body.scrollLeft||e.documentElement.scrollLeft,t=e.body.scrollTop||e.documentElement.scrollTop;return We(r,t)},je=function(n){var e=void 0===n?window:n;return Zn().browser.isFirefox()?C.none():C.from(e.visualViewport)},Be=function(n,e,r,t){return{x:n,y:e,width:r,height:t,right:n+r,bottom:e+t}},Ie=function(n){var e=void 0===n?window:n,r=e.document,t=qe(nn.fromDom(r));return je(e).fold(function(){var n=e.document.documentElement,r=n.clientWidth,o=n.clientHeight;return Be(t.left,t.top,r,o)},function(n){return Be(Math.max(n.pageLeft,t.left),Math.max(n.pageTop,t.top),n.width,n.height)})},Ve=function(n,e,r){return je(r).map(function(r){var t=function(n){return e(Ce(n))};return r.addEventListener(n,t),{unbind:function(){return r.removeEventListener(n,t)}}}).getOrThunk(function(){return{unbind:w}})},_e=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Xe=tinymce.util.Tools.resolve("tinymce.Env"),ze=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ue=function(n,e){n.fire("FullscreenStateChanged",{state:e})},$e=function(n){return n.getParam("fullscreen_native",!1,"boolean")},Ke=function(n){var e=nn.fromDom(n.getElement());return ve(e).map(he).getOrThunk(function(){return ye(oe(e))})},Ye=function(n){return void 0!==n.fullscreenElement?n.fullscreenElement:void 0!==n.msFullscreenElement?n.msFullscreenElement:void 0!==n.webkitFullscreenElement?n.webkitFullscreenElement:null},Ge=function(){return void 0!==document.fullscreenElement?"fullscreenchange":void 0!==document.msFullscreenElement?"MSFullscreenChange":void 0!==document.webkitFullscreenElement?"webkitfullscreenchange":"fullscreenchange"},Je=function(n){var e=n.dom;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()},Qe=function(n){var e=n.dom;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()},Ze=function(n){return n.dom===Ye(oe(n).dom)},nr=function(n,e,r){return W(ce(n,r),e)},er=function(n,e){return W(fe(n),e)},rr=function(n){return re(n)},tr=function(n,e,r){return nr(n,function(n){return ne(n,e)},r)},or=function(n,e){return er(n,function(n){return ne(n,e)})},ir="data-ephox-mobile-fullscreen-style",ur="display:none!important;",cr="position:absolute!important;",fr="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",ar="background-color:rgb(255,255,255)!important;",sr=Xe.os.isAndroid(),lr=function(n){var e=Te(n,"background-color");return void 0!==e&&""!==e?"background-color:"+e+"!important":ar},mr=function(n,e,r){var t=function(n){return or(n,"*:not(.tox-silver-sink)")},o=function(e){return function(r){var t=xe(r,"style"),o=void 0===t?"no-styles":t.trim();o!==e&&(Se(r,ir,o),Fe(r,n.parseStyle(e)))}},i=tr(e,"*"),u=I(i,t),c=lr(r);H(u,o(ur)),H(i,o(cr+fr+c));var f=!0===sr?"":cr;o(f+fr+c)(e)},dr=function(n){var e=rr("["+ir+"]");H(e,function(e){var r=xe(e,ir);"no-styles"!==r?Fe(e,n.parseStyle(r)):Ee(e,"style"),Ee(e,ir)})},vr=_e.DOM,hr=function(){return Ie(window)},gr=function(n){return window.scrollTo(n.x,n.y)},pr=je().fold(function(){return{bind:w,unbind:w}},function(n){var e=P(),r=L(),t=L(),o=function(){document.body.scrollTop=0,document.documentElement.scrollTop=0},i=function(){window.requestAnimationFrame(function(){e.on(function(e){return Fe(e,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})})})},u=ze.throttle(function(){o(),i()},50),c=function(n){e.set(n),u(),r.set(Ve("resize",u)),t.set(Ve("scroll",u))},f=function(){e.on(function(){r.clear(),t.clear()}),e.clear()};return{bind:c,unbind:f}}),wr=function(n,e){var r=document.body,t=document.documentElement,o=n.getContainer(),i=nn.fromDom(o),u=Ke(n),c=e.get(),f=nn.fromDom(n.getBody()),a=Xe.deviceType.isTouch(),s=o.style,l=n.iframeElement,m=l.style,d=function(n){n(r,"tox-fullscreen"),n(t,"tox-fullscreen"),n(o,"tox-fullscreen"),ve(i).map(function(n){return he(n).dom}).each(function(e){n(e,"tox-fullscreen"),n(e,"tox-shadowhost")})},v=function(){a&&dr(n.dom),d(vr.removeClass),pr.unbind(),C.from(e.get()).each(function(n){return n.fullscreenChangeHandler.unbind()})};if(c)c.fullscreenChangeHandler.unbind(),$e(n)&&Ze(u)&&Qe(oe(u)),m.width=c.iframeWidth,m.height=c.iframeHeight,s.width=c.containerWidth,s.height=c.containerHeight,s.top=c.containerTop,s.left=c.containerLeft,gr(c.scrollPos),e.set(null),Ue(n,!1),v(),n.off("remove",v);else{var h=Me(oe(u),Ge(),function(r){$e(n)&&(Ze(u)||null===e.get()||wr(n,e))}),g={scrollPos:hr(),containerWidth:s.width,containerHeight:s.height,containerTop:s.top,containerLeft:s.left,iframeWidth:m.width,iframeHeight:m.height,fullscreenChangeHandler:h};a&&mr(n.dom,i,f),m.width=m.height="100%",s.width=s.height="",d(vr.addClass),pr.bind(i),n.on("remove",v),e.set(g),$e(n)&&Je(u),Ue(n,!0)}},yr=function(n,e){n.addCommand("mceFullScreen",function(){wr(n,e)})},br=function(n,e){return function(r){r.setActive(null!==e.get());var t=function(n){return r.setActive(n.state)};return n.on("FullscreenStateChanged",t),function(){return n.off("FullscreenStateChanged",t)}}},Sr=function(n,e){var r=function(){return n.execCommand("mceFullScreen")};n.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",icon:"fullscreen",shortcut:"Meta+Shift+F",onAction:r,onSetup:br(n,e)}),n.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:r,onSetup:br(n,e)})};e()})();