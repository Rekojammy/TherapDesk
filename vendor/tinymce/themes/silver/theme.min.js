(function(){"use strict";function t(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}function n(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function e(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}function o(t,n,e,o,r){return t(e,o)?j.some(e):C(r)&&r(e)?j.none():n(e,o,r)}function r(t,n,e){var o=n.backstage.shared,r=function(t){switch(t){case"bc-bc":return SS;case"tc-tc":return wS;case"tc-bc":return Zf;case"bc-tc":default:return tl}},i=function(t){t.length>0&&nt(t,function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")})},u=function(n,i){var u=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),a=function(){i(),sS.hide(s)},c=Vs(qS.sketch({text:n.text,level:J(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:j.from(n.icon),closeButton:!u,onAction:a,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),s=Vs(sS.sketch(z({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));e.add(s),n.timeout>0&&DS.setTimeout(function(){a()},n.timeout);var f=function(){var n=ur(fn.fromDom(t.getContentAreaContainer())),e=cr(),o=Vf(e.x,n.x,n.right),r=Vf(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom);return j.some(ir(o,r,i-o,u-r))};return{close:a,moveTo:function(t,n){sS.showAt(s,Ps(c),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e=Ps(c),i={maxHeightFunction:Rd()};if("banner"!==n&&k(t)){var u=r(n),a={type:"node",root:Ge(),node:j.some(fn.fromDom(t)),overrides:i,layouts:{onRtl:function(){return[u]},onLtr:function(){return[u]}}};sS.showWithinBounds(s,e,{anchor:a},f)}else{var l=z(z({},o.anchors.banner()),{overrides:i});sS.showWithinBounds(s,e,{anchor:l},f)}},text:function(t){qS.updateText(c,t)},settings:n,getEl:function(){return c.element.dom},progressBar:{value:function(t){qS.updateProgress(c,t)}}}},a=function(t){t.close()},c=function(t){return t.settings};return{open:u,close:a,reposition:i,getArgs:c}}function i(t){void 0===t&&(t=10);var n=FT.getItem(RT),e=v(n)?JSON.parse(n):[],o=function(n){var e=t-n.length;return e<0?n.slice(0,t):n},r=o(e),i=function(n){K(r,n).each(u),r.unshift(n),r.length>t&&r.pop(),FT.setItem(RT,JSON.stringify(r))},u=function(t){r.splice(t,1)},a=function(){return r.slice(0)};return{add:i,state:a}}function u(t,n){var e,o,r,i,u,a,c,s=[],f=[],l=null!==(e=n.document)&&void 0!==e?e:document,d=null!==(o=n.root)&&void 0!==o?o:l,m=fn.fromDom(l),g=fn.fromDom(d.getElementById(null!==(r=n.handle)&&void 0!==r?r:t)),p=function(t){var e=t.raw,o=WV(l);jV(e),t.prevent(),u=e.button,a=e.screenX,c=e.screenY;var r=io(g,"cursor");i=fn.fromTag("div",l),oo(i,{position:"absolute",top:"0",left:"0",width:o.width+"px",height:o.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:r}),zo(Xe(m),i),f.push(md(m,"mousemove",v),md(m,"touchmove",v),md(m,"mouseup",h),md(m,"touchend",h)),n.start(e)},v=function(t){var e=t.raw;if(jV(e),e.button!==u)return h(t);e.deltaX=e.screenX-a,e.deltaY=e.screenY-c,t.prevent(),n.drag(e)},h=function(t){jV(t.raw),nt(f,function(t){return t.unbind()}),f=[],jo(i),n.stop&&n.stop(t.raw)},b=function(){nt(f.concat(s),function(t){return t.unbind()}),f=[],s=[],k(i)&&jo(i)};return s.push(md(g,"mousedown",p),md(g,"touchstart",p)),{destroy:b}}function a(){var t=[],n=-1,e=function(e){var o=t.splice(++n);return t.push(e),{state:e,removed:o}},o=function(){if(i())return t[--n]},r=function(){if(u())return t[++n]},i=function(){return n>0},u=function(){return-1!==n&&n<t.length-1};return{data:t,add:e,undo:o,redo:r,canUndo:i,canRedo:u}}function c(){H.add("silver",function(t){var n=jq(t),e=n.uiMothership,o=n.backstage,i=n.renderUI,u=n.getUi;NE.register(t,o.shared);var a=aQ({editor:t,backstage:o});return{renderUI:i,getWindowReceptionistImpl:A(a),getNotificationReceptionistImpl:function(){return r(t,{backstage:o},e)},ui:u()}})}var s,f,l,d=function(t){var n=typeof t;return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n},m=function(t){return function(n){return d(n)===t}},g=function(t){return function(n){return typeof n===t}},p=function(t){return function(n){return t===n}},v=m("string"),h=m("object"),b=m("array"),y=p(null),x=g("boolean"),w=p(void 0),S=function(t){return null==t},k=function(t){return!S(t)},C=g("function"),O=g("number"),_=function(t,n){if(b(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},T=function(){},E=function(t){return function(){return t()}},D=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},B=function(t,n){return function(e){return t(n(e))}},A=function(t){return function(){return t}},M=function(t){return t},F=function(t,n){return t===n},R=function(t){return function(n){return!t(n)}},I=function(t){return function(){throw new Error(t)}},V=A(!1),P=A(!0),H=tinymce.util.Tools.resolve("tinymce.ThemeReceptionist"),z=function(){return z=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e],n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},z.apply(this,arguments)},N=function(){return L},L=(s=function(t){return t()},f=M,l={fold:function(t,n){return t()},isSome:V,isNone:P,getOr:f,getOrThunk:s,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:A(null),getOrUndefined:A(void 0),or:f,orThunk:s,map:N,each:T,bind:N,exists:V,forall:P,filter:function(){return N()},toArray:function(){return[]},toString:A("none()")},l),W=function(t){var n=A(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:P,isNone:V,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return W(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:L},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},U=function(t){return null==t?L:W(t)},j={some:W,none:N,from:U},G=Array.prototype.slice,X=Array.prototype.indexOf,Y=Array.prototype.push,q=function(t,n){return X.call(t,n)},K=function(t,n){var e=q(t,n);return-1===e?j.none():j.some(e)},J=function(t,n){return q(t,n)>-1},$=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e))return!0}return!1},Q=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},Z=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=G.call(t,o,o+n);e.push(r)}return e},tt=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},nt=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];n(r,e)}},et=function(t,n){for(var e=t.length-1;e>=0;e--){var o=t[e];n(o,e)}},ot=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r],a=n(u,r)?e:o;a.push(u)}return{pass:e,fail:o}},rt=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},it=function(t,n,e){return et(t,function(t,o){e=n(e,t,o)}),e},ut=function(t,n,e){return nt(t,function(t,o){e=n(e,t,o)}),e},at=function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return j.some(i);if(e(i,o))break}return j.none()},ct=function(t,n){return at(t,n,V)},st=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e))return j.some(e)}return j.none()},ft=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!b(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);Y.apply(n,t[e])}return n},lt=function(t,n){return ft(tt(t,n))},dt=function(t,n){for(var e=0,o=t.length;e<o;++e){var r=t[e];if(!0!==n(r,e))return!1}return!0},mt=function(t){var n=G.call(t,0);return n.reverse(),n},gt=function(t,n){return rt(t,function(t){return!J(n,t)})},pt=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},vt=function(t){return[t]},ht=function(t,n){var e=G.call(t,0);return e.sort(n),e},bt=function(t,n){return n>=0&&n<t.length?j.some(t[n]):j.none()},yt=function(t){return bt(t,0)},xt=function(t){return bt(t,t.length-1)},wt=C(Array.from)?Array.from:function(t){return G.call(t)},St=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return j.none()},kt=Object.keys,Ct=Object.hasOwnProperty,Ot=function(t,n){for(var e=kt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];n(u,i)}},_t=function(t,n){return Tt(t,function(t,e){return{k:e,v:n(t,e)}})},Tt=function(t,n){var e={};return Ot(t,function(t,o){var r=n(t,o);e[r.k]=r.v}),e},Et=function(t){return function(n,e){t[e]=n}},Dt=function(t,n,e,o){var r={};return Ot(t,function(t,r){(n(t,r)?e:o)(t,r)}),r},Bt=function(t,n){var e={};return Dt(t,n,Et(e),T),e},At=function(t,n){var e=[];return Ot(t,function(t,o){e.push(n(t,o))}),e},Mt=function(t,n){for(var e=kt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return j.some(u)}return j.none()},Ft=function(t){return At(t,M)},Rt=function(t,n){return It(t,n)?j.from(t[n]):j.none()},It=function(t,n){return Ct.call(t,n)},Vt=function(t,n){return It(t,n)&&void 0!==t[n]&&null!==t[n]},Pt=function(t,n,e){return void 0===e&&(e=F),t.exists(function(t){return e(t,n)})},Ht=function(t,n,e){return void 0===e&&(e=F),Lt(t,n,e).getOr(t.isNone()&&n.isNone())},zt=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Nt=function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return j.none();n.push(o.getOrDie())}return j.some(n)},Lt=function(t,n,e){return t.isSome()&&n.isSome()?j.some(e(t.getOrDie(),n.getOrDie())):j.none()},Wt=function(t,n,e,o){return t.isSome()&&n.isSome()&&e.isSome()?j.some(o(t.getOrDie(),n.getOrDie(),e.getOrDie())):j.none()},Ut=function(t,n){return null!=t?j.some(n(t)):j.none()},jt=function(t,n){return t?j.some(n):j.none()},Gt=function(t,n){return t+n},Xt=function(t,n){return t.substring(n)},Yt=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},qt=function(t,n){return $t(t,n)?Xt(t,n.length):t},Kt=function(t,n){return Qt(t,n)?t:Gt(t,n)},Jt=function(t,n){return-1!==t.indexOf(n)},$t=function(t,n){return Yt(t,n,0)},Qt=function(t,n){return Yt(t,n,t.length-n.length)},Zt=function(t){return function(n){return n.replace(t,"")}},tn=Zt(/^\s+|\s+$/g),nn=function(t){return t.length>0},en=function(t){return!nn(t)},on=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},rn=function(t,n){var e=n||document,o=e.createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return cn(o.childNodes[0])},un=function(t,n){var e=n||document,o=e.createElement(t);return cn(o)},an=function(t,n){var e=n||document,o=e.createTextNode(t);return cn(o)},cn=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},sn=function(t,n,e){return j.from(t.dom.elementFromPoint(n,e)).map(cn)},fn={fromHtml:rn,fromTag:un,fromText:an,fromDom:cn,fromPoint:sn};"undefined"!=typeof window?window:Function("return this;")();var ln,dn=9,mn=11,gn=1,pn=3,vn=function(t){var n=t.dom.nodeName;return n.toLowerCase()},hn=function(t){return t.dom.nodeType},bn=function(t){return function(n){return hn(n)===t}},yn=bn(gn),xn=bn(pn),wn=bn(dn),Sn=bn(mn),kn=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Cn=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:A(r),isiPhone:A(i),isTablet:A(c),isPhone:A(s),isTouch:A(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:A(f),isDesktop:A(l)}},On=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}},_n=function(t,n){var e=On(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return Dn(o(1),o(2))},Tn=function(t,n){var e=String(n).toLowerCase();return 0===t.length?En():_n(t,e)},En=function(){return Dn(0,0)},Dn=function(t,n){return{major:t,minor:n}},Bn={nu:Dn,detect:Tn,unknown:En},An=function(t,n){return St(n.brands,function(n){var e=n.brand.toLowerCase();return ct(t,function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())}).map(function(t){return{current:t.name,version:Bn.nu(parseInt(n.version,10),0)}})})},Mn=function(t,n){var e=String(n).toLowerCase();return ct(t,function(t){return t.search(e)})},Fn=function(t,n){return Mn(t,n).map(function(t){var e=Bn.detect(t.versionRegexes,n);return{current:t.name,version:e}})},Rn=function(t,n){return Mn(t,n).map(function(t){var e=Bn.detect(t.versionRegexes,n);return{current:t.name,version:e}})},In=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Vn=function(t){return function(n){return Jt(n,t)}},Pn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Jt(t,"edge/")&&Jt(t,"chrome")&&Jt(t,"safari")&&Jt(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,In],search:function(t){return Jt(t,"chrome")&&!Jt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Jt(t,"msie")||Jt(t,"trident")}},{name:"Opera",versionRegexes:[In,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Vn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Vn("firefox")},{name:"Safari",versionRegexes:[In,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Jt(t,"safari")||Jt(t,"mobile/"))&&Jt(t,"applewebkit")}}],Hn=[{name:"Windows",search:Vn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Jt(t,"iphone")||Jt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Vn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Vn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Vn("linux"),versionRegexes:[]},{name:"Solaris",search:Vn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Vn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Vn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],zn={browsers:A(Pn),oses:A(Hn)},Nn="Edge",Ln="Chrome",Wn="IE",Un="Opera",jn="Firefox",Gn="Safari",Xn=function(){return Yn({current:void 0,version:Bn.unknown()})},Yn=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o(Nn),isChrome:o(Ln),isIE:o(Wn),isOpera:o(Un),isFirefox:o(jn),isSafari:o(Gn)}},qn={unknown:Xn,nu:Yn,edge:A(Nn),chrome:A(Ln),ie:A(Wn),opera:A(Un),firefox:A(jn),safari:A(Gn)},Kn="Windows",Jn="iOS",$n="Android",Qn="Linux",Zn="OSX",te="Solaris",ne="FreeBSD",ee="ChromeOS",oe=function(){return re({current:void 0,version:Bn.unknown()})},re=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(Kn),isiOS:o(Jn),isAndroid:o($n),isOSX:o(Zn),isLinux:o(Qn),isSolaris:o(te),isFreeBSD:o(ne),isChromeOS:o(ee)}},ie={unknown:oe,nu:re,windows:A(Kn),ios:A(Jn),android:A($n),linux:A(Qn),osx:A(Zn),solaris:A(te),freebsd:A(ne),chromeos:A(ee)},ue=function(t,n,e){var o=zn.browsers(),r=zn.oses(),i=n.bind(function(t){return An(o,t)}).orThunk(function(){return Fn(o,t)}).fold(qn.unknown,qn.nu),u=Rn(r,t).fold(ie.unknown,ie.nu),a=Cn(u,i,t,e);return{browser:i,os:u,deviceType:a}},ae={detect:ue},ce=function(t){return window.matchMedia(t).matches},se=kn(function(){return ae.detect(navigator.userAgent,j.from(navigator.userAgentData),ce)}),fe=function(){return se()},le=function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)},de=function(t,n){return le(t,n,Node.DOCUMENT_POSITION_CONTAINED_BY)},me=function(t,n){var e=t.dom;if(e.nodeType!==gn)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},ge=function(t){return t.nodeType!==gn&&t.nodeType!==dn&&t.nodeType!==mn||0===t.childElementCount},pe=function(t,n){var e=void 0===n?document:n.dom;return ge(e)?[]:tt(e.querySelectorAll(t),fn.fromDom)},ve=function(t,n){var e=void 0===n?document:n.dom;return ge(e)?j.none():j.from(e.querySelector(t)).map(fn.fromDom)},he=function(t,n){return t.dom===n.dom},be=function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)},ye=function(t,n){return de(t.dom,n.dom)},xe=function(t,n){return fe().browser.isIE()?ye(t,n):be(t,n)},we=function(t){return fn.fromDom(t.dom.ownerDocument)},Se=function(t){return wn(t)?t:we(t)},ke=function(t){return fn.fromDom(Se(t).dom.documentElement)},Ce=function(t){return fn.fromDom(Se(t).dom.defaultView)},Oe=function(t){return j.from(t.dom.parentNode).map(fn.fromDom)},_e=function(t){return Oe(t)},Te=function(t){return j.from(t.dom.offsetParent).map(fn.fromDom)},Ee=function(t){return j.from(t.dom.nextSibling).map(fn.fromDom)},De=function(t){return tt(t.dom.childNodes,fn.fromDom)},Be=function(t,n){var e=t.dom.childNodes;return j.from(e[n]).map(fn.fromDom)},Ae=function(t){return Be(t,0)},Me=function(t,n){return{element:t,offset:n}},Fe=function(t,n){var e=De(t);return e.length>0&&n<e.length?Me(e[n],0):Me(t,n)},Re=function(t){return Sn(t)&&k(t.dom.host)},Ie=C(Element.prototype.attachShadow)&&C(Node.prototype.getRootNode),Ve=A(Ie),Pe=Ie?function(t){return fn.fromDom(t.dom.getRootNode())}:Se,He=function(t){return Re(t)?t:fn.fromDom(Se(t).dom.body)},ze=function(t){return Ne(t).isSome()},Ne=function(t){var n=Pe(t);return Re(n)?j.some(n):j.none()},Le=function(t){return fn.fromDom(t.dom.host)},We=function(t){if(Ve()&&k(t.target)){var n=fn.fromDom(t.target);if(yn(n)&&Ue(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return yt(e)}}return j.from(t.target)},Ue=function(t){return k(t.dom.shadowRoot)},je=function(t){var n=xn(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e=n.ownerDocument;return Ne(fn.fromDom(n)).fold(function(){return e.body.contains(n)},B(je,Le))},Ge=function(){return Xe(fn.fromDom(document))},Xe=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return fn.fromDom(n)},Ye=function(t,n,e){if(!(v(e)||x(e)||O(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},qe=function(t,n,e){Ye(t.dom,n,e)},Ke=function(t,n){var e=t.dom;Ot(n,function(t,n){Ye(e,n,t)})},Je=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},$e=function(t,n){return j.from(Je(t,n))},Qe=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Ze=function(t,n){t.dom.removeAttribute(n)},to=function(t,n,e){if(!v(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);on(t)&&t.style.setProperty(n,e)},no=function(t,n){on(t)&&t.style.removeProperty(n)},eo=function(t,n,e){var o=t.dom;to(o,n,e)},oo=function(t,n){var e=t.dom;Ot(n,function(t,n){to(e,n,t)})},ro=function(t,n){var e=t.dom;Ot(n,function(t,n){t.fold(function(){no(e,n)},function(t){to(e,n,t)})})},io=function(t,n){var e=t.dom,o=window.getComputedStyle(e),r=o.getPropertyValue(n);return""!==r||je(t)?r:uo(e,n)},uo=function(t,n){return on(t)?t.style.getPropertyValue(n):""},ao=function(t,n){var e=t.dom,o=uo(e,n);return j.from(o).filter(function(t){return t.length>0})},co=function(t){var n={},e=t.dom;if(on(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},so=function(t,n,e){var o=fn.fromTag(t);eo(o,n,e);var r=ao(o,n);return r.isSome()},fo=function(t,n){var e=t.dom;no(e,n),Pt($e(t,"style").map(tn),"")&&Ze(t,"style")},lo=function(t){return t.dom.offsetWidth},mo=function(t,n){var e=function(n,e){if(!O(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;on(o)&&(o.style[t]=e+"px")},o=function(e){var o=n(e);if(o<=0||null===o){var r=io(e,t);return parseFloat(r)||0}return o},r=o,i=function(t,n){return ut(n,function(n,e){var o=io(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r},0)},u=function(t,n,e){var o=i(t,e),r=n>o?n-o:0;return r};return{set:e,get:o,getOuter:r,aggregate:i,max:u}},go=mo("height",function(t){var n=t.dom;return je(t)?n.getBoundingClientRect().height:n.offsetHeight}),po=function(t){return go.get(t)},vo=function(t){return go.getOuter(t)},ho=function(t,n){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=go.max(t,n,e);eo(t,"max-height",o+"px")},bo=function(t,n){var e=function(e,o){return bo(t+e,n+o)};return{left:t,top:n,translate:e}},yo=bo,xo=function(t){var n=t.getBoundingClientRect();return yo(n.left,n.top)},wo=function(t,n){return void 0!==t?t:void 0!==n?n:0},So=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return yo(e.offsetLeft,e.offsetTop);var i=wo(null==o?void 0:o.pageYOffset,r.scrollTop),u=wo(null==o?void 0:o.pageXOffset,r.scrollLeft),a=wo(r.clientTop,e.clientTop),c=wo(r.clientLeft,e.clientLeft);return ko(t).translate(u-c,i-a)},ko=function(t){var n=t.dom,e=n.ownerDocument,o=e.body;return o===n?yo(o.offsetLeft,o.offsetTop):je(t)?xo(n):yo(0,0)},Co=mo("width",function(t){return t.dom.offsetWidth}),Oo=function(t,n){return Co.set(t,n)},_o=function(t){return Co.get(t)},To=function(t){return Co.getOuter(t)},Eo=function(t,n){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=Co.max(t,n,e);eo(t,"max-width",o+"px")},Do=function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}},Bo=function(t){var n=fn.fromDom(We(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=D(o,e);return Do(n,t.clientX,t.clientY,e,o,r,t)},Ao=function(t,n){return function(e){t(e)&&n(Bo(e))}},Mo=function(n,e,o,r,i){var u=Ao(o,r);return n.dom.addEventListener(e,u,i),{unbind:t(Io,n,e,u,i)}},Fo=function(t,n,e,o){return Mo(t,n,e,o,!1)},Ro=function(t,n,e,o){return Mo(t,n,e,o,!0)},Io=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Vo=function(t,n){var e=Oe(t);e.each(function(e){e.dom.insertBefore(n.dom,t.dom)})},Po=function(t,n){var e=Ee(t);e.fold(function(){var e=Oe(t);e.each(function(t){zo(t,n)})},function(t){Vo(t,n)})},Ho=function(t,n){var e=Ae(t);e.fold(function(){zo(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})},zo=function(t,n){t.dom.appendChild(n.dom)},No=function(t,n,e){Be(t,e).fold(function(){zo(t,n)},function(t){Vo(t,n)})},Lo=function(t,n){nt(n,function(n){Vo(t,n)})},Wo=function(t,n){nt(n,function(n){zo(t,n)})},Uo=function(t){t.dom.textContent="",nt(De(t),function(t){jo(t)})},jo=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Go=function(t){var n=De(t);n.length>0&&Lo(t,n),jo(t)},Xo=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return yo(e,o)},Yo=function(t,n,e){var o=void 0!==e?e.dom:document,r=o.defaultView;r&&r.scrollTo(t,n)},qo=function(t){var n=void 0===t?window:t;return fe().browser.isFirefox()?j.none():j.from(n.visualViewport)},Ko=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Jo=function(t){var n=void 0===t?window:t,e=n.document,o=Xo(fn.fromDom(e));return qo(n).fold(function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return Ko(o.left,o.top,e,r)},function(t){return Ko(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)})},$o=function(t,n){var e=t.view(n);return e.fold(A([]),function(n){var e=t.owner(n),o=$o(t,e);return[n].concat(o)})},Qo=function(t,n){var e=n.owner(t),o=$o(n,e);return j.some(o)},Zo=function(t){var n,e=t.dom===document?j.none():j.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement);return e.map(fn.fromDom)},tr=function(t){return we(t)},nr=Object.freeze({__proto__:null,view:Zo,owner:tr}),er=function(n){var e=fn.fromDom(document),o=Xo(e),r=Qo(n,nr);return r.fold(t(So,n),function(t){var e=ko(n),r=it(t,function(t,n){var e=ko(n);return{left:t.left+e.left,top:t.top+e.top}},{left:0,top:0});return yo(r.left+e.left+o.left,r.top+e.top+o.top)})},or=function(t,n,e){return{point:t,width:n,height:e}},rr=function(t,n,e,o){return{x:t,y:n,width:e,height:o}},ir=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},ur=function(t){var n=So(t),e=To(t),o=vo(t);return ir(n.left,n.top,e,o)},ar=function(t){var n=er(t),e=To(t),o=vo(t);return ir(n.left,n.top,e,o)},cr=function(){return Jo(window)},sr=function(t){var n=function(n){return sr(t)},e=function(n){return sr(t)},o=function(n){return sr(n(t))},r=function(n){return sr(t)},i=function(n){n(t)},u=function(n){return n(t)},a=function(n,e){return e(t)},c=function(n){return n(t)},s=function(n){return n(t)},f=function(){return j.some(t)};return{isValue:P,isError:V,getOr:A(t),getOrThunk:A(t),getOrDie:A(t),or:n,orThunk:e,fold:a,map:o,mapError:r,each:i,bind:u,exists:c,forall:s,toOptional:f}},fr=function(t){var n=function(t){return t()},e=function(){return I(String(t))()},o=M,r=function(t){return t()},i=function(n){return fr(t)},u=function(n){return fr(n(t))},a=function(n){return fr(t)},c=function(n,e){return n(t)};return{isValue:V,isError:P,getOr:M,getOrThunk:n,getOrDie:e,or:o,orThunk:r,fold:c,map:i,mapError:u,each:T,bind:a,exists:V,forall:P,toOptional:j.none}},lr=function(t,n){return t.fold(function(){return fr(n)},sr)},dr={value:sr,error:fr,fromOption:lr};(function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"})(ln||(ln={}));var mr=function(t,n,e){return t.stype===ln.Error?n(t.serror):e(t.svalue)},gr=function(t){var n=[],e=[];return nt(t,function(t){mr(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},pr=function(t,n){return t.stype===ln.Error?{stype:ln.Error,serror:n(t.serror)}:t},vr=function(t,n){return t.stype===ln.Value?{stype:ln.Value,svalue:n(t.svalue)}:t},hr=function(t,n){return t.stype===ln.Value?n(t.svalue):t},br=function(t,n){return t.stype===ln.Error?n(t.serror):t},yr=function(t){return{stype:ln.Value,svalue:t}},xr=function(t){return{stype:ln.Error,serror:t}},wr=function(t){return mr(t,dr.error,dr.value)},Sr=function(t){return t.fold(xr,yr)},kr={fromResult:Sr,toResult:wr,svalue:yr,partition:gr,serror:xr,bind:hr,bindError:br,map:vr,mapError:pr,fold:mr},Cr=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},Or=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},_r=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},Tr=function(t,n){return n},Er=function(t,n){var e=h(t)&&h(n);return e?Br(t,n):n},Dr=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)It(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Br=Dr(Er),Ar=Dr(Tr),Mr=function(){return{tag:"required",process:{}}},Fr=function(t){return{tag:"defaultedThunk",process:t}},Rr=function(t){return Fr(A(t))},Ir=function(){return{tag:"option",process:{}}},Vr=function(t){return{tag:"mergeWithThunk",process:t}},Pr=function(t){return Vr(A(t))},Hr=function(t,n){return t.length>0?kr.svalue(Br(n,Ar.apply(void 0,t))):kr.svalue(n)},zr=function(t){return D(kr.serror,ft)(t)},Nr=function(t,n){var e=kr.partition(t);return e.errors.length>0?zr(e.errors):Hr(e.values,n)},Lr=function(t){var n=kr.partition(t);return n.errors.length>0?zr(n.errors):kr.svalue(n.values)},Wr={consolidateObj:Nr,consolidateArr:Lr},Ur=function(t){return h(t)&&kt(t).length>100?" removed due to size":JSON.stringify(t,null,2)},jr=function(t){var n=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:A("... (only showing first ten failures)")}]):t;return tt(n,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})},Gr=function(t,n){return kr.serror([{path:t,getErrorInfo:n}])},Xr=function(t,n,e){return Gr(t,function(){return'Could not find valid *required* value for "'+n+'" in '+Ur(e)})},Yr=function(t,n){return Gr(t,function(){return'Choice schema did not contain choice key: "'+n+'"'})},qr=function(t,n,e){return Gr(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Ur(n)})},Kr=function(t,n){return Gr(t,function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"})},Jr=function(t,n){return Gr(t,A(n))},$r=function(t){var n=function(n,e){return kr.bindError(t(e),function(t){return Jr(n,t)})},e=A("val");return{extract:n,toString:e}},Qr=$r(kr.svalue),Zr=function(t,n,e,o){return Rt(n,e).fold(function(){return Xr(t,e,n)},o)},ti=function(t,n,e,o){var r=Rt(t,n).getOrThunk(function(){return e(t)});return o(r)},ni=function(t,n,e){return e(Rt(t,n))},ei=function(t,n,e,o){var r=Rt(t,n).map(function(n){return!0===n?e(t):n});return o(r)},oi=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold(function(){return kr.svalue(j.none())},function(t){var e=r.extract(n.concat([o]),t);return kr.map(e,j.some)})};switch(t.tag){case"required":return Zr(n,e,o,i);case"defaultedThunk":return ti(e,o,t.process,i);case"option":return ni(e,o,u);case"defaultedOptionThunk":return ei(e,o,t.process,u);case"mergeWithThunk":return ti(e,o,A({}),function(n){var o=Br(t.process(e),n);return i(o)})}},ri=function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i];_r(a,function(e,i,u,a){var c=oi(u,t,n,e,a);kr.fold(c,function(t){r.push.apply(r,t)},function(t){o[i]=t})},function(t,e){o[t]=e(n)})}return r.length>0?kr.serror(r):kr.svalue(o)},ii=function(t){var n=function(n,e){return t().extract(n,e)},e=function(){return t().toString()};return{extract:n,toString:e}},ui=function(t){return kt(Bt(t,k))},ai=function(t){var n=ci(t),e=it(t,function(t,n){return _r(n,function(n){var e;return Br(t,(e={},e[n]=!0,e))},A(t))},{}),o=function(t,o){var r=x(o)?[]:ui(o),i=rt(r,function(t){return!Vt(e,t)});return 0===i.length?n.extract(t,o):Kr(t,i)};return{extract:o,toString:n.toString}},ci=function(t){var n=function(n,e){return ri(n,e,t)},e=function(){var n=tt(t,function(t){return _r(t,function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})});return"obj{\n"+n.join("\n")+"}"};return{extract:n,toString:e}},si=function(t){var n=function(n,e){var o=tt(e,function(e,o){return t.extract(n.concat(["["+o+"]"]),e)});return Wr.consolidateArr(o)},e=function(){return"array("+t.toString()+")"};return{extract:n,toString:e}},fi=function(t){var n=function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r],a=u.extract(n,e);if(a.stype===ln.Value)return a;o.push(a)}return Wr.consolidateArr(o)},e=function(){return"oneOf("+tt(t,function(t){return t.toString()}).join(", ")+")"};return{extract:n,toString:e}},li=function(t,n){var e=function(n,e){return si($r(t)).extract(n,e)},o=function(t,o){var r=kt(o),i=e(t,r);return kr.bind(i,function(e){var r=tt(e,function(t){return Cr(t,t,Mr(),n)});return ci(r).extract(t,o)})},r=function(){
return"setOf("+n.toString()+")"};return{extract:o,toString:r}},di=function(t,n){var e=kn(n),o=function(t,n){return e().extract(t,n)},r=function(){return e().toString()};return{extract:o,toString:r}},mi=D(si,ci),gi=A(Qr),pi=function(t,n){return $r(function(e){var o=typeof e;return t(e)?kr.svalue(e):kr.serror("Expected type: "+n+" but got: "+o)})},vi=pi(O,"number"),hi=pi(v,"string"),bi=pi(x,"boolean"),yi=pi(C,"function"),xi=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(function(n){return xi(t[n])});default:return!1}},wi=$r(function(t){return xi(t)?kr.svalue(t):kr.serror("Expected value to be acceptable for sending via postMessage")}),Si=function(t,n,e,o){var r=Rt(e,o);return r.fold(function(){return qr(t,e,o)},function(e){return e.extract(t.concat(["branch: "+o]),n)})},ki=function(t,n){var e=function(e,o){var r=Rt(o,t);return r.fold(function(){return Yr(e,t)},function(t){return Si(e,o,n,t)})},o=function(){return"chooseOn("+t+"). Possible values: "+kt(n)};return{extract:e,toString:o}},Ci=function(){return si(Qr)},Oi=function(t){return $r(function(n){return t(n).fold(kr.serror,kr.svalue)})},_i=function(t,n){return li(function(n){return kr.fromResult(t(n))},n)},Ti=function(t,n,e){var o=n.extract([t],e);return kr.mapError(o,function(t){return{input:e,errors:t}})},Ei=function(t,n,e){return kr.toResult(Ti(t,n,e))},Di=function(t){return t.fold(function(t){throw new Error(Ai(t))},M)},Bi=function(t,n,e){return Di(Ei(t,n,e))},Ai=function(t){return"Errors: \n"+jr(t.errors).join("\n")+"\n\nInput object: "+Ur(t.input)},Mi=function(t,n){return ki(t,_t(n,ci))},Fi=function(t,n){return di(t,n)},Ri=Cr,Ii=Or,Vi=function(t){return Oi(function(n){return J(t,n)?dr.value(n):dr.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')})},Pi=function(t){return Ri(t,t,Mr(),gi())},Hi=function(t,n){return Ri(t,t,Mr(),n)},zi=function(t){return Hi(t,vi)},Ni=function(t){return Hi(t,hi)},Li=function(t,n){return Ri(t,t,Mr(),Vi(n))},Wi=function(t){return Hi(t,bi)},Ui=function(t){return Hi(t,yi)},ji=function(t,n){return Ri(t,t,Ir(),$r(function(e){return kr.serror("The field: "+t+" is forbidden. "+n)}))},Gi=function(t,n){return Ri(t,t,Mr(),ci(n))},Xi=function(t,n){return Ri(t,t,Mr(),mi(n))},Yi=function(t,n){return Ri(t,t,Mr(),si(n))},qi=function(t){return Ri(t,t,Ir(),gi())},Ki=function(t,n){return Ri(t,t,Ir(),n)},Ji=function(t){return Ki(t,vi)},$i=function(t){return Ki(t,hi)},Qi=function(t){return Ki(t,yi)},Zi=function(t,n){return Ki(t,si(n))},tu=function(t,n){return Ki(t,ci(n))},nu=function(t,n){return Ki(t,ai(n))},eu=function(t,n){return Ri(t,t,Rr(n),gi())},ou=function(t,n,e){return Ri(t,t,Rr(n),e)},ru=function(t,n){return ou(t,n,vi)},iu=function(t,n){return ou(t,n,hi)},uu=function(t,n,e){return ou(t,n,Vi(e))},au=function(t,n){return ou(t,n,bi)},cu=function(t,n){return ou(t,n,yi)},su=function(t,n){return ou(t,n,wi)},fu=function(t,n,e){return ou(t,n,si(e))},lu=function(t,n,e){return ou(t,n,ci(e))},du=function(t){var n=t,e=function(){return n},o=function(t){n=t};return{get:e,set:o}},mu=function(t){if(!b(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return nt(t,function(o,r){var i=kt(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!b(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);var c=function(t){var o=kt(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));var r=dt(n,function(t){return J(o,t)});if(!r)throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:c,log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}}),e},gu={generate:mu};gu.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var pu,vu,hu=function(t){var n=[],e=[];return nt(t,function(t){t.fold(function(t){n.push(t)},function(t){e.push(t)})}),{errors:n,values:e}},bu=function(t,n){var e={};return Ot(t,function(t,o){J(n,o)||(e[o]=t)}),e},yu=function(t,n){var e;return e={},e[t]=n,e},xu=function(t){var n={};return nt(t,function(t){n[t.key]=t.value}),n},wu=function(t,n){return bu(t,n)},Su=function(t,n){return yu(t,n)},ku=function(t){return xu(t)},Cu=function(t,n){return 0===t.length?dr.value(n):dr.value(Br(n,Ar.apply(void 0,t)))},Ou=function(t){return dr.error(ft(t))},_u=function(t,n){var e=hu(t);return e.errors.length>0?Ou(e.errors):Cu(e.values,n)},Tu=function(t){return C(t)?t:V},Eu=function(t,n,e){for(var o=t.dom,r=Tu(e);o.parentNode;){o=o.parentNode;var i=fn.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return j.none()},Du=function(t,n,e){var o=n(t),r=Tu(e);return o.orThunk(function(){return r(t)?j.none():Eu(t,n,r)})},Bu=function(t,n){return he(t.element,n.event.target)},Au={can:P,abort:V,run:T},Mu=function(t){if(!Vt(t,"can")&&!Vt(t,"abort")&&!Vt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return z(z({},Au),t)},Fu=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return ut(t,function(t,o){return t&&n(o).apply(void 0,e)},!0)}},Ru=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return ut(t,function(t,o){return t||n(o).apply(void 0,e)},!1)}},Iu=function(t){return C(t)?{can:P,abort:V,run:t}:t},Vu=function(t){var n=Fu(t,function(t){return t.can}),e=Ru(t,function(t){return t.abort}),o=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];nt(t,function(t){t.run.apply(void 0,n)})};return{can:n,abort:e,run:o}},Pu=A,Hu=Pu("touchstart"),zu=Pu("touchmove"),Nu=Pu("touchend"),Lu=Pu("touchcancel"),Wu=Pu("mousedown"),Uu=Pu("mousemove"),ju=Pu("mouseout"),Gu=Pu("mouseup"),Xu=Pu("mouseover"),Yu=Pu("focusin"),qu=Pu("focusout"),Ku=Pu("keydown"),Ju=Pu("keyup"),$u=Pu("input"),Qu=Pu("change"),Zu=Pu("click"),ta=Pu("transitioncancel"),na=Pu("transitionend"),ea=Pu("transitionstart"),oa=Pu("selectstart"),ra=function(t){return A("alloy."+t)},ia={tap:ra("tap")},ua=ra("focus"),aa=ra("blur.post"),ca=ra("paste.post"),sa=ra("receive"),fa=ra("execute"),la=ra("focus.item"),da=ia.tap,ma=ra("longpress"),ga=ra("sandbox.close"),pa=ra("typeahead.cancel"),va=ra("system.init"),ha=ra("system.touchmove"),ba=ra("system.touchend"),ya=ra("system.scroll"),xa=ra("system.resize"),wa=ra("system.attached"),Sa=ra("system.detached"),ka=ra("system.dismissRequested"),Ca=ra("system.repositionRequested"),Oa=ra("focusReceptionist.shifted"),_a=ra("slotcontainer.visibility"),Ta=ra("change.tab"),Ea=ra("dismiss.tab"),Da=ra("highlight"),Ba=ra("dehighlight"),Aa=function(t,n){Ia(t,t.element,n,{})},Ma=function(t,n,e){Ia(t,t.element,n,e)},Fa=function(t){Aa(t,fa())},Ra=function(t,n,e){Ia(t,n,e,{})},Ia=function(t,n,e,o){var r=z({target:n},o);t.getSystem().triggerEvent(e,n,r)},Va=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Pa=function(t){return ku(t)},Ha=function(t,n){return{key:t,value:Mu({abort:n})}},za=function(t,n){return{key:t,value:Mu({can:n})}},Na=function(t){return{key:t,value:Mu({run:function(t,n){n.event.prevent()}})}},La=function(t,n){return{key:t,value:Mu({run:n})}},Wa=function(t,n,e){return{key:t,value:Mu({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Ua=function(t){return function(n){return La(t,n)}},ja=function(t){return function(n){return{key:t,value:Mu({run:function(t,e){Bu(t,e)&&n(t,e)}})}}},Ga=function(t,n){return La(t,function(e,o){e.getSystem().getByUid(n).each(function(n){Va(n,n.element,t,o)})})},Xa=function(t,n,e){var o=n.partUids[e];return Ga(t,o)},Ya=function(t,n){return La(t,function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk(function(){var n=Du(o.target,function(n){return t.getSystem().getByDom(n).toOptional()},V);return n.getOr(t)});n(t,r,e)})},qa=function(t){return La(t,function(t,n){n.cut()})},Ka=function(t){return La(t,function(t,n){n.stop()})},Ja=function(t,n){return ja(t)(n)},$a=ja(wa()),Qa=ja(Sa()),Za=ja(va()),tc=Ua(fa()),nc=function(t,n){var e=n||document,o=e.createElement("div");return o.innerHTML=t,De(fn.fromDom(o))},ec=function(t){return t.dom.innerHTML},oc=function(t,n){var e=we(t),o=e.dom,r=fn.fromDom(o.createDocumentFragment()),i=nc(n,o);Wo(r,i),Uo(t),zo(t,r)},rc=function(t){var n=fn.fromTag("div"),e=fn.fromDom(t.dom.cloneNode(!0));return zo(n,e),ec(n)},ic=function(t,n){return fn.fromDom(t.dom.cloneNode(n))},uc=function(t){return ic(t,!1)},ac=function(t){if(Re(t))return"#shadow-root";var n=uc(t);return rc(n)},cc=function(t){return ac(t)},sc=function(t,n,e){return he(n,t.element)&&!he(n,e)},fc=Pa([za(ua(),function(t,n){var e=n.event,o=e.originator,r=e.target;return!sc(t,o,r)||(console.warn(ua()+" did not get interpreted by the desired target. \nOriginator: "+cc(o)+"\nTarget: "+cc(r)+"\nCheck the "+ua()+" event handlers"),!1)})]),lc=Object.freeze({__proto__:null,events:fc}),dc=0,mc=function(t){var n=new Date,e=n.getTime(),o=Math.floor(1e9*Math.random());return dc++,t+"_"+o+dc+String(e)},gc=A("alloy-id-"),pc=A("data-alloy-id"),vc=gc(),hc=pc(),bc=function(t,n){var e=mc(vc+t);return yc(n,e),e},yc=function(t,n){Object.defineProperty(t.dom,hc,{value:n,writable:!0})},xc=function(t){var n=yn(t)?t.dom[hc]:null;return j.from(n)},wc=function(t){return mc(t)},Sc=M,kc=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+cc(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:A("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:V}},Cc=kc(),Oc=function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:_c(u.slice(0,1).concat(u.slice(3)))}},t},_c=function(t){return tt(t,function(t){return Qt(t,"/*")?t.substring(0,t.length-"/*".length):t})},Tc=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:_c(i)}},t},Ec=function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:_c(i.slice(1))}},t},Dc=mc("alloy-premade"),Bc=function(t){return Su(Dc,t)},Ac=function(t){return Rt(t,Dc)},Mc=function(t){return Ec(function(n){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];return t.apply(void 0,e([n.getApis(),n],o,!1))},t)},Fc={init:function(){return Rc({readState:A("No State required")})}},Rc=function(t){return t},Ic=function(t,n){var e=tt(n,function(t){return tu(t.name(),[Pi("config"),eu("state",Fc)])}),o=Ei("component.behaviours",ci(e),t.behaviours).fold(function(n){throw new Error(Ai(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))},M);return{list:n,data:_t(o,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return A(n)})}},Vc=function(t){return t.list},Pc=function(t){return t.data},Hc=function(t,n){var e={};return Ot(t,function(t,o){Ot(t,function(t,r){var i=Rt(e,r).getOr([]);e[r]=i.concat([n(o,t)])})}),e},zc=function(t){return{classes:w(t.classes)?[]:t.classes,attributes:w(t.attributes)?{}:t.attributes,styles:w(t.styles)?{}:t.styles}},Nc=function(t,n){return z(z({},t),{attributes:z(z({},t.attributes),n.attributes),styles:z(z({},t.styles),n.styles),classes:t.classes.concat(n.classes)})},Lc=function(t,n,e,o){var r=z({},n);nt(e,function(n){r[n.name()]=n.exhibit(t,o)});var i=Hc(r,function(t,n){return{name:t,modification:n}}),u=function(t){return it(t,function(t,n){return z(z({},n.modification),t)},{})},a=it(i.classes,function(t,n){return n.modification.concat(t)},[]),c=u(i.attributes),s=u(i.styles);return zc({classes:a,attributes:c,styles:s})},Wc=function(t,n,e,o){try{var r=ht(e,function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0});return dr.value(r)}catch(t){return dr.error([t])}},Uc=function(t,n){return{handler:t,purpose:n}},jc=function(t,n){return{cHandler:t,purpose:n}},Gc=function(n,e){return jc(t.apply(void 0,[n.handler].concat(e)),n.purpose)},Xc=function(t){return t.cHandler},Yc=function(t,n){return{name:t,handler:n}},qc=function(t,n){var e={};return nt(t,function(t){e[t.name()]=t.handlers(n)}),e},Kc=function(t,n,e){var o=z(z({},e),qc(n,t));return Hc(o,Yc)},Jc=function(t,n,e,o){var r=Kc(t,e,o);return ts(r,n)},$c=function(t){var n=Iu(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Qc=function(t,n){return dr.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(tt(n,function(t){return t.name}),null,2)])},Zc=function(t,n,e){var o=n[e];return o?Wc("Event: "+e,"name",t,o).map(function(t){var n=tt(t,function(t){return t.handler});return Vu(n)}):Qc(e,t)},ts=function(t,n){var e=At(t,function(t,e){var o=1===t.length?dr.value(t[0].handler):Zc(t,n,e);return o.map(function(o){var r=$c(o),i=t.length>1?rt(n[e],function(n){return $(t,function(t){return t.name===n})}).join(" > "):t[0].name;return Su(e,Uc(r,i))})});return _u(e,{})},ns="alloy.base.behaviour",es=ci([Ri("dom","dom",Mr(),ci([Pi("tag"),eu("styles",{}),eu("classes",[]),eu("attributes",{}),qi("value"),qi("innerHtml")])),Pi("components"),Pi("uid"),eu("events",{}),eu("apis",{}),Ri("eventOrder","eventOrder",Pr((pu={},pu[fa()]=["disabling",ns,"toggling","typeaheadevents"],pu[ua()]=[ns,"focusing","keying"],pu[va()]=[ns,"disabling","toggling","representing"],pu[$u()]=[ns,"representing","streaming","invalidating"],pu[Sa()]=[ns,"representing","item-events","tooltipping"],pu[Wu()]=["focusing",ns,"item-type-events"],pu[Hu()]=["focusing",ns,"item-type-events"],pu[Xu()]=["item-type-events","tooltipping"],pu[sa()]=["receiving","reflecting","tooltipping"],pu)),gi()),qi("domModification")]),os=function(t){return Ei("custom.definition",es,t)},rs=function(t){return z(z({},t.dom),{uid:t.uid,domChildren:tt(t.components,function(t){return t.element})})},is=function(t){return t.domModification.fold(function(){return zc({})},zc)},us=function(t){return t.events},as=function(t,n){var e=Je(t,n);return void 0===e||""===e?[]:e.split(" ")},cs=function(t,n,e){var o=as(t,n),r=o.concat([e]);return qe(t,n,r.join(" ")),!0},ss=function(t,n,e){var o=rt(as(t,n),function(t){return t!==e});return o.length>0?qe(t,n,o.join(" ")):Ze(t,n),!1},fs=function(t){return void 0!==t.dom.classList},ls=function(t){return as(t,"class")},ds=function(t,n){return cs(t,"class",n)},ms=function(t,n){return ss(t,"class",n)},gs=function(t,n){fs(t)?t.dom.classList.add(n):ds(t,n)},ps=function(t){var n=fs(t)?t.dom.classList:ls(t);0===n.length&&Ze(t,"class")},vs=function(t,n){if(fs(t)){var e=t.dom.classList;e.remove(n)}else ms(t,n);ps(t)},hs=function(t,n){return fs(t)&&t.dom.classList.contains(n)},bs=function(t,n){nt(n,function(n){gs(t,n)})},ys=function(t,n){nt(n,function(n){vs(t,n)})},xs=function(t,n){return dt(n,function(n){return hs(t,n)})},ws=function(t){return t.dom.value},Ss=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},ks=function(t){var n=fn.fromTag(t.tag);Ke(n,t.attributes),bs(n,t.classes),oo(n,t.styles),t.innerHtml.each(function(t){return oc(n,t)});var e=t.domChildren;return Wo(n,e),t.value.each(function(t){Ss(n,t)}),t.uid,yc(n,t.uid),n},Cs=function(t){var n=Rt(t,"behaviours").getOr({});return lt(kt(n),function(t){var e=n[t];return k(e)?[e.me]:[]})},Os=function(t,n){return Ic(t,n)},_s=function(t){var n=Cs(t);return Os(t,n)},Ts=function(t,n,e){var o=rs(t),r=is(t),i={"alloy.base.modification":r},u=n.length>0?Lc(e,i,n,o):r;return Nc(o,u)},Es=function(t,n,e){var o={"alloy.base.behaviour":us(t)};return Jc(e,t.eventOrder,n,o).getOrDie()},Ds=function(t){var n=function(){return b},e=du(Cc),o=Di(os(t)),r=_s(t),i=Vc(r),u=Pc(r),a=Ts(o,i,u),c=ks(a),s=Es(o,i,u),f=du(o.components),l=function(t){e.set(t)},d=function(){e.set(kc(n))},m=function(){var t=De(c),n=lt(t,function(t){return e.get().getByDom(t).fold(function(){return[]},vt)});f.set(n)},g=function(n){var e=u,o=C(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))};return o()},p=function(t){return C(u[t.name()])},v=function(){return o.apis},h=function(t){return u[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},b={uid:t.uid,getSystem:e.get,config:g,hasConfigured:p,spec:t,readState:h,getApis:v,connect:l,disconnect:d,element:c,syncComponents:m,components:f.get,events:s};return b},Bs=function(t){var n=Rt(t,"components").getOr([]);return tt(n,Vs)},As=function(t){var e=Sc(t),o=e.events,r=n(e,["events"]),i=Bs(r),u=z(z({},r),{events:z(z({},lc),o),components:i});return dr.value(Ds(u))},Ms=function(t){var n=fn.fromText(t);return Fs({element:n})},Fs=function(t){var n=Bi("external.component",ai([Pi("element"),qi("uid")]),t),e=du(kc()),o=function(t){e.set(t)},r=function(){e.set(kc(function(){return u}))},i=n.uid.getOrThunk(function(){return wc("external")});yc(n.element,i);var u={uid:i,getSystem:e.get,config:j.none,hasConfigured:V,connect:o,disconnect:r,getApis:function(){return{}},element:n.element,spec:t,readState:A("No state"),syncComponents:T,components:A([]),events:{}};return Bc(u)},Rs=wc,Is=function(t){return It(t,"uid")},Vs=function(t){return Ac(t).getOrThunk(function(){var n=Is(t)?t:z({uid:Rs("")},t);return As(n).getOrDie()})},Ps=Bc,Hs=function(t,n,e){for(var o=t.dom,r=C(e)?e:V;o.parentNode;){o=o.parentNode;var i=fn.fromDom(o);if(n(i))return j.some(i);if(r(i))break}return j.none()},zs=function(t,n,e){var r=function(t,n){return n(t)};return o(r,Hs,t,n,e)},Ns=function(t,n){var e=function(t){return n(fn.fromDom(t))},o=ct(t.dom.childNodes,e);return o.map(fn.fromDom)},Ls=function(t,n){var e=function(t){for(var o=0;o<t.childNodes.length;o++){var r=fn.fromDom(t.childNodes[o]);if(n(r))return j.some(r);var i=e(t.childNodes[o]);if(i.isSome())return i}return j.none()};return e(t.dom)},Ws=function(t,n,e){return zs(t,n,e).isSome()},Us=function(t,n,e){return Hs(t,function(t){return me(t,n)},e)},js=function(t,n){return Ns(t,function(t){return me(t,n)})},Gs=function(t,n){return ve(n,t)},Xs=function(t,n,e){var r=function(t,n){return me(t,n)};return o(r,Us,t,n,e)},Ys=function(t){var n=zs(t,function(t){if(!yn(t))return!1;var n=Je(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1});return n.bind(function(t){var n=Je(t,"id"),e=Pe(t);return Gs(e,'[aria-owns="'+n+'"]')})},qs=function(){var t=mc("aria-owns"),n=function(n){qe(n,"aria-owns",t)},e=function(t){Ze(t,"aria-owns")};return{id:t,link:n,unlink:e}},Ks=function(t,n){return Ys(n).exists(function(n){return Js(t,n)})},Js=function(t,n){return Ws(n,function(n){return he(n,t.element)},V)||Ks(t,n)},$s="unknown";(function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"})(vu||(vu={}));var Qs=du({}),Zs=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();J(["mousemove","mouseover","mouseout",va()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:tt(e,function(t){return J(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+cc(t.target)+")":t.outcome})})}}},tf=function(t,n,e){var o=Rt(Qs.get(),t).orThunk(function(){var n=kt(Qs.get());return St(n,function(n){return t.indexOf(n)>-1?j.some(Qs.get()[n]):j.none()})}).getOr(vu.NORMAL);switch(o){case vu.NORMAL:return e(uf());case vu.LOGGING:var r=Zs(t,n),i=e(r);return r.write(),i;case vu.STOP:return!0}},nf=["alloy/data/Fields","alloy/debugging/Debugging"],ef=function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");return ct(n,function(t){return t.indexOf("alloy")>0&&!$(nf,function(n){return t.indexOf(n)>-1})}).getOr($s)}return $s},of={logEventCut:T,logEventStopped:T,logNoParent:T,logEventNoHandlers:T,logEventResponse:T,write:T},rf=function(t,n,e){return tf(t,n,e)},uf=A(of),af=A([Pi("menu"),Pi("selectedMenu")]),cf=A([Pi("item"),Pi("selectedItem")]);A(ci(cf().concat(af())));var sf=A(ci(cf())),ff=Gi("initSize",[Pi("numColumns"),Pi("numRows")]),lf=function(){return Hi("markers",sf())},df=function(){return Gi("markers",[Pi("backgroundMenu")].concat(af()).concat(cf()))},mf=function(t){return Gi("markers",tt(t,Pi))},gf=function(t,n,e){return ef(),Ri(n,n,e,Oi(function(t){return dr.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)})}))},pf=function(t){return gf("onHandler",t,Rr(T))},vf=function(t){return gf("onKeyboardHandler",t,Rr(j.none))},hf=function(t){return gf("onHandler",t,Mr())},bf=function(t){return gf("onKeyboardHandler",t,Mr())},yf=function(t,n){return Ii(t,A(n))},xf=function(t){return Ii(t,M)},wf=A(ff),Sf=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},kf=gu.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Cf=function(t,n,e,o,r,i,u,a,c){return t.fold(n,e,o,r,i,u,a,c)},Of=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)},_f=function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)},Tf=kf.southeast,Ef=kf.southwest,Df=kf.northeast,Bf=kf.northwest,Af=kf.south,Mf=kf.north,Ff=kf.east,Rf=kf.west,If=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},Vf=function(t,n,e){return Math.min(Math.max(t,n),e)},Pf=function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}},Hf=function(t,n){return pt(["left","right","top","bottom"],function(e){return Rt(n,e).map(function(n){return Pf(t,n)})})},zf=function(t,n,e){var o=function(o,r){return n[o].map(function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a="left"===o||"top"===o?Math.max:Math.min,c=a(n,r)+u;return i?Vf(c,t.y,t.bottom):Vf(c,t.x,t.right)}).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return ir(r,i,u-r,a-i)},Nf="layout",Lf=function(t){return t.x},Wf=function(t,n){return t.x+t.width/2-n.width/2},Uf=function(t,n){return t.x+t.width-n.width},jf=function(t,n){return t.y-n.height},Gf=function(t){return t.y+t.height},Xf=function(t,n){return t.y+t.height/2-n.height/2},Yf=function(t){return t.x+t.width},qf=function(t,n){return t.x-n.width},Kf=function(t,n,e){return Sf(Lf(t),Gf(t),e.southeast(),Tf(),"southeast",Hf(t,{left:1,top:3}),Nf)},Jf=function(t,n,e){return Sf(Uf(t,n),Gf(t),e.southwest(),Ef(),"southwest",Hf(t,{right:0,top:3}),Nf)},$f=function(t,n,e){return Sf(Lf(t),jf(t,n),e.northeast(),Df(),"northeast",Hf(t,{left:1,bottom:2}),Nf)},Qf=function(t,n,e){return Sf(Uf(t,n),jf(t,n),e.northwest(),Bf(),"northwest",Hf(t,{right:0,bottom:2}),Nf)},Zf=function(t,n,e){return Sf(Wf(t,n),jf(t,n),e.north(),Mf(),"north",Hf(t,{bottom:2}),Nf)},tl=function(t,n,e){return Sf(Wf(t,n),Gf(t),e.south(),Af(),"south",Hf(t,{top:3}),Nf)},nl=function(t,n,e){return Sf(Yf(t),Xf(t,n),e.east(),Ff(),"east",Hf(t,{left:0}),Nf)},el=function(t,n,e){return Sf(qf(t,n),Xf(t,n),e.west(),Rf(),"west",Hf(t,{right:1}),Nf)},ol=function(){return[Kf,Jf,$f,Qf,tl,Zf,nl,el]},rl=function(){return[Jf,Kf,Qf,$f,tl,Zf,nl,el]},il=function(){return[$f,Qf,Kf,Jf,Zf,tl]},ul=function(){return[Qf,$f,Jf,Kf,Zf,tl]},al=function(){return[Kf,Jf,$f,Qf,tl,Zf]},cl=function(){return[Jf,Kf,Qf,$f,tl,Zf]},sl=function(t,n){return n.universal?t:rt(t,function(t){return J(n.channels,t)})},fl=function(t){return Pa([La(sa(),function(n,e){var o=t.channels,r=kt(o),i=e,u=sl(r,i);nt(u,function(t){var e=o[t],r=e.schema,u=Bi("channel["+t+"] data\nReceiver: "+cc(n.element),r,i.data);e.onReceive(n,u)})})])},ll=Object.freeze({__proto__:null,events:fl}),dl=[Hi("channels",_i(dr.value,ai([hf("onReceive"),eu("schema",gi())])))],ml=function(t,n,e){return tc(function(o){e(o,t,n)})},gl=function(t,n,e){return Za(function(o,r){e(o,t,n)})},pl=function(t,n,e,o,r,i){var u=ai(t),a=tu(n,[nu("config",t)]);return yl(u,a,n,e,o,r,i)},vl=function(t,n,e,o,r,i){var u=t,a=tu(n,[Ki("config",t)]);return yl(u,a,n,e,o,r,i)},hl=function(t,n,e){var o=function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:A(t)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)},function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))})};return Oc(o,e,n)},bl=function(t){return{key:t,value:void 0}},yl=function(n,e,o,r,i,u,a){var c=function(t){return Vt(t,o)?t[o]():j.none()},s=_t(i,function(t,n){return hl(o,t,n)}),f=_t(u,function(t,n){return Tc(t,n)}),l=z(z(z({},f),s),{revoke:t(bl,o),config:function(t){var e=Bi(o+"-config",n,t);return{key:o,value:{config:e,me:l,configAsRaw:kn(function(){return Bi(o+"-config",n,t)}),initialConfig:t,state:a}}},schema:A(e),exhibit:function(t,n){return Lt(c(t),Rt(r,"exhibit"),function(t,e){return e(n,t.config,t.state)}).getOrThunk(function(){return zc({})})},name:A(o),handlers:function(t){return c(t).map(function(t){var n=Rt(r,"events").getOr(function(){return{}});return n(t.config,t.state)}).getOr({})}});return l},xl=function(t){return ku(t)},wl=ai([Pi("fields"),Pi("name"),eu("active",{}),eu("apis",{}),eu("state",Fc),eu("extra",{})]),Sl=function(t){var n=Bi("Creating behaviour: "+t.name,wl,t);return pl(n.fields,n.name,n.active,n.apis,n.extra,n.state)},kl=ai([Pi("branchKey"),Pi("branches"),Pi("name"),eu("active",{}),eu("apis",{}),eu("state",Fc),eu("extra",{})]),Cl=function(t){var n=Bi("Creating behaviour: "+t.name,kl,t);return vl(Mi(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},Ol=A(void 0),_l=Sl({fields:dl,name:"receiving",active:ll}),Tl=function(t,n){return zc({classes:[],styles:n.useFixed()?{}:{position:"relative"}})},El=Object.freeze({__proto__:null,exhibit:Tl}),Dl=function(){return fn.fromDom(document)},Bl=function(t){return t.dom.focus()},Al=function(t){return t.dom.blur()},Ml=function(t){var n=Pe(t).dom;return t.dom===n.activeElement},Fl=function(t){return void 0===t&&(t=Dl()),j.from(t.dom.activeElement).map(fn.fromDom)},Rl=function(t){return Fl(Pe(t)).filter(function(n){return t.dom.contains(n.dom)})},Il=function(t,n){var e=Pe(n),o=Fl(e).bind(function(t){var e=function(n){return he(t,n)};return e(n)?j.some(n):Ls(n,e)}),r=t(n);return o.each(function(t){Fl(e).filter(function(n){return he(n,t)}).fold(function(){Bl(t)},T)}),r},Vl=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},Pl=function(t){return z(z({},t),{position:j.some(t.position)})},Hl=function(t,n){ro(t,Pl(n))},zl=gu.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Nl=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=u.width,f=u.height,l=r-(a+s),d=i-(c+f),m=j.some(a),g=j.some(c),p=j.some(l),v=j.some(d),h=j.none();return Cf(n.direction,function(){return Vl(t,m,g,h,h)},function(){return Vl(t,h,g,p,h)},function(){return Vl(t,m,h,h,v)},function(){return Vl(t,h,h,p,v)},function(){return Vl(t,m,g,h,h)},function(){return Vl(t,m,h,h,v)},function(){return Vl(t,m,g,h,h)},function(){return Vl(t,h,g,p,h)})},Ll=function(t,n){return t.fold(function(){var t=n.rect;return Vl("absolute",j.some(t.x),j.some(t.y),j.none(),j.none())},function(t,e,o,r){return Nl("absolute",n,t,e,o,r)},function(t,e,o,r){return Nl("fixed",n,t,e,o,r)})},Wl=function(n,e){var o=t(er,e),r=n.fold(o,o,function(){var t=Xo();return er(e).translate(-t.left,-t.top)}),i=To(e),u=vo(e);return ir(r.left,r.top,i,u)},Ul=function(t,n){return n.fold(function(){return t.fold(cr,cr,ir)},function(n){return t.fold(n,n,function(){var e=n(),o=jl(t,e.x,e.y);return ir(o.left,o.top,e.width,e.height)})})},jl=function(t,n,e){var o=yo(n,e),r=function(){var t=Xo();return o.translate(-t.left,-t.top)};return t.fold(A(o),A(o),r)},Gl=function(t,n,e,o){return t.fold(n,e,o)};zl.none;var Xl,Yl=zl.relative,ql=zl.fixed,Kl=function(t,n){return{anchorBox:t,origin:n}},Jl=function(t,n){return Kl(t,n)},$l="data-alloy-placement",Ql=function(t,n){qe(t,$l,n)},Zl=function(t){return $e(t,$l)},td=function(t){return Ze(t,$l)},nd=gu.generate([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),ed=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height,d=u>=e&&u<=r,m=a>=o&&a<=i,g=d&&m,p=c<=r&&c>=e,v=s<=i&&s>=o,h=p&&v,b=Math.min(f,u>=e?r-u:c-e),y=Math.min(l,a>=o?i-a:s-o);return{originInBounds:g,sizeInBounds:h,visibleW:b,visibleH:y}},od=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Vf(u,e,f),m=Vf(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m;return ir(d,m,g,p)},rd=function(t,n,e){var o=A(n.bottom-e.y),r=A(e.bottom-n.y),i=Of(t,r,r,o),u=A(n.right-e.x),a=A(e.right-n.x),c=_f(t,a,a,u);return{maxWidth:c,maxHeight:i}},id=function(t,n,e,o){var r=t.bubble,i=r.offset,u=zf(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=ir(a,c,n,e),f=ed(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,v=p?s:od(s,u),h=v.width>0&&v.height>0,b=rd(t.direction,v,o),y=b.maxWidth,x=b.maxHeight,w={rect:v,maxHeight:x,maxWidth:y,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?nd.fit(w):nd.nofit(w,m,g,h)},ud=function(n,e,o,r,i,u){var a=r.width,c=r.height,s=function(t,e,s,f,l){var d=t(o,r,i,n,u),m=id(d,a,c,u);return m.fold(A(m),function(t,n,o,r){var i=l===r?o>f||n>s:!l&&r;return i?m:nd.nofit(e,s,f,l)})},f=ut(e,function(n,e){var o=t(s,e);return n.fold(A(n),o)},nd.nofit({rect:o,maxHeight:r.height,maxWidth:r.width,direction:Tf(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:o.y},-1,-1,!1));return f.fold(M,M)},ad=function(t){var n=du(j.none()),e=function(){return n.get().each(t)},o=function(){e(),n.set(j.none())},r=function(){return n.get().isSome()},i=function(){return n.get()},u=function(t){e(),n.set(j.some(t))};return{clear:o,isSet:r,get:i,
set:u}},cd=function(){return ad(function(t){return t.destroy()})},sd=function(){return ad(function(t){return t.unbind()})},fd=function(){var t=cd(),n=function(n){return t.get().each(n)};return z(z({},t),{run:n})},ld=function(){var t=ad(T),n=function(n){return t.get().each(n)};return z(z({},t),{on:n})},dd=P,md=function(t,n,e){return Fo(t,n,dd,e)},gd=function(t,n,e){return Ro(t,n,dd,e)},pd=Bo,vd=["top","bottom","right","left"],hd="data-alloy-transition-timer",bd=function(t,n){return xs(t,n.classes)},yd=function(t,n,e){return e.exists(function(e){var o=t.mode;return"all"===o||e[o]!==n[o]})},xd=function(t,n){var e=function(t){return parseFloat(t).toFixed(3)};return Mt(n,function(n,o){var r=t[o].map(e),i=n.map(e);return!Ht(r,i)}).isSome()},wd=function(t){var n=function(n){var e=io(t,n),o=v(e)?e.split(/\s*,\s*/):[];return rt(o,nn)},e=function(t){if(v(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return Qt(t,"ms")?n:1e3*n}return 0},o=n("transition-delay"),r=n("transition-duration");return ut(r,function(t,n,r){var i=e(o[r])+e(n);return Math.max(t,i)},0)},Sd=function(t,n){var e,o=sd(),r=sd(),i=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return he(n.target,t)&&en(o)&&J(vd,n.raw.propertyName)},u=function(u){if(S(u)||i(u)){o.clear(),r.clear();var a=null==u?void 0:u.raw.type;(S(a)||a===na())&&(clearTimeout(e),Ze(t,hd),ys(t,n.classes))}},a=function(){o.set(md(t,na(),u)),r.set(md(t,ta(),u))};if("ontransitionstart"in t.dom)var c=md(t,ea(),function(t){i(t)&&(c.unbind(),a())});else a();var s=wd(t);requestAnimationFrame(function(){e=setTimeout(u,s+17),qe(t,hd,e)})},kd=function(t,n){bs(t,n.classes),$e(t,hd).each(function(n){clearTimeout(parseInt(n,10)),Ze(t,hd)}),Sd(t,n)},Cd=function(t,n,e,o,r,i){var u=yd(o,r,i);if(u||bd(t,o)){eo(t,"position",e.position);var a=Wl(n,t),c=Ll(n,z(z({},r),{rect:a})),s=pt(vd,function(t){return c[t]});xd(e,s)&&(ro(t,s),u&&kd(t,o),lo(t))}else ys(t,o.classes)},Od=function(t){return{width:To(t),height:vo(t)}},_d=function(t,n,e,o){fo(n,"max-height"),fo(n,"max-width");var r=Od(n);return ud(n,o.preference,t,r,e,o.bounds)},Td=function(t,n){var e=n.classes;ys(t,e.off),bs(t,e.on)},Ed=function(t,n,e){var o=e.maxHeightFunction;o(t,n.maxHeight)},Dd=function(t,n,e){var o=e.maxWidthFunction;o(t,n.maxWidth)},Bd=function(t,n,e){var o=Ll(e.origin,n);e.transition.each(function(r){Cd(t,e.origin,o,r,n,e.lastPlacement)}),Hl(t,o)},Ad=function(t,n){Ql(t,n.placement)},Md=function(t,n){ho(t,Math.floor(n))},Fd=A(function(t,n){Md(t,n),oo(t,{"overflow-x":"hidden","overflow-y":"auto"})}),Rd=A(function(t,n){Md(t,n)}),Id=function(t,n,e){return void 0===t[n]?e:t[n]},Vd=function(t,n,e,o,r,i,u,a){var c=Id(u,"maxHeightFunction",Fd()),s=Id(u,"maxWidthFunction",T),f=t.anchorBox,l=t.origin,d={bounds:Ul(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a};return Pd(f,n,e,d)},Pd=function(t,n,e,o){var r=_d(t,n,e,o);return Bd(n,r,o),Ad(n,r),Td(n,r),Ed(n,r,o),Dd(n,r,o),{layout:r.layout,placement:r.placement}},Hd=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],zd=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return Rt(e,t).getOr([])},a=function(t,n,e){var o=gt(Hd,e);return{offset:yo(t,n),classesOn:lt(e,u),classesOff:lt(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},Nd=function(){return zd(0,0,{})},Ld=M,Wd=function(t,n){return function(e){return"rtl"===Ud(e)?n:t}},Ud=function(t){return"rtl"===io(t,"direction")?"rtl":"ltr"};(function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"})(Xl||(Xl={}));var jd="data-alloy-vertical-dir",Gd=function(t){return Ws(t,function(t){return yn(t)&&Je(t,"data-alloy-vertical-dir")===Xl.BottomToTop})},Xd=function(){return tu("layouts",[Pi("onLtr"),Pi("onRtl"),qi("onBottomLtr"),qi("onBottomRtl")])},Yd=function(t,n,e,o,r,i,u){var a=u.map(Gd).getOr(!1),c=n.layouts.map(function(n){return n.onLtr(t)}),s=n.layouts.map(function(n){return n.onRtl(t)}),f=a?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(t)})}).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(t)})}).or(s).getOr(i):s.getOr(o),d=Wd(f,l);return d(t)},qd=function(t,n,e){var o=n.hotspot,r=Wl(e,o.element),i=Yd(t.element,n,al(),cl(),il(),ul(),j.some(n.hotspot.element));return j.some(Ld({anchorBox:r,bubble:n.bubble.getOr(Nd()),overrides:n.overrides,layouts:i,placer:j.none()}))},Kd=[Pi("hotspot"),qi("bubble"),eu("overrides",{}),Xd(),yf("placement",qd)],Jd=function(t,n,e){var o=jl(e,n.x,n.y),r=ir(o.left,o.top,n.width,n.height),i=Yd(t.element,n,ol(),rl(),ol(),rl(),j.none());return j.some(Ld({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:j.none()}))},$d=[Pi("x"),Pi("y"),eu("height",0),eu("width",0),eu("bubble",Nd()),eu("overrides",{}),Xd(),yf("placement",Jd)],Qd=gu.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Zd=function(t){return t.fold(M,function(t,n,e){return t.translate(-n,-e)})},tm=function(t){return t.fold(M,M)},nm=function(t){return ut(t,function(t,n){return t.translate(n.left,n.top)},yo(0,0))},em=function(t){var n=tt(t,Zd);return nm(n)},om=function(t){var n=tt(t,tm);return nm(n)},rm=Qd.screen,im=Qd.absolute,um=function(t,n,e){var o=Ce(e.root).dom,r=function(n){var e=we(n),o=we(t.element);return he(e,o)};return j.from(o.frameElement).map(fn.fromDom).filter(r).map(So)},am=function(t,n,e){var o=we(t.element),r=Xo(o),i=um(t,n,e).getOr(r);return im(i,r.left,r.top)},cm=function(t,n,e,o){var r=rm(yo(t,n));return j.some(or(r,e,o))},sm=function(t,n,e,o,r){return t.map(function(t){var i=[n,t.point],u=Gl(o,function(){return om(i)},function(){return om(i)},function(){return em(i)}),a=rr(u.left,u.top,t.width,t.height),c=e.showAbove?il():al(),s=e.showAbove?ul():cl(),f=Yd(r,e,c,s,c,s,j.none());return Ld({anchorBox:a,bubble:e.bubble.getOr(Nd()),overrides:e.overrides,layouts:f,placer:j.none()})})},fm=function(t,n,e){var o=am(t,e,n);return n.node.filter(je).bind(function(r){var i=r.dom.getBoundingClientRect(),u=cm(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return sm(u,o,n,e,a)})},lm=[Pi("node"),Pi("root"),qi("bubble"),Xd(),eu("overrides",{}),eu("showAbove",!1),yf("placement",fm)],dm="\ufeff",mm="",gm=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},pm={create:gm},vm=gu.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),hm=function(t,n,e,o){return t.fold(n,e,o)},bm=function(t){return t.fold(M,M,M)},ym=vm.before,xm=vm.on,wm=vm.after,Sm={before:ym,on:xm,after:wm,cata:hm,getStart:bm},km=gu.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Cm=function(t){return km.exact(t.start,t.soffset,t.finish,t.foffset)},Om=function(t){return t.match({domRange:function(t){return fn.fromDom(t.startContainer)},relative:function(t,n){return Sm.getStart(t)},exact:function(t,n,e,o){return t}})},_m=km.domRange,Tm=km.relative,Em=km.exact,Dm=function(t){var n=Om(t);return Ce(n)},Bm=pm.create,Am={domRange:_m,relative:Tm,exact:Em,exactFromRange:Cm,getWin:Dm,range:Bm},Mm=function(t,n){n.fold(function(n){t.setStartBefore(n.dom)},function(n,e){t.setStart(n.dom,e)},function(n){t.setStartAfter(n.dom)})},Fm=function(t,n){n.fold(function(n){t.setEndBefore(n.dom)},function(n,e){t.setEnd(n.dom,e)},function(n){t.setEndAfter(n.dom)})},Rm=function(t,n,e){var o=t.document.createRange();return Mm(o,n),Fm(o,e),o},Im=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Vm=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Pm=function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?j.some(e).map(Vm):j.none()},Hm=function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?j.some(n).map(Vm):j.none()},zm=gu.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Nm=function(t,n,e){return n(fn.fromDom(e.startContainer),e.startOffset,fn.fromDom(e.endContainer),e.endOffset)},Lm=function(t,n){return n.match({domRange:function(t){return{ltr:A(t),rtl:j.none}},relative:function(n,e){return{ltr:kn(function(){return Rm(t,n,e)}),rtl:kn(function(){return j.some(Rm(t,e,n))})}},exact:function(n,e,o,r){return{ltr:kn(function(){return Im(t,n,e,o,r)}),rtl:kn(function(){return j.some(Im(t,o,r,n,e))})}}})},Wm=function(t,n){var e=n.ltr();if(e.collapsed){var o=n.rtl().filter(function(t){return!1===t.collapsed});return o.map(function(t){return zm.rtl(fn.fromDom(t.endContainer),t.endOffset,fn.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Nm(t,zm.ltr,e)})}return Nm(t,zm.ltr,e)},Um=function(t,n){var e=Lm(t,n);return Wm(t,e)},jm=function(t,n){var e=Um(t,n);return e.match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};zm.ltr,zm.rtl;var Gm,Xm=function(t,n){var e=function(e){if(!t(e))throw new Error("Can only get "+n+" value of a "+n+" node");return o(e).getOr("")},o=function(n){return t(n)?j.from(n.dom.nodeValue):j.none()},r=function(e,o){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=o};return{get:e,getOption:o,set:r}},Ym=Xm(xn,"text"),qm=function(t){return Ym.get(t)},Km=function(t){return Ym.getOption(t)},Jm=function(t){return"img"===vn(t)?1:Km(t).fold(function(){return De(t).length},function(t){return t.length})},$m=function(t){return Km(t).filter(function(t){return 0!==t.trim().length||t.indexOf(mm)>-1}).isSome()},Qm=["img","br"],Zm=function(t){var n=$m(t);return n||J(Qm,vn(t))},tg=function(t){return ng(t,Zm)},ng=function(t,n){var e=function(t){for(var o=De(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return j.some(i);var u=e(i);if(u.isSome())return u}return j.none()};return e(t)},eg=function(t,n){return pe(n,t)},og=function(t,n,e,o){var r=we(t),i=r.dom.createRange();return i.setStart(t.dom,n),i.setEnd(e.dom,o),i},rg=function(t,n,e,o){var r=og(t,n,e,o),i=he(t,e)&&n===o;return r.collapsed&&!i},ig=function(t){return j.from(t.getSelection())},ug=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return j.some(pm.create(fn.fromDom(n.startContainer),n.startOffset,fn.fromDom(e.endContainer),e.endOffset))}return j.none()},ag=function(t){if(null===t.anchorNode||null===t.focusNode)return ug(t);var n=fn.fromDom(t.anchorNode),e=fn.fromDom(t.focusNode);return rg(n,t.anchorOffset,e,t.focusOffset)?j.some(pm.create(n,t.anchorOffset,e,t.focusOffset)):ug(t)},cg=function(t){return ig(t).filter(function(t){return t.rangeCount>0}).bind(ag)},sg=function(t,n){var e=jm(t,n);return Pm(e)},fg=function(t,n){var e=jm(t,n);return Hm(e)},lg=function(t,n){return{element:t,offset:n}},dg=function(t,n){var e=De(t);if(0===e.length)return lg(t,n);if(n<e.length)return lg(e[n],0);var o=e[e.length-1],r=xn(o)?qm(o).length:De(o).length;return lg(o,r)},mg=function(t,n){return xn(t)?lg(t,n):dg(t,n)},gg=function(t,n){var e=n.getSelection.getOrThunk(function(){return function(){return cg(t)}});return e().map(function(t){var n=mg(t.start,t.soffset),e=mg(t.finish,t.foffset);return Am.range(n.element,n.offset,e.element,e.offset)})},pg=function(t,n,e){var o=Ce(n.root).dom,r=am(t,e,n),i=gg(o,n).bind(function(t){var n=fg(o,Am.exactFromRange(t)).orThunk(function(){var n=fn.fromText(dm);Vo(t.start,n);var e=sg(o,Am.exact(n,0,n,1));return jo(n),e});return n.bind(function(t){return cm(t.left,t.top,t.width,t.height)})}),u=gg(o,n).bind(function(t){return yn(t.start)?j.some(t.start):_e(t.start)}),a=u.getOr(t.element);return sm(i,r,n,e,a)},vg=[qi("getSelection"),Pi("root"),qi("bubble"),Xd(),eu("overrides",{}),eu("showAbove",!1),yf("placement",pg)],hg="link-layout",bg=function(t){return t.x+t.width},yg=function(t,n){return t.x-n.width},xg=function(t,n){return t.y-n.height+t.height},wg=function(t){return t.y},Sg=function(t,n,e){return Sf(bg(t),wg(t),e.southeast(),Tf(),"southeast",Hf(t,{left:0,top:2}),hg)},kg=function(t,n,e){return Sf(yg(t,n),wg(t),e.southwest(),Ef(),"southwest",Hf(t,{right:1,top:2}),hg)},Cg=function(t,n,e){return Sf(bg(t),xg(t,n),e.northeast(),Df(),"northeast",Hf(t,{left:0,bottom:3}),hg)},Og=function(t,n,e){return Sf(yg(t,n),xg(t,n),e.northwest(),Bf(),"northwest",Hf(t,{right:1,bottom:3}),hg)},_g=function(){return[Sg,kg,Cg,Og]},Tg=function(){return[kg,Sg,Og,Cg]},Eg=function(t,n,e){var o=Wl(e,n.item.element),r=Yd(t.element,n,_g(),Tg(),_g(),Tg(),j.none());return j.some(Ld({anchorBox:o,bubble:Nd(),overrides:n.overrides,layouts:r,placer:j.none()}))},Dg=[Pi("item"),Xd(),eu("overrides",{}),yf("placement",Eg)],Bg=Mi("type",{selection:vg,node:lm,hotspot:Kd,submenu:Dg,makeshift:$d}),Ag=[Yi("classes",hi),uu("mode","all",["all","layout","placement"])],Mg=[eu("useFixed",V),qi("getBounds")],Fg=[Hi("anchor",Bg),tu("transition",Ag)],Rg=function(){var t=document.documentElement;return ql(0,0,t.clientWidth,t.clientHeight)},Ig=function(t){var n=So(t.element),e=t.element.dom.getBoundingClientRect();return Yl(n.left,n.top,e.width,e.height)},Vg=function(t,n,e,o,r,i,u){var a=Jl(e.anchorBox,n);return Vd(a,r.element,e.bubble,e.layouts,i,o,e.overrides,u)},Pg=function(t,n,e,o,r){Hg(t,n,e,o,r,j.none())},Hg=function(t,n,e,o,r,i){var u=i.map(ur);return zg(t,n,e,o,r,u)},zg=function(t,n,e,o,r,i){var u=Bi("placement.info",ci(Fg),r),a=u.anchor,c=o.element,s=e.get(o.uid);Il(function(){eo(c,"position","fixed");var r=ao(c,"visibility");eo(c,"visibility","hidden");var f=n.useFixed()?Rg():Ig(t),l=a.placement,d=i.map(A).or(n.getBounds);l(t,a,f).each(function(n){var r=n.placer.getOr(Vg),i=r(t,f,n,d,o,s,u.transition);e.set(o.uid,i)}),r.fold(function(){fo(c,"visibility")},function(t){eo(c,"visibility",t)}),ao(c,"left").isNone()&&ao(c,"top").isNone()&&ao(c,"right").isNone()&&ao(c,"bottom").isNone()&&Pt(ao(c,"position"),"fixed")&&fo(c,"position")},c)},Ng=function(t,n,e){return n.useFixed()?"fixed":"absolute"},Lg=function(t,n,e,o){var r=o.element;nt(["position","left","right","top","bottom"],function(t){return fo(r,t)}),td(r),e.clear(o.uid)},Wg=Object.freeze({__proto__:null,position:Pg,positionWithin:Hg,positionWithinBounds:zg,getMode:Ng,reset:Lg}),Ug=function(){var t={},n=function(n,e){t[n]=e},e=function(n){return Rt(t,n)},o=function(n){k(n)?delete t[n]:t={}};return Rc({readState:function(){return t},clear:o,set:n,get:e})},jg=Object.freeze({__proto__:null,init:Ug}),Gg=Sl({fields:Mg,name:"positioning",active:El,apis:Wg,state:jg}),Xg=function(t){Aa(t,Sa());var n=t.components();nt(n,Xg)},Yg=function(t){var n=t.components();nt(n,Yg),Aa(t,wa())},qg=function(t,n){zo(t.element,n.element)},Kg=function(t){nt(t.components(),function(t){return jo(t.element)}),Uo(t.element),t.syncComponents()},Jg=function(t,n){var e=t.components();Kg(t);var o=gt(e,n);nt(o,function(n){Xg(n),t.getSystem().removeFromWorld(n)}),nt(n,function(n){n.getSystem().isConnected()?qg(t,n):(t.getSystem().addToWorld(n),qg(t,n),je(t.element)&&Yg(n)),t.syncComponents()})},$g=function(t,n){Qg(t,n,zo)},Qg=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),je(t.element)&&Yg(n),t.syncComponents()},Zg=function(t){Xg(t),jo(t.element),t.getSystem().removeFromWorld(t)},tp=function(t){var n=Oe(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()});Zg(t),n.each(function(t){t.syncComponents()})},np=function(t){var n=t.components();nt(n,Zg),Uo(t.element),t.syncComponents()},ep=function(t,n){rp(t,n,zo)},op=function(t,n){rp(t,n,Po)},rp=function(t,n,e){e(t,n.element);var o=De(n.element);nt(o,function(t){n.getByDom(t).each(Yg)})},ip=function(t){var n=De(t.element);nt(n,function(n){t.getByDom(n).each(Xg)}),jo(t.element)},up=function(t,n,e,o){e.get().each(function(n){np(t)});var r=n.getAttachPoint(t);$g(r,t);var i=t.getSystem().build(o);return $g(t,i),e.set(i),i},ap=function(t,n,e,o){var r=up(t,n,e,o);return n.onOpen(t,r),r},cp=function(t,n,e,o){return e.get().map(function(){return up(t,n,e,o)})},sp=function(t,n,e,o,r){vp(t,n),ap(t,n,e,o),r(),bp(t,n)},fp=function(t,n,e){e.get().each(function(o){np(t),tp(t),n.onClose(t,o),e.clear()})},lp=function(t,n,e){return e.isOpen()},dp=function(t,n,e,o){return lp(t,n,e)&&e.get().exists(function(e){return n.isPartOf(t,e,o)})},mp=function(t,n,e){return e.get()},gp=function(t,n,e,o){ao(t.element,n).fold(function(){Ze(t.element,e)},function(n){qe(t.element,e,n)}),eo(t.element,n,o)},pp=function(t,n,e){$e(t.element,e).fold(function(){return fo(t.element,n)},function(e){return eo(t.element,n,e)})},vp=function(t,n,e){var o=n.getAttachPoint(t);eo(t.element,"position",Gg.getMode(o)),gp(t,"visibility",n.cloakVisibilityAttr,"hidden")},hp=function(t){return $(["top","left","right","bottom"],function(n){return ao(t,n).isSome()})},bp=function(t,n,e){hp(t.element)||fo(t.element,"position"),pp(t,"visibility",n.cloakVisibilityAttr)},yp=Object.freeze({__proto__:null,cloak:vp,decloak:bp,open:ap,openWhileCloaked:sp,close:fp,isOpen:lp,isPartOf:dp,getState:mp,setContent:cp}),xp=function(t,n){return Pa([La(ga(),function(e,o){fp(e,t,n)})])},wp=Object.freeze({__proto__:null,events:xp}),Sp=[pf("onOpen"),pf("onClose"),Pi("isPartOf"),Pi("getAttachPoint"),eu("cloakVisibilityAttr","data-precloak-visibility")],kp=function(){var t=ld(),n=A("not-implemented");return Rc({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})},Cp=Object.freeze({__proto__:null,init:kp}),Op=Sl({fields:Sp,name:"sandboxing",active:wp,apis:yp,state:Cp}),_p=A("dismiss.popups"),Tp=A("reposition.popups"),Ep=A("mouse.released"),Dp=ai([eu("isExtraPart",V),tu("fireEventInstead",[eu("event",ka())])]),Bp=function(t){var n,e=Bi("Dismissal",Dp,t);return n={},n[_p()]={schema:ai([Pi("target")]),onReceive:function(t,n){if(Op.isOpen(t)){var o=Op.isPartOf(t,n.target)||e.isExtraPart(t,n.target);o||e.fireEventInstead.fold(function(){return Op.close(t)},function(n){return Aa(t,n.event)})}}},n},Ap=ai([tu("fireEventInstead",[eu("event",Ca())]),Ui("doReposition")]),Mp=function(t){var n,e=Bi("Reposition",Ap,t);return n={},n[Tp()]={onReceive:function(t){Op.isOpen(t)&&e.fireEventInstead.fold(function(){return e.doReposition(t)},function(n){return Aa(t,n.event)})}},n},Fp=function(t,n,e){n.store.Receptionist.onLoad(t,n,e)},Rp=function(t,n,e){n.store.Receptionist.onUnload(t,n,e)},Ip=function(t,n,e,o){n.store.Receptionist.setValue(t,n,e,o)},Vp=function(t,n,e){return n.store.Receptionist.getValue(t,n,e)},Pp=function(t,n,e){return e},Hp=Object.freeze({__proto__:null,onLoad:Fp,onUnload:Rp,setValue:Ip,getValue:Vp,getState:Pp}),zp=function(t,n){var e=t.resetOnDom?[$a(function(e,o){Fp(e,t,n)}),Qa(function(e,o){Rp(e,t,n)})]:[gl(t,n,Fp)];return Pa(e)},Np=Object.freeze({__proto__:null,events:zp}),Lp=function(){var t=du(null),n=function(){return{mode:"memory",value:t.get()}},e=function(){return null===t.get()},o=function(){t.set(null)};return Rc({set:t.set,get:t.get,isNotSet:e,clear:o,readState:n})},Wp=function(){var t=T;return Rc({readState:t})},Up=function(){var t=du({}),n=du({}),e=function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},o=function(){t.set({}),n.set({})},r=function(e){return Rt(t.get(),e).orThunk(function(){return Rt(n.get(),e)})},i=function(e){var o=t.get(),r=n.get(),i={},u={};nt(e,function(t){i[t.value]=t,Rt(t,"meta").each(function(n){Rt(n,"text").each(function(n){u[n]=t})})}),t.set(z(z({},o),i)),n.set(z(z({},r),u))};return Rc({readState:e,lookup:r,update:i,clear:o})},jp=function(t){return t.store.Receptionist.state(t)},Gp=Object.freeze({__proto__:null,memory:Lp,dataset:Up,manual:Wp,init:jp}),Xp=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},Yp=function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk(function(){return o.getFallbackEntry(r)})},qp=function(t,n,e){var o=n.store;o.initialValue.each(function(o){Xp(t,n,e,o)})},Kp=function(t,n,e){e.clear()},Jp=[qi("initialValue"),Pi("getFallbackEntry"),Pi("getDataKey"),Pi("setValue"),yf("Receptionist",{setValue:Xp,getValue:Yp,onLoad:qp,onUnload:Kp,state:Up})],$p=function(t,n,e){return n.store.getValue(t)},Qp=function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},Zp=function(t,n,e){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},tv=[Pi("getValue"),eu("setValue",T),qi("initialValue"),yf("Receptionist",{setValue:Qp,getValue:$p,onLoad:Zp,onUnload:T,state:Fc.init})],nv=function(t,n,e,o){e.set(o),n.onSetValue(t,o)},ev=function(t,n,e){return e.get()},ov=function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},rv=function(t,n,e){e.clear()},iv=[qi("initialValue"),yf("Receptionist",{setValue:nv,getValue:ev,onLoad:ov,onUnload:rv,state:Lp})],uv=[ou("store",{mode:"memory"},Mi("mode",{memory:iv,manual:tv,dataset:Jp})),pf("onSetValue"),eu("resetOnDom",!1)],av=Sl({fields:uv,name:"representing",active:Np,apis:Hp,extra:{setValueFrom:function(t,n){var e=av.getValue(n);av.setValue(t,e)}},state:Gp}),cv=function(t,n){return lu(t,{},tt(n,function(n){return ji(n.name(),"Cannot configure "+n.name()+" for "+t)}).concat([Ii("dump",M)]))},sv=function(t){return t.dump},fv=function(t,n){return z(z({},xl(n)),t.dump)},lv={field:cv,augment:fv,get:sv},dv="placeholder",mv=gu.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),gv=function(t){return It(t,"uiType")},pv=function(t,n,e,o){return t.exists(function(t){return t!==e.owner})?mv.single(!0,A(e)):Rt(o,e.name).fold(function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+kt(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))},function(t){return t.replace()})},vv=function(t,n,e,o){return gv(e)&&e.uiType===dv?pv(t,n,e,o):mv.single(!1,A(e))},hv=function(t,n,e,o){var r=vv(t,n,e,o);return r.fold(function(r,i){var u=gv(e)?i(n,e.config,e.validated):i(n),a=Rt(u,"components").getOr([]),c=lt(a,function(e){return hv(t,n,e,o)});return[z(z({},u),{components:c})]},function(t,o){if(gv(e)){var r=o(n,e.config,e.validated),i=e.validated.preprocess.getOr(M);return i(r)}return o(n)})},bv=function(t,n,e,o){return lt(e,function(e){return hv(t,n,e,o)})},yv=function(t,n){var e=!1,o=function(){return e},r=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+t);return e=!0,n},i=function(){return n.fold(function(t,n){return t},function(t,n){return t})};return{name:A(t),required:i,used:o,replace:r}},xv=function(t,n,e,o){var r=_t(o,function(t,n){return yv(n,t)}),i=bv(t,n,e,r);return Ot(r,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))}),i},wv=mv.single,Sv=mv.multiple,kv=A(dv),Cv=gu.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ov=eu("factory",{sketch:M}),_v=eu("schema",[]),Tv=Pi("name"),Ev=Ri("pname","pname",Fr(function(t){return"<alloy."+mc(t.name)+">"}),gi()),Dv=Ii("schema",function(){return[qi("preprocess")]}),Bv=eu("defaults",A({})),Av=eu("overrides",A({})),Mv=ci([Ov,_v,Tv,Ev,Bv,Av]),Fv=ci([Ov,_v,Tv,Bv,Av]),Rv=ci([Ov,_v,Tv,Ev,Bv,Av]),Iv=ci([Ov,Dv,Tv,Pi("unit"),Ev,Bv,Av]),Vv=function(t){return t.fold(j.some,j.none,j.some,j.some)},Pv=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Hv=function(t){return t.fold(M,M,M,M)},zv=function(t,n){return function(e){var o=Bi("Converting part type",n,e);return t(o)}},Nv=zv(Cv.required,Mv),Lv=zv(Cv.external,Fv),Wv=zv(Cv.optional,Rv),Uv=zv(Cv.group,Iv),jv=A("entirety"),Gv=Object.freeze({__proto__:null,required:Nv,external:Lv,optional:Wv,group:Uv,asNamedPart:Vv,name:Pv,asCommon:Hv,original:jv}),Xv=function(t,n,e,o){return Br(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Yv=function(t,n,e){var o={},r={};return nt(e,function(t){t.fold(function(t){o[t.pname]=wv(!0,function(n,e,o){return t.factory.sketch(Xv(n,t,e,o))})},function(t){var e=n.parts[t.name];r[t.name]=A(t.factory.sketch(Xv(n,t,e[jv()]),e))},function(t){o[t.pname]=wv(!1,function(n,e,o){return t.factory.sketch(Xv(n,t,e,o))})},function(t){o[t.pname]=Sv(!0,function(n,e,o){var r=n[t.name];return tt(r,function(e){return t.factory.sketch(Br(t.defaults(n,e,o),e,t.overrides(n,e)))})})})}),{internals:A(o),externals:A(r)}},qv=function(t,n){var e={};return nt(n,function(n){Vv(n).each(function(n){var o=Kv(t,n.pname);e[n.name]=function(e){var r=Bi("Part: "+n.name+" in "+t,ci(n.schema),e);return z(z({},o),{config:e,validated:r})}})}),e},Kv=function(t,n){return{uiType:kv(),owner:t,name:n}},Jv=function(t,n,e){return{uiType:kv(),owner:t,name:n,config:e,validated:{}}},$v=function(t){return lt(t,function(t){return t.fold(j.none,j.some,j.none,j.none).map(function(t){return Gi(t.name,t.schema.concat([xf(jv())]))}).toArray()})},Qv=function(t){return tt(t,Pv)},Zv=function(t,n,e){return Yv(t,n,e)},th=function(t,n,e){return xv(j.some(t),n,n.components,e)},nh=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},eh=function(t,n,e){return nh(t,n,e).getOrDie("Could not find part: "+e)},oh=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return nt(e,function(t){o[t]=A(i.getByUid(r[t]))}),o},rh=function(t,n){var e=t.getSystem();return _t(n.partUids,function(t,n){return A(e.getByUid(t))})},ih=function(t){return kt(t.partUids)},uh=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return nt(e,function(t){o[t]=A(i.getByUid(r[t]).getOrDie())}),o},ah=function(t,n){var e=Qv(n);return ku(tt(e,function(n){return{key:n,value:t+"-"+n}}))},ch=function(t){return Ri("partUids","partUids",Vr(function(n){return ah(n.uid,t)}),gi())},sh=Object.freeze({__proto__:null,generate:qv,generateOne:Jv,schemas:$v,names:Qv,substitutes:Zv,components:th,defaultUids:ah,defaultUidsSchema:ch,getAllParts:rh,getAllPartNames:ih,getPart:nh,getPartOrDie:eh,getParts:oh,getPartsOrDie:uh}),fh=function(t,n){var e=t.length>0?[Gi("parts",t)]:[];return e.concat([Pi("uid"),eu("dom",{}),eu("components",[]),xf("originalSpec"),eu("debug.sketcher",{})]).concat(n)},lh=function(t,n,e,o,r){var i=fh(o,r);return Bi(t+" [SpecSchema]",ai(i.concat(n)),e)},dh=function(t,n,e,o){var r=ph(o),i=lh(t,n,r,[],[]);return e(i,r)},mh=function(t,n,e,o,r){var i=ph(r),u=$v(e),a=ch(e),c=lh(t,n,i,u,[a]),s=Zv(t,c,e),f=th(t,c,s.internals());return o(c,f,i,s.externals())},gh=function(t){return It(t,"uid")},ph=function(t){return gh(t)?t:z(z({},t),{uid:wc("uid")})},vh=function(t){return void 0!==t.uid},hh=ai([Pi("name"),Pi("factory"),Pi("configFields"),eu("apis",{}),eu("extraApis",{})]),bh=ai([Pi("name"),Pi("factory"),Pi("configFields"),Pi("partFields"),eu("apis",{}),eu("extraApis",{})]),yh=function(t){var n=Bi("Sketcher for "+t.name,hh,t),e=function(t){return dh(n.name,n.configFields,n.factory,t)},o=_t(n.apis,Mc),r=_t(n.extraApis,function(t,n){return Tc(t,n)});return z(z({name:n.name,configFields:n.configFields,sketch:e},o),r)},xh=function(t){var n=Bi("Sketcher for "+t.name,bh,t),e=function(t){return mh(n.name,n.configFields,n.partFields,n.factory,t)},o=qv(n.name,n.partFields),r=_t(n.apis,Mc),i=_t(n.extraApis,function(t,n){return Tc(t,n)});return z(z({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:e,parts:o},r),i)},wh=function(t){return"input"===vn(t)&&"radio"!==Je(t,"type")||"textarea"===vn(t)},Sh=function(t,n,e){return n.find(t)},kh=Object.freeze({__proto__:null,getCurrent:Sh}),Ch=[Pi("find")],Oh=Sl({fields:Ch,name:"composing",apis:kh}),_h=["input","button","textarea","select"],Th=function(t,n,e){var o=n.disabled()?Ih:Vh;o(t,n)},Eh=function(t,n){return!0===n.useNative&&J(_h,vn(t.element))},Dh=function(t){return Qe(t.element,"disabled")},Bh=function(t){qe(t.element,"disabled","disabled")},Ah=function(t){Ze(t.element,"disabled")},Mh=function(t){return"true"===Je(t.element,"aria-disabled")},Fh=function(t){qe(t.element,"aria-disabled","true")},Rh=function(t){qe(t.element,"aria-disabled","false")},Ih=function(t,n,e){n.disableClass.each(function(n){gs(t.element,n)});var o=Eh(t,n)?Bh:Fh;o(t),n.onDisabled(t)},Vh=function(t,n,e){n.disableClass.each(function(n){vs(t.element,n)});var o=Eh(t,n)?Ah:Rh;o(t),n.onEnabled(t)},Ph=function(t,n){return Eh(t,n)?Dh(t):Mh(t)},Hh=function(t,n,e,o){var r=o?Ih:Vh;r(t,n)},zh=Object.freeze({__proto__:null,enable:Vh,disable:Ih,isDisabled:Ph,onLoad:Th,set:Hh}),Nh=function(t,n){return zc({classes:n.disabled()?n.disableClass.toArray():[]})},Lh=function(t,n){return Pa([Ha(fa(),function(n,e){return Ph(n,t)}),gl(t,n,Th)])},Wh=Object.freeze({__proto__:null,exhibit:Nh,events:Lh}),Uh=[cu("disabled",V),eu("useNative",!0),qi("disableClass"),pf("onDisabled"),pf("onEnabled")],jh=Sl({fields:Uh,name:"disabling",active:Wh,apis:zh}),Gh=function(t,n,e,o){var r=eg(t.element,"."+n.highlightClass);nt(r,function(e){$(o,function(t){return t.element===e})||(vs(e,n.highlightClass),t.getSystem().getByDom(e).each(function(e){n.onDehighlight(t,e),Aa(e,Ba())}))})},Xh=function(t,n,e){return Gh(t,n,e,[])},Yh=function(t,n,e,o){Zh(t,n,e,o)&&(vs(o.element,n.highlightClass),n.onDehighlight(t,o),Aa(o,Ba()))},qh=function(t,n,e,o){Gh(t,n,e,[o]),Zh(t,n,e,o)||(gs(o.element,n.highlightClass),n.onHighlight(t,o),Aa(o,Da()))},Kh=function(t,n,e){eb(t,n).each(function(o){qh(t,n,e,o)})},Jh=function(t,n,e){ob(t,n).each(function(o){qh(t,n,e,o)})},$h=function(t,n,e,o){nb(t,n,e,o).fold(function(t){throw t},function(o){qh(t,n,e,o)})},Qh=function(t,n,e,o){var r=ab(t,n),i=ct(r,o);i.each(function(o){qh(t,n,e,o)})},Zh=function(t,n,e,o){return hs(o.element,n.highlightClass)},tb=function(t,n,e){return Gs(t.element,"."+n.highlightClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},nb=function(t,n,e,o){var r=eg(t.element,"."+n.itemClass);return j.from(r[o]).fold(function(){return dr.error(new Error("No element found with index "+o))},t.getSystem().getByDom)},eb=function(t,n,e){return Gs(t.element,"."+n.itemClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},ob=function(t,n,e){var o=eg(t.element,"."+n.itemClass),r=o.length>0?j.some(o[o.length-1]):j.none();return r.bind(function(n){return t.getSystem().getByDom(n).toOptional()})},rb=function(t,n,e,o){var r=eg(t.element,"."+n.itemClass),i=st(r,function(t){return hs(t,n.highlightClass)});return i.bind(function(n){var e=If(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})},ib=function(t,n,e){return rb(t,n,e,-1)},ub=function(t,n,e){return rb(t,n,e,1)},ab=function(t,n,e){var o=eg(t.element,"."+n.itemClass);return zt(tt(o,function(n){return t.getSystem().getByDom(n).toOptional()}))},cb=Object.freeze({__proto__:null,dehighlightAll:Xh,dehighlight:Yh,highlight:qh,highlightFirst:Kh,highlightLast:Jh,highlightAt:$h,highlightBy:Qh,isHighlighted:Zh,getHighlighted:tb,getFirst:eb,getLast:ob,getPrevious:ib,getNext:ub,getCandidates:ab}),sb=[Pi("highlightClass"),Pi("itemClass"),pf("onHighlight"),pf("onDehighlight")],fb=Sl({fields:sb,name:"highlighting",apis:cb}),lb=[8],db=[9],mb=[13],gb=[27],pb=[32],vb=[37],hb=[38],bb=[39],yb=[40],xb=function(t,n,e){var o=mt(t.slice(0,n)),r=mt(t.slice(n+1));return ct(o.concat(r),e)
},wb=function(t,n,e){var o=mt(t.slice(0,n));return ct(o,e)},Sb=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return ct(r.concat(o),e)},kb=function(t,n,e){var o=t.slice(n+1);return ct(o,e)},Cb=function(t){return function(n){var e=n.raw;return J(t,e.which)}},Ob=function(t){return function(n){return dt(t,function(t){return t(n)})}},_b=function(t){var n=t.raw;return!0===n.shiftKey},Tb=function(t){var n=t.raw;return!0===n.ctrlKey},Eb=R(_b),Db=function(t,n){return{matches:t,classification:n}},Bb=function(t,n){var e=ct(t,function(t){return t.matches(n)});return e.map(function(t){return t.classification})},Ab=function(t,n,e){var o=n.exists(function(t){return e.exists(function(n){return he(n,t)})});o||Ma(t,Oa(),{prevFocus:n,newFocus:e})},Mb=function(){var t=function(t){return Rl(t.element)},n=function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Ab(n,o,r)};return{get:t,set:n}},Fb=function(){var t=function(t){return fb.getHighlighted(t).map(function(t){return t.element})},n=function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(T,function(t){fb.highlight(n,t)});var r=t(n);Ab(n,o,r)};return{get:t,set:n}};(function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"})(Gm||(Gm={}));var Rb,Ib=function(t,n,e,o,r){var i=function(){return t.concat([eu("focusReceptionist",Mb()),ou("focusInside","onFocus",Oi(function(t){return J(["onFocus","onEnterOrSpace","onApi"],t)?dr.value(t):dr.error("Invalid value for focusInside")})),yf("handler",c),yf("state",n),yf("sendFocusIn",r)])},u=function(t,n,e,o,r){var i=e(t,n,o,r);return Bb(i,n.event).bind(function(e){return e(t,n,o,r)})},a=function(t,n){var i=t.focusInside!==Gm.OnFocusMode?j.none():r(t).map(function(e){return La(ua(),function(o,r){e(o,t,n),r.stop()})}),a=function(e,o){var i=Cb(pb.concat(mb))(o.event);t.focusInside===Gm.OnEnterOrSpaceMode&&i&&Bu(e,o)&&r(t).each(function(r){r(e,t,n),o.stop()})},c=[La(Ku(),function(o,r){u(o,r,e,t,n).fold(function(){a(o,r)},function(t){r.stop()})}),La(Ju(),function(e,r){u(e,r,o,t,n).each(function(t){r.stop()})})];return Pa(i.toArray().concat(c))},c={schema:i,processKey:u,toEvents:a};return c},Vb=function(n){var e=[qi("onEscape"),qi("onEnter"),eu("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),eu("firstTabstop",0),eu("useTabstopAt",P),qi("visibilitySelector")].concat([n]),o=function(t,n){var e=t.visibilitySelector.bind(function(t){return Xs(n,t)}).getOr(n);return po(e)>0},r=function(t,n){var e=eg(t.element,n.selector),r=rt(e,function(t){return o(n,t)});return j.from(r[n.firstTabstop])},i=function(t,n){return n.focusReceptionist.get(t).bind(function(t){return Xs(t,n.selector)})},u=function(t,n){return o(t,n)&&t.useTabstopAt(n)},a=function(t,n,e){r(t,n).each(function(e){n.focusReceptionist.set(t,e)})},c=function(t,n,e,o,r){return r(n,e,function(t){return u(o,t)}).fold(function(){return o.cyclic?j.some(!0):j.none()},function(n){return o.focusReceptionist.set(t,n),j.some(!0)})},s=function(n,e,o,r){var u=eg(n.element,o.selector);return i(n,o).bind(function(e){var i=st(u,t(he,e));return i.bind(function(t){return c(n,u,t,o,r)})})},f=function(t,n,e){var o=e.cyclic?xb:wb;return s(t,n,e,o)},l=function(t,n,e){var o=e.cyclic?Sb:kb;return s(t,n,e,o)},d=function(t,n,e){return e.onEnter.bind(function(e){return e(t,n)})},m=function(t,n,e){return e.onEscape.bind(function(e){return e(t,n)})},g=A([Db(Ob([_b,Cb(db)]),f),Db(Cb(db),l),Db(Cb(gb),m),Db(Ob([Eb,Cb(mb)]),d)]),p=A([]);return Ib(e,Fc.init,g,p,function(){return j.some(a)})},Pb=Vb(Ii("cyclic",V)),Hb=Vb(Ii("cyclic",P)),zb=function(t,n,e){return Ra(t,e,fa()),j.some(!0)},Nb=function(t,n,e){var o=wh(e)&&Cb(pb)(n.event);return o?j.none():zb(t,n,e)},Lb=function(t,n){return j.some(!0)},Wb=[eu("execute",Nb),eu("useSpace",!1),eu("useEnter",!0),eu("useControlEnter",!1),eu("useDown",!1)],Ub=function(t,n,e){return e.execute(t,n,t.element)},jb=function(t,n,e,o){var r=e.useSpace&&!wh(t.element)?pb:[],i=e.useEnter?mb:[],u=e.useDown?yb:[],a=r.concat(i).concat(u);return[Db(Cb(a),Ub)].concat(e.useControlEnter?[Db(Ob([Tb,Cb(mb)]),Ub)]:[])},Gb=function(t,n,e,o){return e.useSpace&&!wh(t.element)?[Db(Cb(pb),Lb)]:[]},Xb=Ib(Wb,Fc.init,jb,Gb,function(){return j.none()}),Yb=function(){var t=ld(),n=function(n,e){t.set({numRows:n,numColumns:e})},e=function(){return t.get().map(function(t){return t.numRows})},o=function(){return t.get().map(function(t){return t.numColumns})};return Rc({readState:function(){return t.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:n,getNumRows:e,getNumColumns:o})},qb=function(t){return t.state(t)},Kb=Object.freeze({__proto__:null,flatgrid:Yb,init:qb}),Jb=function(t){return function(n,e,o,r){var i=t(n.element);return ty(i,n,e,o,r)}},$b=function(t,n){var e=Wd(t,n);return Jb(e)},Qb=function(t,n){var e=Wd(n,t);return Jb(e)},Zb=function(t){return function(n,e,o,r){return ty(t,n,e,o,r)}},ty=function(t,n,e,o,r){var i=o.focusReceptionist.get(n).bind(function(e){return t(n.element,e,o,r)});return i.map(function(t){return o.focusReceptionist.set(n,t),!0})},ny=Zb,ey=Zb,oy=Zb,ry=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},iy=function(t){return!ry(t.dom)},uy=function(t,n){return st(t,n).map(function(n){return{index:n,candidates:t}})},ay=function(t,n,e){var o=function(t){return he(t,n)},r=eg(t,e),i=rt(r,iy);return uy(i,o)},cy=function(t,n){return st(t,function(t){return he(n,t)})},sy=function(t,n,e,o){var r=Math.floor(n/e),i=n%e;return o(r,i).bind(function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?j.some(t[o]):j.none()})},fy=function(t,n,e,o,r){return sy(t,n,o,function(n,i){var u=n===e-1,a=u?t.length-n*o:o,c=If(i,r,0,a-1);return j.some({row:n,column:c})})},ly=function(t,n,e,o,r){return sy(t,n,o,function(n,i){var u=If(n,r,0,e-1),a=u===e-1,c=a?t.length-u*o:o,s=Vf(i,0,c-1);return j.some({row:u,column:s})})},dy=function(t,n,e,o){return fy(t,n,e,o,1)},my=function(t,n,e,o){return fy(t,n,e,o,-1)},gy=function(t,n,e,o){return ly(t,n,e,o,-1)},py=function(t,n,e,o){return ly(t,n,e,o,1)},vy=[Pi("selector"),eu("execute",Nb),vf("onEscape"),eu("captureTab",!1),wf()],hy=function(t,n,e){Gs(t.element,n.selector).each(function(e){n.focusReceptionist.set(t,e)})},by=function(t,n){return n.focusReceptionist.get(t).bind(function(t){return Xs(t,n.selector)})},yy=function(t,n,e,o){return by(t,e).bind(function(o){return e.execute(t,n,o)})},xy=function(t){return function(n,e,o,r){return ay(n,e,o.selector).bind(function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))})}},wy=function(t,n,e){return e.captureTab?j.some(!0):j.none()},Sy=function(t,n,e){return e.onEscape(t,n)},ky=xy(my),Cy=xy(dy),Oy=xy(gy),_y=xy(py),Ty=A([Db(Cb(vb),$b(ky,Cy)),Db(Cb(bb),Qb(ky,Cy)),Db(Cb(hb),ny(Oy)),Db(Cb(yb),ey(_y)),Db(Ob([_b,Cb(db)]),wy),Db(Ob([Eb,Cb(db)]),wy),Db(Cb(gb),Sy),Db(Cb(pb.concat(mb)),yy)]),Ey=A([Db(Cb(pb),Lb)]),Dy=Ib(vy,Yb,Ty,Ey,function(){return j.some(hy)}),By=function(t,n,e,o){var r=function(t){return"button"===vn(t)&&"disabled"===Je(t,"disabled")},i=function(t,n,e){var u=If(n,o,0,e.length-1);return u===t?j.none():r(e[u])?i(t,u,e):j.from(e[u])};return ay(t,e,n).bind(function(t){var n=t.index,e=t.candidates;return i(n,n,e)})},Ay=[Pi("selector"),eu("getInitial",j.none),eu("execute",Nb),vf("onEscape"),eu("executeOnMove",!1),eu("allowVertical",!0)],My=function(t,n){return n.focusReceptionist.get(t).bind(function(t){return Xs(t,n.selector)})},Fy=function(t,n,e){return My(t,e).bind(function(o){return e.execute(t,n,o)})},Ry=function(t,n,e){n.getInitial(t).orThunk(function(){return Gs(t.element,n.selector)}).each(function(e){n.focusReceptionist.set(t,e)})},Iy=function(t,n,e){return By(t,e.selector,n,-1)},Vy=function(t,n,e){return By(t,e.selector,n,1)},Py=function(t){return function(n,e,o,r){return t(n,e,o,r).bind(function(){return o.executeOnMove?Fy(n,e,o):j.some(!0)})}},Hy=function(t,n,e){return e.onEscape(t,n)},zy=function(t,n,e,o){var r=vb.concat(e.allowVertical?hb:[]),i=bb.concat(e.allowVertical?yb:[]);return[Db(Cb(r),Py($b(Iy,Vy))),Db(Cb(i),Py(Qb(Iy,Vy))),Db(Cb(mb),Fy),Db(Cb(pb),Fy),Db(Cb(gb),Hy)]},Ny=A([Db(Cb(pb),Lb)]),Ly=Ib(Ay,Fc.init,zy,Ny,function(){return j.some(Ry)}),Wy=function(t,n,e){return j.from(t[n]).bind(function(t){return j.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},Uy=function(t,n,e,o){var r=t[n],i=r.length,u=If(e,o,0,i-1);return Wy(t,n,u)},jy=function(t,n,e,o){var r=If(e,o,0,t.length-1),i=t[r].length,u=Vf(n,0,i-1);return Wy(t,r,u)},Gy=function(t,n,e,o){var r=t[n],i=r.length,u=Vf(e+o,0,i-1);return Wy(t,n,u)},Xy=function(t,n,e,o){var r=Vf(e+o,0,t.length-1),i=t[r].length,u=Vf(n,0,i-1);return Wy(t,r,u)},Yy=function(t,n,e){return Uy(t,n,e,1)},qy=function(t,n,e){return Uy(t,n,e,-1)},Ky=function(t,n,e){return jy(t,e,n,-1)},Jy=function(t,n,e){return jy(t,e,n,1)},$y=function(t,n,e){return Gy(t,n,e,-1)},Qy=function(t,n,e){return Gy(t,n,e,1)},Zy=function(t,n,e){return Xy(t,e,n,-1)},tx=function(t,n,e){return Xy(t,e,n,1)},nx=[Gi("selectors",[Pi("row"),Pi("cell")]),eu("cycles",!0),eu("previousSelector",j.none),eu("execute",Nb)],ex=function(t,n,e){var o=n.previousSelector(t).orThunk(function(){var e=n.selectors;return Gs(t.element,e.cell)});o.each(function(e){n.focusReceptionist.set(t,e)})},ox=function(t,n,e){return Rl(t.element).bind(function(o){return e.execute(t,n,o)})},rx=function(t,n){return tt(t,function(t){return eg(t,n.selectors.cell)})},ix=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Xs(o,r.selectors.row).bind(function(t){var n=eg(t,r.selectors.cell);return cy(n,o).bind(function(n){var o=eg(e,r.selectors.row);return cy(o,t).bind(function(t){var e=rx(o,r);return i(e,t,n).map(function(t){return t.cell})})})})}},ux=ix(qy,$y),ax=ix(Yy,Qy),cx=ix(Ky,Zy),sx=ix(Jy,tx),fx=A([Db(Cb(vb),$b(ux,ax)),Db(Cb(bb),Qb(ux,ax)),Db(Cb(hb),ny(cx)),Db(Cb(yb),ey(sx)),Db(Cb(pb.concat(mb)),ox)]),lx=A([Db(Cb(pb),Lb)]),dx=Ib(nx,Fc.init,fx,lx,function(){return j.some(ex)}),mx=[Pi("selector"),eu("execute",Nb),eu("moveOnTab",!1)],gx=function(t,n,e){return e.focusReceptionist.get(t).bind(function(o){return e.execute(t,n,o)})},px=function(t,n,e){Gs(t.element,n.selector).each(function(e){n.focusReceptionist.set(t,e)})},vx=function(t,n,e){return By(t,e.selector,n,-1)},hx=function(t,n,e){return By(t,e.selector,n,1)},bx=function(t,n,e,o){return e.moveOnTab?oy(vx)(t,n,e,o):j.none()},yx=function(t,n,e,o){return e.moveOnTab?oy(hx)(t,n,e,o):j.none()},xx=A([Db(Cb(hb),oy(vx)),Db(Cb(yb),oy(hx)),Db(Ob([_b,Cb(db)]),bx),Db(Ob([Eb,Cb(db)]),yx),Db(Cb(mb),gx),Db(Cb(pb),gx)]),wx=A([Db(Cb(pb),Lb)]),Sx=Ib(mx,Fc.init,xx,wx,function(){return j.some(px)}),kx=[vf("onSpace"),vf("onEnter"),vf("onShiftEnter"),vf("onLeft"),vf("onRight"),vf("onTab"),vf("onShiftTab"),vf("onUp"),vf("onDown"),vf("onEscape"),eu("stopSpaceKeyup",!1),qi("focusIn")],Cx=function(t,n,e){return[Db(Cb(pb),e.onSpace),Db(Ob([Eb,Cb(mb)]),e.onEnter),Db(Ob([_b,Cb(mb)]),e.onShiftEnter),Db(Ob([_b,Cb(db)]),e.onShiftTab),Db(Ob([Eb,Cb(db)]),e.onTab),Db(Cb(hb),e.onUp),Db(Cb(yb),e.onDown),Db(Cb(vb),e.onLeft),Db(Cb(bb),e.onRight),Db(Cb(pb),e.onSpace),Db(Cb(gb),e.onEscape)]},Ox=function(t,n,e){return e.stopSpaceKeyup?[Db(Cb(pb),Lb)]:[]},_x=Ib(kx,Fc.init,Cx,Ox,function(t){return t.focusIn}),Tx=Pb.schema(),Ex=Hb.schema(),Dx=Ly.schema(),Bx=Dy.schema(),Ax=dx.schema(),Mx=Xb.schema(),Fx=Sx.schema(),Rx=_x.schema(),Ix=Object.freeze({__proto__:null,acyclic:Tx,cyclic:Ex,flow:Dx,flatgrid:Bx,matrix:Ax,execution:Mx,menu:Fx,special:Rx}),Vx=function(t){return Vt(t,"setGridSize")},Px=Cl({branchKey:"mode",branches:Ix,name:"keying",active:{events:function(t,n){var e=t.handler;return e.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(o){o(t,n,e)})},setGridSize:function(t,n,e,o,r){Vx(e)?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Kb}),Hx=function(t,n,e,o){Il(function(){var n=tt(o,t.getSystem().build);Jg(t,n)},t.element)},zx=function(t,n,e,o){var r=t.getSystem().build(o);Qg(t,r,e)},Nx=function(t,n,e,o){zx(t,n,zo,o)},Lx=function(t,n,e,o){zx(t,n,Ho,o)},Wx=function(t,n,e,o){var r=Ux(t),i=ct(r,function(t){return he(o.element,t.element)});i.each(tp)},Ux=function(t,n){return t.components()},jx=function(t,n,e,o,r){var i=Ux(t);return j.from(i[o]).map(function(i){return Wx(t,n,e,i),r.each(function(e){zx(t,n,function(t,n){No(t,n,o)},e)}),i})},Gx=function(t,n,e,o,r){var i=Ux(t);return st(i,o).bind(function(o){return jx(t,n,e,o,r)})},Xx=Object.freeze({__proto__:null,append:Nx,prepend:Lx,remove:Wx,replaceAt:jx,replaceBy:Gx,set:Hx,contents:Ux}),Yx=Sl({fields:[],name:"replacing",apis:Xx}),qx=function(t,n){var e=Pa(n);return Sl({fields:[Pi("enabled")],name:t,active:{events:A(e)}})},Kx=function(t,n){var e=qx(t,n);return{key:t,value:{config:{},me:e,configAsRaw:A({}),initialConfig:{},state:Fc}}},Jx=function(t,n){n.ignore||(Bl(t.element),n.onFocus(t))},$x=function(t,n){n.ignore||Al(t.element)},Qx=function(t){return Ml(t.element)},Zx=Object.freeze({__proto__:null,focus:Jx,blur:$x,isFocused:Qx}),tw=function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return zc(e)},nw=function(t){return Pa([La(ua(),function(n,e){Jx(n,t),e.stop()})].concat(t.stopMousedown?[La(Wu(),function(t,n){n.event.prevent()})]:[]))},ew=Object.freeze({__proto__:null,exhibit:tw,events:nw}),ow=[pf("onFocus"),eu("stopMousedown",!1),eu("ignore",!1)],rw=Sl({fields:ow,name:"focusing",active:ew,apis:Zx}),iw=function(t){var n=function(){var n=du(t),e=function(){return n.get()},o=function(t){return n.set(t)},r=function(){return n.set(t)},i=function(){return n.get()};return{get:e,set:o,clear:r,readState:i}};return{init:n}},uw=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},aw=function(t,n,e){n.toggleClass.each(function(n){e.get()?gs(t.element,n):vs(t.element,n)})},cw=function(t,n,e){lw(t,n,e,!e.get())},sw=function(t,n,e){e.set(!0),aw(t,n,e),uw(t,n,e)},fw=function(t,n,e){e.set(!1),aw(t,n,e),uw(t,n,e)},lw=function(t,n,e,o){var r=o?sw:fw;r(t,n,e)},dw=function(t,n,e){return e.get()},mw=function(t,n,e){lw(t,n,e,n.selected)},gw=Object.freeze({__proto__:null,onLoad:mw,toggle:cw,isOn:dw,on:sw,off:fw,set:lw}),pw=function(){return zc({})},vw=function(t,n){var e=ml(t,n,cw),o=gl(t,n,mw);return Pa(ft([t.toggleOnExecute?[e]:[],[o]]))},hw=Object.freeze({__proto__:null,exhibit:pw,events:vw}),bw=function(t,n,e){qe(t.element,"aria-pressed",e),n.syncWithExpanded&&ww(t,n,e)},yw=function(t,n,e){qe(t.element,"aria-selected",e)},xw=function(t,n,e){qe(t.element,"aria-checked",e)},ww=function(t,n,e){qe(t.element,"aria-expanded",e)},Sw=[eu("selected",!1),qi("toggleClass"),eu("toggleOnExecute",!0),ou("aria",{mode:"none"},Mi("mode",{pressed:[eu("syncWithExpanded",!1),yf("update",bw)],checked:[yf("update",xw)],expanded:[yf("update",ww)],selected:[yf("update",yw)],none:[yf("update",T)]}))],kw=Sl({fields:Sw,name:"toggling",active:hw,apis:gw,state:iw(!1)}),Cw=function(){var t=function(t,n){n.stop(),Fa(t)};return[La(Zu(),t),La(da(),t),qa(Hu()),qa(Wu())]},Ow=function(t){var n=function(t){return tc(function(n,e){t(n),e.stop()})};return Pa(ft([t.map(n).toArray(),Cw()]))},_w="alloy.item-hover",Tw="alloy.item-focus",Ew=function(t){(Rl(t.element).isNone()||rw.isFocused(t))&&(rw.isFocused(t)||rw.focus(t),Ma(t,_w,{item:t}))},Dw=function(t){Ma(t,Tw,{item:t})},Bw=A(_w),Aw=A(Tw),Mw=function(t){return{dom:t.dom,domModification:z(z({},t.domModification),{attributes:z(z(z({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:lv.augment(t.itemBehaviours,[t.toggling.fold(kw.revoke,function(t){return kw.config(z({aria:{mode:"checked"}},t))}),rw.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Dw(t)}}),Px.config({mode:"execution"}),av.config({store:{mode:"memory",initialValue:t.data}}),Kx("item-type-events",e(e([],Cw(),!0),[La(Xu(),Ew),La(la(),rw.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}},Fw=[Pi("data"),Pi("components"),Pi("dom"),eu("hasSubmenu",!1),qi("toggling"),lv.field("itemBehaviours",[kw,rw,Px,av]),eu("ignoreFocus",!1),eu("domModification",{}),yf("builder",Mw),eu("eventOrder",{})],Rw=function(t){return{dom:t.dom,components:t.components,events:Pa([Ka(la())])}},Iw=[Pi("dom"),Pi("components"),yf("builder",Rw)],Vw=A("item-widget"),Pw=A([Nv({name:"widget",overrides:function(t){return{behaviours:xl([av.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:T}})])}}})]),Hw=function(t){var n=Zv(Vw(),t,Pw()),e=th(Vw(),t,n.internals()),o=function(n){return nh(n,t,"widget").map(function(t){return Px.focusIn(t),t})},r=function(n,e){return wh(e.event.target)?j.none():t.autofocus?(e.setSource(n.element),j.none()):j.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Pa([tc(function(t,n){o(t).each(function(t){n.stop()})}),La(Xu(),Ew),La(la(),function(n,e){t.autofocus?o(n):rw.focus(n)})]),behaviours:lv.augment(t.widgetBehaviours,[av.config({store:{mode:"memory",initialValue:t.data}}),rw.config({ignore:t.ignoreFocus,onFocus:function(t){Dw(t)}}),Px.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:Ol(),onLeft:r,onRight:r,onEscape:function(n,e){return rw.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),j.none()):j.none():(rw.focus(n),j.some(!0))}})])}},zw=[Pi("uid"),Pi("data"),Pi("components"),Pi("dom"),eu("autofocus",!1),eu("ignoreFocus",!1),lv.field("widgetBehaviours",[av,rw,Px]),eu("domModification",{}),ch(Pw()),yf("builder",Hw)],Nw=Mi("type",{widget:zw,item:Fw,separator:Iw}),Lw=function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusReceptionist:t.focusReceptionist}},Ww=function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusReceptionist:t.focusReceptionist}},Uw=function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusReceptionist:t.focusReceptionist}},jw=A([Uv({factory:{sketch:function(t){var n=Bi("menu.spec item",Nw,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return It(n,"uid")?n:z(z({},n),{uid:wc("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Gw=A([Pi("value"),Pi("items"),Pi("dom"),Pi("components"),eu("eventOrder",{}),cv("menuBehaviours",[fb,av,Oh,Px]),ou("movement",{mode:"menu",moveOnTab:!0},Mi("mode",{grid:[wf(),yf("config",Lw)],matrix:[yf("config",Ww),Pi("rowSelector")],menu:[eu("moveOnTab",!0),yf("config",Uw)]})),lf(),eu("fakeFocus",!1),eu("focusReceptionist",Mb()),pf("onHighlight")]),Xw=A("alloy.menu-focus"),Yw=function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:fv(t.menuBehaviours,[fb.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),av.config({store:{mode:"memory",initialValue:t.value}}),Oh.config({find:j.some}),Px.config(t.movement.config(t,t.movement))]),events:Pa([La(Aw(),function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each(function(e){fb.highlight(t,e),n.stop(),Ma(t,Xw(),{menu:t,item:e})})}),La(Bw(),function(t,n){var e=n.event.item;fb.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}},qw=xh({name:"Menu",configFields:Gw(),partFields:jw(),factory:Yw}),Kw=function(t){return Tt(t,function(t,n){return{k:t,v:n}})},Jw=function(t,n,e,o){return Rt(e,o).bind(function(o){return Rt(t,o).bind(function(o){var r=Jw(t,n,e,o);return j.some([o].concat(r))})}).getOr([])},$w=function(t,n){var e={};Ot(t,function(t,n){nt(t,function(t){e[t]=n})});var o=n,r=Kw(n),i=_t(r,function(t,n){return[n].concat(Jw(e,o,r,n))});return _t(e,function(t){return Rt(i,t).getOr([t])})},Qw=function(){var t=du({}),n=du({}),e=du({}),o=ld(),r=du({}),i=function(){t.set({}),n.set({}),e.set({}),o.clear()},u=function(){return o.get().isNone()},a=function(t,e){var o;n.set(z(z({},n.get()),(o={},o[t]={type:"prepared",menu:e},o)))},c=function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=$w(c,a);e.set(s)},s=function(n){return Mt(t.get(),function(t,e){return t===n})},f=function(t,n,e){return p(t).bind(function(o){return s(t).bind(function(t){return n(t).map(function(t){return{triggeredMenu:o,triggeringItem:t,triggeringPath:e}})})})},l=function(t,n){var r=rt(h(t).toArray(),function(t){return p(t).isSome()});return Rt(e.get(),t).bind(function(t){var e=mt(r.concat(t)),i=lt(e,function(t,r){return f(t,n,e.slice(0,r+1)).fold(function(){return Pt(o.get(),t)?[]:[j.none()]},function(t){return[j.some(t)]})});return Nt(i)})},d=function(n){return Rt(t.get(),n).map(function(t){var o=Rt(e.get(),n).getOr([]);return[t].concat(o)})},m=function(t){return Rt(e.get(),t).bind(function(t){return t.length>1?j.some(t.slice(1)):j.none()})},g=function(t){return Rt(e.get(),t)},p=function(t){return v(t).bind(Zw)},v=function(t){return Rt(n.get(),t)},h=function(n){return Rt(t.get(),n)},b=function(t){var n=r.get();return gt(kt(n),t)},y=function(){return o.get().bind(p)},x=function(){return n.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:g,collapse:m,lookupMenu:v,lookupItem:h,otherMenus:b,getPrimary:y,getMenus:x,clear:i,isClear:u,getTriggeringPath:l}},Zw=function(t){return"prepared"===t.type?j.some(t.menu):j.none()},tS={init:Qw,extractPreparedMenu:Zw},nS=function(t,n){var e,o=ld(),r=function(n,e,o){return _t(o,function(o,r){var i=function(){return qw.sketch(z(z({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusReceptionist:t.fakeFocus?Fb():Mb()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})},i=tS.init(),u=function(n){var e=r(n,t.data.primary,t.data.menus),o=s();return i.setContents(t.data.primary,e,t.data.expansions,o),i.getPrimary()},a=function(t){return av.getValue(t).value},c=function(t,n,e){return St(n,function(t){if(!t.getSystem().isConnected())return j.none();var n=fb.getCandidates(t);return ct(n,function(t){return a(t)===e})})},s=function(n){return _t(t.data.menus,function(t,n){return lt(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},f=function(t,n){fb.highlight(t,n),fb.getHighlighted(n).orThunk(function(){return fb.getFirst(n)}).each(function(n){Ra(t,n.element,la())})},l=function(t,n){return zt(tt(n,function(n){return t.lookupMenu(n).bind(function(t){return"prepared"===t.type?j.some(t.menu):j.none()})}))},d=function(n,e,o){var r=l(e,e.otherMenus(o));nt(r,function(e){ys(e.element,[t.markers.backgroundMenu]),t.stayInDom||Yx.remove(n,e)})},m=function(n){return o.get().getOrThunk(function(){var e={},r=eg(n.element,"."+t.markers.item),i=rt(r,function(t){return"true"===Je(t,"aria-haspopup")});return nt(i,function(t){n.getSystem().getByDom(t).each(function(t){var n=a(t);e[n]=t})}),o.set(e),e})},g=function(t,n){var e=m(t);Ot(e,function(t,e){var o=J(n,e);qe(t.element,"aria-expanded",o)})},p=function(n,e,o){return j.from(o[0]).bind(function(r){return e.lookupMenu(r).bind(function(r){if("notbuilt"===r.type)return j.none();var i=r.menu,u=l(e,o.slice(1));return nt(u,function(n){gs(n.element,t.markers.backgroundMenu)}),je(i.element)||Yx.append(n,Ps(i)),ys(i.element,[t.markers.backgroundMenu]),f(n,i),d(n,e,o),j.some(i)})})};(function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"})(e||(e={}));var v=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return i.setMenuBuilt(n,o),o}return e.menu},h=function(n,o,r){if(void 0===r&&(r=e.HighlightSubmenu),o.hasConfigured(jh)&&jh.isDisabled(o))return j.some(o);var u=a(o);return i.expand(u).bind(function(u){return g(n,u),j.from(u[0]).bind(function(a){return i.lookupMenu(a).bind(function(c){var s=v(n,a,c);return je(s.element)||Yx.append(n,Ps(s)),t.onOpenSubmenu(n,o,s,mt(u)),r===e.HighlightSubmenu?(fb.highlightFirst(s),p(n,i,u)):(fb.dehighlightAll(s),j.some(o))})})})},b=function(n,e){var o=a(e);return i.collapse(o).bind(function(o){return g(n,o),p(n,i,o).map(function(o){return t.onCollapseMenu(n,e,o),o})})},y=function(t,n){var e=a(n);return i.refresh(e).bind(function(n){return g(t,n),p(t,i,n)})},x=function(t,n){return wh(n.element)?j.none():h(t,n,e.HighlightSubmenu)},w=function(t,n){return wh(n.element)?j.none():b(t,n)},S=function(n,e){return b(n,e).orThunk(function(){return t.onEscape(n,e).map(function(){return n})})},k=function(n){return function(e,o){return Xs(o.getSource(),"."+t.markers.item).bind(function(t){return e.getSystem().getByDom(t).toOptional().bind(function(t){return n(e,t).map(P)})})}},C=Pa([La(Xw(),function(t,n){var e=n.event.item;i.lookupItem(a(e)).each(function(){var e=n.event.menu;fb.highlight(t,e);var o=a(n.event.item);i.refresh(o).each(function(n){return d(t,i,n)})})}),tc(function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each(function(o){var r=a(o);0===r.indexOf("collapse-item")&&b(n,o),h(n,o,e.HighlightSubmenu).fold(function(){t.onExecute(n,o)},T)})}),$a(function(n,e){u(n).each(function(e){Yx.append(n,Ps(e)),t.onOpenMenu(n,e),t.highlightImmediately&&f(n,e)})})].concat(t.navigateOnHover?[La(Bw(),function(n,o){var r=o.event.item;y(n,r),h(n,r,e.HighlightParent),t.onHover(n,r)})]:[])),O=function(t){return fb.getHighlighted(t).bind(fb.getHighlighted)},_=function(t){O(t).each(function(n){b(t,n)})},E=function(t){i.getPrimary().each(function(n){f(t,n)})},D=function(t){return j.from(t.components()[0]).filter(function(t){return"menu"===Je(t.element,"role")})},B=function(n){var e=i.getPrimary().bind(function(t){return O(n).bind(function(t){var e=a(t),o=Ft(i.getMenus()),r=zt(tt(o,tS.extractPreparedMenu));return i.getTriggeringPath(e,function(t){return c(n,r,t)})}).map(function(n){return{primary:t,triggeringPath:n}})});e.fold(function(){D(n).each(function(e){t.onRepositionMenu(n,e,[])})},function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)})},A={collapseMenu:_,highlightPrimary:E,repositionMenus:B};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:fv(t.tmenuBehaviours,[Px.config({mode:"special",onRight:k(x),onLeft:k(w),onEscape:k(S),focusIn:function(t,n){i.getPrimary().each(function(n){Ra(t,n.element,la())})}}),fb.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Oh.config({find:function(t){return fb.getHighlighted(t)}}),Yx.config({})]),eventOrder:t.eventOrder,apis:A,events:C}},eS=A("collapse-item"),oS=function(t,n,e){return{primary:t,menus:n,expansions:e}},rS=function(t,n){return{primary:t,menus:Su(t,n),expansions:{}}},iS=function(t){return{value:mc(eS()),meta:{text:t}}},uS=yh({name:"TieredMenu",configFields:[bf("onExecute"),bf("onEscape"),hf("onOpenMenu"),hf("onOpenSubmenu"),pf("onRepositionMenu"),pf("onCollapseMenu"),eu("highlightImmediately",!0),Gi("data",[Pi("primary"),Pi("menus"),Pi("expansions")]),eu("fakeFocus",!1),pf("onHighlight"),pf("onHover"),df(),Pi("dom"),eu("navigateOnHover",!0),eu("stayInDom",!1),cv("tmenuBehaviours",[Px,fb,Oh,Yx]),eu("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:nS,extraApis:{tieredData:oS,singleData:rS,collapseItem:iS}}),aS=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return al()},onRtl:function(){return cl()}}}:{},a=function(t){return 2===t.length},c=function(t){return a(t)?u:{}};return uS.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return Op.close(n),t.onEscape.map(function(t){return t(n)}),j.some(!0)},onExecute:function(){return j.some(!0)},onOpenMenu:function(t,n){Gg.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();Gg.position(r,e,{anchor:z({type:"submenu",item:n},c(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();Gg.positionWithinBounds(u,n,e,r()),nt(o,function(t){var n=c(t.triggeringPath);Gg.position(u,t.triggeredMenu,{anchor:z({type:"submenu",item:t.triggeringItem},n)})})}})},cS=function(t,n){var e=function(n,e){var o=t.getRelated(n);return o.exists(function(t){return Js(t,e)})},o=function(t,n){Op.setContent(t,n)},r=function(t,n,e){i(t,n,e,j.none())},i=function(t,n,e,o){u(t,n,e,function(){return o.map(function(t){return ur(t)})})},u=function(n,e,o,r){var i=t.lazySink(n).getOrDie();Op.openWhileCloaked(n,e,function(){return Gg.positionWithinBounds(i,n,o,r())}),av.setValue(n,j.some({mode:"position",config:o,getBounds:r}))},a=function(t,n,e){c(t,n,e,j.none)},c=function(n,e,o,r){var i=aS(t,n,e,o,r);Op.open(n,i),av.setValue(n,j.some({mode:"menu",menu:i}))},s=function(t){Op.isOpen(t)&&(av.setValue(t,j.none()),Op.close(t))},f=function(t){return Op.getState(t)},l=function(n){Op.isOpen(n)&&av.getValue(n).each(function(e){switch(e.mode){case"menu":Op.getState(n).each(uS.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();Gg.positionWithinBounds(o,n,e.config,e.getBounds())}})},d={setContent:o,showAt:r,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:f,reposition:l,isOpen:Op.isOpen};return{uid:t.uid,dom:t.dom,behaviours:fv(t.inlineBehaviours,[Op.config({isPartOf:function(t,n,o){return Js(n,o)||e(t,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),av.config({store:{mode:"memory",initialValue:j.none()}}),_l.config({channels:z(z({},Bp(z({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Mp(z(z({},t.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:l})))})]),eventOrder:t.eventOrder,apis:d}},sS=yh({name:"InlineView",configFields:[Pi("lazySink"),pf("onShow"),pf("onHide"),Qi("onEscape"),cv("inlineBehaviours",[Op,av,_l]),tu("fireDismissalEventInstead",[eu("event",ka())]),tu("fireRepositionEventInstead",[eu("event",Ca())]),eu("getRelated",j.none),eu("isExtraPart",V),eu("eventOrder",j.none)],factory:cS,apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),fS="layout-inset",lS=function(t){return t.x},dS=function(t,n){return t.x+t.width/2-n.width/2},mS=function(t,n){return t.x+t.width-n.width},gS=function(t){return t.y},pS=function(t,n){return t.y+t.height-n.height},vS=function(t,n){return t.y+t.height/2-n.height/2},hS=function(t,n,e){return Sf(mS(t,n),pS(t,n),e.insetSouthwest(),Bf(),"southwest",Hf(t,{right:0,bottom:3}),fS)},bS=function(t,n,e){return Sf(lS(t),pS(t,n),e.insetSoutheast(),Df(),"southeast",Hf(t,{left:1,bottom:3}),fS)},yS=function(t,n,e){return Sf(mS(t,n),gS(t),e.insetNorthwest(),Ef(),"northwest",Hf(t,{right:0,top:2}),fS)},xS=function(t,n,e){return Sf(lS(t),gS(t),e.insetNortheast(),Tf(),"northeast",Hf(t,{left:1,top:2}),fS)},wS=function(t,n,e){return Sf(dS(t,n),gS(t),e.insetNorth(),Af(),"north",Hf(t,{top:2}),fS)},SS=function(t,n,e){return Sf(dS(t,n),pS(t,n),e.insetSouth(),Mf(),"south",Hf(t,{bottom:3}),fS)},kS=function(t,n,e){return Sf(mS(t,n),vS(t,n),e.insetEast(),Rf(),"east",Hf(t,{right:0}),fS)},CS=function(t,n,e){return Sf(lS(t),vS(t,n),e.insetWest(),Ff(),"west",Hf(t,{left:1}),fS)},OS=function(t){switch(t){case"north":return wS;case"northeast":return xS;case"northwest":return yS;case"south":return SS;case"southeast":return bS;case"southwest":return hS;case"east":return kS;case"west":return CS}},_S=function(t,n,e,o,r){var i=Zl(o).map(OS).getOr(wS);return i(t,n,e,o,r)},TS=function(t){switch(t){case"north":return SS
;case"northeast":return bS;case"northwest":return hS;case"south":return wS;case"southeast":return xS;case"southwest":return yS;case"east":return CS;case"west":return kS}},ES=function(t,n,e,o,r){var i=Zl(o).map(TS).getOr(wS);return i(t,n,e,o,r)},DS=tinymce.util.Tools.resolve("tinymce.util.Delay"),BS=function(t){var n=Ow(t.action),e=t.dom.tag,o=function(n){return Rt(t.dom,"attributes").bind(function(t){return Rt(t,n)})},r=function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return z({type:t},n)}var r=o("role").getOr("button");return{role:r}};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:lv.augment(t.buttonBehaviours,[rw.config({}),Px.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:t.eventOrder}},AS=yh({name:"Button",factory:BS,configFields:[eu("uid",void 0),Pi("dom"),eu("components",[]),lv.field("buttonBehaviours",[rw,Px]),qi("action"),qi("role"),eu("eventOrder",{})]}),MS=function(t){var n=vh(t)&&Vt(t,"uid")?t.uid:wc("memento"),e=function(t){return t.getSystem().getByUid(n).getOrDie()},o=function(t){return t.getSystem().getByUid(n).toOptional()},r=function(){return z(z({},t),{uid:n})};return{get:e,getOpt:o,asSpec:r}},FS=tinymce.util.Tools.resolve("tinymce.util.I18n"),RS={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},IS="temporary-placeholder",VS=function(t){return function(){return Rt(t,IS).getOr("!not found!")}},PS=function(t,n){var e=t.toLowerCase();if(FS.isRtl()){var o=Kt(e,"-rtl");return It(n,o)?o:e}return e},HS=function(t,n){return Rt(n,PS(t,n))},zS=function(t,n){var e=n();return HS(t,e).getOrThunk(VS(e))},NS=function(t,n,e){var o=n();return HS(t,o).or(e).getOrThunk(VS(o))},LS=function(t){return!!FS.isRtl()&&It(RS,t)},WS=function(){return Kx("add-focusable",[$a(function(t){js(t.element,"svg").each(function(t){return qe(t,"focusable","false")})})])},US=function(t,n,o,r){var i,u,a=LS(n)?["tox-icon--flip"]:[],c=Rt(o,PS(n,o)).or(r).getOrThunk(VS(o));return{dom:{tag:t.tag,attributes:null!==(i=t.attributes)&&void 0!==i?i:{},classes:t.classes.concat(a),innerHtml:c},behaviours:xl(e(e([],null!==(u=t.behaviours)&&void 0!==u?u:[],!0),[WS()],!1))}},jS=function(t,n,e,o){return void 0===o&&(o=j.none()),US(n,t,e(),o)},GS=function(t,n,e){var o=e(),r=ct(t,function(t){return It(o,PS(t,o))});return US(n,r.getOr(IS),o,j.none())},XS={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},YS=function(t){var n=MS({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:xl([Yx.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},o=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},r=MS({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:xl([Yx.config({})])}),i=function(t,n){t.getSystem().isConnected()&&r.getOpt(t).each(function(t){Yx.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])})},u=function(t,e){if(t.getSystem().isConnected()){var o=n.get(t);Yx.set(o,[Ms(e)])}},a={updateProgress:i,updateText:u},c=ft([t.icon.toArray(),t.level.toArray(),t.level.bind(function(t){return j.from(XS[t])}).toArray()]),s=MS(AS.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[jS("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),f=GS(c,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),l={dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:xl([Yx.config({})])},d=[f,l];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:xl([rw.config({}),Kx("notification-events",[La(Yu(),function(t){s.getOpt(t).each(rw.focus)})])]),components:d.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},qS=yh({name:"Notification",factory:YS,configFields:[qi("level"),Pi("progress"),Pi("icon"),Pi("onAction"),Pi("text"),Pi("iconProvider"),Pi("translationProvider"),au("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),KS=function(t,n){var e=null,o=function(){y(e)||(clearTimeout(e),e=null)},r=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];y(e)&&(e=setTimeout(function(){e=null,t.apply(null,o)},n))};return{cancel:o,throttle:r}},JS=function(t,n){var e=null,o=function(){y(e)||(clearTimeout(e),e=null)},r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout(function(){e=null,t.apply(null,r)},n)};return{cancel:o,throttle:r}},$S=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),QS=function(t,n){return t.isBlock(n)||J(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)},ZS=function(t,n,e,o,r){var i=$S(t,function(n){return QS(t,n)});return j.from(i.backwards(n,e,o,r))},tk="[data-mce-autocompleter]",nk=function(t,n){return ek(fn.fromDom(t.selection.getNode())).getOrThunk(function(){var e=fn.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return zo(e,fn.fromDom(n.extractContents())),n.insertNode(e.dom),Oe(e).each(function(t){return t.dom.normalize()}),tg(e).map(function(n){t.selection.setCursorLocation(n.dom,Jm(n))}),e})},ek=function(t){return Xs(t,tk)},ok=function(t){return t.collapsed&&3===t.startContainer.nodeType},rk=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},ik=function(t){return""!==t&&-1!==" \f\n\r\t\v".indexOf(t)},uk=function(t,n){return t.substring(n.length)},ak=function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(ik(r))return j.none();if(r===e)break}return j.some(o)},ck=function(t,n,e,o){if(void 0===o&&(o=0),!ok(n))return j.none();var r=function(t,n,o){return ak(o,n,e).getOr(n)},i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return ZS(t,n.startContainer,n.startOffset,r,i).bind(function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return j.none();var i=rk(r),u=i.lastIndexOf(e);return 0!==u||uk(i,e).length<o?j.none():j.some({text:uk(i,e),range:r,triggerChar:e})})},sk=function(t,n,e,o){return void 0===o&&(o=0),ek(fn.fromDom(n.startContainer)).fold(function(){return ck(t,n,e,o)},function(n){var o=t.createRng();o.selectNode(n.dom);var r=rk(o);return j.some({range:o,text:uk(r,e),triggerChar:e})})},fk=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Ma(t,Ku(),{raw:n})};n.on("keydown",function(n){var o=function(){return t.getView().bind(fb.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Fa),n.preventDefault()):40===n.which?(o().fold(function(){t.getView().each(fb.highlightFirst)},function(t){e(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each(function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())}),n.on("NodeChange",function(n){t.isActive()&&!t.isProcessingAction()&&ek(fn.fromDom(n.element)).isNone()&&t.cancelIfNecessary()})},lk={setup:fk},dk=tinymce.util.Tools.resolve("tinymce.util.Promise"),mk=function(t,n){return{container:t,offset:n}},gk=function(t){return t.nodeType===pn},pk=function(t){return t.nodeType===gn},vk=function(t){if(gk(t))return mk(t,t.data.length);var n=t.childNodes;return n.length>0?vk(n[n.length-1]):mk(t,n.length)},hk=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?hk(e[n],0):e.length>0&&pk(t)&&e.length===n?vk(e[e.length-1]):mk(t,n)},bk=function(t,n){return ZS(t,n.container,n.offset,function(t,n){return 0===n?-1:n},t.getRoot()).filter(function(t){var n=t.container.data.charAt(t.offset-1);return!ik(n)}).isSome()},yk=function(t){return function(n){var e=hk(n.startContainer,n.startOffset);return!bk(t,e)}},xk=function(t,n,e){return St(e.triggerChars,function(e){return sk(t,n,e)})},wk=function(t,n){var e=n(),o=t.selection.getRng();return xk(t.dom,o,e).bind(function(e){return Sk(t,n,e)})},Sk=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng(),u=i.startContainer.nodeValue,a=rt(r.lookupByChar(e.triggerChar),function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk(function(){return yk(t.dom)})(e.range,u,e.text)});if(0===a.length)return j.none();var c=dk.all(tt(a,function(t){var n=t.fetch(e.text,t.maxResults,o);return n.then(function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}})}));return j.some({lookupData:c,context:e})},kk=ci([Ni("type"),$i("text")]),Ck=function(t){return Ei("separatormenuitem",kk,t)},Ok=ci([eu("type","autocompleteitem"),eu("active",!1),eu("disabled",!1),eu("meta",{}),Ni("value"),$i("text"),$i("icon")]),_k=ci([Ni("type"),Ni("ch"),ru("minChars",1),eu("columns",1),ru("maxResults",10),Qi("matches"),Ui("fetch"),Ui("onAction"),fu("highlightOn",[],hi)]),Tk=function(t){return Ei("Autocompleter.Separator",kk,t)},Ek=function(t){return Ei("Autocompleter.Item",Ok,t)},Dk=function(t){return Ei("Autocompleter",_k,t)},Bk=[au("disabled",!1),$i("tooltip"),$i("icon"),$i("text"),cu("onSetup",function(){return T})],Ak=ci([Ni("type"),Ui("onAction")].concat(Bk)),Mk=function(t){return Ei("toolbarbutton",Ak,t)},Fk=[au("active",!1)].concat(Bk),Rk=ci(Fk.concat([Ni("type"),Ui("onAction")])),Ik=function(t){return Ei("ToggleButton",Rk,t)},Vk=[cu("predicate",V),uu("scope","node",["node","editor"]),uu("position","selection",["node","selection","line"])],Pk=Bk.concat([eu("type","contextformbutton"),eu("primary",!1),Ui("onAction"),Ii("original",M)]),Hk=Fk.concat([eu("type","contextformbutton"),eu("primary",!1),Ui("onAction"),Ii("original",M)]),zk=Bk.concat([eu("type","contextformbutton")]),Nk=Fk.concat([eu("type","contextformtogglebutton")]),Lk=Mi("type",{contextformbutton:Pk,contextformtogglebutton:Hk}),Wk=ci([eu("type","contextform"),cu("initValue",A("")),$i("label"),Yi("commands",Lk),Ki("launch",Mi("type",{contextformbutton:zk,contextformtogglebutton:Nk}))].concat(Vk)),Uk=function(t){return Ei("ContextForm",Wk,t)},jk=ci([eu("type","contexttoolbar"),Ni("items")].concat(Vk)),Gk=function(t){return Ei("ContextToolbar",jk,t)},Xk=function(t){var n={};return nt(t,function(t){n[t]={}}),kt(n)},Yk=function(t){var n=t.ui.registry.getAll().popups,e=_t(n,function(t){return Dk(t).fold(function(t){throw new Error(Ai(t))},M)}),o=Xk(At(e,function(t){return t.ch})),r=Ft(e),i=function(t){return rt(r,function(n){return n.ch===t})};return{dataset:e,triggerChars:o,lookupByChar:i}};(function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(Rb||(Rb={}));var qk,Kk=Rb,Jk="tox-menu-nav__js",$k="tox-collection__item",Qk="tox-swatch",Zk={normal:Jk,color:Qk},tC="tox-collection__item--enabled",nC="tox-collection__group-heading",eC="tox-collection__item-icon",oC="tox-collection__item-label",rC="tox-collection__item-accessory",iC="tox-collection__item-caret",uC="tox-collection__item-checkmark",aC="tox-collection__item--active",cC="tox-collection__item-container",sC="tox-collection__item-container--column",fC="tox-collection__item-container--row",lC="tox-collection__item-container--align-right",dC="tox-collection__item-container--align-left",mC="tox-collection__item-container--valign-top",gC="tox-collection__item-container--valign-middle",pC="tox-collection__item-container--valign-bottom",vC=function(t){return Rt(Zk,t).getOr(Jk)},hC=function(t){return"color"===t?"tox-swatches":"tox-menu"},bC=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:hC(t),tieredMenu:"tox-tiered-menu"}},yC=function(t){var n=bC(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:vC(t)}},xC=function(t,n,e){var o=bC(e);return{tag:"div",classes:ft([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},wC=[qw.parts.items({})],SC=function(t,n,e){var o=bC(e),r={tag:"div",classes:ft([[o.tieredMenu]])};return{dom:r,markers:yC(e)}},kC=function(t,n){return function(e){var o=Z(e,n);return tt(o,function(n){return{dom:t,components:n}})}},CC=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[qw.parts.items({preprocess:"auto"!==t?kC({tag:"div",classes:["tox-swatches__row"]},t):M})]}]}},OC=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[qw.parts.items({preprocess:kC({tag:"div",classes:["tox-collection__group"]},t)})]}},_C=function(t,n){var e=[],o=[];return nt(t,function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],It(t.dom,"innerHtml")&&o.push(t)):o.push(t)}),o.length>0&&e.push(o),tt(e,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},TC=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[qw.parts.items({preprocess:function(e){return"auto"!==t&&t>1?kC({tag:"div",classes:["tox-collection__group"]},t)(e):_C(e,function(t,e){return"separator"===n[e].type})}})]}},EC=function(t,n){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[qw.parts.items({preprocess:function(n){return _C(n,function(n,e){return"separator"===t[e].type})}})]}},DC=function(t){return $(t,function(t){return"icon"in t&&void 0!==t.icon})},BC=function(t){return console.error(Ai(t)),console.log(t),j.none()},AC=function(t,n,e,o,r){var i=EC(e);return{value:t,dom:i.dom,components:i.components,items:e}},MC=function(t,n,e,o,r){if("color"===r){var i=CC(o);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){i=TC(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){i=TC(1,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("normal"===r){i=TC(o,e);return{value:t,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){i=OC(o);return{value:t,dom:i.dom,components:i.components,items:e}}return{value:t,dom:xC(n,o,r),components:wC,items:e}},FC=[Ni("type"),Ni("src"),$i("alt"),fu("classes",[],hi)],RC=ci(FC),IC=[Ni("type"),Ni("text"),$i("name"),fu("classes",["tox-collection__item-label"],hi)],VC=ci(IC),PC=ii(function(){return ki("type",{cardimage:RC,cardtext:VC,cardcontainer:HC})}),HC=ci([Ni("type"),iu("direction","horizontal"),iu("align","left"),iu("valign","middle"),Yi("items",PC)]),zC=[au("disabled",!1),$i("text"),$i("shortcut"),Ri("value","value",Fr(function(){return mc("menuitem-value")}),gi()),eu("meta",{})],NC=ci([Ni("type"),$i("label"),Yi("items",PC),cu("onSetup",function(){return T}),cu("onAction",T)].concat(zC)),LC=function(t){return Ei("cardmenuitem",NC,t)},WC=ci([Ni("type"),au("active",!1),$i("icon")].concat(zC)),UC=function(t){return Ei("choicemenuitem",WC,t)},jC=[Ni("type"),Ni("fancytype"),cu("onAction",T)],GC=[eu("initData",{})].concat(jC),XC=[lu("initData",{},[au("allowCustomColors",!0),Zi("colors",gi())])].concat(jC),YC=Mi("fancytype",{inserttable:GC,colorswatch:XC}),qC=function(t){return Ei("fancymenuitem",YC,t)},KC=ci([Ni("type"),cu("onSetup",function(){return T}),cu("onAction",T),$i("icon")].concat(zC)),JC=function(t){return Ei("menuitem",KC,t)},$C=ci([Ni("type"),Ui("getSubmenuItems"),cu("onSetup",function(){return T}),$i("icon")].concat(zC)),QC=function(t){return Ei("nestedmenuitem",$C,t)},ZC=ci([Ni("type"),$i("icon"),au("active",!1),cu("onSetup",function(){return T}),Ui("onAction")].concat(zC)),tO=function(t){return Ei("togglemenuitem",ZC,t)},nO=function(t,n,e){var o=eg(t.element,"."+e);if(o.length>0){var r=st(o,function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n}).getOr(o.length);return j.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return j.none()},eO=function(t,n){return xl([Kx(t,n)])},oO=function(t){return eO(mc("unnamed-events"),t)},rO={namedEvents:eO,unnamedEvents:oO},iO=mc("tooltip.exclusive"),uO=mc("tooltip.show"),aO=mc("tooltip.hide"),cO=function(t,n,e){t.getSystem().broadcastOn([iO],{})},sO=function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&Yx.set(t,o)})},fO=Object.freeze({__proto__:null,hideAllExclusive:cO,setComponents:sO}),lO=function(t,n){var e=function(e){n.getTooltip().each(function(o){tp(o),t.onHide(e,o),n.clearTooltip()}),n.clearTimer()},o=function(e){if(!n.isShowing()){cO(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Pa("normal"===t.mode?[La(Xu(),function(t){Aa(e,uO)}),La(ju(),function(t){Aa(e,aO)})]:[]),behaviours:xl([Yx.config({})])});n.setTooltip(r),$g(o,r),t.onShow(e,r),Gg.position(o,r,{anchor:t.anchor(e)})}};return Pa(ft([[La(uO,function(e){n.resetTimer(function(){o(e)},t.delay)}),La(aO,function(o){n.resetTimer(function(){e(o)},t.delay)}),La(sa(),function(t,n){var o=n;o.universal||J(o.channels,iO)&&e(t)}),Qa(function(t){e(t)})],"normal"===t.mode?[La(Yu(),function(t){Aa(t,uO)}),La(aa(),function(t){Aa(t,aO)}),La(Xu(),function(t){Aa(t,uO)}),La(ju(),function(t){Aa(t,aO)})]:[La(Da(),function(t,n){Aa(t,uO)}),La(Ba(),function(t){Aa(t,aO)})]]))},dO=Object.freeze({__proto__:null,events:lO}),mO=[Pi("lazySink"),Pi("tooltipDom"),eu("exclusive",!0),eu("tooltipComponents",[]),eu("delay",300),uu("mode","normal",["normal","follow-highlight"]),eu("anchor",function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:A([tl,Zf,Kf,$f,Jf,Qf]),onRtl:A([tl,Zf,Kf,$f,Jf,Qf])}}}),pf("onHide"),pf("onShow")],gO=function(){var t=ld(),n=ld(),e=function(){t.on(clearTimeout)},o=function(n,o){e(),t.set(setTimeout(n,o))},r=A("not-implemented");return Rc({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:o,readState:r})},pO=Object.freeze({__proto__:null,init:gO}),vO=Sl({fields:mO,name:"tooltipping",active:dO,state:pO,apis:fO}),hO=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},bO=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),yO=tinymce.util.Tools.resolve("tinymce.EditorReceptionist"),xO=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):yO.baseURL+"/skins/ui/"+o}return e},wO=function(t){return t.getParam("readonly",!1,"boolean")},SO=function(t){return!1===t.getParam("skin")},kO=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},CO=function(t){return t.getParam("width",bO.DOM.getStyle(t.getElement(),"width"))},OO=function(t){return j.from(t.getParam("min_width")).filter(O)},_O=function(t){return j.from(t.getParam("min_height")).filter(O)},TO=function(t){return j.from(t.getParam("max_width")).filter(O)},EO=function(t){return j.from(t.getParam("max_height")).filter(O)},DO=function(t){return j.from(t.getParam("style_formats")).filter(b)},BO=function(t){return t.getParam("style_formats_merge",!1,"boolean")},AO=function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},MO=function(t){return t.getParam("content_langs",void 0,"array")},FO=function(t){return t.getParam("removed_menuitems","")},RO=function(t){return!1!==t.getParam("menubar",!0,"boolean")},IO=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=v(n),r=b(n)&&n.length>0;return!PO(t)&&(r||o||e)},VO=function(t){var n=Q(9,function(n){return t.getParam("toolbar"+(n+1),!1,"string")}),e=rt(n,function(t){return"string"==typeof t});return e.length>0?j.some(e):j.none()},PO=function(t){return VO(t).fold(function(){var n=t.getParam("toolbar",[],"string[]");return n.length>0},P)};(function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"})(qk||(qk={}));var HO,zO=function(t){return t.getParam("toolbar_mode","","string")};(function(t){t.auto="auto",t.top="top",t.bottom="bottom"})(HO||(HO={}));var NO,LO,WO=function(t){return t.getParam("toolbar_groups",{},"object")},UO=function(t){return t.getParam("toolbar_location",HO.auto,"string")},jO=function(t){return UO(t)===HO.bottom},GO=function(t){return t.getParam("fixed_toolbar_container","","string")},XO=function(t){return t.getParam("fixed_toolbar_container_target")},YO=function(t){return t.getParam("toolbar_persist",!1,"boolean")},qO=function(t){if(!t.inline)return j.none();var n=GO(t);if(n.length>0)return Gs(Ge(),n);var e=XO(t);return k(e)?j.some(fn.fromDom(e)):j.none()},KO=function(t){return t.inline&&qO(t).isSome()},JO=function(t){var n=qO(t);return n.getOrThunk(function(){return He(Pe(fn.fromDom(t.getElement())))})},$O=function(t){return t.inline&&!RO(t)&&!IO(t)&&!PO(t)},QO=function(t){var n=t.getParam("toolbar_sticky",!1,"boolean");return(n||t.inline)&&!KO(t)&&!$O(t)},ZO=function(t){return t.getParam("toolbar_sticky_offset",0,"number")},t_=function(t){return t.getParam("draggable_modal",!1,"boolean")},n_=function(t){var n=t.getParam("menu");return n?_t(n,function(t){return z(z({},t),{items:t.items})}):{}},e_=function(t){return t.getParam("menubar")},o_=function(t){return t.getParam("toolbar",!0)},r_=function(t){return t.getParam("file_picker_callback")},i_=function(t){return t.getParam("file_picker_types")},u_=function(t){return t.getParam("file_browser_callback_types")},a_=function(t){return!1===t.getParam("typeahead_urls")},c_=function(t){return t.getParam("anchor_top","#top")},s_=function(t){return t.getParam("anchor_bottom","#bottom")},f_=function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n},l_="silver.readonly",d_=ci([Wi("readonly")]),m_=function(t,n){var e=t.outerContainer,o=e.element;n&&(t.mothership.broadcastOn([_p()],{target:o}),t.uiMothership.broadcastOn([_p()],{target:o})),t.mothership.broadcastOn([l_],{readonly:n}),t.uiMothership.broadcastOn([l_],{readonly:n})},g_=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&m_(n,!0)}),t.on("SwitchMode",function(){return m_(n,t.mode.isReadOnly())}),wO(t)&&t.setMode("readonly")},p_=function(){var t;return _l.config({channels:(t={},t[l_]={schema:d_,onReceive:function(t,n){jh.set(t,n.readonly)}},t)})},v_=function(t){return jh.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},h_=function(t){return jh.config({disabled:t})},b_=function(t){return jh.config({disabled:t,disableClass:"tox-tbtn--disabled"})},y_=function(t){return jh.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},x_={item:v_,button:h_,splitButton:b_,toolbarButton:y_},w_=function(t,n){var e=t.getApi(n);return function(t){t(e)}},S_=function(t,n){return $a(function(e){var o=w_(t,e);o(function(e){var o=t.onSetup(e);C(o)&&n.set(o)})})},k_=function(t,n){return Qa(function(e){return w_(t,e)(n.get())})},C_=function(t,n){return tc(function(e,o){w_(t,e)(t.onAction),t.triggersSubmenu||n!==Kk.CLOSE_ON_EXECUTE||(Aa(e,ga()),o.stop())})},O_=(NO={},NO[fa()]=["disabling","alloy.base.behaviour","toggling","item-events"],NO),__=zt,T_=function(t,n,e,o){var r=du(T);return{type:"item",dom:n.dom,components:__(n.optComponents),data:t.data,eventOrder:O_,hasSubmenu:t.triggersSubmenu,itemBehaviours:xl([Kx("item-events",[C_(t,e),S_(t,r),k_(t,r)]),x_.item(function(){return t.disabled||o.isDisabled()}),p_(),Yx.config({})].concat(t.itemBehaviours))}},E_=function(t){return{value:t.value,meta:z({text:t.text.getOr("")},t.meta)}},D_=tinymce.util.Tools.resolve("tinymce.Env"),B_=function(t){var n={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},o=D_.mac?n:e,r=t.split("+"),i=tt(r,function(t){var n=t.toLowerCase().trim();return It(o,n)?o[n]:t});return D_.mac?i.join(""):i.join("+")},A_=function(t,n,e){return void 0===e&&(e=[eC]),jS(t,{tag:"div",classes:e},n)},M_=function(t){return{dom:{tag:"div",classes:[oC]},components:[Ms(FS.translate(t))]}},F_=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},R_=function(t,n){return{dom:{tag:"div",classes:[oC]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Ms(FS.translate(n))]}]}},I_=function(t){return{dom:{tag:"div",classes:[rC],innerHtml:B_(t)}}},V_=function(t){return A_("checkmark",t,[uC])},P_=function(t){return A_("chevron-right",t,[iC])},H_=function(t){return A_("chevron-down",t,[iC])},z_=function(t,n){var e="vertical"===t.direction?sC:fC,o="left"===t.align?dC:lC,r=function(){switch(t.valign){case"top":return mC;case"middle":return gC;case"bottom":return pC}};return{dom:{tag:"div",classes:[cC,e,o,r()]},components:n}},N_=function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}},L_=function(t,n,o){var r="custom",i="remove",u=t.ariaLabel,a=t.value,c=t.iconContent.map(function(t){return NS(t,n.icons,o)}),s=function(){var t=Qk,o=c.getOr(""),s=u.map(function(t){return{title:n.translate(t)}}).getOr({}),f={tag:"div",attributes:s,classes:[t]};return z(z({},f),a===r?{tag:"button",classes:e(e([],f.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:o}:a===i?{classes:e(e([],f.classes,!0),["tox-swatch--remove"],!1),innerHtml:o}:{attributes:z(z({},f.attributes),{"data-mce-color":a}),styles:{"background-color":a}})};return{dom:s(),optComponents:[]}},W_=function(t){var n=t.map(function(t){return{attributes:{title:FS.translate(t)}}}).getOr({});return z({tag:"div",classes:[Jk,$k]},n)},U_=function(n,e,o,r){var i={tag:"div",classes:[eC]},u=function(t){return jS(t,i,e.icons,r)},a=function(){return j.some({dom:i})},c=o?n.iconContent.map(u).orThunk(a):j.none(),s=n.checkMark,f=j.from(n.meta).fold(function(){return M_},function(n){return It(n,"style")?t(R_,n.style):M_}),l=n.htmlContent.fold(function(){return n.textContent.map(f)},function(t){return j.some(F_(t,[oC]))}),d={dom:W_(n.ariaLabel),optComponents:[c,l,n.shortcutContent.map(I_),s,n.caret]};return d},j_=function(t,n,e,o){return void 0===o&&(o=j.none()),"color"===t.presets?L_(t,n,o):U_(t,n,e,o)},G_=function(t,n){return Rt(t,"tooltipWorker").map(function(t){return[vO.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:Rd}}},mode:"follow-highlight",onShow:function(n,e){t(function(t){vO.setComponents(n,[Fs({element:fn.fromDom(t)})])})}})]}).getOr([])},X_=function(t){return bO.DOM.encode(t)},Y_=function(t,n){var e=FS.translate(t),o=X_(e);if(n.length>0){var r=new RegExp(hO(n),"gi");return o.replace(r,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return o},q_=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=j_({presets:o,textContent:j.none(),htmlContent:e?t.text.map(function(t){return Y_(t,n)}):j.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:j.none(),checkMark:j.none(),caret:j.none(),value:t.value},u.providers,a,t.icon);return T_({data:E_(t),disabled:t.disabled,getApi:A({}),onAction:function(n){return r(t.value,t.meta)},onSetup:A(T),triggersSubmenu:!1,itemBehaviours:G_(t.meta,u)},c,i,u.providers)},K_=function(t,n){return tt(t,function(t){switch(t.type){case"cardcontainer":return z_(t,K_(t.items,n));case"cardimage":return N_(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists(function(t){return J(n.cardText.highlightOn,t)}),o=e?j.from(n.cardText.matchText).getOr(""):"";return F_(Y_(t.text,o),t.classes)}})},J_=function(t,n,e,o){var r=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){jh.set(t,n),nt(eg(t.element,"*"),function(e){t.getSystem().getByDom(e).each(function(t){t.hasConfigured(jh)&&jh.set(t,n)})})}}},i={dom:W_(t.label),optComponents:[j.some({dom:{tag:"div",classes:[cC,fC]},components:K_(t.items,o)})]};return T_({data:E_(z({text:j.none()},t)),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:j.from(o.itemBehaviours).getOr([])},i,n,e.providers)},$_=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=function(t){return{setActive:function(n){kw.set(t,n)},isActive:function(){return kw.isOn(t)},isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},s=j_({presets:e,textContent:n?t.text:j.none(),htmlContent:j.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:j.none(),checkMark:n?j.some(V_(u.icons)):j.none(),caret:j.none(),value:t.value},u,a);return Br(T_({data:E_(t),disabled:t.disabled,getApi:c,onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),T},triggersSubmenu:!1,itemBehaviours:[]},s,i,u),{toggling:{toggleClass:tC,toggleOnExecute:!1,selected:t.active}})},Q_=qv(Vw(),Pw()),Z_=function(t){return{value:t}},tT=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,nT=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,eT=function(t){return tT.test(t)||nT.test(t)},oT=function(t){return qt(t,"#").toUpperCase()},rT=function(t){return eT(t)?j.some({value:oT(t)}):j.none()},iT=function(t){var n=t.value.replace(tT,function(t,n,e,o){return n+n+e+e+o+o});return{value:n}},uT=function(t){var n=iT(t),e=nT.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},aT=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},cT=function(t){var n=aT(t.red)+aT(t.green)+aT(t.blue);return Z_(n)},sT=Math.min,fT=Math.max,lT=Math.round,dT=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,mT=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,gT=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},pT=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},vT=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=fT(0,sT(i,1)),u=fT(0,sT(u,1)),0===i)return n=e=o=lT(255*u),gT(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=lT(255*(n+f)),e=lT(255*(e+f)),o=lT(255*(o+f)),gT(n,e,o,1)},hT=function(t){var n=uT(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return gT(e,o,r,1)},bT=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return gT(r,i,u,a)},yT=function(t){if("transparent"===t)return j.some(gT(0,0,0,0));var n=dT.exec(t);if(null!==n)return j.some(bT(n[1],n[2],n[3],"1"));var e=mT.exec(t);return null!==e?j.some(bT(e[1],e[2],e[3],e[4])):j.none()},xT=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},wT=gT(255,0,0,1),ST=function(t){return t.fire("SkinLoaded")},kT=function(t,n){return t.fire("SkinLoadError",n)},CT=function(t){return t.fire("ResizeEditor")},OT=function(t,n){return t.fire("ResizeContent",n)},_T=function(t,n){return t.fire("ScrollContent",n)},TT=function(t,n){return t.fire("TextColorChange",n)},ET=function(t,n,e){return{hue:t,saturation:n,value:e}},DT=function(t){var n=0,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));if(a===c)return o=a,ET(0,0,100*o);var s=r===a?i-u:u===a?r-i:u-r;return n=r===a?3:u===a?1:5,n=60*(n-s/(c-a)),e=(c-a)/c,o=c,ET(Math.round(n),Math.round(100*e),Math.round(100*o))},BT=function(t){return DT(hT(t))},AT=function(t){return cT(vT(t))},MT=function(t){return rT(t).orThunk(function(){return yT(t).map(cT)}).getOrThunk(function(){var n=document.createElement("canvas")
;n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3];return cT(gT(r,i,u,a))})},FT=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),RT="tinymce-custom-colors",IT="choiceitem",VT=[{type:IT,text:"Light Green",value:"#BFEDD2"},{type:IT,text:"Light Yellow",value:"#FBEEB8"},{type:IT,text:"Light Red",value:"#F8CAC6"},{type:IT,text:"Light Purple",value:"#ECCAFA"},{type:IT,text:"Light Blue",value:"#C2E0F4"},{type:IT,text:"Green",value:"#2DC26B"},{type:IT,text:"Yellow",value:"#F1C40F"},{type:IT,text:"Red",value:"#E03E2D"},{type:IT,text:"Purple",value:"#B96AD9"},{type:IT,text:"Blue",value:"#3598DB"},{type:IT,text:"Dark Turquoise",value:"#169179"},{type:IT,text:"Orange",value:"#E67E23"},{type:IT,text:"Dark Red",value:"#BA372A"},{type:IT,text:"Dark Purple",value:"#843FA1"},{type:IT,text:"Dark Blue",value:"#236FA1"},{type:IT,text:"Light Gray",value:"#ECF0F1"},{type:IT,text:"Medium Gray",value:"#CED4D9"},{type:IT,text:"Gray",value:"#95A5A6"},{type:IT,text:"Dark Gray",value:"#7E8C8D"},{type:IT,text:"Navy Blue",value:"#34495E"},{type:IT,text:"Black",value:"#000000"},{type:IT,text:"White",value:"#ffffff"}],PT=i(10),HT=function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+MT(t[e]).value,type:"choiceitem"});return n},zT=function(t,n){return t.getParam("color_cols",n,"number")},NT=function(t){return!1!==t.getParam("custom_colors")},LT=function(t){return t.getParam("color_map")},WT=function(t){var n=LT(t);return void 0!==n?HT(n):VT},UT=function(){return tt(PT.state(),function(t){return{type:IT,text:t,value:t}})},jT=function(t){PT.add(t)},GT="#000000",XT=function(t,n){var e;return t.dom.getParents(t.selection.getStart(),function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)}),j.from(e)},YT=function(t,n,e){t.undoReceptionist.transact(function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()})},qT=function(t,n){t.undoReceptionist.transact(function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()})},KT=function(t){t.addCommand("mceApplyTextcolor",function(n,e){YT(t,n,e)}),t.addCommand("mceRemoveTextcolor",function(n){qT(t,n)})},JT=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},$T=function(t){var n=WT(t),e=JT(n.length);return zT(t,e)},QT=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},o={type:n,text:"Custom color",icon:"color-picker",value:"custom"};return t?[e,o]:[e]},ZT=function(t,n,e,o){if("custom"===e){var r=iE(t);r(function(e){e.each(function(e){jT(e),t.execCommand("mceApplyTextcolor",n,e),o(e)})},GT)}else"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},tE=function(t,n){return t.concat(UT().concat(QT(n)))},nE=function(t,n){return function(e){e(tE(t,n))}},eE=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},oE=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o=XT(t,e);return o.bind(function(t){return yT(t).map(function(t){var e=cT(t).value;return Jt(n.toLowerCase(),e)})}).getOr(!1)},columns:$T(t),fetch:nE(WT(t),NT(t)),onAction:function(n){ZT(t,e,r.get(),T)},onItemAction:function(o,i){ZT(t,e,i,function(e){r.set(e),TT(t,{name:n,color:e})})},onSetup:function(e){eE(e,n,r.get());var o=function(t){t.name===n&&eE(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},rE=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){ZT(t,e,n.value,T)}}]}})},iE=function(t){return function(n,e){var o=!1,r=function(e){var r=e.getData(),i=r.colorpicker;o?(n(j.from(i)),e.close()):t.windowReceptionist.alert(t.translate(["Invalid hex color code: {0}",i]))},i=function(t,n){"hex-valid"===n.name&&(o=n.value)},u={colorpicker:e};t.windowReceptionist.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:u,onAction:i,onSubmit:r,onClose:T,onCancel:function(){n(j.none())}})}},uE=function(t){KT(t);var n=du(GT),e=du(GT);oE(t,"forecolor","forecolor","Text color",n),oE(t,"backcolor","hilitecolor","Background color",e),rE(t,"forecolor","forecolor","Text color"),rE(t,"backcolor","hilitecolor","Background color")},aE=function(t,n,e,o,r,i,u,a){var c=DC(n),s="color"!==r?"normal":"color",f=cE(n,e,o,s,i,u,a);return MC(t,c,f,o,r)},cE=function(t,n,e,o,r,i,u){return zt(tt(t,function(a){return"choiceitem"===a.type?UC(a).fold(BC,function(c){return j.some($_(c,1===e,o,n,i(a.value),r,u,DC(t)))}):j.none()}))},sE=function(t,n){var e=yC(n);if(1===t)return{mode:"menu",moveOnTab:!0};if("auto"===t)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var o="color"===n?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o}},fE=function(t,n){return 1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+Qk:"."+$k}}},lE=function(t,n){var e=dE(t,n),o=n.colorinput.getColorCols(),r="color",i=aE(mc("menu-value"),e,function(n){t.onAction({value:n})},o,r,Kk.CLOSE_ON_EXECUTE,V,n.shared.providers),u=z(z({},i),{markers:yC(r),movement:sE(o,r)});return{type:"widget",data:{value:mc("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Q_.widget(qw.sketch(u))]}},dE=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold(function(){return tE(n.colorinput.getColors(),e)},function(t){return t.concat(QT(e))})},mE=mc("cell-over"),gE=mc("cell-execute"),pE=function(t,n,e){var o,r=function(e){return Ma(e,mE,{row:t,col:n})},i=function(e){return Ma(e,gE,{row:t,col:n})},u=function(t,n){n.stop(),i(t)};return Vs({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:xl([Kx("insert-table-picker-cell",[La(Xu(),rw.focus),La(fa(),i),La(Zu(),u),La(da(),u)]),kw.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),rw.config({onFocus:r})])})},vE=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(pE(r,u,t));o.push(i)}return o},hE=function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)kw.set(t[i][u],i<=n&&u<=e)},bE=function(t){return lt(t,function(t){return tt(t,Ps)})},yE=function(t,n){return Ms(n+"x"+t)},xE=function(t){var n=10,e=10,o=mc("size-label"),r=vE(o,n,e),i=yE(0,0),u=MS({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[i],behaviours:xl([Yx.config({})])});return{type:"widget",data:{value:mc("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Q_.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:bE(r).concat(u.asSpec()),behaviours:xl([Kx("insert-table-picker",[$a(function(t){Yx.set(u.get(t),[i])}),Ya(mE,function(t,o,i){var a=i.event,c=a.row,s=a.col;hE(r,c,s,n,e),Yx.set(u.get(t),[yE(c+1,s+1)])}),Ya(gE,function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),Aa(n,ga())})]),Px.config({initSize:{numRows:n,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}},wE={inserttable:xE,colorswatch:lE},SE=function(t,n){return Rt(wE,t.fancytype).map(function(e){return e(t,n)})},kE=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i=r?H_(e.icons):P_(e.icons),u=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},a=j_({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:j.none(),ariaLabel:t.text,caret:j.some(i),checkMark:j.none(),shortcutContent:t.shortcut},e,o);return T_({data:E_(t),getApi:u,disabled:t.disabled,onAction:T,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)},CE=function(t,n,e,o){void 0===o&&(o=!0);var r=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},i=j_({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:j.none(),ariaLabel:t.text,caret:j.none(),checkMark:j.none(),shortcutContent:t.shortcut},e,o);return T_({data:E_(t),getApi:r,disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,e)},OE=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:z({tag:"div",classes:[$k,nC]},n),components:[]}},_E=function(t,n,e,o){void 0===o&&(o=!0);var r=function(t){return{setActive:function(n){kw.set(t,n)},isActive:function(){return kw.isOn(t)},isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},i=j_({iconContent:t.icon,textContent:t.text,htmlContent:j.none(),ariaLabel:t.text,checkMark:j.some(V_(e.icons)),caret:j.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return Br(T_({data:E_(t),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,n,e),{toggling:{toggleClass:tC,toggleOnExecute:!1,selected:t.active}})},TE=q_,EE=OE,DE=CE,BE=kE,AE=_E,ME=SE,FE=J_;(function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"})(LO||(LO={}));var RE=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?z(z({},t),{shortcut:j.none(),icon:t.text.isSome()?j.none():t.icon}):t};switch(t.type){case"menuitem":return JC(t).fold(BC,function(t){return j.some(DE(u(t),n,i,o))});case"nestedmenuitem":return QC(t).fold(BC,function(t){return j.some(BE(u(t),n,i,o,r))});case"togglemenuitem":return tO(t).fold(BC,function(t){return j.some(AE(u(t),n,i,o))});case"separator":return Ck(t).fold(BC,function(t){return j.some(EE(t))});case"fancymenuitem":return qC(t).fold(BC,function(t){return ME(u(t),e)});default:return console.error("Unknown item in general menu",t),j.none()}},IE=function(t,n,e,o,r,i,u){var a=1===o,c=!a||DC(t);return zt(tt(t,function(t){switch(t.type){case"separator":return Tk(t).fold(BC,function(t){return j.some(EE(t))});case"cardmenuitem":return LC(t).fold(BC,function(t){return j.some(FE(z(z({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:G_(t.meta,i),cardText:{matchText:n,highlightOn:u}}))});case"autocompleteitem":default:return Ek(t).fold(BC,function(t){return j.some(TE(t,n,a,"normal",e,r,i,c))})}}))},VE=function(t,n,e,o,r){var i=DC(n),u=zt(tt(n,function(t){var n=function(t){return r?!It(t,"text"):i},u=function(t){return RE(t,e,o,n(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?u(z(z({},t),{disabled:!0})):u(t)})),a=r?AC:MC;return a(t,i,u,1,"normal")},PE=function(t){return uS.singleData(t.value,t)},HE=function(t,n,e,o){var r=e===LO.ContentFocus?Fb():Mb(),i=sE(n,o),u=yC(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===LO.ContentFocus,focusReceptionist:r,menuBehaviours:rO.unnamedEvents("auto"!==n?[]:[$a(function(t,n){nO(t,4,u.item).each(function(n){var e=n.numColumns,o=n.numRows;Px.setGridSize(t,o,e)})})])}},zE=function(t,n){var e=ld(),o=du(!1),r=Vs(sS.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:xl([Kx("dismissAutocompleter",[La(ka(),function(){return c()})])]),lazySink:n.getSink})),i=function(){return sS.isOpen(r)},u=function(){return e.get().isSome()},a=function(){u()&&sS.hide(r)},c=function(){if(u()){var n=e.get().map(function(t){return t.element});ek(n.getOr(fn.fromDom(t.selection.getNode()))).each(Go),a(),e.clear(),o.set(!1)}},s=kn(function(){return Yk(t)}),f=function(e,r){var i=St(r,function(t){return j.from(t.columns)}).getOr(1);return lt(r,function(r){var u=r.items;return IE(u,r.matchText,function(n,i){var u=t.selection.getRng();sk(t.dom,u,e).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var e=t.range,u={hide:function(){c()},reload:function(t){a(),g(t)}};o.set(!0),r.onAction(u,e,n,i),o.set(!1)})},i,Kk.BUBBLE_TO_SANDBOX,n,r.highlightOn)})},l=function(n){if(!u()){var r=nk(t,n.range);e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}},d=function(n,e,o,i){n.matchLength=e.text.length;var u=St(o,function(t){return j.from(t.columns)}).getOr(1);sS.showAt(r,qw.sketch(HE(MC("autocompleter-value",!0,i,u,"normal"),u,LO.ContentFocus,"normal")),{anchor:{type:"node",root:fn.fromDom(t.getBody()),node:j.from(n.element)}}),sS.getContent(r).each(fb.highlightFirst)},m=function(n){return e.get().map(function(e){return sk(t.dom,t.selection.getRng(),e.triggerChar).bind(function(e){return Sk(t,s,e,n)})}).getOrThunk(function(){return wk(t,s)})},g=function(t){m(t).fold(c,function(t){l(t.context),t.lookupData.then(function(n){e.get().map(function(e){var o=t.context;if(e.triggerChar===o.triggerChar){var r=f(o.triggerChar,n);r.length>0?d(e,o,n,r):o.text.length-e.matchLength>=10?c():a()}})})})},p=JS(function(t){27!==t.which&&g()},50),v={onKeypress:p,cancelIfNecessary:c,isMenuOpen:i,isActive:u,isProcessingAction:o.get,getView:function(){return sS.getContent(r)}};!1===t.hasPlugin("rtc")&&lk.setup(v,t)},NE={register:zE},LE=function(t,n,e){return Xs(t,n,e).isSome()},WE=function(t,n){var e=null,o=function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout(function(){t.apply(null,o),e=null},n)},r=function(){null!==e&&(clearTimeout(e),e=null)};return{cancel:r,schedule:o}},UE=5,jE=400,GE=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?j.none():j.some(n.touches[0])},XE=function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>UE||o>UE},YE=function(t){var n=ld(),e=du(!1),o=WE(function(n){t.triggerEvent(ma(),n),e.set(!0)},jE),r=function(t){return GE(t).each(function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)}),j.none()},i=function(t){return o.cancel(),GE(t).each(function(t){n.on(function(e){XE(t,e)&&n.clear()})}),j.none()},u=function(r){o.cancel();var i=function(t){return he(t.target,r.target)};return n.get().filter(i).map(function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(da(),r)})},a=ku([{key:Hu(),value:r},{key:zu(),value:i},{key:Nu(),value:u}]),c=function(t,n){return Rt(a,n).bind(function(n){return n(t)})};return{fireIfReady:c}},qE=function(t){var n=t.raw;return n.which===lb[0]&&!J(["input","textarea"],vn(t.target))&&!LE(t.target,'[contenteditable="true"]')},KE=function(){return fe().browser.isFirefox()},JE=function(t,n){return KE()?gd(t,"focus",n):md(t,"focusin",n)},$E=function(t,n){return KE()?gd(t,"blur",n):md(t,"focusout",n)},QE=function(t,n){var e=z({stopBackspace:!0},n),o=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],r=YE(e),i=tt(o.concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return md(t,n,function(t){r.fireIfReady(t,n).each(function(n){n&&t.kill()});var o=e.triggerEvent(n,t);o&&t.kill()})}),u=ld(),a=md(t,"paste",function(t){r.fireIfReady(t,"paste").each(function(n){n&&t.kill()});var n=e.triggerEvent("paste",t);n&&t.kill(),u.set(setTimeout(function(){e.triggerEvent(ca(),t)},0))}),c=md(t,"keydown",function(t){var n=e.triggerEvent("keydown",t);n?t.kill():e.stopBackspace&&qE(t)&&t.prevent()}),s=JE(t,function(t){var n=e.triggerEvent("focusin",t);n&&t.kill()}),f=ld(),l=$E(t,function(t){var n=e.triggerEvent("focusout",t);n&&t.kill(),f.set(setTimeout(function(){e.triggerEvent(aa(),t)},0))}),d=function(){nt(i,function(t){t.unbind()}),c.unbind(),s.unbind(),l.unbind(),a.unbind(),u.on(clearTimeout),f.on(clearTimeout)};return{unbind:d}},ZE=function(t,n){var e=Rt(t,"target").getOr(n);return du(e)},tD=function(t,n){var e=du(!1),o=du(!1),r=function(){e.set(!0)},i=function(){o.set(!0)};return{stop:r,cut:i,isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}},nD=function(t){var n=du(!1),e=function(){n.set(!0)};return{stop:e,cut:T,isStopped:n.get,isCut:V,event:t,setSource:I("Cannot set source of a broadcasted event"),getSource:I("Cannot get source of a broadcasted event")}},eD=gu.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),oD=function(t,n,e,o,r,i){var u=t(n,o),a=tD(e,r);return u.fold(function(){return i.logEventNoHandlers(n,o),eD.complete()},function(t){var e=t.descHandler,o=Xc(e);return o(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),eD.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),eD.complete()):Oe(t.element).fold(function(){return i.logNoParent(n,t.element,e.purpose),eD.complete()},function(o){return i.logEventResponse(n,t.element,e.purpose),eD.resume(o)})})},rD=function(t,n,e,o,r,i){return oD(t,n,e,o,r,i).fold(P,function(o){return rD(t,n,e,o,r,i)},V)},iD=function(t,n,e,o,r){var i=ZE(e,o);return oD(t,n,e,o,i,r)},uD=function(t,n,e){var o=nD(n);return nt(t,function(t){var n=t.descHandler,e=Xc(n);e(o)}),o.isStopped()},aD=function(t,n,e,o){return cD(t,n,e,e.target,o)},cD=function(t,n,e,o,r){var i=ZE(e,o);return rD(t,n,e,o,i,r)},sD=function(t,n){return{element:t,descHandler:n}},fD=function(t,n){return{id:t,descHandler:n}},lD=function(){var t={},n=function(n,e,o){Ot(o,function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=Gc(o,n),t[r]=i})},e=function(t,n){return xc(n).bind(function(n){return Rt(t,n)}).map(function(t){return sD(n,t)})},o=function(n){return Rt(t,n).map(function(t){return At(t,function(t,n){return fD(n,t)})}).getOr([])},r=function(n,o,r){return Rt(t,o).bind(function(t){return Du(r,function(n){return e(t,n)},n)})},i=function(n){Ot(t,function(t,e){It(t,n)&&delete t[n]})};return{registerId:n,unregisterId:i,filterByType:o,find:r}},dD=function(){var t=lD(),n={},e=function(t){var n=t.element;return xc(n).getOrThunk(function(){return bc("uid-",t.element)})},o=function(t,e){var o=n[e];if(o!==t)throw new Error('The tagId "'+e+'" is already used by: '+cc(o.element)+"\nCannot use it for: "+cc(t.element)+"\nThe conflicting element is"+(je(o.element)?" ":" not ")+"already in the DOM");i(t)},r=function(r){var i=e(r);Vt(n,i)&&o(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},i=function(e){xc(e.element).each(function(e){delete n[e],t.unregisterId(e)})},u=function(n){return t.filterByType(n)},a=function(n,e,o){return t.find(n,e,o)},c=function(t){return Rt(n,t)};return{find:a,filter:u,register:r,unregister:i,getById:c}},mD=function(t){var e=t.dom,o=e.attributes,r=n(e,["attributes"]);return{uid:t.uid,dom:z({tag:"div",attributes:z({role:"presentation"},o)},r),components:t.components,behaviours:sv(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},gD=yh({name:"Container",factory:mD,configFields:[eu("components",[]),cv("containerBehaviours",[]),eu("events",{}),eu("domModification",{}),eu("eventOrder",{})]}),pD=function(t){var n=function(n){return Oe(t.element).fold(P,function(t){return he(n,t)})},e=dD(),o=function(t,o){return e.find(n,t,o)},r=QE(t.element,{triggerEvent:function(t,n){return rf(t,n.target,function(e){return aD(o,t,n,e)})}}),i={debugInfo:A("real"),triggerEvent:function(t,n,e){rf(t,n,function(r){return cD(o,t,e,n,r)})},triggerFocus:function(t,n){xc(t).fold(function(){Bl(t)},function(e){rf(ua(),t,function(e){return iD(o,ua(),{originator:n,kill:T,prevent:T,target:t},t,e),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return p(t)},getByDom:function(t){return v(t)},build:Vs,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){d(t)},broadcastOn:function(t,n){m(t,n)},broadcastEvent:function(t,n){g(t,n)},isConnected:P},u=function(t){t.connect(i),xn(t.element)||(e.register(t),nt(t.components(),u),i.triggerEvent(va(),t.element,{target:t.element}))},a=function(t){xn(t.element)||(nt(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){$g(t,n)},s=function(t){tp(t)},f=function(){r.unbind(),jo(t.element)},l=function(t){var n=e.filter(sa());nt(n,function(n){var e=n.descHandler,o=Xc(e);o(t)})},d=function(t){l({universal:!0,data:t})},m=function(t,n){l({universal:!1,channels:t,data:n})},g=function(t,n){var o=e.filter(t);return uD(o,n)},p=function(t){return e.getById(t).fold(function(){return dr.error(new Error('Could not find component with uid: "'+t+'" in system.'))},dr.value)},v=function(t){var n=xc(t).getOr("not found");return p(n)};return u(t),{root:t,element:t.element,destroy:f,add:c,remove:s,getByUid:p,getByDom:v,addToWorld:u,removeFromWorld:a,broadcast:d,broadcastOn:m,broadcastEvent:g}},vD=function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:tt(t.items,n.interpreter)}},hD=A([eu("prefix","form-field"),cv("fieldBehaviours",[Oh,av])]),bD=A([Wv({schema:[Pi("dom")],name:"label"}),Wv({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Pi("text")],name:"aria-descriptor"}),Nv({factory:{sketch:function(t){var n=wu(t,["factory"]);return t.factory.sketch(n)}},schema:[Pi("factory")],name:"field"})]),yD=function(t,n,e,o){var r=fv(t.fieldBehaviours,[Oh.config({find:function(n){return nh(n,t,"field")}}),av.config({store:{mode:"manual",getValue:function(t){return Oh.getCurrent(t).bind(av.getValue)},setValue:function(t,n){Oh.getCurrent(t).each(function(t){av.setValue(t,n)})}}})]),i=Pa([$a(function(n,e){var o=oh(n,t,["label","field","aria-descriptor"]);o.field().each(function(n){var e=mc(t.prefix);o.label().each(function(t){qe(t.element,"for",e),qe(n.element,"id",e)}),o["aria-descriptor"]().each(function(e){var o=mc(t.prefix);qe(e.element,"id",o),qe(n.element,"aria-describedby",o)})})})]),u={getField:function(n){return nh(n,t,"field")},getLabel:function(n){return nh(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},xD=xh({name:"FormField",configFields:hD(),partFields:bD(),factory:yD,apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),wD=function(t,n){return zc({attributes:ku([{key:n.tabAttr,value:"true"}])})},SD=Object.freeze({__proto__:null,exhibit:wD}),kD=[eu("tabAttr","data-alloy-tabstop")],CD=Sl({fields:kD,name:"tabstopping",active:SD}),OD=tinymce.util.Tools.resolve("tinymce.html.Entities"),_D=function(t,n,e,o){var r=ED(t,n,e,o);return xD.sketch(r)},TD=function(t,n){return _D(t,n,[],[])},ED=function(t,n,e,o){return{dom:BD(e),components:t.toArray().concat([n]),fieldBehaviours:xl(o)}},DD=function(){return BD([])},BD=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},AD=function(t,n){return xD.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},MD=mc("form-component-change"),FD=mc("form-close"),RD=mc("form-cancel"),ID=mc("form-action"),VD=mc("form-submit"),PD=mc("form-block"),HD=mc("form-unblock"),zD=mc("form-tabchange"),ND=mc("form-resize"),LD=function(t,n){var e,o=t.label.map(function(t){return AD(t,n)}),r=function(t){return function(n,e){Xs(e.event.target,"[data-collection-item-value]").each(function(o){t(n,e,o,Je(o,"data-collection-item-value"))})}},i=function(e,o){var r=tt(o,function(e){var o=FS.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,function(t){return u[t]}),c=n.isDisabled()?" tox-collection__item--state-disabled":"";return'<div class="tox-collection__item'+c+'" tabindex="-1" data-collection-item-value="'+OD.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"}),i="auto"!==t.columns&&t.columns>1?Z(r,t.columns):[r],u=tt(i,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});oc(e.element,u.join(""))},u=r(function(e,o,r,i){o.stop(),n.isDisabled()||Ma(e,ID,{name:t.name,value:i})}),a=[La(Xu(),r(function(t,n,e){Bl(e)})),La(Zu(),u),La(da(),u),La(Yu(),r(function(t,n,e){Gs(t.element,"."+aC).each(function(t){vs(t,aC)}),gs(e,aC)})),La(qu(),r(function(t){Gs(t.element,"."+aC).each(function(t){vs(t,aC)})})),tc(r(function(n,e,o,r){Ma(n,ID,{name:t.name,value:r})}))],c=function(t,n){return tt(eg(t.element,".tox-collection__item"),n)},s=xD.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:M},behaviours:xl([jh.config({disabled:n.isDisabled,onDisabled:function(t){c(t,function(t){gs(t,"tox-collection__item--state-disabled"),qe(t,"aria-disabled",!0)})},onEnabled:function(t){c(t,function(t){vs(t,"tox-collection__item--state-disabled"),Ze(t,"aria-disabled")})}}),p_(),Yx.config({}),av.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){i(n,e),"auto"===t.columns&&nO(n,5,"tox-collection__item").each(function(t){var e=t.numRows,o=t.numColumns;Px.setGridSize(n,e,o)}),Aa(n,ND)}}),CD.config({}),Px.config(fE(t.columns,"normal")),Kx("collection-events",a)]),eventOrder:(e={},e[fa()]=["disabling","alloy.base.behaviour","collection-events"],e)}),f=["tox-form__group--collection"];return _D(o,s,f,[])},WD=A([qi("data"),eu("inputAttributes",{}),eu("inputStyles",{}),eu("tag","input"),eu("inputClasses",[]),pf("onSetValue"),eu("styles",{}),eu("eventOrder",{}),cv("inputBehaviours",[av,rw]),eu("selectOnFocus",!0)]),UD=function(t){return xl([rw.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=ws(n);n.dom.setSelectionRange(0,e.length)}:T})])},jD=function(t){return z(z({},UD(t)),fv(t.inputBehaviours,[av.config({store:z(z({mode:"manual"},t.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return ws(t.element)},setValue:function(t,n){var e=ws(t.element);e!==n&&Ss(t.element,n)}}),onSetValue:t.onSetValue})]))},GD=function(t){return{tag:t.tag,attributes:z({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},XD=function(t,n){return{uid:t.uid,dom:GD(t),components:[],behaviours:jD(t),eventOrder:t.eventOrder}},YD=yh({name:"Input",configFields:WD(),factory:XD}),qD={},KD={exports:qD};(function(t,n,e,o){(function(o,r){"object"==typeof n&&void 0!==e?e.exports=r():"function"==typeof t&&t.amd?t(r):(o="undefined"!=typeof globalThis?globalThis:o||self,o.EphoxContactWrapper=r())})(this,function(){var t,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e={exports:{}};t=e,function(n){function e(){}function o(t,n){return function(){t.apply(n,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function i(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn(function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void a(n.promise,t)}u(n.promise,o)}else(1===t._state?u:a)(n.promise,t._value)})):t._deferreds.push(n)}function u(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof r)return t._state=3,t._value=n,void c(t);if("function"==typeof e)return void f(o(e,n),t)}t._state=1,t._value=n,c(t)}catch(n){a(t,n)}}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function f(t,n){var e=!1;try{t(function(t){e||(e=!0,u(n,t))},function(t){e||(e=!0,a(n,t))})}catch(t){if(e)return;e=!0,a(n,t)}}var l=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var o=new this.constructor(e);return i(this,new s(t,n,o)),o},r.all=function(t){var n=Array.prototype.slice.call(t);return new r(function(t,e){function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,function(t){o(i,t)},e)}n[i]=u,0==--r&&t(n)}catch(t){e(t)}}if(0===n.length)return t([]);for(var r=n.length,i=0;i<n.length;i++)o(i,n[i])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(n){n(t)})},r.reject=function(t){return new r(function(n,e){e(t)})},r.race=function(t){return new r(function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)})},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){l(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},t.exports?t.exports=r:n.Promise||(n.Promise=r)}(n);var o=e.exports,r="undefined"!=typeof window?window:Function("return this;")(),i={boltExport:r.Promise||o};return i})})(void 0,qD,KD);var JD,$D=KD.exports.boltExport,QD=function(t){var n=j.none(),e=[],o=function(t){return QD(function(n){r(function(e){n(t(e))})})},r=function(t){u()?c(t):e.push(t)},i=function(t){u()||(n=j.some(t),a(e),e=[])},u=function(){return n.isSome()},a=function(t){nt(t,c)},c=function(t){n.each(function(n){setTimeout(function(){t(n)},0)})};return t(i),{get:r,map:o,isReady:u}},ZD=function(t){return QD(function(n){n(t)})},tB={nu:QD,pure:ZD},nB=function(t){setTimeout(function(){throw t},0)},eB=function(t){var n=function(n){t().then(n,nB)},e=function(n){return eB(function(){return t().then(n)})},o=function(n){return eB(function(){return t().then(function(t){return n(t).toPromise()})})},r=function(n){return eB(function(){return t().then(function(){return n.toPromise()})})},i=function(){return tB.nu(n)},u=function(){var n=null;return eB(function(){return null===n&&(n=t()),n})},a=t;return{map:e,bind:o,anonBind:r,toLazy:i,toCached:u,toPromise:a,get:n}},oB=function(t){return eB(function(){return new $D(t)})},rB=function(t){return eB(function(){return $D.resolve(t)})},iB={nu:oB,pure:rB},uB=["input","textarea"],aB=function(t){var n=vn(t);return J(uB,n)},cB=function(t,n){var e=n.getRoot(t).getOr(t.element);vs(e,n.invalidClass),n.notify.each(function(n){aB(t.element)&&qe(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){oc(t,n.validHtml)}),n.onValid(t)})},sB=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);gs(r,n.invalidClass),n.notify.each(function(n){aB(t.element)&&qe(t.element,"aria-invalid",!0),n.getContainer(t).each(function(t){oc(t,o)}),n.onInvalid(t,o)})},fB=function(t,n,e){return n.validator.fold(function(){return iB.pure(dr.value(!0))},function(n){return n.validate(t)})},lB=function(t,n,e){return n.notify.each(function(n){n.onValidate(t)}),fB(t,n).map(function(o){return t.getSystem().isConnected()?o.fold(function(o){return sB(t,n,e,o),dr.error(o)},function(e){return cB(t,n),dr.value(e)}):dr.error("No longer in system")})},dB=function(t,n){var e=n.getRoot(t).getOr(t.element);return hs(e,n.invalidClass)},mB=Object.freeze({__proto__:null,markValid:cB,markInvalid:sB,query:fB,run:lB,isInvalid:dB}),gB=function(t,n){return t.validator.map(function(e){return Pa([La(e.onEvent,function(e){lB(e,t,n).get(M)
})].concat(e.validateOnLoad?[$a(function(e){lB(e,t,n).get(T)})]:[]))}).getOr({})},pB=Object.freeze({__proto__:null,events:gB}),vB=[Pi("invalidClass"),eu("getRoot",j.none),tu("notify",[eu("aria","alert"),eu("getContainer",j.none),eu("validHtml",""),pf("onValid"),pf("onInvalid"),pf("onValidate")]),tu("validator",[Pi("validate"),eu("onEvent","input"),eu("validateOnLoad",!0)])],hB=Sl({fields:vB,name:"invalidating",active:pB,apis:mB,extra:{validation:function(t){return function(n){var e=av.getValue(n);return iB.pure(t(e))}}}}),bB=function(t,n,e,o){return e.getOrCreate(t,n,o)},yB=Object.freeze({__proto__:null,getCoupled:bB}),xB=[Hi("others",_i(dr.value,gi()))],wB=function(){var t={},n=function(n,e,o){var r=kt(e.others);if(r)return Rt(t,o).getOrThunk(function(){var r=Rt(e.others,o).getOrDie("No information found for coupled component: "+o),i=r(n),u=n.getSystem().build(i);return t[o]=u,u});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))},e=A({});return Rc({readState:e,getOrCreate:n})},SB=Object.freeze({__proto__:null,init:wB}),kB=Sl({fields:xB,name:"coupling",apis:yB,state:SB}),CB=A("sink"),OB=A(Wv({name:CB(),overrides:A({dom:{tag:"div"},behaviours:xl([Gg.config({useFixed:P})]),events:Pa([qa(Ku()),qa(Wu()),qa(Zu())])})}));(function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"})(JD||(JD={}));var _B,TB,EB=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold(function(){return{type:o,hotspot:e,overrides:r}},function(t){return{type:o,hotspot:e,overrides:r,layouts:t}})},DB=function(t,n,e){var o=t.fetch;return o(e).map(n)},BB=function(t,n,e,o,r,i,u){var a=DB(t,n,o),c=IB(o,t);return a.map(function(t){return t.bind(function(t){return j.from(uS.sketch(z(z({},i.menu()),{uid:wc(""),data:t,highlightImmediately:u===JD.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();Gg.position(o,n,{anchor:e}),Op.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Gg.position(o,e,{anchor:{type:"submenu",item:n}}),Op.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();Gg.position(r,n,{anchor:e}),nt(o,function(t){Gg.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})})},onEscape:function(){return rw.focus(o),Op.close(r),j.some(!0)}})))})})},AB=function(t,n,e,o,r,i,u){var a=EB(t,e),c=BB(t,n,a,e,o,r,u);return c.map(function(t){return t.fold(function(){Op.isOpen(o)&&Op.close(o)},function(t){Op.cloak(o),Op.open(o,t),i(o)}),o})},MB=function(t,n,e,o,r,i,u){return Op.close(o),iB.pure(o)},FB=function(t,n,e,o,r,i){var u=kB.getCoupled(e,"sandbox"),a=Op.isOpen(u),c=a?MB:AB;return c(t,n,e,u,o,r,i)},RB=function(t,n,e){var o=Oh.getCurrent(n).getOr(n),r=_o(t.element);e?eo(o.element,"min-width",r+"px"):Oo(o.element,r)},IB=function(t,n){return t.getSystem().getByUid(n.uid+"-"+CB()).map(function(t){return function(){return dr.value(t)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return dr.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(t)}})})},VB=function(t){Op.getState(t).each(function(t){uS.repositionMenus(t)})},PB=function(t,n,e){var o=qs(),r=function(r,i){var u=EB(t,n);o.link(n.element),t.matchWidth&&RB(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},i=function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},u=IB(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:lv.augment(t.sandboxBehaviours,[av.config({store:{mode:"memory",initialValue:n}}),Op.config({onOpen:r,onClose:i,isPartOf:function(t,e,o){return Js(e,o)||Js(n,o)},getAttachPoint:function(){return u().getOrDie()}}),Oh.config({find:function(t){return Op.getState(t).bind(function(t){return Oh.getCurrent(t)})}}),_l.config({channels:z(z({},Bp({isExtraPart:V})),Mp({doReposition:VB}))})])}},HB=function(t){var n=kB.getCoupled(t,"sandbox");VB(n)},zB=function(){return[eu("sandboxClasses",[]),lv.field("sandboxBehaviours",[Oh,_l,Op,av])]},NB=A([Pi("dom"),Pi("fetch"),pf("onOpen"),vf("onExecute"),eu("getHotspot",j.some),eu("getAnchorOverrides",A({})),Xd(),cv("dropdownBehaviours",[kw,kB,Px,rw]),Pi("toggleClass"),eu("eventOrder",{}),qi("lazySink"),eu("matchWidth",!1),eu("useMinWidth",!1),qi("role")].concat(zB())),LB=A([Lv({schema:[df()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),OB()]),WB=function(t,n,e,o){var r,i=function(n){return Rt(t.dom,"attributes").bind(function(t){return Rt(t,n)})},u=function(t){Op.getState(t).each(function(t){uS.highlightPrimary(t)})},a=function(n){var e=u;FB(t,M,n,o,e,JD.HighlightFirst).get(T)},c={expand:function(n){kw.isOn(n)||FB(t,M,n,o,T,JD.HighlightNone).get(T)},open:function(n){kw.isOn(n)||FB(t,M,n,o,T,JD.HighlightFirst).get(T)},isOpen:kw.isOn,close:function(n){kw.isOn(n)&&FB(t,M,n,o,T,JD.HighlightFirst).get(T)},repositionMenus:function(t){kw.isOn(t)&&HB(t)}},s=function(t,n){return Fa(t),j.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.dropdownBehaviours,[kw.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),kB.config({others:{sandbox:function(n){return PB(t,n,{onOpen:function(){return kw.on(n)},onClose:function(){return kw.off(n)}})}}}),Px.config({mode:"special",onSpace:s,onEnter:s,onDown:function(t,n){if(UB.isOpen(t)){var e=kB.getCoupled(t,"sandbox");u(e)}else UB.open(t);return j.some(!0)},onEscape:function(t,n){return UB.isOpen(t)?(UB.close(t),j.some(!0)):j.none()}}),rw.config({})]),events:Ow(j.some(a)),eventOrder:z(z({},t.eventOrder),(r={},r[fa()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:c,domModification:{attributes:z(z({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(t){return{role:t}})),"button"===t.dom.tag?{type:i("type").getOr("button")}:{})}}},UB=xh({name:"Dropdown",configFields:NB(),partFields:LB(),factory:WB,apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),jB=function(){return zc({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},GB=function(){return Pa([Ha(oa(),P)])},XB=Object.freeze({__proto__:null,events:GB,exhibit:jB}),YB=Sl({fields:[],name:"unselecting",active:XB}),qB=function(t,n){return UB.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:xl([x_.button(n.providers.isDisabled),p_(),YB.config({}),CD.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return iB.nu(function(n){return t.fetch(n)}).map(function(o){return j.from(PE(Br(aE(mc("menu-value"),o,function(n){t.onItemAction(e,n)},t.columns,t.presets,Kk.CLOSE_ON_EXECUTE,V,n.providers),{movement:sE(t.columns,t.presets)})))})},parts:{menu:SC(!1,1,t.presets)}})},KB=mc("color-input-change"),JB=mc("color-swatch-change"),$B=mc("color-picker-cancel"),QB=function(t,n,e){var o=xD.parts.field({factory:YD,inputClasses:["tox-textfield"],onSetValue:function(t){return hB.run(t).get(T)},inputBehaviours:xl([jh.config({disabled:n.providers.isDisabled}),p_(),CD.config({}),hB.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Oe(t.element)},notify:{onValid:function(t){var n=av.getValue(t);Ma(t,KB,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=av.getValue(t);if(0===n.length)return iB.pure(dr.value(!0));var e=fn.fromTag("span");eo(e,"background-color",n);var o=ao(e,"background-color").fold(function(){return dr.error("blah")},function(t){return dr.value(n)});return iB.pure(o)}}})]),selectOnFocus:!1}),r=t.label.map(function(t){return AD(t,n.providers)}),i=function(t,n){Ma(t,JB,{value:n})},u=function(t,n){a.getOpt(t).each(function(t){"custom"===n?e.colorPicker(function(n){n.fold(function(){return Aa(t,$B)},function(n){i(t,n),jT(n)})},"#ffffff"):i(t,"remove"===n?"":n)})},a=MS(qB({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Jf,Kf,tl]},onLtr:function(){return[Kf,Jf,tl]}},components:[],fetch:nE(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},n));return xD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,a.asSpec()]}]),fieldBehaviours:xl([Kx("form-field-events",[La(KB,function(n,e){a.getOpt(n).each(function(t){eo(t.element,"background-color",e.event.color)}),Ma(n,MD,{name:t.name})}),La(JB,function(t,n){xD.getField(t).each(function(e){av.setValue(e,n.event.value),Oh.getCurrent(t).each(rw.focus)})}),La($B,function(t,n){xD.getField(t).each(function(n){Oh.getCurrent(t).each(rw.focus)})})])])})},ZB=Wv({schema:[Pi("dom")],name:"label"}),tA=function(t){return Wv({name:t+"-edge",overrides:function(n){var e=n.model.Receptionist.edgeActions[t];return e.fold(function(){return{}},function(t){return{events:Pa([Wa(Hu(),function(n,e,o){return t(n,o)},[n]),Wa(Wu(),function(n,e,o){return t(n,o)},[n]),Wa(Uu(),function(n,e,o){o.mouseIsDown.get()&&t(n,o)},[n])])}})}})},nA=tA("top-left"),eA=tA("top"),oA=tA("top-right"),rA=tA("right"),iA=tA("bottom-right"),uA=tA("bottom"),aA=tA("bottom-left"),cA=tA("left"),sA=Nv({name:"thumb",defaults:A({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Pa([Xa(Hu(),t,"spectrum"),Xa(zu(),t,"spectrum"),Xa(Nu(),t,"spectrum"),Xa(Wu(),t,"spectrum"),Xa(Uu(),t,"spectrum"),Xa(Gu(),t,"spectrum")])}}}),fA=Nv({schema:[Ii("mouseIsDown",function(){return du(!1)})],name:"spectrum",overrides:function(t){var n=t.model,e=n.Receptionist,o=function(n,o){return e.getValueFromEvent(o).map(function(o){return e.setValueFrom(n,t,o)})};return{behaviours:xl([Px.config({mode:"special",onLeft:function(n){return e.onLeft(n,t)},onRight:function(n){return e.onRight(n,t)},onUp:function(n){return e.onUp(n,t)},onDown:function(n){return e.onDown(n,t)}}),rw.config({})]),events:Pa([La(Hu(),o),La(zu(),o),La(Wu(),o),La(Uu(),function(n,e){t.mouseIsDown.get()&&o(n,e)})])}}}),lA=[ZB,cA,rA,eA,uA,nA,oA,aA,iA,sA,fA],dA="slider.change.value",mA=A(dA),gA=function(t){return-1!==t.type.indexOf("touch")},pA=function(t){var n=t.event.raw;if(gA(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?j.some(e.touches[0]).map(function(t){return yo(t.clientX,t.clientY)}):j.none()}var o=n;return void 0!==o.clientX?j.some(o).map(function(t){return yo(t.clientX,t.clientY)}):j.none()},vA="top",hA="right",bA="bottom",yA="left",xA=function(t){return t.model.minX},wA=function(t){return t.model.minY},SA=function(t){return t.model.minX-1},kA=function(t){return t.model.minY-1},CA=function(t){return t.model.maxX},OA=function(t){return t.model.maxY},_A=function(t){return t.model.maxX+1},TA=function(t){return t.model.maxY+1},EA=function(t,n,e){return n(t)-e(t)},DA=function(t){return EA(t,CA,xA)},BA=function(t){return EA(t,OA,wA)},AA=function(t){return DA(t)/2},MA=function(t){return BA(t)/2},FA=function(t){return t.stepSize},RA=function(t){return t.snapToGrid},IA=function(t){return t.snapStart},VA=function(t){return t.rounded},PA=function(t,n){return void 0!==t[n+"-edge"]},HA=function(t){return PA(t,yA)},zA=function(t){return PA(t,hA)},NA=function(t){return PA(t,vA)},LA=function(t){return PA(t,bA)},WA=function(t){return t.model.value.get()},UA=function(t){return{x:t}},jA=function(t){return{y:t}},GA=function(t,n){return{x:t,y:n}},XA=function(t,n){Ma(t,mA(),{value:n})},YA=function(t,n){XA(t,GA(SA(n),kA(n)))},qA=function(t,n){XA(t,jA(kA(n)))},KA=function(t,n){XA(t,GA(AA(n),kA(n)))},JA=function(t,n){XA(t,GA(_A(n),kA(n)))},$A=function(t,n){XA(t,UA(_A(n)))},QA=function(t,n){XA(t,GA(_A(n),MA(n)))},ZA=function(t,n){XA(t,GA(_A(n),TA(n)))},tM=function(t,n){XA(t,jA(TA(n)))},nM=function(t,n){XA(t,GA(AA(n),TA(n)))},eM=function(t,n){XA(t,GA(SA(n),TA(n)))},oM=function(t,n){XA(t,UA(SA(n)))},rM=function(t,n){XA(t,GA(SA(n),MA(n)))},iM=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},uM=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},aM=function(t,n,e){return Math.max(n,Math.min(e,t))},cM=function(t,n,e,o,r){return r.fold(function(){var r=t-n,i=Math.round(r/o)*o;return aM(n+i,n-1,e+1)},function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=Math.min(a,u+i),s=n+c*o;return Math.max(n,s)})},sM=function(t,n,e){return Math.min(e,Math.max(t,n))-n},fM=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var v=sM(r,l,d),h=aM(v/m*o+n,g,p);return u&&h>=n&&h<=e?cM(h,n,e,i,a):c?Math.round(h):h},lM=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},dM="top",mM="right",gM="bottom",pM="left",vM="width",hM="height",bM=function(t){return t.element.dom.getBoundingClientRect()},yM=function(t,n){return t[n]},xM=function(t){var n=bM(t);return yM(n,pM)},wM=function(t){var n=bM(t);return yM(n,mM)},SM=function(t){var n=bM(t);return yM(n,dM)},kM=function(t){var n=bM(t);return yM(n,gM)},CM=function(t){var n=bM(t);return yM(n,vM)},OM=function(t){var n=bM(t);return yM(n,hM)},_M=function(t,n,e){return(t+n)/2-e},TM=function(t,n){var e=bM(t),o=bM(n),r=yM(e,pM),i=yM(e,mM),u=yM(o,pM);return _M(r,i,u)},EM=function(t,n){var e=bM(t),o=bM(n),r=yM(e,dM),i=yM(e,gM),u=yM(o,dM);return _M(r,i,u)},DM=function(t,n){Ma(t,mA(),{value:n})},BM=function(t){return{x:t}},AM=function(t,n,e){var o={min:xA(n),max:CA(n),range:DA(n),value:e,step:FA(n),snap:RA(n),snapStart:IA(n),rounded:VA(n),hasMinEdge:HA(n),hasMaxEdge:zA(n),minBound:xM(t),maxBound:wM(t),screenRange:CM(t)};return fM(o)},MM=function(t,n,e){var o=AM(t,n,e),r=BM(o);return DM(t,r),o},FM=function(t,n){var e=xA(n);DM(t,BM(e))},RM=function(t,n){var e=CA(n);DM(t,BM(e))},IM=function(t,n,e){var o=t>0?uM:iM,r=o(WA(e).x,xA(e),CA(e),FA(e));return DM(n,BM(r)),j.some(r)},VM=function(t){return function(n,e){return IM(t,n,e).map(P)}},PM=function(t){var n=pA(t);return n.map(function(t){return t.left})},HM=function(t,n,e,o,r){var i=0,u=CM(t),a=o.bind(function(n){return j.some(TM(n,t))}).getOr(i),c=r.bind(function(n){return j.some(TM(n,t))}).getOr(u),s={min:xA(n),max:CA(n),range:DA(n),value:e,hasMinEdge:HA(n),hasMaxEdge:zA(n),minBound:xM(t),minOffset:i,maxBound:wM(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return lM(s)},zM=function(t,n,e,o,r,i){var u=HM(n,i,e,o,r);return xM(n)-xM(t)+u},NM=function(t,n,e,o){var r=WA(e),i=zM(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=_o(n.element)/2;eo(n.element,"left",i-u+"px")},LM=VM(-1),WM=VM(1),UM=j.none,jM=j.none,GM={"top-left":j.none(),top:j.none(),"top-right":j.none(),right:j.some($A),"bottom-right":j.none(),bottom:j.none(),"bottom-left":j.none(),left:j.some(oM)},XM=Object.freeze({__proto__:null,setValueFrom:MM,setToMin:FM,setToMax:RM,findValueOfOffset:AM,getValueFromEvent:PM,findPositionOfValue:zM,setPositionFromValue:NM,onLeft:LM,onRight:WM,onUp:UM,onDown:jM,edgeActions:GM}),YM=function(t,n){Ma(t,mA(),{value:n})},qM=function(t){return{y:t}},KM=function(t,n,e){var o={min:wA(n),max:OA(n),range:BA(n),value:e,step:FA(n),snap:RA(n),snapStart:IA(n),rounded:VA(n),hasMinEdge:NA(n),hasMaxEdge:LA(n),minBound:SM(t),maxBound:kM(t),screenRange:OM(t)};return fM(o)},JM=function(t,n,e){var o=KM(t,n,e),r=qM(o);return YM(t,r),o},$M=function(t,n){var e=wA(n);YM(t,qM(e))},QM=function(t,n){var e=OA(n);YM(t,qM(e))},ZM=function(t,n,e){var o=t>0?uM:iM,r=o(WA(e).y,wA(e),OA(e),FA(e));return YM(n,qM(r)),j.some(r)},tF=function(t){return function(n,e){return ZM(t,n,e).map(P)}},nF=function(t){var n=pA(t);return n.map(function(t){return t.top})},eF=function(t,n,e,o,r){var i=0,u=OM(t),a=o.bind(function(n){return j.some(EM(n,t))}).getOr(i),c=r.bind(function(n){return j.some(EM(n,t))}).getOr(u),s={min:wA(n),max:OA(n),range:BA(n),value:e,hasMinEdge:NA(n),hasMaxEdge:LA(n),minBound:SM(t),minOffset:i,maxBound:kM(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return lM(s)},oF=function(t,n,e,o,r,i){var u=eF(n,i,e,o,r);return SM(n)-SM(t)+u},rF=function(t,n,e,o){var r=WA(e),i=oF(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=po(n.element)/2;eo(n.element,"top",i-u+"px")},iF=j.none,uF=j.none,aF=tF(-1),cF=tF(1),sF={"top-left":j.none(),top:j.some(qA),"top-right":j.none(),right:j.none(),"bottom-right":j.none(),bottom:j.some(tM),"bottom-left":j.none(),left:j.none()},fF=Object.freeze({__proto__:null,setValueFrom:JM,setToMin:$M,setToMax:QM,findValueOfOffset:KM,getValueFromEvent:nF,findPositionOfValue:oF,setPositionFromValue:rF,onLeft:iF,onRight:uF,onUp:aF,onDown:cF,edgeActions:sF}),lF=function(t,n){Ma(t,mA(),{value:n})},dF=function(t,n){return{x:t,y:n}},mF=function(t,n,e){var o=AM(t,n,e.left),r=KM(t,n,e.top),i=dF(o,r);return lF(t,i),i},gF=function(t,n,e,o){var r=t>0?uM:iM,i=n?WA(o).x:r(WA(o).x,xA(o),CA(o),FA(o)),u=n?r(WA(o).y,wA(o),OA(o),FA(o)):WA(o).y;return lF(e,dF(i,u)),j.some(i)},pF=function(t,n){return function(e,o){return gF(t,n,e,o).map(P)}},vF=function(t,n){var e=xA(n),o=wA(n);lF(t,dF(e,o))},hF=function(t,n){var e=CA(n),o=OA(n);lF(t,dF(e,o))},bF=function(t){return pA(t)},yF=function(t,n,e,o){var r=WA(e),i=zM(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=oF(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=_o(n.element)/2,c=po(n.element)/2;eo(n.element,"left",i-a+"px"),eo(n.element,"top",u-c+"px")},xF=pF(-1,!1),wF=pF(1,!1),SF=pF(-1,!0),kF=pF(1,!0),CF={"top-left":j.some(YA),top:j.some(KA),"top-right":j.some(JA),right:j.some(QA),"bottom-right":j.some(ZA),bottom:j.some(nM),"bottom-left":j.some(eM),left:j.some(rM)},OF=Object.freeze({__proto__:null,setValueFrom:mF,setToMin:vF,setToMax:hF,getValueFromEvent:bF,setPositionFromValue:yF,onLeft:xF,onRight:wF,onUp:SF,onDown:kF,edgeActions:CF}),_F=[eu("stepSize",1),eu("onChange",T),eu("onChoose",T),eu("onInit",T),eu("onDragStart",T),eu("onDragEnd",T),eu("snapToGrid",!1),eu("rounded",!0),qi("snapStart"),Hi("model",Mi("mode",{x:[eu("minX",0),eu("maxX",100),Ii("value",function(t){return du(t.mode.minX)}),Pi("getInitialValue"),yf("Receptionist",XM)],y:[eu("minY",0),eu("maxY",100),Ii("value",function(t){return du(t.mode.minY)}),Pi("getInitialValue"),yf("Receptionist",fF)],xy:[eu("minX",0),eu("maxX",100),eu("minY",0),eu("maxY",100),Ii("value",function(t){return du({x:t.mode.minX,y:t.mode.minY})}),Pi("getInitialValue"),yf("Receptionist",OF)]})),cv("sliderBehaviours",[Px,av]),Ii("mouseIsDown",function(){return du(!1)})],TF=function(t,n,e,o){var r,i=function(n){return eh(n,t,"thumb")},u=function(n){return eh(n,t,"spectrum")},a=function(n){return nh(n,t,"left-edge")},c=function(n){return nh(n,t,"right-edge")},s=function(n){return nh(n,t,"top-edge")},f=function(n){return nh(n,t,"bottom-edge")},l=t.model,d=l.Receptionist,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n,e){g(n,e);var o=i(n);return t.onChange(n,o,e),j.some(!0)},v=function(n){d.setToMin(n,t)},h=function(n){d.setToMax(n,t)},b=function(n){var e=function(){nh(n,t,"thumb").each(function(e){var o=l.value.get();t.onChoose(n,e,o)})},o=t.mouseIsDown.get();t.mouseIsDown.set(!1),o&&e()},y=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},x=function(n,e){e.stop(),t.onDragEnd(n,i(n)),b(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.sliderBehaviours,[Px.config({mode:"special",focusIn:function(n){return nh(n,t,"spectrum").map(Px.focusIn).map(P)}}),av.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),_l.config({channels:(r={},r[Ep()]={onReceive:b},r)})]),events:Pa([La(mA(),function(t,n){p(t,n.event.value)}),$a(function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())}),La(Hu(),y),La(Nu(),x),La(Wu(),y),La(Gu(),x)]),apis:{resetToMin:v,resetToMax:h,setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},EF=xh({name:"Slider",configFields:_F,partFields:lA,factory:TF,apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),DF=mc("rgb-hex-update"),BF=mc("slider-update"),AF=mc("palette-update"),MF=function(t,n){var e=EF.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=EF.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return EF.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:A({y:0})},components:[e,o],sliderBehaviours:xl([rw.config({})]),onChange:function(t,n,e){Ma(t,BF,{value:e})}})},FF="form",RF=[cv("formBehaviours",[av])],IF=function(t){return"<alloy.field."+t+">"},VF=function(t){var n,e,o=(n=[],e=function(t,e){return n.push(t),Jv(FF,IF(t),e)},{field:e,record:A(n)}),r=t(o),i=o.record(),u=tt(i,function(t){return Nv({name:t,pname:IF(t)})});return mh(FF,RF,u,HF,r)},PF=function(t,n){return t.fold(function(){return dr.error(n)},dr.value)},HF=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.formBehaviours,[av.config({store:{mode:"manual",getValue:function(n){var e=rh(n,t);return _t(e,function(t,n){return t().bind(function(t){var e=Oh.getCurrent(t);return PF(e,new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+cc(t.element)))}).map(av.getValue)})},setValue:function(n,e){Ot(e,function(e,o){nh(n,t,o).each(function(t){Oh.getCurrent(t).each(function(t){av.setValue(t,e)})})})}}})]),apis:{getField:function(n,e){return nh(n,t,e).bind(Oh.getCurrent)}}}},zF={getField:Mc(function(t,n,e){return t.getField(n,e)}),sketch:VF},NF=mc("valid-input"),LF=mc("invalid-input"),WF=mc("validating-input"),UF="colorcustom.rgb.",jF=function(t,n,e,o){var r=function(e,o){return hB.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Ma(t,WF,{type:e})},onValid:function(t){Ma(t,NF,{type:e,value:av.getValue(t)})},onInvalid:function(t){Ma(t,LF,{type:e,value:av.getValue(t)})}},validator:{validate:function(n){var e=av.getValue(n),r=o(e)?dr.value(!0):dr.error(t("aria.input.invalid"));return iB.pure(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t(UF+"range"),s=xD.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),f=xD.parts.field({data:a,factory:YD,inputAttributes:z({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:xl([r(o,e),CD.config({})]),onSetValue:function(t){if(hB.isInvalid(t)){var n=hB.run(t);n.get(T)}}}),l=[s,f],d="hex"!==o?[xD.parts["aria-descriptor"]({text:c})]:[],m=l.concat(d);return{dom:{tag:"div",attributes:{role:"presentation"}},components:m}},u=function(t,n){var e=cT(n);return zF.getField(t,"hex").each(function(n){rw.isFocused(n)||av.setValue(t,{hex:e.value})}),e},a=function(t,n){var e=n.red,o=n.green,r=n.blue;av.setValue(t,{red:e,green:o,blue:r})},c=MS({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(t,n){c.getOpt(t).each(function(t){eo(t.element,"background-color","#"+n.value)})},f=function(){var r={red:du(j.some(255)),green:du(j.some(255)),blue:du(j.some(255)),hex:du(j.some("ffffff"))},f=function(t,n){var e=hT(n);a(t,e),g(e)},l=function(t){return r[t].get()},d=function(t,n){r[t].set(n)},m=function(){return l("red").bind(function(t){return l("green").bind(function(n){return l("blue").map(function(e){return gT(t,n,e,1)})})})},g=function(t){var n=t.red,e=t.green,o=t.blue;d("red",j.some(n)),d("green",j.some(e)),d("blue",j.some(o))},p=function(t,n){var e=n.event;"hex"!==e.type?d(e.type,j.none()):o(t)},v=function(t,n){e(t);var o=Z_(n);d("hex",j.some(n));var r=hT(o);a(t,r),g(r),Ma(t,DF,{hex:o}),s(t,o)},h=function(t,n,e){var o=parseInt(e,10);d(n,j.some(o)),m().each(function(n){var e=u(t,n);Ma(t,DF,{hex:e}),s(t,e)})},b=function(t){return"hex"===t.type},y=function(t,n){var e=n.event;b(e)?v(t,e.value):h(t,e.type,e.value)},x=function(n){return{label:t(UF+n+".label"),description:t(UF+n+".description")}},w=x("red"),S=x("green"),k=x("blue"),C=x("hex");return Br(zF.sketch(function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",xD.sketch(i(pT,"red",w.label,w.description,255))),e.field("green",xD.sketch(i(pT,"green",S.label,S.description,255))),e.field("blue",xD.sketch(i(pT,"blue",k.label,k.description,255))),e.field("hex",xD.sketch(i(eT,"hex",C.label,C.description,"ffffff"))),c.asSpec()],formBehaviours:xl([hB.config({invalidClass:n("form-invalid")}),Kx("rgb-form-events",[La(NF,y),La(LF,p),La(WF,p)])])}}),{apis:{updateHex:function(t,n){av.setValue(t,{hex:n.value}),f(t,n),s(t,n)}}})},l=yh({factory:f,name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}});return l},GF=function(t,n){var e=EF.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=EF.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},i=function(t,n){var e=t.components()[0].element.dom,o=ET(n,100,100),i=vT(o);r(e,xT(i))},u=function(t,n){var e=DT(hT(n));EF.setValue(t,{x:e.saturation,y:100-e.value})},a=function(t){var i=A({x:0,y:0}),u=function(t,n,e){Ma(t,AF,{value:e})},a=function(t,n,e,o){r(e.element.dom,xT(wT))},c=xl([Oh.config({find:j.some}),rw.config({})]);return EF.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:u,onInit:a,sliderBehaviours:c})},c=yh({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){i(n,e)},setThumb:function(t,n,e){u(n,e)}},extraApis:{}});return c},XF=function(t,n){var e=function(e){var o=jF(t,n,e.onValidHex,e.onInvalidHex),r=GF(t,n),i=function(t){return(100-t)/100*360},u=function(t){return 100-t/360*100},a={paletteRgba:du(wT),paletteHue:du(0)},c=MS(MF(t,n)),s=MS(r.sketch({})),f=MS(o.sketch({})),l=function(t,n,e){s.getOpt(t).each(function(t){r.setHue(t,e)})},d=function(t,n){f.getOpt(t).each(function(t){o.updateHex(t,n)})},m=function(t,n,e){c.getOpt(t).each(function(t){EF.setValue(t,{y:u(e)})})},g=function(t,n){s.getOpt(t).each(function(t){r.setThumb(t,n)})},p=function(t,n){var e=hT(t);a.paletteRgba.set(e),a.paletteHue.set(n)},v=function(t,n,e,o){p(n,e),nt(o,function(o){o(t,n,e)})},h=function(){var t=[d];return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=ET(r,o.x,100-o.y),u=AT(i);v(n,u,r,t)}},b=function(){var t=[l,d];return function(n,e){var o=i(e.event.value.y),r=a.paletteRgba.get(),u=DT(r),c=ET(o,u.saturation,u.value),s=AT(c);v(n,s,o,t)}},y=function(){var t=[l,m,g];return function(n,e){var o=e.event.hex,r=BT(o);v(n,o,r.hue,t)}};return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:xl([Kx("colour-picker-events",[La(DF,y()),La(AF,h()),La(BF,b())]),Oh.config({find:function(t){return f.getOpt(t)}}),Px.config({mode:"acyclic"})])}},o=yh({name:"ColourPicker",configFields:[Pi("dom"),eu("onValidHex",T),eu("onInvalidHex",T)],factory:e});return o},YF=function(){return Oh.config({find:j.some})},qF=function(t){return Oh.config({find:t.getOpt})},KF=function(t){return Oh.config({find:function(n){return Be(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})},JF={self:YF,memento:qF,childAt:KF},$F={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},QF=function(t){return $F[t]},ZF=function(t){return QF(t)},tR=function(t){var n=function(t){return"tox-"+t},e=XF(ZF,n),o=function(t){Ma(t,ID,{name:"hex-valid",value:!0})},r=function(t){Ma(t,ID,{name:"hex-valid",value:!1})},i=MS(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:o,onInvalidHex:r}));return{dom:{tag:"div"},components:[i.asSpec()],behaviours:xl([av.config({store:{mode:"manual",getValue:function(t){var n=i.get(t),e=Oh.getCurrent(n),o=e.bind(function(t){var n=av.getValue(t);return n.hex});return o.map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,o=e.exec(n),r=i.get(t),u=Oh.getCurrent(r);u.fold(function(){console.log("Can not find form")},function(t){av.setValue(t,{hex:j.from(o[1]).getOr("")}),zF.getField(t,"hex").each(function(t){Aa(t,$u())})})}}}),JF.self()])}},nR=tinymce.util.Tools.resolve("tinymce.Resource"),eR=function(t){return It(t,"init")},oR=function(t){var n=ld(),e=MS({dom:{tag:t.tag}}),o=ld();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:xl([Kx("custom-editor-events",[$a(function(r){e.getOpt(r).each(function(e){(eR(t)?t.init(e.element.dom):nR.load(t.scriptId,t.scriptUrl).then(function(n){return n(e.element.dom,t.settings)})).then(function(t){o.on(function(n){t.setValue(n)}),o.clear(),n.set(t)})})})]),av.config({store:{mode:"manual",getValue:function(){return n.get().fold(function(){return o.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,e){n.get().fold(function(){o.set(e)},function(t){return t.setValue(e)})}}}),JF.self()]),components:[e.asSpec()]}},rR=tinymce.util.Tools.resolve("tinymce.util.Tools"),iR=ci([eu("preprocess",M),eu("postprocess",M)]),uR=function(t,n){var e=Bi("RepresentingConfigs.memento processors",iR,n);return av.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=av.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);av.setValue(i,r)}}})},aR=function(t,n,e){return av.config(Br({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},cR=function(t,n,e){return aR(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},sR=function(t){return cR(t,ws,Ss)},fR=function(t){return cR(t,ec,oc)},lR=function(t){return av.config({store:{mode:"memory",initialValue:t}})},dR={memento:uR,withElement:cR,withComp:aR,domValue:sR,domHtml:fR,memory:lR},mR="jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp",gR=function(t,n){var e=rR.explode(n.getSetting("images_file_types",mR,"string")),o=function(t){return $(e,function(n){return Qt(t.name.toLowerCase(),"."+n.toLowerCase())})};return rt(wt(t),o)},pR=function(t,n){var e=function(t,n){n.stop()},o=function(t){
return function(n,e){nt(t,function(t){t(n,e)})}},r=function(t,n){if(!jh.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){av.setValue(e,gR(o,n)),Ma(e,MD,{name:t.name})},a=MS({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:xl([Kx("input-file-events",[qa(Zu()),qa(da())])])}),c=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:xl([dR.memory([]),JF.self(),jh.config({}),kw.config({toggleClass:"dragenter",toggleOnExecute:!1}),Kx("dropzone-events",[La("dragenter",o([e,kw.toggle])),La("dragleave",o([e,kw.toggle])),La("dragover",e),La("drop",o([e,r])),La(Qu(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},AS.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){var n=a.get(t);n.element.dom.click()},buttonBehaviours:xl([CD.config({}),x_.button(n.isDisabled),p_()])})]}]}},s=t.label.map(function(t){return AD(t,n)}),f=xD.parts.field({factory:{sketch:c}});return _D(s,f,["tox-form__group--stretched"],[])},vR=function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:tt(t.items,n.interpreter)}},hR=mc("alloy-fake-before-tabstop"),bR=mc("alloy-fake-after-tabstop"),yR=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:xl([rw.config({ignore:!0}),CD.config({})])}},xR=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[yR([hR]),t,yR([bR])],behaviours:xl([JF.childAt(1)])}},wR=function(t,n){Ma(t,Ku(),{raw:{which:9,shiftKey:n}})},SR=function(t,n){var e=n.element;hs(e,hR)?wR(t,!0):hs(e,bR)&&wR(t,!1)},kR=function(t){return LE(t,["."+hR,"."+bR].join(","),V)},CR=!(fe().browser.isIE()||fe().browser.isEdge()),OR=function(t){var n=du("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)qe(e.element,"srcdoc",o);else{qe(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}},_R=function(t,n){var e=CR&&t.sandboxed,o=z(z({},t.label.map(function(t){return{title:t}}).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=OR(e),i=t.label.map(function(t){return AD(t,n)}),u=function(t){return xR({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:xl([CD.config({}),rw.config({}),dR.withComp(j.none(),r.getValue,r.setValue)])})},a=xD.parts.field({factory:{sketch:u}});return _D(i,a,["tox-form__group--stretched"],[])},TR=function(t,n){return BR(document.createElement("canvas"),t,n)},ER=function(t){var n=TR(t.width,t.height),e=DR(n);return e.drawImage(t,0,0),n},DR=function(t){return t.getContext("2d")},BR=function(t,n,e){return t.width=n,t.height=e,t},AR=function(t){return t.naturalWidth||t.width},MR=function(t){return t.naturalHeight||t.height},FR=function(t){return new $D(function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)})},RR=function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return j.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return j.some(new Blob(s,{type:o}))},IR=function(t){return new $D(function(n,e){RR(t).fold(function(){e("uri is not base64: "+t)},n)})},VR=function(t,n,e){return n=n||"image/png",C(HTMLCanvasElement.prototype.toBlob)?new $D(function(o,r){t.toBlob(function(t){t?o(t):r()},n,e)}):IR(t.toDataURL(n,e))},PR=function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)},HR=function(t){return FR(t).then(function(t){NR(t);var n=TR(AR(t),MR(t)),e=DR(n);return e.drawImage(t,0,0),n})},zR=function(t){return new $D(function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)})},NR=function(t){URL.revokeObjectURL(t.src)},LR=function(t,n,e){var o=n.type,r=A(o),i=function(){return $D.resolve(n)},u=A(e),a=function(){return e.split(",")[1]},c=function(n,e){return t.then(function(t){return VR(t,n,e)})},s=function(n,e){return t.then(function(t){return PR(t,n,e)})},f=function(t,n){return s(t,n).then(function(t){return t.split(",")[1]})},l=function(){return t.then(ER)};return{getType:r,toBlob:i,toDataURL:u,toBase64:a,toAdjustedBlob:c,toAdjustedDataURL:s,toAdjustedBase64:f,toCanvas:l}},WR=function(t){return zR(t).then(function(n){return LR(HR(t),t,n)})},UR=function(t,n){return VR(t,n).then(function(n){return LR($D.resolve(t),n,t.toDataURL())})},jR=function(t){return WR(t)},GR=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},XR=function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},YR=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],qR=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},KR=function(t,n){var e;return n=GR(n,-1,1),n*=100,n<0?e=127+n/100*127:(e=n%1,e=0===e?YR[n]:YR[Math.floor(n)]*(1-e)+YR[Math.floor(n)+1]*e,e=127*e+127),qR(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},JR=function(t,n){return n=GR(255*n,-255,255),qR(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])},$R=function(t,n,e,o){return n=GR(n,0,2),e=GR(e,0,2),o=GR(o,0,2),qR(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])},QR=function(t,n){return t.toCanvas().then(function(e){return ZR(e,t.getType(),n)})},ZR=function(t,n,e){var o=DR(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],v=n[9],h=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+v,u[T+2]=e*h+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t},i=r(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(i,0,0),UR(t,n)},tI=function(t,n){return t.toCanvas().then(function(e){return nI(e,t.getType(),n)})},nI=function(t,n,e){var o=DR(t),r=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var v=0;v<r;v++){var h=o(l+v-i,0,c-1),b=o(f+p-i,0,s-1),y=4*(b*c+h),x=e[p*r+v];d+=u[y]*x,m+=u[y+1]*x,g+=u[y+2]*x}var w=4*(f*c+l);a[w]=o(d,0,255),a[w+1]=o(m,0,255),a[w+2]=o(g,0,255)}return n},i=o.getImageData(0,0,t.width,t.height),u=o.getImageData(0,0,t.width,t.height);return u=r(i,u,e),o.putImageData(u,0,0),UR(t,n)},eI=function(t){var n=function(n,e,o){for(var r=DR(n),i=new Array(256),u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t},a=0;a<i.length;a++)i[a]=t(a,o);var c=u(r.getImageData(0,0,n.width,n.height),i);return r.putImageData(c,0,0),UR(n,e)};return function(t,e){return t.toCanvas().then(function(o){return n(o,t.getType(),e)})}},oI=function(t){return function(n,e){return QR(n,t(XR(),e))}},rI=function(t){return function(n){return QR(n,t)}},iI=function(t){return function(n){return tI(n,t)}},uI=rI([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),aI=oI(JR),cI=oI(KR),sI=function(t,n,e,o){return QR(t,$R(XR(),n,e,o))},fI=iI([0,-1,0,-1,5,-1,0,-1,0]),lI=eI(function(t,n){return 255*Math.pow(t/255,1-n)}),dI=function(t,n,e){var o=AR(t),r=MR(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=mI(t,i,u);return a?c.then(function(t){return dI(t,n,e)}):c},mI=function(t,n,e){return new $D(function(o){var r=AR(t),i=MR(t),u=Math.floor(r*n),a=Math.floor(i*e),c=TR(u,a),s=DR(c);s.drawImage(t,0,0,r,i,0,0,u,a),o(c)})},gI=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},pI=function(t,n){return t.toCanvas().then(function(e){return vI(e,t.getType(),n)})},vI=function(t,n,e){var o=e<0?360+e:e,r=o*Math.PI/180,i=t.width,u=t.height,a=Math.sin(r),c=Math.cos(r),s=gI(Math.abs(i*c)+Math.abs(u*a)),f=gI(Math.abs(i*a)+Math.abs(u*c)),l=TR(s,f),d=DR(l);return d.translate(s/2,f/2),d.rotate(r),d.drawImage(t,-i/2,-u/2),UR(l,n)},hI=function(t,n){return t.toCanvas().then(function(e){return bI(e,t.getType(),n)})},bI=function(t,n,e){var o=TR(t.width,t.height),r=DR(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),UR(o,n)},yI=function(t,n,e,o,r){return t.toCanvas().then(function(i){return xI(i,t.getType(),n,e,o,r)})},xI=function(t,n,e,o,r,i){var u=TR(r,i),a=DR(u);return a.drawImage(t,-e,-o),UR(u,n)},wI=function(t,n,e){return t.toCanvas().then(function(o){return dI(o,n,e).then(function(n){return UR(n,t.getType())})})},SI=function(t){return uI(t)},kI=function(t){return fI(t)},CI=function(t,n){return lI(t,n)},OI=function(t,n,e,o){return sI(t,n,e,o)},_I=function(t,n){return aI(t,n)},TI=function(t,n){return cI(t,n)},EI=function(t,n){return hI(t,n)},DI=function(t,n,e,o,r){return yI(t,n,e,o,r)},BI=function(t,n,e){return wI(t,n,e)},AI=function(t,n){return pI(t,n)},MI=function(t,n,e){return jS(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},FI=function(t,n){return MI(t,n,[])},RI=function(t,n){return MI(t,n,[Yx.config({})])},II=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:xl([Yx.config({})])}},VI=mc("toolbar.button.execute"),PI=function(t){return tc(function(n,e){w_(t,n)(function(e){Ma(n,VI,{buttonApi:e}),t.onAction(e)})})},HI=(_B={},_B[fa()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],_B),zI=mc("update-menu-text"),NI=mc("update-menu-icon"),LI=function(n,o,r){var i=du(T),u=n.text.map(function(t){return MS(II(t,o,r.providers))}),a=n.icon.map(function(t){return MS(RI(t,r.providers.icons))}),c=function(t,n){var e=av.getValue(t);return rw.focus(e),Ma(e,"keydown",{raw:n.event.raw}),UB.close(e),j.some(!0)},s=n.role.fold(function(){return{}},function(t){return{role:t}}),f=n.tooltip.fold(function(){return{}},function(t){var n=r.providers.translate(t);return{title:n,"aria-label":n}}),l=jS("chevron-down",{tag:"div",classes:[o+"__select-chevron"]},r.providers.icons),d=MS(UB.sketch(z(z(z({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[o,o+"--select"].concat(tt(n.classes,function(t){return o+"--"+t})),attributes:z({},f)},components:__([a.map(function(t){return t.asSpec()}),u.map(function(t){return t.asSpec()}),j.some(l)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:xl(e(e([],n.dropdownBehaviours,!0),[x_.button(function(){return n.disabled||r.providers.isDisabled()}),p_(),YB.config({}),Yx.config({}),Kx("dropdown-events",[S_(n,i),k_(n,i)]),Kx("menubutton-update-display-text",[La(zI,function(t,n){u.bind(function(n){return n.getOpt(t)}).each(function(t){Yx.set(t,[Ms(r.providers.translate(n.event.text))])})}),La(NI,function(t,n){a.bind(function(n){return n.getOpt(t)}).each(function(t){Yx.set(t,[RI(n.event.icon,r.providers.icons)])})})])],!1)),eventOrder:Br(HI,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:xl([Px.config({mode:"special",onLeft:c,onRight:c})]),lazySink:r.getSink,toggleClass:o+"--active",parts:{menu:SC(!1,n.columns,n.presets)},fetch:function(e){return iB.nu(t(n.fetch,e))}})));return d.asSpec()},WI=function(t){return v(t)},UI=function(t){return"separator"===t.type},jI=function(t){return It(t,"getSubmenuItems")},GI={type:"separator"},XI=function(t,n){var e=ut(t,function(t,e){return WI(e)?""===e?t:"|"===e?t.length>0&&!UI(t[t.length-1])?t.concat([GI]):t:It(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])},[]);return e.length>0&&UI(e[e.length-1])&&e.pop(),e},YI=function(t,n){var e=t.getSubmenuItems(),o=JI(e,n),r=Br(o.menus,Su(t.value,o.items)),i=Br(o.expansions,Su(t.value,t.value));return{item:t,menus:r,expansions:i}},qI=function(t,n){return jI(t)?YI(t,n):{item:t,menus:{},expansions:{}}},KI=function(t){if(UI(t))return t;var n=Rt(t,"value").getOrThunk(function(){return mc("generated-menu-item")});return Br({value:n},t)},JI=function(t,n){var e=XI(v(t)?t.split(" "):t,n);return it(e,function(t,e){var o=KI(e),r=qI(o,n);return{menus:Br(t.menus,r.menus),items:[r.item].concat(t.items),expansions:Br(t.expansions,r.expansions)}},{menus:{},expansions:{},items:[]})},$I=function(t,n,e,o){var r=mc("primary-menu"),i=JI(t,e.shared.providers.menuItems());if(0===i.items.length)return j.none();var u=VE(r,i.items,n,e,o),a=_t(i.menus,function(t,o){return VE(o,t,n,e,!1)}),c=Br(a,Su(r,u));return j.from(uS.tieredData(r,c,i.expansions))},QI=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)},setActive:function(n){var e=t.element;n?(gs(e,"tox-tbtn--enabled"),qe(e,"aria-pressed",!0)):(vs(e,"tox-tbtn--enabled"),Ze(e,"aria-pressed"))},isActive:function(){return hs(t.element,"tox-tbtn--enabled")}}},ZI=function(t,n,e,o){return LI({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch(function(t){o($I(t,Kk.CLOSE_ON_EXECUTE,e,!1))})},onSetup:t.onSetup,getApi:QI,columns:1,presets:"normal",classes:[],dropdownBehaviours:[CD.config({})]},n,e.shared)},tV=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each(function(e){n().getOpt(e).each(function(n){Bl(n.element),Ma(n,ID,{name:t.name,value:t.storage.get()})})})}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(tt(t,function(t){var n=t.text.fold(function(){return{}},function(t){return{text:t}});return z(z({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})}))}},nV=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold(function(){return{}},function(t){return{action:t}}),a=z({buttonBehaviours:xl([x_.button(function(){return t.disabled||i.isDisabled()}),p_(),CD.config({}),Kx("button press",[Na("click"),Na("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Br(a,{dom:o});return Br(c,{components:r})},eV=function(t,n,e,o){void 0===o&&(o=[]);var r=t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:r},u=t.icon.map(function(t){return FI(t,e.icons)}),a=__([u]);return nV(t,n,o,i,a,e)},oV=function(t,n,e,o){void 0===o&&(o=[]);var r=eV(t,j.some(n),e,o);return AS.sketch(r)},rV=function(t,n,o,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);var u=o.translate(t.text),a=t.icon?t.icon.map(function(t){return FI(t,o.icons)}):j.none(),c=a.isSome()?__([a]):[],s=a.isSome()?{}:{innerHtml:u},f=e(e(e(e([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),a.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),i,!0),l=z(z({tag:"button",classes:f},s),{attributes:{title:u}});return nV(t,n,r,l,c,o)},iV=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=rV(t,j.some(n),e,o,r);return AS.sketch(i)},uV=function(t,n){return function(e){"custom"===n?Ma(e,ID,{name:t,value:{}}):"submit"===n?Aa(e,VD):"cancel"===n?Aa(e,RD):console.error("Unknown button type: ",n)}},aV=function(t,n){return"menu"===n},cV=function(t,n){return"custom"===n||"cancel"===n||"submit"===n},sV=function(t,n,e){if(aV(t,n)){var o=function(){return u},r=t,i=z(z({},t),{onSetup:function(n){return n.setDisabled(t.disabled),T},fetch:tV(r.items,o,e)}),u=MS(ZI(i,"tox-tbtn",e,j.none()));return u.asSpec()}if(cV(t,n)){var a=uV(t.name,n),c=z(z({},t),{borderless:!1});return iV(c,a,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},fV=function(t,n){var e=uV(t.name,"custom");return TD(j.none(),xD.parts.field(z({factory:AS},rV(t,j.some(e),n,[dR.memory(""),JF.self()]))))},lV=A([eu("field1Name","field1"),eu("field2Name","field2"),hf("onLockedChange"),mf(["lockClass"]),eu("locked",!1),lv.field("coupledFieldBehaviours",[Oh,av])]),dV=function(t,n,e){return nh(t,n,e).bind(Oh.getCurrent)},mV=function(t,n){return Nv({factory:xD,name:t,overrides:function(t){return{fieldBehaviours:xl([Kx("coupled-input-behaviour",[La($u(),function(e){dV(e,t,n).each(function(n){nh(e,t,"lock").each(function(o){kw.isOn(o)&&t.onLockedChange(e,n,o)})})})])])}}})},gV=A([mV("field1","field2"),mV("field2","field1"),Nv({factory:AS,schema:[Pi("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:xl([kw.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),pV=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:lv.augment(t.coupledFieldBehaviours,[Oh.config({find:j.some}),av.config({store:{mode:"manual",getValue:function(n){var e,o=uh(n,t,["field1","field2"]);return e={},e[t.field1Name]=av.getValue(o.field1()),e[t.field2Name]=av.getValue(o.field2()),e},setValue:function(n,e){var o=uh(n,t,["field1","field2"]);Vt(e,t.field1Name)&&av.setValue(o.field1(),e[t.field1Name]),Vt(e,t.field2Name)&&av.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return nh(n,t,"field1")},getField2:function(n){return nh(n,t,"field2")},getLock:function(n){return nh(n,t,"lock")}}}},vV=xh({name:"FormCoupledInputs",configFields:lV(),partFields:gV(),factory:pV,apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),hV=function(t){var n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(t){return t in n?n[t]:1},o=t.value.toFixed(e(t.unit));return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit},bV=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=n.exec(t);if(null!==e){var o=parseFloat(e[1]),r=e[2];return dr.value({value:o,unit:r})}return dr.error(t)},yV=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return It(e,t)};return t.unit===n?j.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?j.some(t.value):j.some(t.value/e[t.unit]*e[n]):j.none()},xV=function(t){return j.none()},wV=function(t,n){return function(e){return yV(e,n).map(function(e){return{value:e*t,unit:n}})}},SV=function(t,n){var e=bV(t).toOptional(),o=bV(n).toOptional();return Lt(e,o,function(t,n){return yV(t,n.unit).map(function(t){return n.value/t}).map(function(t){return wV(t,n.unit)}).getOr(xV)}).getOr(xV)},kV=function(t,n){var e=xV,o=mc("ratio-event"),r=function(t){return jS(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=vV.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()}}),p_(),CD.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return xD.parts.field({factory:YD,inputClasses:["tox-textfield"],inputBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()}}),p_(),CD.config({}),Kx("size-input-events",[La(Yu(),function(t,n){Ma(t,o,{isField1:e})}),La(Qu(),function(n,e){Ma(n,MD,{name:t.name})})])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=vV.parts.field1(u([xD.parts.label(c("Width")),a(!0)])),f=vV.parts.field2(u([xD.parts.label(c("Height")),a(!1)]));return vV.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){bV(av.getValue(t)).each(function(t){e(t).each(function(t){av.setValue(n,hV(t))})})},coupledFieldBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){vV.getField1(t).bind(xD.getField).each(jh.disable),vV.getField2(t).bind(xD.getField).each(jh.disable),vV.getLock(t).each(jh.disable)},onEnabled:function(t){vV.getField1(t).bind(xD.getField).each(jh.enable),vV.getField2(t).bind(xD.getField).each(jh.enable),vV.getLock(t).each(jh.enable)}}),p_(),Kx("size-input-events2",[La(o,function(t,n){var o=n.event.isField1,r=o?vV.getField1(t):vV.getField2(t),i=o?vV.getField2(t):vV.getField1(t),u=r.map(av.getValue).getOr(""),a=i.map(av.getValue).getOr("");e=SV(u,a)})])])})},CV=A(mc("undo")),OV=A(mc("redo")),_V=A(mc("zoom")),TV=A(mc("back")),EV=A(mc("apply")),DV=A(mc("swap")),BV=A(mc("transform")),AV=A(mc("temp-transform")),MV=A(mc("transform-apply")),FV={undo:CV,redo:OV,zoom:_V,back:TV,apply:EV,swap:DV,transform:BV,tempTransform:AV,transformApply:MV},RV=A("save-state"),IV=A("disable"),VV=A("enable"),PV={formActionEvent:ID,saveState:RV,disable:IV,enable:VV},HV=function(t,n){var e=function(t,e,o,r){return MS(iV({name:t,text:t,disabled:o,primary:r,icon:j.none(),borderless:!1},e,n))},o=function(t,e,o,r){return MS(oV({name:t,icon:j.some(t),tooltip:j.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(jh)&&jh.disable(e)})},i=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(jh)&&jh.enable(e)})},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=T,c=function(t,n,e){Ma(t,n,e)},s=function(t){return Aa(t,PV.disable())},f=function(t){return Aa(t,PV.enable())},l=function(t,n){s(t),c(t,FV.transform(),{transform:n}),f(t)},d=function(t,n){s(t),c(t,FV.tempTransform(),{transform:n}),f(t)},m=function(t){return function(){ut.getOpt(t).each(function(t){Yx.set(t,[rt])})}},g=function(t,n){s(t),c(t,FV.transformApply(),{transform:n,swap:m(t)}),f(t)},p=function(){return e("Back",function(t){return c(t,FV.back(),{swap:m(t)})},!1,!1)},v=function(){return MS({dom:{tag:"div",classes:["tox-spacer"]},behaviours:xl([jh.config({})])})},h=function(){return e("Apply",function(t){return c(t,FV.apply(),{swap:m(t)})},!0,!0)},b=function(){return function(n){var e=t.getRect();return DI(n,e.x,e.y,e.w,e.h)}},y=[p(),v(),e("Apply",function(n){var e=b();g(n,e),t.hideCrop()},!1,!0)],x=gD.sketch({dom:u,components:y.map(function(t){return t.asSpec()}),containerBehaviours:xl([Kx("image-tools-crop-buttons-events",[La(PV.disable(),function(t,n){r(y,t)}),La(PV.enable(),function(t,n){i(y,t)})])])}),w=MS(kV({name:"size",label:j.none(),constrain:!0,disabled:!1},n)),S=function(t,n){return function(e){return BI(e,t,n)}},k=[p(),v(),w,v(),e("Apply",function(t){w.getOpt(t).each(function(n){var e=av.getValue(n),o=parseInt(e.width,10),r=parseInt(e.height,10),i=S(o,r);g(t,i)})},!1,!0)],C=gD.sketch({dom:u,components:k.map(function(t){return t.asSpec()}),containerBehaviours:xl([Kx("image-tools-resize-buttons-events",[La(PV.disable(),function(t,n){r(k,t)}),La(PV.enable(),function(t,n){i(k,t)})])])}),O=function(t,n){return function(e){return t(e,n)}},_=O(EI,"h"),E=O(EI,"v"),D=O(AI,-90),B=O(AI,90),M=function(t,n){d(t,n)},F=[p(),v(),o("flip-horizontally","Flip horizontally",function(t){M(t,_)},!1),o("flip-vertically","Flip vertically",function(t){M(t,E)},!1),o("rotate-left","Rotate counterclockwise",function(t){M(t,D)},!1),o("rotate-right","Rotate clockwise",function(t){M(t,B)},!1),v(),h()],R=gD.sketch({dom:u,components:F.map(function(t){return t.asSpec()}),containerBehaviours:xl([Kx("image-tools-fliprotate-buttons-events",[La(PV.disable(),function(t,n){r(F,t)}),La(PV.enable(),function(t,n){i(F,t)})])])}),I=function(t,e,o,r,i){var u=EF.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=EF.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=EF.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return MS(EF.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:A({x:r})},components:[u,a,c],sliderBehaviours:xl([rw.config({})]),onChoose:e}))},V=function(t,n,e,o,r){var i=function(t,e,o){var r=O(n,o.x/100);l(t,r)};return I(t,i,e,o,r)},P=function(t,n,e,o,r){return[p(),V(t,n,e,o,r),h()]},H=function(t,n,e,o,a){var c=P(t,n,e,o,a);return gD.sketch({dom:u,components:c.map(function(t){return t.asSpec()}),containerBehaviours:xl([Kx("image-tools-filter-panel-buttons-events",[La(PV.disable(),function(t,n){r(c,t)}),La(PV.enable(),function(t,n){i(c,t)})])])})},z=[p(),v(),h()],N=gD.sketch({dom:u,components:z.map(function(t){return t.asSpec()})}),L=H("Brightness",_I,-100,0,100),W=H("Contrast",TI,-100,0,100),U=H("Gamma",CI,-100,0,100),G=function(t,n,e){return function(o){return OI(o,t,n,e)}},X=function(t){var n=function(t,n,e){var o=Y.getOpt(t),r=K.getOpt(t),i=q.getOpt(t);o.each(function(n){r.each(function(e){i.each(function(o){var r=av.getValue(n).x/100,i=av.getValue(o).x/100,u=av.getValue(e).x/100,a=G(r,i,u);l(t,a)})})})};return I(t,n,0,100,200)},Y=X("R"),q=X("G"),K=X("B"),J=[p(),Y,q,K,h()],$=gD.sketch({dom:u,components:J.map(function(t){return t.asSpec()})}),Q=function(t,n,e){return function(o){var r=function(){ut.getOpt(o).each(function(n){Yx.set(n,[t]),e(n)})};c(o,FV.swap(),{transform:n,swap:r})}},Z=function(n){t.showCrop()},tt=function(n){w.getOpt(n).each(function(n){var e=t.getMeasurements(),o=e.width,r=e.height;av.setValue(n,{width:o,height:r})})},nt=j.some(kI),et=j.some(SI),ot=[o("crop","Crop",Q(x,j.none(),Z),!1),o("resize","Resize",Q(C,j.none(),tt),!1),o("orientation","Orientation",Q(R,j.none(),a),!1),o("brightness","Brightness",Q(L,j.none(),a),!1),o("sharpen","Sharpen",Q(N,nt,a),!1),o("contrast","Contrast",Q(W,j.none(),a),!1),o("color-levels","Color levels",Q($,j.none(),a),!1),o("gamma","Gamma",Q(U,j.none(),a),!1),o("invert","Invert",Q(N,et,a),!1)],rt=gD.sketch({dom:u,components:ot.map(function(t){return t.asSpec()})}),it=gD.sketch({dom:{tag:"div"},components:[rt],containerBehaviours:xl([Yx.config({})])}),ut=MS(it),at=function(t){return ut.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})};return{memContainer:ut,getApplyButton:at}},zV=tinymce.util.Tools.resolve("tinymce.geom.Rect"),NV=tinymce.util.Tools.resolve("tinymce.util.Observable"),LV=tinymce.util.Tools.resolve("tinymce.util.VK"),WV=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight),s=n(e.offsetHeight,o.offsetHeight);return{width:r<u?i:r,height:a<s?c:a}},UV=function(t){return k(t.changedTouches)},jV=function(t){if(UV(t))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]},GV=0,XV=function(t,n,o,r,i){var a,c=[],s="tox-",f=s+"crid-"+GV++,l=fn.fromDom(r),d=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],m=["top","right","bottom","left"],g=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},p=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},v=function(){return p(o,t)},h=function(n,e,r,i){var u=e.x+r*n.deltaX,a=e.y+i*n.deltaY,c=Math.max(20,e.w+r*n.deltaW),s=Math.max(20,e.h+i*n.deltaH),f=t=zV.clamp({x:u,y:a,w:c,h:s},o,"move"===n.name);f=p(o,f),_.fire("updateRect",{rect:f}),k(f)},b=function(){var n=function(n){var e;return u(f,{document:r.ownerDocument,root:Pe(l).dom,handle:f+"-"+n.name,start:function(){e=t},drag:function(t){h(n,e,t.deltaX,t.deltaY)}})},e=fn.fromTag("div");Ke(e,{id:f,class:s+"croprect-container",role:"grid","aria-dropeffect":"execute"}),zo(l,e),nt(m,function(t){Gs(l,"#"+f).each(function(n){var e=fn.fromTag("div");Ke(e,{id:f+"-"+t,class:s+"croprect-block","data-mce-bogus":"all"}),eo(e,"display","none"),zo(n,e)})}),nt(d,function(t){Gs(l,"#"+f).each(function(n){var e=fn.fromTag("div");Ke(e,{id:f+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),bs(e,[s+"croprect-handle",s+"croprect-handle-"+t.name]),eo(e,"display","none"),zo(n,e)})}),a=tt(d,n),x(t);var o=function(t){qe(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")},g=function(n){var e;nt(d,function(t){if(Je(n.target,"id")===f+"-"+t.name)return e=t,!1});var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),h(e,o,r,i)};switch(n.raw.keyCode){case LV.LEFT:o(n,e,t,-10,0);break;case LV.RIGHT:o(n,e,t,10,0);break;case LV.UP:o(n,e,t,0,-10);break;case LV.DOWN:o(n,e,t,0,10);break;case LV.ENTER:case LV.SPACEBAR:n.prevent(),i()}};c.push(md(l,"focusin",o),md(l,"focusout",o),md(l,"keydown",g))},y=function(t){var n=e(e([],tt(d,function(t){return"#"+f+"-"+t.name}),!0),tt(m,function(t){return"#"+f+"-"+t}),!0).join(","),o=eg(l,n);nt(o,t?function(t){return fo(t,"display")}:function(t){return eo(t,"display","none")})},x=function(t){var e=function(t,n){Gs(l,"#"+f+"-"+t).each(function(t){oo(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})})};nt(d,function(n){Gs(l,"#"+f+"-"+n.name).each(function(e){oo(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})})}),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},w=function(n){t=n,x(t)},S=function(e){n=e,x(t)},k=function(t){w(g(o,t))},C=function(n){o=n,x(t)},O=function(){nt(a,function(t){return t.destroy()}),a=[],nt(c,function(t){return t.unbind()}),c=[]};b();var _=z(z({},NV),{toggleVisibility:y,setClampRect:C,setRect:w,getInnerRect:v,setInnerRect:k,setViewPortRect:S,destroy:O});return _},YV={create:XV},qV=function(t){return new dk(function(n){var e=function(){t.removeEventListener("load",e),n(t)};t.complete?n(t):t.addEventListener("load",e)})},KV=function(t){var n=MS({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=du(1),o=fd(),r=du({x:0,y:0,w:1,h:1}),i=du({x:0,y:0,w:1,h:1}),u=function(t,i){g.getOpt(t).each(function(t){var u=e.get(),a=_o(t.element),c=po(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};oo(i,m),n.getOpt(t).each(function(t){oo(t.element,m)}),o.run(function(t){var n=r.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})})})},a=function(t,n){g.getOpt(t).each(function(t){var o=_o(t.element),r=po(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)})},c=function(t,n){var e=fn.fromTag("img");return qe(e,"src",n),qV(e.dom).then(function(){t.getSystem().isConnected()&&g.getOpt(t).map(function(t){var n=Fs({element:e});Yx.replaceAt(t,1,j.some(n))
;var o=i.get(),c={x:0,y:0,w:e.dom.naturalWidth,h:e.dom.naturalHeight};i.set(c);var s=zV.inflate(c,-20,-20);r.set(s),o.w===c.w&&o.h===c.h||a(t,e),u(t,e)})})},s=function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),g.getOpt(t).each(function(t){var n=t.components()[1].element;u(t,n)})},f=function(){o.run(function(t){t.toggleVisibility(!0)})},l=function(){o.run(function(t){t.toggleVisibility(!1)})},d=function(){return r.get()},m=gD.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:xl([Kx("image-panel-crop-events",[$a(function(t){g.getOpt(t).each(function(t){var n=t.element.dom,i=YV.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,T);i.toggleVisibility(!1),i.on("updateRect",function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)}),o.set(i)})}),Qa(function(){o.clear()})])])}],containerBehaviours:xl([Yx.config({}),Kx("image-panel-events",[$a(function(n){c(n,t)})])])}),g=MS(m),p=function(){var t=i.get();return{width:t.w,height:t.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:p}},JV=function(t,n,e,o,r){return oV({name:t,icon:j.some(n),disabled:e,tooltip:j.some(t),primary:!1,borderless:!1},o,r)},$V=function(t,n){n?jh.enable(t):jh.disable(t)},QV=function(t){var n=function(t,n,r){e.getOpt(t).each(function(t){$V(t,n)}),o.getOpt(t).each(function(t){$V(t,r)})},e=MS(JV("Undo","undo",!0,function(t){Ma(t,FV.undo(),{direction:1})},t)),o=MS(JV("Redo","redo",!0,function(t){Ma(t,FV.redo(),{direction:1})},t)),r=gD.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),o.asSpec(),JV("Zoom in","zoom-in",!1,function(t){Ma(t,FV.zoom(),{direction:1})},t),JV("Zoom out","zoom-out",!1,function(t){Ma(t,FV.zoom(),{direction:-1})},t)]});return{container:r,updateButtonUndoStates:n}},ZV=function(t){var n=du(t),e=ld(),o=a();o.add(t);var r=function(){return n.get()},i=function(t){n.set(t)},u=function(){return e.get().getOrThunk(n.get)},c=function(t){var n=s(t);return d(),e.set(n),n.url},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},l=function(t){rR.each(t,f)},d=function(){e.on(f),e.clear()},m=function(t){var n=s(t);i(n);var e=o.add(n).removed;return l(e),n.url},g=function(t){var n=s(t);return e.set(n),n.url},p=function(t){return e.get().fold(T,function(n){m(n.blob),t()})},v=function(){var t=o.undo();return i(t),t.url},h=function(){var t=o.redo();return i(t),t.url},b=function(){var t=o.canUndo(),n=o.canRedo();return{undoEnabled:t,redoEnabled:n}};return{getBlobState:r,setBlobState:i,addBlobState:m,getTempState:u,updateTempState:c,addTempState:g,applyTempState:p,destroyTempState:d,undo:v,redo:h,getHistoryStates:b}},tP=function(t,n){var e=ZV(t.currentState),o=function(t,n){var e=n.event.direction;k.zoom(t,e)},r=function(t){var n=e.getHistoryStates();C.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Ma(t,PV.formActionEvent,{name:PV.saveState(),value:n.undoEnabled})},i=function(t){C.updateButtonUndoStates(t,!1,!1)},u=function(t,n){var o=e.undo();l(t,o).then(function(n){f(t),r(t)})},a=function(t,n){var o=e.redo();l(t,o).then(function(n){f(t),r(t)})},c=function(t){return t.toBlob()},s=function(t){Ma(t,PV.formActionEvent,{name:PV.disable(),value:{}})},f=function(t){O.getApplyButton(t).each(function(t){jh.enable(t)}),Ma(t,PV.formActionEvent,{name:PV.enable(),value:{}})},l=function(t,n){return s(t),k.updateSrc(t,n)},d=function(t,n,e,o,i){s(t),jR(n).then(e).then(c).then(o).then(function(n){return l(t,n)}).then(function(){r(t),i(),f(t)}).catch(function(n){console.log(n),t.getSystem().isConnected()&&f(t)})},m=function(t,n,o){var r=e.getBlobState().blob,i=function(t){return e.updateTempState(t)};d(t,r,n,i,o)},g=function(t,n){var o=e.getTempState().blob,r=function(t){return e.addTempState(t)};d(t,o,n,r,T)},p=function(t,n,o){var r=e.getBlobState().blob,i=function(n){var o=e.addBlobState(n);return h(t),o};d(t,r,n,i,o)},v=function(t,n){var o=function(){h(t);var e=n.event.swap;e()};e.applyTempState(o)},h=function(t){var n=e.getBlobState().url;return e.destroyTempState(),r(t),n},b=function(t){var n=h(t);l(t,n).then(function(n){f(t)})},y=function(t,n){b(t);var e=n.event.swap;e(),k.hideCrop()},x=function(t,n){return m(t,n.event.transform,T)},w=function(t,n){return g(t,n.event.transform)},S=function(t,n){return p(t,n.event.transform,n.event.swap)},k=KV(t.currentState.url),C=QV(n),O=HV(k,n),_=function(t,n){i(t);var e=n.event.transform,o=n.event.swap;e.fold(function(){o()},function(n){m(t,n,o)})};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[O.memContainer.asSpec(),k.memContainer.asSpec(),C.container],behaviours:xl([av.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),Kx("image-tools-events",[La(FV.undo(),u),La(FV.redo(),a),La(FV.zoom(),o),La(FV.back(),y),La(FV.apply(),v),La(FV.transform(),x),La(FV.tempTransform(),w),La(FV.transformApply(),S),La(FV.swap(),_)]),JF.self()])}},nP=function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=tt(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:xl([JF.self(),Yx.config({}),dR.domHtml(j.none()),Px.config({mode:"acyclic"})])}},eP=function(t){return!It(t,"items")},oP="data-value",rP=function(t,n,e,o){return tt(e,function(e){return eP(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){av.setValue(t,e.value),Ma(t,MD,{name:n}),rw.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return rP(t,n,e.items,o)}}})},iP=function(t,n){return St(t,function(t){return eP(t)?jt(t.value===n,t):iP(t.items,n)})},uP=function(t,n){var e=n.shared.providers,o=yt(t.items).filter(eP),r=t.label.map(function(t){return AD(t,e)}),i=xD.parts.field({dom:{},factory:{sketch:function(e){return LI({uid:e.uid,text:o.map(function(t){return t.text}),icon:j.none(),tooltip:t.label,role:j.none(),fetch:function(e,o){var r=rP(e,t.name,t.items,av.getValue(e));o($I(r,Kk.CLOSE_ON_EXECUTE,n,!1))},onSetup:A(T),getApi:A({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[CD.config({}),av.config({store:{mode:"manual",initialValue:o.map(function(t){return t.value}).getOr(""),getValue:function(t){return Je(t.element,oP)},setValue:function(n,e){iP(t.items,e).each(function(t){qe(n.element,oP,t.value),Ma(n,zI,{text:t.text})})}}})]},"tox-listbox",n.shared)}}}),u={dom:{tag:"div",classes:["tox-listboxfield"]},components:[i]};return xD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ft([r.toArray(),[u]]),fieldBehaviours:xl([jh.config({disabled:A(t.disabled),onDisabled:function(t){xD.getField(t).each(jh.disable)},onEnabled:function(t){xD.getField(t).each(jh.enable)}})])})},aP=function(t,n){return{dom:{tag:"div",classes:t.classes},components:tt(t.items,n.shared.interpreter)}},cP=function(t,n){var e=tt(t.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=t.data.map(function(t){return Su("initialValue",t)}).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:fv(t.selectBehaviours,[rw.config({}),av.config({store:z({mode:"manual",getValue:function(t){return ws(t.element)},setValue:function(n,e){var o=ct(t.options,function(t){return t.value===e});o.isSome()&&Ss(n.element,e)}},o)})])}},sP=yh({name:"HtmlSelect",configFields:[Pi("options"),cv("selectBehaviours",[rw,av]),eu("selectClasses",[]),eu("selectAttributes",{}),qi("data")],factory:cP}),fP=function(t,n){var e=tt(t.items,function(t){return{text:n.translate(t.text),value:t.value}}),o=t.label.map(function(t){return AD(t,n)}),r=xD.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:sP,selectBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()}}),CD.config({}),Kx("selectbox-change",[La(Qu(),function(n,e){Ma(n,MD,{name:t.name})})])])}),i=t.size>1?j.none():j.some(jS("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:ft([[r],i.toArray()])};return xD.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:ft([o.toArray(),[u]]),fieldBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){xD.getField(t).each(jh.disable)},onEnabled:function(t){xD.getField(t).each(jh.enable)}}),p_()])})},lP=function(t,n){var e=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},o=function(t){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:tt(t,e)}]}},r=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"tr"},components:tt(t,r)}},u=function(t){return{dom:{tag:"tbody"},components:tt(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(t.header),u(t.cells)],behaviours:xl([CD.config({}),rw.config({})])}},dP=function(t,n){var e=t.label.map(function(t){return AD(t,n)}),o=[jh.config({disabled:function(){return t.disabled||n.isDisabled()}}),p_(),Px.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Aa(t,VD),j.some(!0)}}),Kx("textfield-change",[La($u(),function(n,e){Ma(n,MD,{name:t.name})}),La(ca(),function(n,e){Ma(n,MD,{name:t.name})})]),CD.config({})],r=t.validation.map(function(t){return hB.config({getRoot:function(t){return Oe(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=av.getValue(n),o=t.validator(e);return iB.pure(!0===o?dr.value(e):dr.error(o))},validateOnLoad:t.validateOnLoad}})}).toArray(),i=t.placeholder.fold(A({}),function(t){return{placeholder:n.translate(t)}}),u=t.inputMode.fold(A({}),function(t){return{inputmode:t}}),a=z(z({},i),u),c=xD.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:xl(ft([o,r])),selectOnFocus:!1,factory:YD}),s=t.flex?["tox-form__group--stretched"]:[],f=s.concat(t.maximized?["tox-form-group--maximize"]:[]),l=[jh.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){xD.getField(t).each(jh.disable)},onEnabled:function(t){xD.getField(t).each(jh.enable)}}),p_()];return _D(e,c,f,l)},mP=function(t,n){return dP({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:j.none(),maximized:t.maximized},n)},gP=function(t,n){return dP({name:t.name,multiline:!0,label:t.label,inputMode:j.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:j.none(),maximized:t.maximized},n)},pP=function(t,n){var e=t.stream.streams,o=e.setup(t,n);return Pa([La(t.event,o),Qa(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[La(t,function(){return n.cancel()})]}).getOr([])))},vP=Object.freeze({__proto__:null,events:pP}),hP=function(t){var n=du(null),e=function(){return{timer:null!==n.get()?"set":"unset"}},o=function(t){n.set(t)},r=function(){var t=n.get();null!==t&&t.cancel()};return Rc({readState:e,setTimer:o,cancel:r})},bP=function(t){return t.stream.streams.state(t)},yP=Object.freeze({__proto__:null,throttle:hP,init:bP}),xP=function(t,n){var e=t.stream,o=JS(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},wP=[Hi("stream",Mi("mode",{throttle:[Pi("delay"),eu("stopEvent",!0),yf("streams",{setup:xP,state:hP})]})),eu("event","input"),qi("cancelEvent"),hf("onStream")],SP=Sl({fields:wP,name:"streaming",active:vP,state:yP}),kP=function(t,n,e){var o=av.getValue(e);av.setValue(n,o),OP(n)},CP=function(t,n){var e=t.element,o=ws(e),r=e.dom;"number"!==Je(e,"type")&&n(r,o)},OP=function(t){CP(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},_P=function(t,n){CP(t,function(t,e){return t.setSelectionRange(n,e.length)})},TP=function(t,n,e){if(t.selectsOver){var o=av.getValue(n),r=t.getDisplayText(o),i=av.getValue(e),u=t.getDisplayText(i);return 0===u.indexOf(r)?j.some(function(){kP(t,n,e),_P(n,r.length)}):j.none()}return j.none()},EP=A("alloy.typeahead.itemexecute"),DP=function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=kB.getCoupled(n,"sandbox");if(Op.isOpen(i))Oh.getCurrent(i).each(function(t){fb.getHighlighted(t).fold(function(){r(t)},function(){Va(i,t.element,"keydown",e)})});else{var a=function(t){Oh.getCurrent(t).each(r)};AB(t,u(n),n,i,o,a,JD.HighlightFirst).get(T)}},i=UD(t),u=function(t){return function(n){return n.map(function(n){var e=Ft(n.menus),o=lt(e,function(t){return rt(t.items,function(t){return"item"===t.type})}),r=av.getState(t);return r.update(tt(o,function(t){return t.data})),n})}},a=[rw.config({}),av.config({onSetValue:t.onSetValue,store:z({mode:"dataset",getDataKey:function(t){return ws(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Ss(n.element,t.model.getDisplayText(e))}},t.initialData.map(function(t){return Su("initialValue",t)}).getOr({}))}),SP.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=kB.getCoupled(n,"sandbox"),i=rw.isFocused(n);if(i&&ws(n.element).length>=t.minChars){var a=Oh.getCurrent(r).bind(function(t){return fb.getHighlighted(t).map(av.getValue)});t.previewing.set(!0);var c=function(n){Oh.getCurrent(r).each(function(n){a.fold(function(){t.model.selectsOver&&fb.highlightFirst(n)},function(t){fb.highlightBy(n,function(n){var e=av.getValue(n);return e.value===t.value}),fb.getHighlighted(n).orThunk(function(){return fb.highlightFirst(n),j.none()})})})};AB(t,u(n),n,r,o,c,JD.HighlightFirst).get(T)}},cancelEvent:pa()}),Px.config({mode:"special",onDown:function(t,n){return r(t,n,fb.highlightFirst),j.some(!0)},onEscape:function(t){var n=kB.getCoupled(t,"sandbox");return Op.isOpen(n)?(Op.close(n),j.some(!0)):j.none()},onUp:function(t,n){return r(t,n,fb.highlightLast),j.some(!0)},onEnter:function(n){var e=kB.getCoupled(n,"sandbox"),o=Op.isOpen(e);if(o&&!t.previewing.get())return Oh.getCurrent(e).bind(function(t){return fb.getHighlighted(t)}).map(function(t){return Ma(n,EP(),{item:t}),!0});var r=av.getValue(n);return Aa(n,pa()),t.onExecute(e,n,r),o&&Op.close(e),j.some(!0)}}),kw.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),kB.config({others:{sandbox:function(n){return PB(t,n,{onOpen:function(){return kw.on(n)},onClose:function(){return kw.off(n)}})}}}),Kx("typeaheadevents",[tc(function(n){var e=T;FB(t,u(n),n,o,e,JD.HighlightFirst).get(T)}),La(EP(),function(n,e){var o=kB.getCoupled(n,"sandbox");kP(t.model,n,e.event.item),Aa(n,pa()),t.onItemExecute(n,o,e.event.item,av.getValue(n)),Op.close(o),OP(n)})].concat(t.dismissOnBlur?[La(aa(),function(t){var n=kB.getCoupled(t,"sandbox");Rl(n.element).isNone()&&Op.close(n)})]:[]))];return{uid:t.uid,dom:GD(Br(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:z(z({},i),fv(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}},BP=A([qi("lazySink"),Pi("fetch"),eu("minChars",5),eu("responseTime",1e3),pf("onOpen"),eu("getHotspot",j.some),eu("getAnchorOverrides",A({})),eu("layouts",j.none()),eu("eventOrder",{}),lu("model",{},[eu("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),eu("selectsOver",!0),eu("populateFromBrowse",!0)]),pf("onSetValue"),vf("onExecute"),pf("onItemExecute"),eu("inputClasses",[]),eu("inputAttributes",{}),eu("inputStyles",{}),eu("matchWidth",!0),eu("useMinWidth",!1),eu("dismissOnBlur",!0),mf(["openClass"]),qi("initialData"),cv("typeaheadBehaviours",[rw,av,SP,Px,kw,kB]),Ii("previewing",function(){return du(!0)})].concat(WD()).concat(zB())),AP=A([Lv({schema:[df()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each(function(o){TP(t.model,o,e).fold(function(){return fb.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kP(t.model,n,e)}),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map(function(t){return Ma(t,EP(),{item:e}),!0})},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kP(t.model,n,e)})}}}})]),MP=xh({name:"Typeahead",configFields:BP(),partFields:AP(),factory:DP}),FP=function(t){var n=function(){return FP(t.toCached())},e=function(n){return FP(t.bind(function(t){return t.fold(function(t){return iB.pure(dr.error(t))},function(t){return n(t)})}))},o=function(n){return FP(t.map(function(t){return t.bind(n)}))},r=function(n){return FP(t.map(function(t){return t.map(n)}))},i=function(n){return FP(t.map(function(t){return t.mapError(n)}))},u=function(n,e){return t.map(function(t){return t.fold(n,e)})},a=function(n,e){return FP(iB.nu(function(o){var r=!1,i=setTimeout(function(){r=!0,o(dr.error(e()))},n);t.get(function(t){r||(clearTimeout(i),o(t))})}))};return z(z({},t),{toCached:n,bindFuture:e,bindResult:o,mapResult:r,mapError:i,foldResult:u,withTimeout:a})},RP=function(t){return FP(iB.nu(t))},IP=function(t){return FP(iB.pure(dr.value(t)))},VP=function(t){return FP(iB.pure(dr.error(t)))},PP=function(t){return FP(iB.pure(t))},HP=function(t){return FP(t.map(dr.value))},zP=function(t){return RP(function(n){t.then(function(t){n(dr.value(t))},function(t){n(dr.error(t))})})},NP={nu:RP,wrap:FP,pure:IP,value:IP,error:VP,fromResult:PP,fromFuture:HP,fromPromise:zP},LP={type:"separator"},WP=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:T}},UP=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:T}},jP=function(t){return tt(t,WP)},GP=function(t,n){return rt(n,function(n){return n.type===t})},XP=function(t,n){return jP(GP(t,n))},YP=function(t){return XP("header",t.targets)},qP=function(t){return XP("anchor",t.targets)},KP=function(t){return j.from(t.anchorTop).map(function(t){return UP("<top>",t)}).toArray()},JP=function(t){return j.from(t.anchorBottom).map(function(t){return UP("<bottom>",t)}).toArray()},$P=function(t){return tt(t,function(t){return UP(t,t)})},QP=function(t){return ut(t,function(t,n){var e=0===t.length||0===n.length;return e?t.concat(n):t.concat(LP,n)},[])},ZP=function(t,n){var e=t.toLowerCase();return rt(n,function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return Jt(n.toLowerCase(),e)||Jt(t.value.toLowerCase(),e)})},tH=function(t,n,e){var o=av.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value,i=e.getLinkInformation();return i.fold(function(){return[]},function(n){var o=ZP(r,$P(e.getHistory(t)));return"file"===t?QP([o,ZP(r,YP(n)),ZP(r,ft([KP(n),qP(n),JP(n)]))]):o})},nH=mc("aria-invalid"),eH=function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=av.getValue(n);e.addToHistory(o.value,t.filetype)},u=xD.parts.field({factory:MP,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":nH,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=tH(t.filetype,o,e),i=$I(r,Kk.BUBBLE_TO_SANDBOX,n,!1);return iB.pure(i)},getHotspot:function(t){return m.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(hB)&&hB.run(t).get(T)},typeaheadBehaviours:xl(ft([e.getValidationHandler().map(function(n){return hB.config({getRoot:function(t){return Oe(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){s.getOpt(t).each(function(t){qe(t.element,"title",r.translate(n))})}},validator:{validate:function(e){var o=av.getValue(e);return NP.nu(function(e){n({type:t.filetype,url:o.value},function(t){if("invalid"===t.status){var n=dr.error(t.message);e(n)}else{var o=dr.value(t.message);e(o)}})})},validateOnLoad:!1}})}).toArray(),[jh.config({disabled:function(){return t.disabled||r.isDisabled()}}),CD.config({}),Kx("urlinput-events",ft(["file"===t.filetype?[La($u(),function(n){Ma(n,MD,{name:t.name})})]:[],[La(Qu(),function(n){Ma(n,MD,{name:t.name}),i(n)}),La(ca(),function(n){Ma(n,MD,{name:t.name}),i(n)})]]))]])),eventOrder:(o={},o[$u()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:SC(!1,1,"normal")},onExecute:function(t,n,e){Ma(n,VD,{})},onItemExecute:function(n,e,o,r){i(n),Ma(n,MD,{name:t.name})}}),a=t.label.map(function(t){return AD(t,r)}),c=function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),jS(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:z({title:r.translate(o),"aria-live":"polite"},n.fold(function(){return{}},function(t){return{id:t}}))},r.icons)},s=MS(c("invalid",j.some(nH),"warning")),f=MS({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),l=e.getUrlPicker(t.filetype),d=mc("browser.url.event"),m=MS({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,f.asSpec()],behaviours:xl([jh.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),g=MS(iV({name:t.name,icon:j.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},function(t){return Aa(t,d)},r,[],["tox-browse-url"])),p=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:ft([[m.asSpec()],l.map(function(){return g.asSpec()}).toArray()])}},v=function(n){Oh.getCurrent(n).each(function(e){var o=av.getValue(e),r=z({fieldname:t.name},o);l.each(function(o){o(r).get(function(o){av.setValue(e,o),Ma(n,MD,{name:t.name})})})})};return xD.sketch({dom:DD(),components:a.toArray().concat([p()]),fieldBehaviours:xl([jh.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){xD.getField(t).each(jh.disable),g.getOpt(t).each(jh.disable)},onEnabled:function(t){xD.getField(t).each(jh.enable),g.getOpt(t).each(jh.enable)}}),p_(),Kx("url-input-events",[La(d,v)])])})},oH=function(t,n){return gD.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[AS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:zS(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){Ma(n,ID,{name:"alert-banner",value:t.url})},buttonBehaviours:xl([WS()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})},rH=function(t,n){var e=av.config({store:{mode:"manual",getValue:function(t){var n=t.element.dom;return n.checked},setValue:function(t,n){var e=t.element.dom;e.checked=n}}}),o=function(t){return t.element.dom.click(),j.some(!0)},r=xD.parts.field({factory:{sketch:M},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:xl([JF.self(),jh.config({disabled:function(){return t.disabled||n.isDisabled()}}),CD.config({}),rw.config({}),e,Px.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),Kx("checkbox-events",[La(Qu(),function(n,e){Ma(n,MD,{name:t.name})})])])}),i=xD.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:xl([YB.config({})])}),u=function(t){var e="checked"===t?"selected":"unselected";return jS(e,{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=MS({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return xD.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:xl([jh.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){xD.getField(t).each(jh.disable)},onEnabled:function(t){xD.getField(t).each(jh.enable)}}),p_()])})},iH=function(t){return"presentation"===t.presets?gD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):gD.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:xl([CD.config({}),rw.config({})])})},uH=function(t){return function(n,e,o){return Rt(e,"name").fold(function(){return t(e,o)},function(r){return n.field(r,t(e,o))})}},aH=function(t){return function(n,e,o){var r=Br(e,{source:"dynamic"});return uH(t)(n,r,o)}},cH={bar:uH(function(t,n){return vD(t,n.shared)}),collection:uH(function(t,n){return LD(t,n.shared.providers)}),alertbanner:uH(function(t,n){return oH(t,n.shared.providers)}),input:uH(function(t,n){return mP(t,n.shared.providers)}),textarea:uH(function(t,n){return gP(t,n.shared.providers)}),label:uH(function(t,n){return nP(t,n.shared)}),iframe:aH(function(t,n){return _R(t,n.shared.providers)}),button:uH(function(t,n){return fV(t,n.shared.providers)}),checkbox:uH(function(t,n){return rH(t,n.shared.providers)}),colorinput:uH(function(t,n){return QB(t,n.shared,n.colorinput)}),colorpicker:uH(tR),dropzone:uH(function(t,n){return pR(t,n.shared.providers)}),grid:uH(function(t,n){return vR(t,n.shared)}),listbox:uH(function(t,n){return uP(t,n)}),selectbox:uH(function(t,n){return fP(t,n.shared.providers)}),sizeinput:uH(function(t,n){return kV(t,n.shared.providers)}),urlinput:uH(function(t,n){return eH(t,n,n.urlinput)}),customeditor:uH(oR),htmlpanel:uH(iH),imagetools:uH(function(t,n){return tP(t,n.shared.providers)}),table:uH(function(t,n){return lP(t,n.shared.providers)}),panel:uH(function(t,n){return aP(t,n)})},sH={field:function(t,n){return n}},fH=function(t,n,e){var o=Br(e,{shared:{interpreter:function(n){return lH(t,n,o)}}});return lH(t,n,o)},lH=function(t,n,e){return Rt(cH,n.type).fold(function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n},function(o){return o(t,n,e)})},dH=function(t,n){var e=sH;return lH(e,t,n)},mH={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},gH=function(t,n,e){var o=12,r={maxHeightFunction:Rd()},i=function(){return{type:"node",root:He(t()),node:j.from(t()),bubble:zd(o,o,mH),layouts:{onRtl:function(){return[xS]},onLtr:function(){return[yS]}},overrides:r}},u=function(){return{type:"hotspot",hotspot:n(),bubble:zd(-o,o,mH),layouts:{onRtl:function(){return[Kf]},onLtr:function(){return[Jf]}},overrides:r}};return function(){return e()?i():u()}},pH=function(t,n,e){var o=function(){return{type:"node",root:He(t()),node:j.from(t()),layouts:{onRtl:function(){return[wS]},onLtr:function(){return[wS]}}}},r=function(){return{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[tl]},onLtr:function(){return[tl]}}}};return function(){return e()?o():r()}},vH=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return j.some(Am.range(fn.fromDom(n.startContainer),n.startOffset,fn.fromDom(n.endContainer),n.endOffset))}}}},hH=function(t){return function(n){return{type:"node",root:t(),node:n}}},bH=function(t,n,e){var o=KO(t),r=function(){return fn.fromDom(t.getBody())},i=function(){return fn.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:gH(i,n,u),banner:pH(i,n,u),cursor:vH(t,r),node:hH(r)}},yH=function(t){return function(n,e){var o=iE(t);o(n,e)}},xH=function(t){return function(){return NT(t)}},wH=function(t){return function(){return WT(t)}},SH=function(t){return function(){return $T(t)}},kH=function(t){return{colorPicker:yH(t),hasCustomColors:xH(t),getColors:wH(t),getColorCols:SH(t)}},CH=function(t){return function(){return t_(t)}},OH=function(t){return{isDraggableModal:CH(t)}},_H=function(t){var n=du(jO(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}},TH=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],EH=function(t){return It(t,"items")},DH=function(t){return It(t,"block")},BH=function(t){return It(t,"inline")},AH=function(t){return It(t,"selector")},MH=function(t){return ut(t,function(t,n){if(EH(n)){var e=MH(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(BH(n)||DH(n)||AH(n)){var o=v(n.name)?n.name:n.title.toLowerCase(),r="custom-"+o;return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return z(z({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},FH=function(t,n){var e=MH(n),o=function(n){nt(n,function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)})};return t.formatter?o(e.customFormats):t.on("init",function(){o(e.customFormats)}),e.formats},RH=function(t){return DO(t).map(function(n){var e=FH(t,n);return BO(t)?TH.concat(e):e}).getOr(TH)},IH=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Br(t,o)},VH=function(t,n,e,o){var r=function(t){return IH(t,e,o)},i=function(t){var n={type:"submenu"};return Br(t,n)},u=function(n){var r=v(n.name)?n.name:mc(n.title),i="custom-"+r,u={type:"formatter",format:i,isSelected:e(i),getStylePreview:o(i)},a=Br(n,u);return t.formatter.register(r,a),a},a=function(t){return tt(t,function(t){var n=kt(t);if(Vt(t,"items")){var e=a(t.items);return Br(i(t),{getStyleItems:A(e)})}return Vt(t,"format")?r(t):1===n.length&&J(n,"title")?Br(t,{type:"separator"}):u(t)})};return a(n)},PH=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?j.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):j.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?lt(n,o):[t.format]},r=du([]),i=du([]),u=du([]),a=du([]),c=du(!1);t.on("PreInit",function(u){var a=RH(t),c=VH(t,a,n,e);r.set(c),i.set(lt(c,o))}),t.on("addStyleModifications",function(r){var i=VH(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(lt(i,o))});var s=function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},f=function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)};return{getData:s,getFlattenedKeys:f}},HH=function(t){return k(t)&&1===t.nodeType},zH=rR.trim,NH=function(t){return function(n){if(HH(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},LH=NH("true"),WH=NH("false"),UH=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},jH=function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return LH(t)}return!1},GH=function(t,n){return tt(eg(fn.fromDom(n),t),function(t){return t.dom})},XH=function(t){return t.innerText||t.textContent},YH=function(t){return t.id?t.id:mc("h")},qH=function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)},KH=function(t){return qH(t)&&$H(t)},JH=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},$H=function(t){return jH(t)&&!WH(t)},QH=function(t){return JH(t)&&$H(t)},ZH=function(t){return JH(t)?parseInt(t.nodeName.substr(1),10):0},tz=function(t){var n=YH(t),e=function(){t.id=n}
;return UH("header",XH(t),"#"+n,ZH(t),e)},nz=function(t){var n=t.id||t.name,e=XH(t);return UH("anchor",e||"#"+n,"#"+n,0,T)},ez=function(t){return tt(rt(t,QH),tz)},oz=function(t){return tt(rt(t,KH),nz)},rz=function(t){var n=GH("h1,h2,h3,h4,h5,h6,a:not([href])",t);return n},iz=function(t){return zH(t.title).length>0},uz=function(t){var n=rz(t);return rt(ez(n).concat(oz(n)),iz)},az={find:uz},cz="tinymce-url-history",sz=5,fz=function(t){return v(t)&&/^https?/.test(t)},lz=function(t){return b(t)&&t.length<=sz&&dt(t,fz)},dz=function(t){return h(t)&&Mt(t,function(t){return!lz(t)}).isNone()},mz=function(){var t,n=FT.getItem(cz);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+cz+" was not valid JSON",t),{};throw t}return dz(t)?t:(console.log("Local storage "+cz+" was not valid format",t),{})},gz=function(t){if(!dz(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));FT.setItem(cz,JSON.stringify(t))},pz=function(t){var n=mz();return Rt(n,t).getOr([])},vz=function(t,n){if(fz(t)){var e=mz(),o=Rt(e,n).getOr([]),r=rt(o,function(n){return n!==t});e[n]=[t].concat(r).slice(0,sz),gz(e)}},hz=function(t){return!!t},bz=function(t){return _t(rR.makeMap(t,/[, ]/),hz)},yz=function(t){return j.from(r_(t)).filter(C)},xz=function(t){var n=j.some(i_(t)).filter(hz),e=j.some(u_(t)).filter(hz),o=n.or(e).map(bz);return yz(t).fold(V,function(t){return o.fold(P,function(t){return kt(t).length>0&&t})})},wz=function(t,n){var e=xz(t);return x(e)?e?yz(t):j.none():e[n]?yz(t):j.none()},Sz=function(t,n){return wz(t,n).map(function(e){return function(o){return iB.nu(function(r){var i=function(t,n){if(!v(t))throw new Error("Expected value to be string");if(void 0!==n&&!h(n))throw new Error("Expected meta to be a object");var e={value:t,meta:n};r(e)},u=z({filetype:n,fieldname:o.fieldname},j.from(o.meta).getOr({}));e.call(t,i,o.value,u)})}})},kz=function(t){return j.from(t).filter(v).getOrUndefined()},Cz=function(t){return a_(t)?j.none():j.some({targets:az.find(t.getBody()),anchorTop:kz(c_(t)),anchorBottom:kz(s_(t))})},Oz=function(t){return j.from(f_(t))},_z=function(t){return{getHistory:pz,addToHistory:vz,getLinkInformation:function(){return Cz(t)},getValidationHandler:function(){return Oz(t)},getUrlPicker:function(n){return Sz(t,n)}}},Tz=function(t,n,e){var o=du(!1),r=_H(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:FS.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return dH(t,i)},anchors:bH(n,e,r.isPositionedAtTop),header:r,getSink:function(){return dr.value(t)}},urlinput:_z(n),styleselect:PH(n),colorinput:kH(n),dialog:OH(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},Ez=function(t,n,e){var o=function(t,o){nt([n,e],function(n){n.broadcastEvent(t,o)})},r=function(t,o){nt([n,e],function(n){n.broadcastOn([t],o)})},i=function(t){return r(_p(),{target:t.target})},u=Dl(),a=md(u,"touchstart",i),c=md(u,"touchmove",function(t){return o(ha(),t)}),s=md(u,"touchend",function(t){return o(ba(),t)}),f=md(u,"mousedown",i),l=md(u,"mouseup",function(t){0===t.raw.button&&r(Ep(),{target:t.target})}),d=function(t){return r(_p(),{target:fn.fromDom(t.target)})},m=function(t){0===t.button&&r(Ep(),{target:fn.fromDom(t.target)})},g=function(){nt(t.editorReceptionist.get(),function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})})},p=function(t){return o(ya(),pd(t))},v=function(t){r(Tp(),{}),o(xa(),pd(t))},h=function(){return r(Tp(),{})},b=function(n){n.state&&r(_p(),{target:fn.fromDom(t.getContainer())})},y=function(t){r(_p(),{target:fn.fromDom(t.relatedTarget.getContainer())})};t.on("PostRender",function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",v),t.on("ResizeEditor",h),t.on("AfterProgressState",b),t.on("DismissPopups",y)}),t.on("remove",function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",v),t.off("ResizeEditor",h),t.off("AfterProgressState",b),t.off("DismissPopups",y),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()}),t.on("detach",function(){ip(n),ip(e),n.destroy(),e.destroy()})},Dz=sh,Bz=Gv,Az=A([eu("shell",!1),Pi("makeItem"),eu("setupItem",T),lv.field("listBehaviours",[Yx])]),Mz=function(){return{behaviours:xl([Yx.config({})])}},Fz=Wv({name:"items",overrides:Mz}),Rz=A([Fz]),Iz=A("CustomList"),Vz=function(t,n,e,o){var r=function(n,e){u(n).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(o){var r=Yx.contents(o),i=e.length,u=i-r.length,a=u>0?Q(u,function(){return t.makeItem()}):[],c=r.slice(i);nt(c,function(t){return Yx.remove(o,t)}),nt(a,function(t){return Yx.append(o,t)});var s=Yx.contents(o);nt(s,function(o,r){t.setupItem(n,o,e[r],r)})})},i=t.shell?{behaviours:[Yx.config({})],components:[]}:{behaviours:[],components:n},u=function(n){return t.shell?j.some(n):nh(n,t,"items")};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:fv(t.listBehaviours,i.behaviours),apis:{setItems:r}}},Pz=xh({name:Iz(),configFields:Az(),partFields:Rz(),factory:Vz,apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),Hz=A([Pi("dom"),eu("shell",!0),cv("toolbarBehaviours",[Yx])]),zz=function(){return{behaviours:xl([Yx.config({})])}},Nz=A([Wv({name:"groups",overrides:zz})]),Lz=function(t,n,e,o){var r=function(t,n){i(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){Yx.set(t,n)})},i=function(n){return t.shell?j.some(n):nh(n,t,"groups")},u=t.shell?{behaviours:[Yx.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:u.components,behaviours:fv(t.toolbarBehaviours,u.behaviours),apis:{setGroups:r},domModification:{attributes:{role:"group"}}}},Wz=xh({name:"Toolbar",configFields:Hz(),partFields:Nz(),factory:Lz,apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),Uz=T,jz=V,Gz=A([]),Xz=Object.freeze({__proto__:null,setup:Uz,isDocked:jz,getBehaviours:Gz}),Yz=function(t){var n=Pt(ao(t,"position"),"fixed"),e=n?j.none():Te(t);return e.orThunk(function(){var n=fn.fromTag("span");return Oe(t).bind(function(t){zo(t,n);var e=Te(n);return jo(n),e})})},qz=function(t){return Yz(t).map(So).getOrThunk(function(){return yo(0,0)})},Kz=gu.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),Jz=function(t,n){var e=t.element;gs(e,n.transitionClass),vs(e,n.fadeOutClass),gs(e,n.fadeInClass),n.onShow(t)},$z=function(t,n){var e=t.element;gs(e,n.transitionClass),vs(e,n.fadeInClass),gs(e,n.fadeOutClass),n.onHide(t)},Qz=function(t,n){return t.y<n.bottom&&t.bottom>n.y},Zz=function(t,n){return t.y>=n.y},tN=function(t,n){return t.bottom<=n.bottom},nN=function(t,n,e){return dt(t,function(t){switch(t){case"bottom":return tN(n,e);case"top":return Zz(n,e)}})},eN=function(t,n){return n.getInitialPos().map(function(n){return ir(n.bounds.x,n.bounds.y,_o(t),po(t))})},oN=function(t,n,e){e.setInitialPos({style:co(t),position:io(t,"position")||"static",bounds:n})},rN=function(t,n,e){return e.getInitialPos().bind(function(o){switch(e.clearInitialPos(),o.position){case"static":return j.some(Kz.static());case"absolute":var r=Yz(t).map(ur).getOrThunk(function(){return ur(Ge())});return j.some(Kz.absolute(Vl("absolute",Rt(o.style,"left").map(function(t){return n.x-r.x}),Rt(o.style,"top").map(function(t){return n.y-r.y}),Rt(o.style,"right").map(function(t){return r.right-n.right}),Rt(o.style,"bottom").map(function(t){return r.bottom-n.bottom}))));default:return j.none()}})},iN=function(t,n,e){return eN(t,e).filter(function(t){return nN(e.getModes(),t,n)}).bind(function(n){return rN(t,n,e)})},uN=function(t,n,e){var o=ur(t);if(nN(e.getModes(),o,n))return j.none();oN(t,o,e);var r=cr(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return j.some(Kz.fixed(Vl("fixed",j.some(i),c?j.some(u):j.none(),j.none(),c?j.none():j.some(a))))},aN=function(t,n,e){var o=t.element,r=Pt(ao(o,"position"),"fixed");return r?iN(o,n,e):uN(o,n,e)},cN=function(t,n){var e=t.element;return eN(e,n).bind(function(t){return rN(e,t,n)})},sN=function(t,n,e){e.setDocked(!1),nt(["left","right","top","bottom","position"],function(n){return fo(t.element,n)}),n.onUndocked(t)},fN=function(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),Hl(t.element,o);var i=r?n.onDocked:n.onUndocked;i(t)},lN=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each(function(n){n.lazyContext(t).each(function(i){var u=Qz(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)bs(t.element,[n.fadeOutClass]),n.onHide(t);else{var a=u?Jz:$z;a(t,n)}})})},dN=function(t,n,e){var o=n.lazyViewport(t),r=e.isDocked();r&&lN(t,n,e,o),aN(t,o,e).each(function(r){r.fold(function(){return sN(t,n,e)},function(o){return fN(t,n,e,o)},function(r){lN(t,n,e,o,!0),fN(t,n,e,r)})})},mN=function(t,n,e){var o=t.element;e.setDocked(!1),cN(t,e).each(function(o){o.fold(function(){return sN(t,n,e)},function(o){return fN(t,n,e,o)},T)}),e.setVisible(!0),n.contextual.each(function(n){ys(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)}),gN(t,n,e)},gN=function(t,n,e){t.getSystem().isConnected()&&dN(t,n,e)},pN=function(t,n,e){e.isDocked()&&mN(t,n,e)},vN=function(t,n,e){return e.isDocked()},hN=function(t,n,e,o){return e.setModes(o)},bN=function(t,n,e){return e.getModes()},yN=Object.freeze({__proto__:null,refresh:gN,reset:pN,isDocked:vN,getModes:bN,setModes:hN}),xN=function(t,n){return Pa([Ja(na(),function(e,o){t.contextual.each(function(t){if(hs(e.element,t.transitionClass)){ys(e.element,[t.transitionClass,t.fadeInClass]);var r=n.isVisible()?t.onShown:t.onHidden;r(e)}o.stop()})}),La(ya(),function(e,o){gN(e,t,n)}),La(xa(),function(e,o){pN(e,t,n)})])},wN=Object.freeze({__proto__:null,events:xN}),SN=[tu("contextual",[Ni("fadeInClass"),Ni("fadeOutClass"),Ni("transitionClass"),Ui("lazyContext"),pf("onShow"),pf("onShown"),pf("onHide"),pf("onHidden")]),cu("lazyViewport",cr),fu("modes",["top","bottom"],hi),pf("onDocked"),pf("onUndocked")],kN=function(t){var n=du(!1),e=du(!0),o=ld(),r=du(t.modes),i=function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")};return Rc({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:i})},CN=Object.freeze({__proto__:null,init:kN}),ON=Sl({fields:SN,name:"docking",active:wN,apis:yN,state:CN}),_N=A(mc("toolbar-height-change")),TN={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},EN="tox-tinymce--toolbar-sticky-on",DN="tox-tinymce--toolbar-sticky-off",BN=function(t,n){var e=we(n),o=e.dom.defaultView.innerHeight,r=Xo(e),i=fn.fromDom(t.elm),u=ar(i),a=po(i),c=u.y,s=c+a,f=So(n),l=po(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)Yo(r.left,c-l,e);else if(p&&s>d){var v=c-o+a+l;Yo(r.left,v,e)}},AN=function(t,n){return J(ON.getModes(t),n)},MN=function(t){var n=function(t){return vo(t)+(parseInt(io(t,"margin-top"),10)||0)+(parseInt(io(t,"margin-bottom"),10)||0)},e=t.element;Oe(e).each(function(o){var r="padding-"+ON.getModes(t)[0];if(ON.isDocked(t)){var i=_o(o);eo(e,"width",i+"px"),eo(o,r,n(e)+"px")}else fo(e,"width"),fo(o,r)})},FN=function(t,n){n?(vs(t,TN.fadeOutClass),bs(t,[TN.transitionClass,TN.fadeInClass])):(vs(t,TN.fadeInClass),bs(t,[TN.fadeOutClass,TN.transitionClass]))},RN=function(t,n){var e=fn.fromDom(t.getContainer());n?(gs(e,EN),vs(e,DN)):(gs(e,DN),vs(e,EN))},IN=function(t,n){var e=we(n);Fl(e).filter(function(t){return!he(n,t)}).filter(function(n){return he(n,fn.fromDom(e.dom.body))||xe(t,n)}).each(function(){return Bl(n)})},VN=function(t,n){return Rl(t).orThunk(function(){return n().toOptional().bind(function(t){return Rl(t.element)})})},PN=function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(ON.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(MN)}),t.on("SkinLoaded",function(){e().each(function(t){ON.isDocked(t)?ON.reset(t):ON.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(ON.reset)})),t.on("AfterScrollIntoView",function(t){e().each(function(n){ON.refresh(n);var e=n.element;iy(e)&&BN(t,e)})}),t.on("PostRender",function(){RN(t,!1)})},HN=function(t){return t().map(ON.isDocked).getOr(!1)},zN=function(){var t;return[_l.config({channels:(t={},t[_N()]={onReceive:MN},t)})]},NN=function(t,n){var o=ld(),r=n.getSink,i=function(t){r().each(function(n){return t(n.element)})},u=function(n){t.inline||MN(n),RN(t,ON.isDocked(n)),n.getSystem().broadcastOn([Tp()],{}),r().each(function(t){return t.getSystem().broadcastOn([Tp()],{})})},a=t.inline?[]:zN();return e([rw.config({}),ON.config({contextual:z({lazyContext:function(n){var e=vo(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=ur(fn.fromDom(o)),i=r.height-e,u=r.y+(AN(n,"top")?0:e);return j.some(ir(r.x,u,r.width,i))},onShow:function(){i(function(t){return FN(t,!0)})},onShown:function(t){i(function(t){return ys(t,[TN.transitionClass,TN.fadeInClass])}),o.get().each(function(n){IN(t.element,n),o.clear()})},onHide:function(t){VN(t.element,r).fold(o.clear,o.set),i(function(t){return FN(t,!1)})},onHidden:function(){i(function(t){return ys(t,[TN.transitionClass])})}},TN),lazyViewport:function(n){var e=cr(),o=ZO(t),r=e.y+(AN(n,"top")?o:0),i=e.height-(AN(n,"bottom")?o:0);return ir(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:u,onUndocked:u})],a,!0)},LN=Object.freeze({__proto__:null,setup:PN,isDocked:HN,getBehaviours:NN}),WN=function(t){var n=t.editor,e=t.sticky?NN:Gz;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:xl(e(n,t.sharedBackstage))}},UN=ci([Ni("type"),Hi("items",fi([mi([Ni("name"),Yi("items",hi)]),hi]))].concat(Bk)),jN=function(t){return Ei("GroupToolbarButton",UN,t)},GN=[$i("text"),$i("tooltip"),$i("icon"),Ui("fetch"),cu("onSetup",function(){return T})],XN=ci(e([Ni("type")],GN,!0)),YN=function(t){return Ei("menubutton",XN,t)},qN=ci([Ni("type"),$i("tooltip"),$i("icon"),$i("text"),Qi("select"),Ui("fetch"),cu("onSetup",function(){return T}),uu("presets","normal",["normal","color","listpreview"]),eu("columns",1),Ui("onAction"),Ui("onItemAction")]),KN=function(t){return Ei("SplitButton",qN,t)},JN=function(t,n){var e=function(t,e){var o=tt(e,function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=YN(e).mapError(function(t){return Ai(t)}).getOrDie();return ZI(o,"tox-mbtn",n.backstage,j.some("menuitem"))});Yx.set(t,o)},o={focus:Px.focusIn,setMenus:e};return{uid:t.uid,dom:t.dom,components:[],behaviours:xl([Yx.config({}),Kx("menubar-events",[$a(function(n){t.onSetup(n)}),La(Xu(),function(t,n){Gs(t.element,".tox-mbtn--active").each(function(e){Xs(n.event.target,".tox-mbtn").each(function(n){he(e,n)||t.getSystem().getByDom(e).each(function(e){t.getSystem().getByDom(n).each(function(t){UB.expand(t),UB.close(e),rw.focus(t)})})})})}),La(Oa(),function(t,n){n.event.prevFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(e){n.event.newFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(t){UB.isOpen(e)&&(UB.expand(t),UB.close(e))})})})]),Px.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),j.some(!0)}}),CD.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},$N=yh({factory:JN,name:"silver.Menubar",configFields:[Pi("dom"),Pi("uid"),Pi("onEscape"),Pi("backstage"),eu("onSetup",T)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),QN=function(t,n){return n.getAnimationRoot.fold(function(){return t.element},function(n){return n(t)})},ZN=function(t){return t.dimension.property},tL=function(t,n){return t.dimension.getDimension(n)},nL=function(t,n){var e=QN(t,n);ys(e,[n.shrinkingClass,n.growingClass])},eL=function(t,n){vs(t.element,n.openClass),gs(t.element,n.closedClass),eo(t.element,ZN(n),"0px"),lo(t.element)},oL=function(t,n){vs(t.element,n.closedClass),gs(t.element,n.openClass),fo(t.element,ZN(n))},rL=function(t,n,e,o){e.setCollapsed(),eo(t.element,ZN(n),tL(n,t.element)),lo(t.element),nL(t,n),eL(t,n),n.onStartShrink(t),n.onShrunk(t)},iL=function(t,n,e,o){var r=o.getOrThunk(function(){return tL(n,t.element)});e.setCollapsed(),eo(t.element,ZN(n),r),lo(t.element);var i=QN(t,n);vs(i,n.growingClass),gs(i,n.shrinkingClass),eL(t,n),n.onStartShrink(t)},uL=function(t,n,e){var o=tL(n,t.element),r="0px"===o?rL:iL;r(t,n,e,j.some(o))},aL=function(t,n,e){var o=QN(t,n),r=hs(o,n.shrinkingClass),i=tL(n,t.element);oL(t,n);var u=tL(n,t.element),a=function(){eo(t.element,ZN(n),i),lo(t.element)},c=function(){eL(t,n)},s=r?a:c;s(),vs(o,n.shrinkingClass),gs(o,n.growingClass),oL(t,n),eo(t.element,ZN(n),u),e.setExpanded(),n.onStartGrow(t)},cL=function(t,n,e){if(e.isExpanded()){fo(t.element,ZN(n));var o=tL(n,t.element);eo(t.element,ZN(n),o)}},sL=function(t,n,e){e.isExpanded()||aL(t,n,e)},fL=function(t,n,e){e.isExpanded()&&uL(t,n,e)},lL=function(t,n,e){e.isExpanded()&&rL(t,n,e)},dL=function(t,n,e){return e.isExpanded()},mL=function(t,n,e){return e.isCollapsed()},gL=function(t,n,e){var o=QN(t,n);return!0===hs(o,n.growingClass)},pL=function(t,n,e){var o=QN(t,n);return!0===hs(o,n.shrinkingClass)},vL=function(t,n,e){return gL(t,n)||pL(t,n)},hL=function(t,n,e){var o=e.isExpanded()?uL:aL;o(t,n,e)},bL=Object.freeze({__proto__:null,refresh:cL,grow:sL,shrink:fL,immediateShrink:lL,hasGrown:dL,hasShrunk:mL,isGrowing:gL,isShrinking:pL,isTransitioning:vL,toggleGrow:hL,disableTransitions:nL}),yL=function(t,n,e){var o=n.expanded;return zc(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Su(n.dimension.property,"0px")})},xL=function(t,n){return Pa([Ja(na(),function(e,o){var r=o.event.raw;if(r.propertyName===t.dimension.property){nL(e,t),n.isExpanded()&&fo(e.element,t.dimension.property);var i=n.isExpanded()?t.onGrown:t.onShrunk;i(e)}})])},wL=Object.freeze({__proto__:null,exhibit:yL,events:xL}),SL=[Pi("closedClass"),Pi("openClass"),Pi("shrinkingClass"),Pi("growingClass"),qi("getAnimationRoot"),pf("onShrunk"),pf("onStartShrink"),pf("onGrown"),pf("onStartGrow"),eu("expanded",!1),Hi("dimension",Mi("property",{width:[yf("property","width"),yf("getDimension",function(t){return _o(t)+"px"})],height:[yf("property","height"),yf("getDimension",function(t){return po(t)+"px"})]}))],kL=function(n){var e=du(n.expanded),o=function(){return"expanded: "+e.get()};return Rc({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:t(e.set,!1),setExpanded:t(e.set,!0),readState:o})},CL=Object.freeze({__proto__:null,init:kL}),OL=Sl({fields:SL,name:"sliding",active:wL,apis:bL,state:CL}),_L="container",TL=[cv("slotBehaviours",[])],EL=function(t){return"<alloy.field."+t+">"},DL=function(t){var n,e,o=(n=[],e=function(t,e){return n.push(t),Jv(_L,EL(t),e)},{slot:e,record:A(n)}),r=t(o),i=o.record(),u=tt(i,function(t){return Nv({name:t,pname:EL(t)})});return mh(_L,TL,u,BL,r)},BL=function(t,n){var e=function(n){return ih(t)},o=function(n,e){return nh(n,t,e)},r=function(n,e){return function(o,r){return nh(o,t,r).map(function(t){return n(t,r)}).getOr(e)}},i=function(t){return function(n,e){nt(e,function(e){return t(n,e)})}},u=function(t,n){return"true"!==Je(t.element,"aria-hidden")},a=function(t,n){if(!u(t)){var e=t.element;fo(e,"display"),Ze(e,"aria-hidden"),Ma(t,_a(),{name:n,visible:!0})}},c=function(t,n){if(u(t)){var e=t.element;eo(e,"display","none"),qe(e,"aria-hidden","true"),Ma(t,_a(),{name:n,visible:!1})}},s=r(u,!1),f=r(c),l=i(f),d=function(t){return l(t,e())},m=r(a),g={getSlotNames:e,getSlot:o,isShowing:s,hideSlot:f,hideAllSlots:d,showSlot:m};return{uid:t.uid,dom:t.dom,components:n,behaviours:sv(t.slotBehaviours),apis:g}},AL=_t({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},function(t){return Mc(t)}),ML=z(z({},AL),{sketch:DL}),FL=ci([$i("icon"),$i("tooltip"),cu("onShow",T),cu("onHide",T),cu("onSetup",function(){return T})]),RL=function(t){return Ei("sidebar",FL,t)},IL=function(t){var n=t.ui.registry.getAll().sidebars;nt(kt(n),function(e){var o=n[e],r=function(){return Pt(j.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})})},VL=function(t){return{element:function(){return t.element.dom}}},PL=function(t,n){var e=tt(kt(n),function(t){var e=n[t],o=Di(RL(e));return{name:t,getApi:VL,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}});return tt(e,function(n){var o=du(T);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:rO.unnamedEvents([S_(n,o),k_(n,o),La(_a(),function(t,n){var o=n.event,r=ct(e,function(t){return t.name===o.name});r.each(function(n){var e=o.visible?n.onShow:n.onHide;e(n.getApi(t))})})])})})},HL=function(t){return ML.sketch(function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:PL(n,t),slotBehaviours:rO.unnamedEvents([$a(function(t){return ML.hideAllSlots(t)})])}})},zL=function(t,n){var e=Oh.getCurrent(t);e.each(function(t){return Yx.set(t,[HL(n)])})},NL=function(t,n){var e=Oh.getCurrent(t);e.each(function(t){var e=Oh.getCurrent(t);e.each(function(e){OL.hasGrown(t)?ML.isShowing(e,n)?OL.shrink(t):(ML.hideAllSlots(e),ML.showSlot(e,n)):(ML.hideAllSlots(e),ML.showSlot(e,n),OL.grow(t))})})},LL=function(t){var n=Oh.getCurrent(t);return n.bind(function(t){var n=OL.isGrowing(t)||OL.hasGrown(t);if(n){var e=Oh.getCurrent(t);return e.bind(function(t){return ct(ML.getSlotNames(t),function(n){return ML.isShowing(t,n)})})}return j.none()})},WL=mc("FixSizeEvent"),UL=mc("AutoSizeEvent"),jL=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:xl([CD.config({}),rw.config({}),OL.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){var n=Oh.getCurrent(t);n.each(ML.hideAllSlots),Aa(t,UL)},onGrown:function(t){Aa(t,UL)},onStartGrow:function(t){Ma(t,WL,{width:ao(t.element,"width").getOr("")})},onStartShrink:function(t){Ma(t,WL,{width:_o(t.element)+"px"})}}),Yx.config({}),Oh.config({find:function(t){var n=Yx.contents(t);return yt(n)}})])}],behaviours:xl([JF.childAt(0),Kx("sidebar-sliding-events",[La(WL,function(t,n){eo(t.element,"width",n.event.width)}),La(UL,function(t,n){fo(t.element,"width")})])])}},GL=function(t,n,e,o){qe(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=xl([Px.config({mode:"special",onTab:function(){return j.some(!0)},onShiftTab:function(){return j.some(!0)}}),rw.config({})]),u=o(r,i),a=r.getSystem().build(u);Yx.append(r,Ps(a)),a.hasConfigured(Px)&&n.focus&&Px.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith(function(){return Yx.remove(r,a)})},XL=function(t,n,e){Ze(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()},YL=Object.freeze({__proto__:null,block:GL,unblock:XL}),qL=[cu("getRoot",j.none),au("focus",!0),pf("onBlock"),pf("onUnblock")],KL=function(){var t=cd(),n=function(n){t.set({destroy:n})};return Rc({readState:t.isSet,blockWith:n,clear:t.clear,isBlocked:t.isSet})},JL=Object.freeze({__proto__:null,init:KL}),$L=Sl({fields:qL,name:"blocking",apis:YL,state:JL}),QL=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return ut(n,function(t,n){var e;return"class"===n.name?t:z(z({},t),(e={},e[n.name]=n.value,e))},{})},ZL=function(t){return Array.prototype.slice.call(t.dom.classList,0)},tW=function(t){var n=fn.fromHtml(t),e=De(n),o=QL(n),r=ZL(n),i=0===e.length?{}:{innerHtml:ec(n)};return z({tag:vn(n),classes:r,attributes:o},i)},nW=function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:tW('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}},eW=function(t){return Oh.getCurrent(t).each(function(t){return Bl(t.element)})},oW=function(t,n){var e="tabindex",o="data-mce-"+e;j.from(t.iframeElement).map(fn.fromDom).each(function(t){n?($e(t,e).each(function(n){return qe(t,o,n)}),qe(t,e,-1)):(Ze(t,e),$e(t,o).each(function(n){qe(t,e,n),Ze(t,o)}))})},rW=function(t,n,e,o){var r=n.element;if(oW(t,e),e)$L.block(n,nW(o)),fo(r,"display"),Ze(r,"aria-hidden"),t.hasFocus()&&eW(n);else{var i=Oh.getCurrent(n).exists(function(t){return Ml(t.element)});$L.unblock(n),eo(r,"display","none"),qe(r,"aria-hidden","true"),i&&t.focus()}},iW=function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:xl([Yx.config({}),$L.config({focus:!1}),Oh.config({find:function(t){return yt(t.components())}})]),components:[]}},uW=function(t){return"focusin"===t.type},aW=function(t){if(uW(t)){var n=t.composed?yt(t.composedPath()):j.from(t.target);return n.map(fn.fromDom).filter(yn).exists(function(t){return hs(t,"mce-pastebin")})}return!1},cW=function(t,n,e){var o=du(!1),r=ld(),i=function(e){o.get()&&!aW(e)&&(e.preventDefault(),eW(n()),t.editorReceptionist.setActive(t))};t.inline||t.on("PreInit",function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)})});var u=function(r){r!==o.get()&&(o.set(r),rW(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",function(n){if(r.on(DS.clearTimeout),O(n.time)){var e=DS.setEditorTimeout(t,function(){return u(n.state)},n.time);r.set(e)}else u(n.state),r.clear()})},sW=function(t,n){var e={len:0,list:[]},o=ut(t,function(t,e){var o=n(e,t.len);return o.fold(A(t),function(n){return{len:n.finish,list:t.list.concat([n])}})},e);return o.list},fW=function(t,n,e){return{within:t,extra:n,withinWidth:e}},lW=function(t,n,e){var o=sW(t,function(t,n){var o=e(t);return j.some({element:t,start:n,finish:n+o,width:o})}),r=rt(o,function(t){return t.finish<=n}),i=it(r,function(t,n){return t+n.width},0),u=o.slice(r.length);return{within:r,extra:u,withinWidth:i}},dW=function(t){return tt(t,function(t){return t.element})},mW=function(t,n,e){var o=dW(t.concat(n));return fW(o,[],e)},gW=function(t,n,e,o){var r=dW(t).concat([e]);return fW(r,dW(n),o)},pW=function(t,n,e){return fW(dW(t),[],e)},vW=function(t,n,e){var o=lW(n,t,e);return 0===o.extra.length?j.some(o):j.none()},hW=function(t,n,e,o){var r=vW(t,n,e).getOrThunk(function(){return lW(n,t-e(o),e)}),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?mW(i,u,a):u.length>=1?gW(i,u,o,a):pW(i,u,a)},bW=function(t,n){var e=tt(n,function(t){return Ps(t)});Wz.setGroups(t,e)},yW=function(t){return St(t,function(t){return Rl(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()})})},xW=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=eh(t,n,"primary"),i=kB.getCoupled(t,"overflowGroup");eo(r.element,"visibility","hidden");var u=o.concat([i]),a=yW(u);e([]),bW(r,u);var c=_o(r.element),s=hW(c,n.builtGroups.get(),function(t){return _o(t.element)},i);0===s.extra.length?(Yx.remove(r,i),e([])):(bW(r,s.within),e(s.extra)),fo(r.element,"visibility"),lo(r.element),a.each(rw.focus)}},wW=A([cv("splitToolbarBehaviours",[kB]),Ii("builtGroups",function(){return du([])})]),SW=A([mf(["overflowToggledClass"]),Qi("getOverflowBounds"),Pi("lazySink"),Ii("overflowGroups",function(){return du([])})].concat(wW())),kW=A([Nv({factory:Wz,schema:Hz(),name:"primary"}),Lv({schema:Hz(),name:"overflow"}),Lv({name:"overflow-button"}),Lv({name:"overflow-group"})]),CW=A(function(t,n){Eo(t,Math.floor(n))}),OW=A([mf(["toggledClass"]),Pi("lazySink"),Ui("fetch"),Qi("getBounds"),tu("fireDismissalEventInstead",[eu("event",ka())]),Xd()]),_W=A([Lv({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:xl([kw.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Lv({factory:Wz,schema:Hz(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:xl([Px.config({mode:"cyclic",onEscape:function(n){return nh(n,t,"button").each(rw.focus),j.none()}})])}}})]),TW=function(t,n){var e=kB.getCoupled(t,"toolbarSandbox");Op.isOpen(e)?Op.close(e):Op.open(e,n.toolbar())},EW=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),i=e.lazySink(t).getOrDie();Gg.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:CW()}}},r)},DW=function(t,n,e,o,r){Wz.setGroups(n,r),EW(t,n,e,o),kw.on(t)},BW=function(t,n,e){var o=qs(),r=function(r,i){e.fetch().get(function(r){DW(t,i,e,n.layouts,r),o.link(t.element),Px.focusIn(i)})},i=function(){kw.off(t),rw.focus(t),o.unlink(t.element)};return{dom:{tag:"div",attributes:{id:o.id}},behaviours:xl([Px.config({mode:"special",onEscape:function(t){return Op.close(t),j.some(!0)}}),Op.config({onOpen:r,onClose:i,isPartOf:function(n,e,o){return Js(e,o)||Js(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),_l.config({channels:z(z({},Bp(z({isExtraPart:V},e.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Mp({doReposition:function(){Op.getState(kB.getCoupled(t,"toolbarSandbox")).each(function(o){EW(t,o,e,n.layouts)})}}))})])}},AW=function(t,n,e,o){return z(z({},AS.sketch(z(z({},o.button()),{action:function(t){TW(t,o)},buttonBehaviours:lv.augment({dump:o.button().buttonBehaviours},[kB.config({others:{toolbarSandbox:function(n){return BW(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){Op.getState(kB.getCoupled(n,"toolbarSandbox")).each(function(r){DW(n,r,t,e.layouts,o)})},reposition:function(n){Op.getState(kB.getCoupled(n,"toolbarSandbox")).each(function(o){EW(n,o,t,e.layouts)})},toggle:function(t){TW(t,o)},getToolbar:function(t){return Op.getState(kB.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Op.isOpen(kB.getCoupled(t,"toolbarSandbox"))}}})},MW=xh({name:"FloatingToolbarButton",factory:AW,configFields:OW(),partFields:_W(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),FW=A([Pi("items"),mf(["itemSelector"]),cv("tgroupBehaviours",[Px])]),RW=A([Uv({name:"items",unit:"item"})]),IW=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.tgroupBehaviours,[Px.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},VW=xh({name:"ToolbarGroup",configFields:FW(),partFields:RW(),factory:IW}),PW=function(t){return tt(t,function(t){return Ps(t)})},HW=function(t,n,e){xW(t,e,function(o){e.overflowGroups.set(o),n.getOpt(t).each(function(t){MW.setGroups(t,PW(o))})})},zW=function(t,n,e,o){var r=MS(MW.sketch({fetch:function(){return iB.nu(function(n){n(PW(t.overflowGroups.get()))})},layouts:{onLtr:function(){return[Jf,Kf]},onRtl:function(){return[Kf,Jf]},onBottomLtr:function(){return[Qf,$f]},onBottomRtl:function(){return[$f,Qf]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,
fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.splitToolbarBehaviours,[kB.config({others:{overflowGroup:function(){return VW.sketch(z(z({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(tt(e,n.getSystem().build)),HW(n,r,t)},refresh:function(n){return HW(n,r,t)},toggle:function(t){r.getOpt(t).each(function(t){MW.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(MW.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){MW.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(MW.getToolbar)}},domModification:{attributes:{role:"group"}}}},NW=xh({name:"SplitFloatingToolbar",configFields:SW(),partFields:kW(),factory:zW,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),LW=A([mf(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),pf("onOpened"),pf("onClosed")].concat(wW())),WW=A([Nv({factory:Wz,schema:Hz(),name:"primary"}),Nv({factory:Wz,schema:Hz(),name:"overflow",overrides:function(t){return{toolbarBehaviours:xl([OL.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){nh(n,t,"overflow-button").each(function(t){kw.off(t),rw.focus(t)}),t.onClosed(n)},onGrown:function(n){Px.focusIn(n),t.onOpened(n)},onStartGrow:function(n){nh(n,t,"overflow-button").each(kw.on)}}),Px.config({mode:"acyclic",onEscape:function(n){return nh(n,t,"overflow-button").each(rw.focus),j.some(!0)}})])}}}),Lv({name:"overflow-button",overrides:function(t){return{buttonBehaviours:xl([kw.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Lv({name:"overflow-group"})]),UW=function(t,n){return nh(t,n,"overflow").map(OL.hasGrown).getOr(!1)},jW=function(t,n){nh(t,n,"overflow-button").bind(function(){return nh(t,n,"overflow")}).each(function(e){GW(t,n),OL.toggleGrow(e)})},GW=function(t,n){nh(t,n,"overflow").each(function(e){xW(t,n,function(t){var n=tt(t,function(t){return Ps(t)});Wz.setGroups(e,n)}),nh(t,n,"overflow-button").each(function(t){OL.hasGrown(e)&&kw.on(t)}),OL.refresh(e)})},XW=function(t,n,e,o){var r="alloy.toolbar.toggle",i=function(n,e){var o=tt(e,n.getSystem().build);t.builtGroups.set(o)};return{uid:t.uid,dom:t.dom,components:n,behaviours:fv(t.splitToolbarBehaviours,[kB.config({others:{overflowGroup:function(t){return VW.sketch(z(z({},o["overflow-group"]()),{items:[AS.sketch(z(z({},o["overflow-button"]()),{action:function(n){Aa(t,r)}}))]}))}}}),Kx("toolbar-toggle-events",[La(r,function(n){jW(n,t)})])]),apis:{setGroups:function(n,e){i(n,e),GW(n,t)},refresh:function(n){return GW(n,t)},toggle:function(n){return jW(n,t)},isOpen:function(n){return UW(n,t)}},domModification:{attributes:{role:"group"}}}},YW=xh({name:"SplitSlidingToolbar",configFields:LW(),partFields:WW(),factory:XW,apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),qW=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:z({tag:"div",classes:["tox-toolbar__group"]},n),components:[VW.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:xl([CD.config({}),rw.config({})])}},KW=function(t){return VW.sketch(qW(t))},JW=function(t,n){var e=$a(function(n){var e=tt(t.initGroups,KW);Wz.setGroups(n,e)});return xl([x_.toolbarButton(t.providers.isDisabled),p_(),Px.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Kx("toolbar-events",[e])])},$W=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":qW({title:j.none(),items:[]}),"overflow-button":eV({name:"more",icon:j.some("more-drawer"),disabled:!1,tooltip:j.some("More..."),primary:!1,borderless:!1},j.none(),t.providers)},splitToolbarBehaviours:JW(t,n)}},QW=function(t){var n=$W(t),e=4,o=NW.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return NW.sketch(z(z({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,o=ar(n),r=ke(n),i=ar(r),u=Math.max(r.dom.scrollHeight,i.height);return ir(o.x+e,i.y,o.width-2*e,u)},parts:z(z({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},ZW=function(t){var n=YW.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=YW.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=$W(t);return YW.sketch(z(z({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([_N()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([_N()],{type:"closed"})}}))},tU=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return Wz.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===qk.scrolling?["tox-toolbar--scrolling"]:[])},components:[Wz.parts.groups({})],toolbarBehaviours:JW(t,n)})},nU=function(t,n,e){var o={getSocket:function(n){return Dz.getPart(n,t,"socket")},setSidebar:function(n,e){Dz.getPart(n,t,"sidebar").each(function(t){return zL(t,e)})},toggleSidebar:function(n,e){Dz.getPart(n,t,"sidebar").each(function(t){return NL(t,e)})},whichSidebar:function(n){return Dz.getPart(n,t,"sidebar").bind(LL).getOrNull()},getHeader:function(n){return Dz.getPart(n,t,"header")},getToolbar:function(n){return Dz.getPart(n,t,"toolbar")},setToolbar:function(n,e){Dz.getPart(n,t,"toolbar").each(function(t){t.getApis().setGroups(t,e)})},setToolbars:function(n,e){Dz.getPart(n,t,"multiple-toolbar").each(function(t){Pz.setItems(t,e)})},refreshToolbar:function(n){var e=Dz.getPart(n,t,"toolbar");e.each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(n){Dz.getPart(n,t,"toolbar").each(function(t){Ut(t.getApis().toggle,function(n){return n(t)})})},isToolbarDrawerToggled:function(n){return Dz.getPart(n,t,"toolbar").bind(function(t){return j.from(t.getApis().isOpen).map(function(n){return n(t)})}).getOr(!1)},getThrobber:function(n){return Dz.getPart(n,t,"throbber")},focusToolbar:function(n){var e=Dz.getPart(n,t,"toolbar").orThunk(function(){return Dz.getPart(n,t,"multiple-toolbar")});e.each(function(t){Px.focusIn(t)})},setMenubar:function(n,e){Dz.getPart(n,t,"menubar").each(function(t){$N.setMenus(t,e)})},focusMenubar:function(n){Dz.getPart(n,t,"menubar").each(function(t){$N.focus(t)})}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},eU=Bz.optional({factory:$N,name:"menubar",schema:[Pi("backstage")]}),oU=function(t){return t.type===qk.sliding?ZW:t.type===qk.floating?QW:tU},rU=Bz.optional({factory:{sketch:function(t){return Pz.sketch({uid:t.uid,dom:t.dom,listBehaviours:xl([Px.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return tU({type:t.type,uid:mc("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),j.some(!0)}})},setupItem:function(t,n,e,o){Wz.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Pi("dom"),Pi("onEscape")]}),iU=Bz.optional({factory:{sketch:function(t){var n=oU(t),e={type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),j.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes};return n(e)}},name:"toolbar",schema:[Pi("dom"),Pi("onEscape"),Pi("getSink")]}),uU=Bz.optional({factory:{sketch:WN},name:"header",schema:[Pi("dom")]}),aU=Bz.optional({name:"socket",schema:[Pi("dom")]}),cU=Bz.optional({factory:{sketch:jL},name:"sidebar",schema:[Pi("dom")]}),sU=Bz.optional({factory:{sketch:iW},name:"throbber",schema:[Pi("dom")]}),fU=xh({name:"OuterContainer",factory:nU,configFields:[Pi("dom"),Pi("behaviours")],partFields:[uU,eU,iU,rU,aU,cU,sU],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=tt(e,function(t){return KW(t)});t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=tt(e,function(t){return tt(t,KW)});t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),lU="file edit view insert format tools table help",dU={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},mU=function(t,n,e){var o=FO(e).split(/[ ,]/);return{text:t.title,getItems:function(){return lt(t.items,function(t){var e=t.toLowerCase();return 0===e.trim().length?[]:$(o,function(t){return t===e})?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]})}}},gU=function(t){return"string"==typeof t?t.split(" "):t},pU=function(t,n){var e=z(z({},dU),n.menus),o=kt(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?gU(lU):gU(!1===n.menubar?"":n.menubar),i=rt(r,function(t){var e=It(dU,t);return o?e||Rt(n.menus,t).exists(function(t){return It(t,"items")}):e}),u=tt(i,function(o){var r=e[o];return mU({title:r.title,items:gU(r.items)},n,t)});return rt(u,function(t){var n=function(t){return"separator"!==t.type};return t.getItems().length>0&&$(t.getItems(),n)})},vU=function(t){var n=function(){t._skinLoaded=!0,ST(t)};return function(){t.initialized?n():t.on("init",n)}},hU=function(t,n){return function(){return kT(t,{message:n})}},bU=function(t,n,e){return new dk(function(o,r){e.load(n,o,r),t.on("remove",function(){return e.unload(n)})})},yU=function(t,n){var e=n+"/skin.min.css";return bU(t,e,t.ui.styleSheetLoader)},xU=function(t,n){var e=ze(fn.fromDom(t.getElement()));if(e){var o=n+"/skin.shadowdom.min.css";return bU(t,o,bO.DOM.styleSheetLoader)}return dk.resolve()},wU=function(t,n){var e=xO(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===SO(n)&&v(e)?dk.all([yU(n,e),xU(n,e)]).then(vU(n),hU(n,"Skin could not be loaded")):vU(n)()},SU=t(wU,!1),kU=t(wU,!0),CU=function(t,n){return function(e){var o=sd(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},OU=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},_U=function(t){return function(n){return function(){t.undoReceptionist.transact(function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)})}}},TU=function(t,n){return function(){return t.execCommand(n)}},EU=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return j.some({type:"separator",text:a});if("submenu"===t.type){var c=lt(t.getStyleItems(),function(t){return r(t,o,u)});return 0===o&&c.length<=0?j.none():j.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return lt(t.getStyleItems(),function(t){return r(t,o,u)})}})}return j.some(z({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return lt(t,function(t){return r(t,o,n)})},u=function(t,n){return function(e,o){var r=n(),u=i(r),a=$I(u,Kk.CLOSE_ON_EXECUTE,t,!1);o(a)}};return{validateItems:i,getFetch:u}},DU=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return tt(o.data,function(t){return IH(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:EU(t,n,e),getStyleItems:r}},BU=function(t,n,e){var o=DU(t,n,e),r=o.items,i=o.getStyleItems,u=function(t){return{getComponent:A(t)}},a=OU(t,"NodeChange",function(t){var n=t.getComponent();e.updateText(n)});return LI({text:e.icon.isSome()?j.none():e.text,icon:e.icon,tooltip:j.from(e.tooltip),role:j.none(),fetch:r.getFetch(n,i),onSetup:a,getApi:u,columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)},AU=function(t){return tt(t,function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}})},MU=function(t){return{type:"basic",data:t}};(function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"})(TB||(TB={}));var FU,RU,IU,VU,PU,HU,zU,NU,LU=function(t,n){return n===TB.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")},WU=function(t,n,e,o){var r=t.getParam(n,e,"string"),i=AU(LU(r,o));return{type:"basic",data:i}},UU=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],jU=function(t){var n=function(){return ct(UU,function(n){return t.formatter.match(n.format)})},e=function(n){return function(){return t.formatter.match(n)}},o=function(t){return j.none},r=function(t){var e=n(),o=e.fold(A("left"),function(t){return t.title.toLowerCase()});Ma(t,NI,{icon:"align-"+o})},i=MU(UU),u=function(n){return function(){return ct(UU,function(t){return t.format===n.format}).each(function(n){return t.execCommand(n.command)})}};return{tooltip:"Align",text:j.none(),icon:j.some("align-left"),isSelectedFor:e,getCurrentValue:j.none,getPreviewFor:o,onAction:u,updateText:r,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},GU=function(t,n){return BU(t,n,jU(t))},XU=function(t,n){var e=DU(t,n,jU(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},YU="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",qU=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],KU=function(t){var n=t.split(/\s*,\s*/);return tt(n,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},JU=function(t){var n=function(){var n=KU(t.toLowerCase());return dt(qU,function(t){return n.indexOf(t.toLowerCase())>-1})};return 0===t.indexOf("-apple-system")&&n()},$U=function(t){var n="System Font",e=function(){var e=function(t){return t?KU(t)[0]:""},o=t.queryCommandValue("FontName"),r=c.data,i=o?o.toLowerCase():"",u=ct(r,function(t){var n=t.format;return n.toLowerCase()===i||e(n).toLowerCase()===e(i).toLowerCase()}).orThunk(function(){return jt(JU(i),{title:n,format:i})});return{matchOpt:u,font:o}},o=function(t){return function(n){return n.exists(function(n){return n.format===t})}},r=function(){var t=e().matchOpt;return t},i=function(t){return function(){return j.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},u=function(n){return function(){t.undoReceptionist.transact(function(){t.focus(),t.execCommand("FontName",!1,n.format)})}},a=function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(A(r),function(t){return t.title});Ma(t,zI,{text:i})},c=WU(t,"font_formats",YU,TB.SemiColon);return{tooltip:"Fonts",text:j.some(n),icon:j.none(),isSelectedFor:o,getCurrentValue:r,getPreviewFor:i,onAction:u,updateText:a,dataset:c,shouldHide:!1,isInvalid:V}},QU=function(t,n){return BU(t,n,$U(t))},ZU=function(t,n){var e=DU(t,n,$U(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},tj="8pt 10pt 12pt 14pt 18pt 24pt 36pt",nj={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},ej={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},oj=function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e},rj=function(t,n){return/[0-9.]+px$/.test(t)?oj(72*parseInt(t,10)/96,n||0)+"pt":Rt(ej,t).getOr(t)},ij=function(t){return Rt(nj,t).getOr("")},uj=function(t){var n=function(){var n=j.none(),e=a.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=rj(o,t),i=ij(r);n=ct(e,function(t){return t.format===o||t.format===r||t.format===i})},i=3;n.isNone()&&i>=0;i--)r(i);return{matchOpt:n,size:o}},e=function(t){return function(n){return n.exists(function(n){return n.format===t})}},o=function(){var t=n().matchOpt;return t},r=A(j.none),i=function(n){return function(){t.undoReceptionist.transact(function(){t.focus(),t.execCommand("FontSize",!1,n.format)})}},u=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(A(r),function(t){return t.title});Ma(t,zI,{text:i})},a=WU(t,"fontsize_formats",tj,TB.Space);return{tooltip:"Font sizes",text:j.some("12pt"),icon:j.none(),isSelectedFor:e,getPreviewFor:r,getCurrentValue:o,onAction:i,updateText:u,dataset:a,shouldHide:!1,isInvalid:V}},aj=function(t,n){return BU(t,n,uj(t))},cj=function(t,n){var e=DU(t,n,uj(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},sj=function(t,n){var e=n(),o=tt(e,function(t){return t.format});return j.from(t.formatter.closest(o)).bind(function(t){return ct(e,function(n){return n.format===t})}).orThunk(function(){return jt(t.formatter.match("p"),{title:"Paragraph",format:"p"})})},fj="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",lj=function(t){var n="Paragraph",e=function(n){return function(){return t.formatter.match(n)}},o=function(n){return function(){var e=t.formatter.get(n);return j.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},r=function(e){var o=sj(t,function(){return i.data}),r=o.fold(A(n),function(t){return t.title});Ma(e,zI,{text:r})},i=WU(t,"block_formats",fj,TB.SemiColon);return{tooltip:"Blocks",text:j.some(n),icon:j.none(),isSelectedFor:e,getCurrentValue:j.none,getPreviewFor:o,onAction:_U(t),updateText:r,dataset:i,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},dj=function(t,n){return BU(t,n,lj(t))},mj=function(t,n){var e=DU(t,n,lj(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},gj=function(t,n){var e="Paragraph",o=function(n){return function(){return t.formatter.match(n)}},r=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?j.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):j.none()}},i=function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?lt(n,o):[{title:t.title,format:t.format}]},r=lt(RH(t),o),i=sj(t,A(r)),u=i.fold(A(e),function(t){return t.title});Ma(n,zI,{text:u})};return{tooltip:"Formats",text:j.some(e),icon:j.none(),isSelectedFor:o,getCurrentValue:j.none,getPreviewFor:r,onAction:_U(t),updateText:i,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},pj=function(t,n){var e=z({type:"advanced"},n.styleselect);return BU(t,n,gj(t,e))},vj=function(t,n){var e=z({type:"advanced"},n.styleselect),o=DU(t,n,gj(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},hj=function(t,n){var e=function(e,o){t.updateState.each(function(t){var r=t(e,o);n.set(r)}),t.renderComponents.each(function(t){var r=t(o,n.get()),i=tt(r,e.getSystem().build);Jg(e,i)})};return Pa([La(sa(),function(n,o){var r=o;if(!r.universal){var i=t.channel;J(r.channels,i)&&e(n,r.data)}}),$a(function(n,o){t.initialData.each(function(t){e(n,t)})})])},bj=Object.freeze({__proto__:null,events:hj}),yj=function(t,n,e){return e},xj=Object.freeze({__proto__:null,getState:yj}),wj=[Pi("channel"),qi("renderComponents"),qi("updateState"),qi("initialData")],Sj=function(){var t=du(j.none()),n=function(){return t.set(j.none())},e=function(){return t.get().getOr("none")};return{readState:e,get:t.get,set:t.set,clear:n}},kj=Object.freeze({__proto__:null,init:Sj}),Cj=Sl({fields:wj,name:"reflecting",active:bj,apis:xj,state:kj}),Oj=A([Pi("toggleClass"),Pi("fetch"),hf("onExecute"),eu("getHotspot",j.some),eu("getAnchorOverrides",A({})),Xd(),hf("onItemExecute"),qi("lazySink"),Pi("dom"),pf("onOpen"),cv("splitDropdownBehaviours",[kB,Px,rw]),eu("matchWidth",!1),eu("useMinWidth",!1),eu("eventOrder",{}),qi("role")].concat(zB())),_j=Nv({factory:AS,schema:[Pi("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:xl([rw.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Fa)},buttonBehaviours:xl([kw.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),Tj=Nv({factory:AS,schema:[Pi("dom")],name:"button",defaults:function(){return{buttonBehaviours:xl([rw.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(function(e){t.onExecute(e,n)})}}}}),Ej=A([_j,Tj,Wv({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Pi("text")],name:"aria-descriptor"}),Lv({schema:[df()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each(function(o){t.onItemExecute(o,n,e)})}}}}),OB()]),Dj=function(t,n,e,o){var r,i=function(t){Oh.getCurrent(t).each(function(t){fb.highlightFirst(t),Px.focusIn(t)})},u=function(n){var e=i;FB(t,M,n,o,e,JD.HighlightFirst).get(T)},a=function(t){return u(t),j.some(!0)},c=function(n){var e=eh(n,t,"button");return Fa(e),j.some(!0)},s=z(z({},Pa([$a(function(n,e){var o=nh(n,t,"aria-descriptor");o.each(function(t){var e=mc("aria");qe(t.element,"id",e),qe(n.element,"aria-describedby",e)})})])),Ow(j.some(u))),f={repositionMenus:function(t){kw.isOn(t)&&HB(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:f,eventOrder:z(z({},t.eventOrder),(r={},r[fa()]=["disabling","toggling","alloy.base.behaviour"],r)),events:s,behaviours:fv(t.splitDropdownBehaviours,[kB.config({others:{sandbox:function(n){var e=eh(n,t,"arrow"),o={onOpen:function(){kw.on(e),kw.on(n)},onClose:function(){kw.off(e),kw.off(n)}};return PB(t,n,o)}}}),Px.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),rw.config({}),kw.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},Bj=xh({name:"SplitDropdown",configFields:Oj(),partFields:Ej(),factory:Dj,apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Aj=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},Mj=function(t){return{setActive:function(n){kw.set(t,n)},isActive:function(){return kw.isOn(t)},isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)}}},Fj=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},Rj=mc("focus-button"),Ij=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:Fj(e,i)},components:__([t.map(function(t){return FI(t,i.icons)}),n.map(function(t){return II(t,"tox-tbtn",i)})]),eventOrder:(u={},u[Wu()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:xl([x_.toolbarButton(i.isDisabled),p_(),Kx("common-button-display-events",[La(Wu(),function(t,n){n.event.prevent(),Aa(t,Rj)})])].concat(o.map(function(e){return Cj.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return __([t.icon.map(function(t){return FI(t,i.icons)}),t.text.map(function(t){return II(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},Vj=function(t,n,e,o){var r=n.shared;return MW.sketch({lazySink:r.getSink,fetch:function(){return iB.nu(function(n){n(tt(e(t.items),KW))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:Ij(t.icon,t.text,t.tooltip,j.none(),j.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},Pj=function(t,n,e){var o=du(T),r=Ij(t.icon,t.text,t.tooltip,j.none(),j.none(),e);return AS.sketch({dom:r.dom,components:r.components,eventOrder:HI,buttonBehaviours:xl([Kx("toolbar-button-events",[PI({onAction:t.onAction,getApi:n.getApi}),S_(n,o),k_(n,o)]),x_.toolbarButton(function(){return t.disabled||e.isDisabled()}),p_()].concat(n.toolbarButtonBehaviours))})},Hj=function(t,n){return zj(t,n,[])},zj=function(t,n,e){return Pj(t,{toolbarButtonBehaviours:[].concat(e.length>0?[Kx("toolbarButtonWith",e)]:[]),getApi:Aj,onSetup:t.onSetup},n)},Nj=function(t,n){return Lj(t,n,[])},Lj=function(t,n,e){return Br(Pj(t,{toolbarButtonBehaviours:[Yx.config({}),kw.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[Kx("toolbarToggleButtonWith",e)]:[]),getApi:Mj,onSetup:t.onSetup},n))},Wj=function(t,n,e){return function(o){return iB.nu(function(t){return n.fetch(t)}).map(function(r){return j.from(PE(Br(aE(mc("menu-value"),r,function(e){n.onItemAction(t(o),e)},n.columns,n.presets,Kk.CLOSE_ON_EXECUTE,n.select.getOr(V),e),{movement:sE(n.columns,n.presets),menuBehaviours:rO.unnamedEvents("auto"!==n.columns?[]:[$a(function(t,e){nO(t,4,vC(n.presets)).each(function(n){var e=n.numRows,o=n.numColumns;Px.setGridSize(t,e,o)})})])})))})}},Uj=function(t,n){var e,o=mc("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return jh.isDisabled(t)},setDisabled:function(n){return jh.set(t,n)},setIconFill:function(n,e){Gs(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){qe(t,"fill",e)})},setIconStroke:function(n,e){Gs(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){qe(t,"stroke",e)})},setActive:function(n){qe(t.element,"aria-pressed",n),Gs(t.element,"span").each(function(e){t.getSystem().getByDom(e).each(function(t){return kw.set(t,n)})})},isActive:function(){return Gs(t.element,"span").exists(function(n){return t.getSystem().getByDom(n).exists(kw.isOn)})}}},i=du(T),u={getApi:r,onSetup:t.onSetup};return Bj.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:z({"aria-pressed":!1},Fj(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:xl([x_.splitButton(n.providers.isDisabled),p_(),Kx("split-dropdown-events",[La(Rj,rw.focus),S_(u,i),k_(u,i)]),YB.config({})]),eventOrder:(e={},e[wa()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:Wj(r,t,n.providers),parts:{menu:SC(!1,t.columns,t.presets)},components:[Bj.parts.button(Ij(t.icon,t.text,j.none(),j.some(o),j.some([kw.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),Bj.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:zS("chevron-down",n.providers.icons)},buttonBehaviours:xl([x_.splitButton(n.providers.isDisabled),p_(),WS()])}),Bj.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},jj=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Gj=function(t,n){return function(e,o,r){var i=t(e).mapError(function(t){return Ai(t)}).getOrDie();return n(i,o,r)}},Xj={button:Gj(Mk,function(t,n){return Hj(t,n.backstage.shared.providers)}),togglebutton:Gj(Ik,function(t,n){return Nj(t,n.backstage.shared.providers)}),menubutton:Gj(YN,function(t,n){return ZI(t,"tox-tbtn",n.backstage,j.none())}),splitbutton:Gj(KN,function(t,n){return Uj(t,n.backstage.shared)}),grouptoolbarbutton:Gj(jN,function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=function(t){return tG(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,j.none())},u=(o={},o[jd]=n.backstage.shared.header.isPositionedAtTop()?Xl.TopToBottom:Xl.BottomToTop,o);switch(zO(e)){case qk.floating:return Vj(t,n.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(t,n){return pj(t,n.backstage)},fontsizeSelectButton:function(t,n){return aj(t,n.backstage)},fontSelectButton:function(t,n){return QU(t,n.backstage)},formatButton:function(t,n){return dj(t,n.backstage)},alignMenuButton:function(t,n){return GU(t,n.backstage)}},Yj=function(t,n,e){return Rt(Xj,t.type).fold(function(){return console.error("skipping button defined by",t),j.none()},function(o){return j.some(o(t,n,e))})},qj={styleselect:Xj.styleSelectButton,fontsizeselect:Xj.fontsizeSelectButton,fontselect:Xj.fontSelectButton,formatselect:Xj.formatButton,align:Xj.alignMenuButton},Kj=function(t){var n=tt(jj,function(n){var e=rt(n.items,function(n){return It(t,n)||It(qj,n)});return{name:n.name,items:e}});return rt(n,function(t){return t.items.length>0})},Jj=function(t){var n=t.split("|");return tt(n,function(t){return{items:t.trim().split(" ")}})},$j=function(t){return _(t,function(t){return It(t,"name")&&It(t,"items")})},Qj=function(t){var n=t.toolbar,e=t.buttons
;return!1===n?[]:void 0===n||!0===n?Kj(e):v(n)?Jj(n):$j(n)?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Zj=function(t,n,e,o,r,i){return Rt(n,e.toLowerCase()).orThunk(function(){return i.bind(function(t){return St(t,function(t){return Rt(n,t+e.toLowerCase())})})}).fold(function(){return Rt(qj,e.toLowerCase()).map(function(n){return n(t,r)}).orThunk(function(){return j.none()})},function(n){return"grouptoolbarbutton"!==n.type||o?Yj(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),j.none())})},tG=function(t,n,e,o){var r=Qj(n),i=tt(r,function(r){var i=lt(r.items,function(r){return 0===r.trim().length?[]:Zj(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()});return{title:j.from(t.translate(r.name)),items:i}});return rt(i,function(t){return t.items.length>0})},nG=function(t,n,e,o){var r=n.outerContainer,i=e.toolbar,u=e.buttons;if(_(i,v)){var a=i.map(function(n){var r={toolbar:n,buttons:u,allowToolbarGroups:e.allowToolbarGroups};return tG(t,r,{backstage:o},j.none())});fU.setToolbars(r,a)}else fU.setToolbar(r,tG(t,e,{backstage:o},j.none()))},eG=fe(),oG=eG.os.isiOS()&&eG.os.version.major<=12,rG=function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=du(yo(o.innerWidth,o.innerHeight)),u=du(yo(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(yo(o.innerWidth,o.innerHeight)),OT(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(yo(n.offsetWidth,n.offsetHeight)),OT(t))},s=function(n){return _T(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=gd(fn.fromDom(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",function(){eo(l,"display","none")}),t.on("show",function(){fo(l,"display")}),t.on("NodeChange",c),t.on("remove",function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null})},iG=function(t,n,e,o,r){var i=du(0),u=n.outerContainer;SU(t);var a=fn.fromDom(r.targetNode),c=He(Pe(a));op(a,n.mothership),ep(c,n.uiMothership),t.on("PostRender",function(){nG(t,n,e,o),i.set(t.getWin().innerWidth),fU.setMenubar(u,pU(t,e)),fU.setSidebar(u,e.sidebar),rG(t,n)});var s=fU.getSocket(u).getOrDie("Could not find expected socket element");if(oG){oo(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var f=KS(function(){t.fire("ScrollContent")},20),l=md(s.element,"scroll",f.throttle);t.on("remove",l.unbind)}g_(t,n),t.addCommand("ToggleSidebar",function(n,e){fU.toggleSidebar(u,e),t.fire("ToggleSidebar")}),t.addQueryValueHandler("ToggleSidebar",function(){return fU.whichSidebar(u)});var d=zO(t),m=function(){fU.refreshToolbar(n.outerContainer)};d!==qk.sliding&&d!==qk.floating||t.on("ResizeWindow ResizeEditor ResizeContent",function(){var n=t.getWin().innerWidth;n!==i.get()&&(m(),i.set(n))});var g={enable:function(){m_(n,!1)},disable:function(){m_(n,!0)},isDisabled:function(){return jh.isDisabled(u)}};return{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:g}},uG=Object.freeze({__proto__:null,render:iG}),aG=function(t){var n=/^[0-9\.]+(|px)$/i;return n.test(""+t)?j.some(parseInt(""+t,10)):j.none()},cG=function(t){return O(t)?t+"px":t},sG=function(t,n,e){var o=n.filter(function(n){return t<n}),r=e.filter(function(n){return t>n});return o.or(r).getOr(t)},fG=function(t){var n=kO(t),e=_O(t),o=EO(t);return aG(n).map(function(t){return sG(t,e,o)})},lG=function(t){var n=fG(t);return n.getOr(kO(t))},dG=function(t){var n=CO(t),e=OO(t),o=TO(t);return aG(n).map(function(t){return sG(t,e,o)})},mG=function(t){var n=dG(t);return n.getOr(CO(t))},gG=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=bO.DOM,c=KO(t),s=QO(t),f=TO(t).or(dG(t)),l=o.shared.header,d=l.isPositionedAtTop,m=zO(t),g=m===qk.sliding||m===qk.floating,p=du(!1),v=function(){return p.get()&&!t.removed},h=function(t){return g?t.fold(A(0),function(t){return t.components().length>1?po(t.components()[1].element):0}):0},b=function(e){switch(UO(t)){case HO.auto:var o=fU.getToolbar(u),r=h(o),i=po(e.element)-r,a=ur(n),c=a.y>i;if(c)return"top";var s=ke(n),f=Math.max(s.dom.scrollHeight,po(s)),l=a.bottom<f-i;if(l)return"bottom";var d=cr(),m=d.bottom<a.bottom-i;return m?"bottom":"top";case HO.bottom:return"bottom";case HO.top:default:return"top"}},y=function(t){var n=r.get();ON.setModes(n,[t]),l.setDockingMode(t);var e=d()?Xl.TopToBottom:Xl.BottomToTop;qe(n.element,jd,e)},x=function(){var t=f.getOrThunk(function(){var t=aG(io(Ge(),"margin-left")).getOr(0);return _o(Ge())-So(n).left+t});eo(r.get().element,"max-width",t+"px")},w=function(){var t=fU.getToolbar(u),e=h(t),o=ur(n),i=d()?Math.max(o.y-po(r.get().element)+e,0):o.bottom;oo(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})},S=function(){i.broadcastOn([Tp()],{})},k=function(t){if(void 0===t&&(t=!1),v()){if(c||x(),g&&fU.refreshToolbar(u),c||w(),s){var n=r.get();t?ON.reset(n):ON.refresh(n)}S()}},C=function(t){if(void 0===t&&(t=!0),!c&&s&&v()){var n=l.getDockingMode(),e=b(r.get());e!==n&&(y(e),t&&k(!0))}},O=function(){p.set(!0),eo(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),fo(i.element,"display"),C(!1),k()},_=function(){p.set(!1),e.outerContainer&&(eo(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),eo(i.element,"display","none")};return{isVisible:v,isPositionedAtTop:d,show:O,hide:_,update:k,updateMode:C,repositionPopups:S}},pG=function(t,n){var e=ur(t);return{pos:n?e.y:e.bottom,bounds:e}},vG=function(t,n,e,o){var r=du(pG(n,e.isPositionedAtTop())),i=function(o){var i=pG(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&OT(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",function(){return e.update(!0)}),t.on("NodeChange keydown",function(t){DS.requestAnimationFrame(function(){return i(t)})}),t.on("ScrollWindow",function(){return e.updateMode()});var u=sd();u.set(gd(fn.fromDom(t.getBody()),"load",i)),t.on("remove",function(){u.clear()})},hG=function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=du(null),s=fn.fromDom(r.targetNode),f=gG(t,s,n,o,c),l=YO(t);kU(t);var d=function(){if(c.get())f.show();else{c.set(fU.getHeader(a).getOrDie());var r=JO(t);ep(r,i),ep(r,u),nG(t,n,e,o),fU.setMenubar(a,pU(t,e)),f.show(),vG(t,s,f,l),t.nodeChanged()}},m=function(){return DS.setEditorTimeout(t,d,0)};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",m),t.on("blur",f.hide)),t.on("init",function(){(t.hasFocus()||l)&&m()}),g_(t,n);var g={show:function(){f.show()},hide:function(){f.hide()},enable:function(){m_(n,!1)},disable:function(){m_(n,!0)},isDisabled:function(){return jh.isDisabled(a)}};return{editorContainer:a.element.dom,api:g}},bG=Object.freeze({__proto__:null,render:hG}),yG="contexttoolbar-show",xG="contexttoolbar-hide",wG=function(t){return{hide:function(){return Aa(t,ga())},getValue:function(){return av.getValue(t)}}},SG=function(t,n){return La(VI,function(e,o){var r=t.get(e),i=wG(r);n.onAction(i,o.event.buttonApi)})},kG=function(t,e,o){var r=e.original;r.primary;var i=n(r,["primary"]),u=Di(Mk(z(z({},i),{type:"button",onAction:T})));return zj(u,o.backstage.shared.providers,[SG(t,e)])},CG=function(t,e,o){var r=e.original;r.primary;var i=n(r,["primary"]),u=Di(Ik(z(z({},i),{type:"togglebutton",onAction:T})));return Lj(u,o.backstage.shared.providers,[SG(t,e)])},OG=function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?CG(t,n,o):kG(t,n,o)},_G=function(t,n,e){var o=tt(n,function(n){return MS(OG(t,n,e))}),r=function(){return tt(o,function(t){return t.asSpec()})},i=function(t){return St(n,function(n,e){return n.primary?j.from(o[e]).bind(function(n){return n.getOpt(t)}).filter(R(jh.isDisabled)):j.none()})};return{asSpecs:r,findPrimary:i}},TG=function(t,n){var e=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),o=MS(YD.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:xl([Px.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map(function(t){return Fa(t),!0})},onLeft:function(t,n){return n.cut(),j.none()},onRight:function(t,n){return n.cut(),j.none()}})])})),r=_G(o,t.commands,n);return[{title:j.none(),items:[o.asSpec()]},{title:j.none(),items:r.asSpecs()}]},EG=function(t,n,e){return tU({type:t,uid:mc("context-toolbar"),initGroups:TG(n,e),onEscape:j.none,cyclicKeying:!0,providers:e})},DG={renderContextForm:EG,buildInitGroups:TG},BG=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},AG=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=Fe(fn.fromDom(t.startContainer),t.startOffset).element,o=xn(e)?Oe(e):j.some(e);return o.filter(yn).map(function(t){return t.dom.getBoundingClientRect()}).getOr(n)}return n},MG=function(t){var n=t.selection.getRng(),e=AG(n);if(t.inline){var o=Xo();return ir(o.left+e.left,o.top+e.top,e.width,e.height)}var r=ar(fn.fromDom(t.getBody()));return ir(r.x+e.left,r.y+e.top,e.width,e.height)},FG=function(t,n){return n.filter(je).map(ar).getOrThunk(function(){return MG(t)})},RG=function(t,n,e){var o=Math.max(t.x+e,n.x),r=Math.min(t.right-e,n.right);return{x:o,width:r-o}},IG=function(t,n,e,o,r,i){var u=fn.fromDom(t.getContainer()),a=Gs(u,".tox-editor-header").getOr(u),c=ur(a),s=c.y>=n.bottom,f=o&&!s;if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var l="line"===r?ur(u):n;return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}},VG=function(t,n,e,o){void 0===o&&(o=0);var r=Jo(window),i=ur(fn.fromDom(t.getContentAreaContainer())),u=RO(t)||IO(t)||PO(t),a=RG(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return ir(c,r.y,s,r.height);var f=n.header.isPositionedAtTop(),l=IG(t,i,r,f,e,o),d=l.y,m=l.bottom;return ir(c,d,s,m-d)},PG=12,HG={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},zG={maxHeightFunction:Rd(),maxWidthFunction:CW()},NG=function(t,n){var e=t.selection.getRng(),o=Fe(fn.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&he(o.element,n)},LG=function(t,n,e){var o=ao(t,"position");eo(t,"position",n);var r=e(t);return o.each(function(n){return eo(t,"position",n)}),r},WG=function(t){return"node"===t},UG=function(t,n,e,o,r){var i=MG(t),u=o.lastElement().exists(function(t){return he(e,t)});if(NG(t,e))return u?_S:wS;if(u)return LG(n,o.getMode(),function(){var t=BG(i,ur(n));return t&&!o.isReposition()?ES:_S});var a="fixed"===o.getMode()?r.y+Xo().top:r.y,c=po(n)+PG;return a+c<=i.y?wS:SS},jG=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=UG(t,u,n,e,a),s=z(z({},o),{y:a.y,height:a.height});return z(z({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return WG(o)?[r(t)]:[]},u={onLtr:function(t){return[Zf,tl,$f,Kf,Qf,Jf].concat(i(t))},onRtl:function(t){return[Zf,tl,Qf,Jf,$f,Kf].concat(i(t))}},a={onLtr:function(t){return[tl,Kf,Jf,$f,Qf,Zf].concat(i(t))},onRtl:function(t){return[tl,Jf,Kf,Qf,$f,Zf].concat(i(t))}};return n?a:u},GG=function(t,n,e,o){return"line"===n?{bubble:zd(PG,0,HG),layouts:{onLtr:function(){return[nl]},onRtl:function(){return[el]}},overrides:zG}:{bubble:zd(0,PG,HG,1/PG),layouts:jG(t,e,o,n),overrides:zG}},XG=function(t,n){var e=rt(n,function(n){return n.predicate(t.dom)}),o=ot(e,function(t){return"contexttoolbar"===t.type}),r=o.pass,i=o.fail;return{contextToolbars:r,contextForms:i}},YG=function(t){if(t.length<=1)return t;var n=function(n){return $(t,function(t){return t.position===n})},e=function(n){return rt(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=tt(e("selection"),function(t){return z(z({},t),{position:"node"})});return i.concat(u)}return e(o?"selection":"node")}return e("line")},qG=function(t){if(t.length<=1)return t;var n=function(n){return ct(t,function(t){return t.position===n})},e=n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position});return e.fold(function(){return[]},function(n){return rt(t,function(t){return t.position===n})})},KG=function(t,n,e){var o=XG(t,n);if(o.contextForms.length>0)return j.some({elem:t,toolbars:[o.contextForms[0]]});var r=XG(t,e);if(r.contextForms.length>0)return j.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=YG(o.contextToolbars.concat(r.contextToolbars));return j.some({elem:t,toolbars:i})}return j.none()},JG=function(t,n,e){return t(n)?j.none():Eu(n,function(t){if(yn(t)){var n=XG(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:qG(o);return i.length>0?j.some({elem:t,toolbars:i}):j.none()}return j.none()},t)},$G=function(t,n){var e=fn.fromDom(n.getBody()),o=function(t){return he(t,e)},r=function(t){return!o(t)&&!xe(e,t)},i=fn.fromDom(n.selection.getNode());return r(i)?j.none():KG(i,t.inNodeScope,t.inEditorScope).orThunk(function(){return JG(o,i,t)})},QG=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=Di(Uk(a));e[t]=c,c.launch.map(function(e){i["form:"+t]=z(z({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})}),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){Gk(n).each(function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e})},s=kt(t);return nt(s,function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)}),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},ZG=mc("forward-slide"),tX=mc("backward-slide"),nX=mc("change-slide-event"),eX="tox-pop--resizing",oX=function(t){var n=du([]);return sS.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){n.set([]),sS.getContent(t).each(function(t){fo(t.element,"visibility")}),vs(t.element,eX),fo(t.element,"width")},inlineBehaviours:xl([Kx("context-toolbar-events",[Ja(na(),function(t,n){"width"===n.event.raw.propertyName&&(vs(t.element,eX),fo(t.element,"width"))}),La(nX,function(t,n){var e=t.element;fo(e,"width");var o=_o(e);sS.setContent(t,n.event.contents),gs(e,eX);var r=_o(e);eo(e,"width",o+"px"),sS.getContent(t).each(function(t){n.event.focus.bind(function(t){return Bl(t),Rl(e)}).orThunk(function(){return Px.focusIn(t),Fl(Pe(e))})}),DS.setTimeout(function(){eo(t.element,"width",r+"px")},0)}),La(ZG,function(t,e){sS.getContent(t).each(function(e){n.set(n.get().concat([{bar:e,focus:Fl(Pe(t.element))}]))}),Ma(t,nX,{contents:e.event.forwardContents,focus:j.none()})}),La(tX,function(t,e){xt(n.get()).each(function(e){n.set(n.get().slice(0,n.get().length-1)),Ma(t,nX,{contents:Ps(e.bar),focus:e.focus})})})]),Px.config({mode:"special",onEscape:function(e){return xt(n.get()).fold(function(){return t.onEscape()},function(t){return Aa(e,tX),j.some(!0)})}})]),lazySink:function(){return dr.value(t.sink)}})},rX="tox-pop--transition",iX=function(t,n,e,o){var r=o.backstage,i=r.shared,u=fe().deviceType.isTouch,a=ld(),c=ld(),s=ld(),f=Vs(oX({sink:e,onEscape:function(){return t.focus(),j.some(!0)}})),l=function(){var n=s.get().getOr("node"),e=WG(n)?1:0;return VG(t,i,n,e)},d=function(){return!(t.removed||u()&&r.isContextMenuOpen())},m=function(t){return Pt(Lt(t,a.get(),he),!0)},g=function(){if(d()){var n=l(),e=Pt(s.get(),"node")?FG(t,a.get()):MG(t);return n.height<=0||!BG(e,n)}return!0},p=function(){a.clear(),c.clear(),s.clear(),sS.hide(f)},v=function(){if(sS.isOpen(f)){var t=f.element;fo(t,"display"),g()?eo(t,"display","none"):(c.set(0),sS.reposition(f))}},h=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:xl([Px.config({mode:"acyclic"}),Kx("pop-dialog-wrap-events",[$a(function(n){t.shortcuts.add("ctrl+F9","focus statusbar",function(){return Px.focusIn(n)})}),Qa(function(n){t.shortcuts.remove("ctrl+F9")})])])}},b=kn(function(){return QG(n,function(t){var n=w([t]);Ma(f,ZG,{forwardContents:h(n)})})}),y=function(n,e){return tG(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,j.some(["form:"]))},x=function(t,n){return DG.buildInitGroups(t,n)},w=function(n){var e=t.ui.registry.getAll().buttons,o=b(),r=z(z({},e),o.formNavigators),u=zO(t)===qk.scrolling?qk.scrolling:qk.default,a=ft(tt(n,function(t){return"contexttoolbar"===t.type?y(r,t):x(t,i.providers)}));return tU({type:u,uid:mc("context-toolbar"),initGroups:a,onEscape:j.none,cyclicKeying:!0,providers:i.providers})},S=function(n,o){var r="node"===n?i.anchors.node(o):i.anchors.cursor(),s=GG(t,n,u(),{lastElement:a.get,isReposition:function(){return Pt(c.get(),0)},getMode:function(){return Gg.getMode(e)}});return Br(r,s)},k=function(t,n){if(C.cancel(),d()){var o=w(t),r=t[0].position,i=S(r,n);s.set(r),c.set(1);var u=f.element;fo(u,"display"),m(n)||(vs(u,rX),Gg.reset(e,f)),sS.showWithinBounds(f,h(o),{anchor:i,transition:{classes:[rX],mode:"placement"}},function(){return j.some(l())}),n.fold(a.clear,a.set),g()&&eo(u,"display","none")}},C=JS(function(){if(t.hasFocus()&&!t.removed)if(hs(f.element,rX))C.throttle();else{var n=b();$G(n,t).fold(p,function(t){k(t.toolbars,j.some(t.elem))})}},17);t.on("init",function(){t.on("remove",p),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",v),t.on("click keyup focus SetContent",C.throttle),t.on(xG,p),t.on(yG,function(n){var e=b();Rt(e.lookupTable,n.toolbarKey).each(function(e){k([e],jt(n.target!==t,n.target)),sS.getContent(f).each(Px.focusIn)})}),t.on("focusout",function(n){DS.setEditorTimeout(t,function(){Rl(e.element).isNone()&&Rl(f.element).isNone()&&p()},0)}),t.on("SwitchMode",function(){t.mode.isReadOnly()&&p()}),t.on("AfterProgressState",function(n){n.state?p():t.hasFocus()&&C.throttle()}),t.on("NodeChange",function(t){Rl(f.element).fold(C.throttle,T)})})},uX=function(t){var n=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];nt(n,function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:TU(t,n.cmd),onSetup:CU(t,n.name)})}),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:TU(t,"JustifyNone")})},aX={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},cX=(FU="[0-9]+",RU="[+-]?"+FU,IU="[eE]"+RU,VU="\\.",PU=function(t){return"(?:"+t+")?"},HU=["Infinity",FU+VU+PU(FU)+PU(IU),VU+FU+PU(IU),FU+PU(IU)].join("|"),zU="[+-]?(?:"+HU+")",new RegExp("^("+zU+")(.*)$")),sX=function(t,n){return $(n,function(n){return $(aX[n],function(n){return t===n})})},fX=function(t,n){var e=j.from(cX.exec(t));return e.bind(function(t){var e=Number(t[1]),o=t[2];return sX(o,n)?j.some({value:e,unit:o}):j.none()})},lX=function(t,n){return fX(t,n).map(function(t){var n=t.value,e=t.unit;return n+e})},dX=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=ld();return tt(e,function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on(function(t){return t.setActive(!1)}),r.set(i)),i.setActive(t)};u(Pt(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}})};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},mX={name:"lineheight",text:"Line height",icon:"line-height",getOptions:AO,hash:function(t){return lX(t,["fixed","relative","empty"]).getOr(t)},display:M,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return j.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},gX=function(t){var n=j.from(MO(t));return n.map(function(n){return{name:"language",text:"Language",icon:"language",getOptions:A(n),hash:function(t){return w(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=fn.fromDom(t.selection.getNode());return Du(n,function(t){return j.some(t).filter(yn).bind(function(t){var n=$e(t,"lang");return n.map(function(n){var e=$e(t,"data-mce-lang").getOrUndefined();return{code:n,customCode:e,title:""}})})})},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=sd();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}})},pX=function(t){dX(t,mX),gX(t).each(function(n){return dX(t,n)})},vX=function(t,n){XU(t,n),ZU(t,n),vj(t,n),mj(t,n),cj(t,n)},hX=function(t){return OU(t,"NodeChange",function(n){n.setDisabled(!t.queryCommandState("outdent"))})},bX=function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:hX(t),onAction:TU(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:TU(t,"indent")})},yX=function(t){bX(t)},xX=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},wX=function(t){rR.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:CU(t,n.name),onAction:xX(t,n.name)})});for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:CU(t,e),onAction:xX(t,e)})}},SX=function(t){rR.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:TU(t,n.action)})})},kX=function(t){rR.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:TU(t,n.action),onSetup:CU(t,n.name)})})},CX=function(t){wX(t),SX(t),kX(t)},OX=function(t){rR.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:TU(t,n.action)})}),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:xX(t,"code")})},_X=function(t){CX(t),OX(t)},TX=function(t,n){return OU(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoReceptionist[n]())})},EX=function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:TX(t,"hasUndo"),onAction:TU(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:TX(t,"hasRedo"),onAction:TU(t,"redo")})},DX=function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:TX(t,"hasUndo"),onAction:TU(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:TX(t,"hasRedo"),onAction:TU(t,"redo")})},BX=function(t){EX(t),DX(t)},AX=function(t){return OU(t,"VisualAid",function(n){n.setActive(t.hasVisual)})},MX=function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:AX(t),onAction:TU(t,"mceToggleVisualAid")})},FX=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:TU(t,"mceToggleVisualAid")})},RX=function(t){FX(t),MX(t)},IX=function(t,n){uX(t),_X(t),vX(t,n),BX(t),uE(t),RX(t),yX(t),pX(t)},VX=function(t,n){return{type:"makeshift",x:t,y:n}},PX=function(t,n,e){return VX(t.x+n,t.y+e)},HX=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},zX=function(t){if(HX(t)){var n=t.touches[0];return VX(n.pageX,n.pageY)}return VX(t.pageX,t.pageY)},NX=function(t){if(HX(t)){var n=t.touches[0];return VX(n.clientX,n.clientY)}return VX(t.clientX,t.clientY)},LX=function(t,n){var e=bO.DOM.getPos(t);return PX(n,e.x,e.y)},WX=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?zX(n):LX(t.getContentAreaContainer(),NX(n)):UX(t)},UX=function(t){return{type:"selection",root:fn.fromDom(t.selection.getNode())}},jX=function(t){return{type:"node",node:j.some(fn.fromDom(t.selection.getNode())),root:fn.fromDom(t.getBody())}},GX=function(t,n,e){switch(e){case"node":return jX(t);case"point":return WX(t,n);case"selection":return UX(t)}},XX=function(t,n,e,o,r,i){var u=e(),a=GX(t,n,i);$I(u,Kk.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),sS.showMenuAt(r,{anchor:a},{menu:{markers:yC("normal")},data:t})})},YX={onLtr:function(){return[tl,Kf,Jf,$f,Qf,Zf,wS,SS,xS,bS,yS,hS]},onRtl:function(){return[tl,Jf,Kf,Qf,$f,Zf,wS,SS,yS,hS,xS,bS]}},qX=12,KX={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},JX=function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng(),i=sg(t.getWin(),Am.domRange(r));return i.exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})},$X=function(t){var n=t.selection.getRng(),e=function(){DS.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}},QX=function(t,n,e){var o=GX(t,n,e),r="point"===e?qX:0;return z({bubble:zd(0,r,KX),layouts:YX,overrides:{maxWidthFunction:CW(),maxHeightFunction:Rd()}},o)},ZX=function(t,n,e,o,r,i,u){var a=QX(t,n,i);$I(e,Kk.CLOSE_ON_EXECUTE,o,!0).map(function(e){n.preventDefault(),sS.showMenuWithinBounds(r,{anchor:a},{menu:{markers:yC("normal"),highlightImmediately:u},data:e,type:"horizontal"},function(){return j.some(VG(t,o.shared,"node"===i?"node":"selection"))}),t.fire(xG)})},tY=function(t,n,e,o,r,i){var u=fe(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){return!(s||a||c&&f)},d=function(){var u=e();ZX(t,n,u,o,r,i,l())};if((c||a)&&"node"!==i){var m=function(){$X(t),d()};JX(t,n)?m():(t.once("selectionchange",m),t.once("touchend",function(){return t.off("selectionchange",m)}))}else d()},nY=function(t){return"string"==typeof t?t.split(/[ ,]/):t},eY=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},oY=function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return j.from(t.getParam(n)).map(nY).getOrThunk(function(){return rt(nY(e),function(t){return It(o,t)})})},rY=function(t){return!1===t.getParam("contextmenu")},iY=function(t){return oY(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},uY=function(t){return t.getParam("contextmenu_avoid_overlap","","string")},aY=function(t){return v(t)?"|"===t:"separator"===t.type},cY={type:"separator"},sY=function(t){var n=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(v(t))return t;switch(t.type){case"separator":return cY;case"submenu":return z(z({type:"nestedmenuitem"},n(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return v(n)?n:tt(n,sY)}});default:return z(z({type:"menuitem"},n(t)),{onAction:E(t.onAction)})}},fY=function(t,n){if(0===n.length)return t;var e=xt(t).filter(function(t){return!aY(t)}),o=e.fold(function(){return[]},function(t){return[cY]});return t.concat(o).concat(n).concat([cY])},lY=function(t,n,e){var o=ut(n,function(n,o){return Rt(t,o.toLowerCase()).map(function(t){var o=t.update(e);if(v(o))return fY(n,o.split(" "));if(o.length>0){var r=tt(o,sY);return fY(n,r)}return n}).getOrThunk(function(){return n.concat([o])})},[]);return o.length>0&&aY(o[o.length-1])&&o.pop(),o},dY=function(t,n){return n.ctrlKey&&!eY(t)},mY=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},gY=function(t,n){return mY(t,n)?t.selection.getStart(!0):n.target},pY=function(t,n){var e=uY(t),o=mY(t,n)?"selection":"point";if(nn(e)){var r=gY(t,n),i=LE(fn.fromDom(r),e);return i?"node":o}return o},vY=function(t,n,e){var o=fe(),r=o.deviceType.isTouch,i=Vs(sS.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:xl([Kx("dismissContextMenu",[La(ka(),function(n,e){Op.close(n),t.focus()})])])})),u=function(t){return sS.hide(i)},a=function(n){if(eY(t)&&n.preventDefault(),!dY(t,n)&&!rY(t)){var o=pY(t,n),u=function(){var e=gY(t,n),o=t.ui.registry.getAll(),r=iY(t);return lY(o.contextMenus,r,e)},a=r()?tY:XX;a(t,n,u,e,i,o)}};t.on("init",function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");t.on(n,u),t.on("longpress contextmenu",a)})},hY=gu.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),bY=function(t){return function(n){return n.translate(-t.left,-t.top)}},yY=function(t){return function(n){return n.translate(t.left,t.top)}},xY=function(t){return function(n,e){return ut(t,function(t,n){return n(t)},yo(n,e))}},wY=function(t,n,e){return t.fold(xY([yY(e),bY(n)]),xY([bY(n)]),xY([]))},SY=function(t,n,e){return t.fold(xY([yY(e)]),xY([]),xY([yY(n)]))},kY=function(t,n,e){return t.fold(xY([]),xY([bY(e)]),xY([yY(n),bY(e)]))},CY=function(t,n,e,o,r,i){var u=SY(t,r,i),a=SY(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o},OY=function(t,n,e,o,r,i){
var u=SY(t,r,i),a=SY(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return yo(c,s)},_Y=function(t,n,e){var o=t.fold(function(t,n){return{position:j.some("absolute"),left:j.some(t+"px"),top:j.some(n+"px")}},function(t,n){return{position:j.some("absolute"),left:j.some(t-e.left+"px"),top:j.some(n-e.top+"px")}},function(t,n){return{position:j.some("fixed"),left:j.some(t+"px"),top:j.some(n+"px")}});return z({right:j.none(),bottom:j.none()},o)},TY=function(t,n,e){return t.fold(function(t,o){return DY(t+n,o+e)},function(t,o){return BY(t+n,o+e)},function(t,o){return AY(t+n,o+e)})},EY=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(kY,DY),r(SY,BY),r(wY,AY))},DY=hY.offset,BY=hY.absolute,AY=hY.fixed,MY=function(t,n){var e=Je(t,n);return w(e)?NaN:parseInt(e,10)},FY=function(t,n){var e=t.element,o=MY(e,n.leftAttr),r=MY(e,n.topAttr);return isNaN(o)||isNaN(r)?j.none():j.some(yo(o,r))},RY=function(t,n,e){var o=t.element;qe(o,n.leftAttr,e.left+"px"),qe(o,n.topAttr,e.top+"px")},IY=function(t,n){var e=t.element;Ze(e,n.leftAttr),Ze(e,n.topAttr)},VY=function(t,n,e,o){return FY(t,n).fold(function(){return e},function(t){return AY(t.left+o.left,t.top+o.top)})},PY=function(t,n,e,o,r,i){var u=VY(t,n,e,o),a=n.mustSnap?NY(t,n,u,r,i):LY(t,n,u,r,i),c=wY(u,r,i);return RY(t,n,c),a.fold(function(){return{coord:AY(c.left,c.top),extra:j.none()}},function(t){return{coord:t.output,extra:t.extra}})},HY=function(t,n){IY(t,n)},zY=function(t,n,e,o){return St(t,function(t){var r=t.sensor,i=CY(n,r,t.range.left,t.range.top,e,o);return i?j.some({output:EY(t.output,n,e,o),extra:t.extra}):j.none()})},NY=function(t,n,e,o,r){var i=n.getSnapPoints(t),u=zY(i,e,o,r);return u.orThunk(function(){var t=ut(i,function(t,n){var i=n.sensor,u=OY(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold(function(){return{deltas:j.some(u),snap:j.some(n)}},function(e){var o=(u.left+u.top)/2,r=(e.left+e.top)/2;return o<=r?{deltas:j.some(u),snap:j.some(n)}:t})},{deltas:j.none(),snap:j.none()});return t.snap.map(function(t){return{output:EY(t.output,e,o,r),extra:t.extra}})})},LY=function(t,n,e,o,r){var i=n.getSnapPoints(t);return zY(i,e,o,r)},WY=function(t,n,e){return{coord:EY(t.output,t.output,n,e),extra:t.extra}},UY=function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=we(t.element),u=Xo(i),a=qz(r),c=WY(o,u,a),s=_Y(c.coord,u,a);ro(r,s)}},jY=Object.freeze({__proto__:null,snapTo:UY}),GY="data-initial-z-index",XY=function(t){Oe(t.element).filter(yn).each(function(t){$e(t,GY).fold(function(){return fo(t,"z-index")},function(n){return eo(t,"z-index",n)}),Ze(t,GY)})},YY=function(t){Oe(t.element).filter(yn).each(function(n){ao(n,"z-index").each(function(t){qe(n,GY,t)}),eo(n,"z-index",io(t.element,"z-index"))})},qY=function(t,n){t.getSystem().addToGui(n),YY(n)},KY=function(t){XY(t),t.getSystem().removeFromGui(t)},JY=function(t,n,e){return t.getSystem().build(gD.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},$Y=tu("snaps",[Pi("getSnapPoints"),pf("onSensor"),Pi("leftAttr"),Pi("topAttr"),eu("lazyViewport",cr),eu("mustSnap",!1)]),QY=[eu("useFixed",V),Pi("blockerClass"),eu("getTarget",M),eu("onDrag",T),eu("repositionTarget",!0),eu("onDrop",T),cu("getBounds",cr),$Y],ZY=function(t){return Wt(ao(t,"left"),ao(t,"top"),ao(t,"position"),function(t,n,e){var o="fixed"===e?AY:DY;return o(parseInt(t,10),parseInt(n,10))}).getOrThunk(function(){var n=So(t);return BY(n.left,n.top)})},tq=function(t,n,e,o,r){var i=r.bounds,u=SY(n,e,o),a=Vf(u.left,i.x,i.x+i.width-r.width),c=Vf(u.top,i.y,i.y+i.height-r.height),s=BY(a,c);return n.fold(function(){var t=kY(s,e,o);return DY(t.left,t.top)},A(s),function(){var t=wY(s,e,o);return AY(t.left,t.top)})},nq=function(t,n,e,o,r,i,u){var a=n.fold(function(){var t=TY(e,i.left,i.top),n=wY(t,o,r);return AY(n.left,n.top)},function(n){var u=PY(t,n,e,i,o,r);return u.extra.each(function(e){n.onSensor(t,e)}),u.coord});return tq(t,a,o,r,u)},eq=function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=we(t.element),u=Xo(i),a=qz(r),c=ZY(r),s=nq(t,n.snaps,c,u,a,o,e),f=_Y(s,u,a);ro(r,f)}n.onDrag(t,r,o)},oq=function(t,n){return{bounds:t.getBounds(),height:vo(n.element),width:To(n.element)}},rq=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk(function(){return oq(n,t)});i.each(function(e){eq(t,n,u,e)})},iq=function(t,n,e,o){n.each(KY),e.snaps.each(function(n){HY(t,n)});var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},uq=function(t){return function(n,o){var r=function(t){o.setStartData(oq(n,t))};return Pa(e([La(ya(),function(t){o.getStartData().each(function(){return r(t)})})],t(n,o,r),!0))}},aq=function(t){return Pa([La(Wu(),t.forceDrop),La(Gu(),t.drop),La(Uu(),function(n,e){t.move(e.event)}),La(ju(),t.delayDrop)])},cq=function(t){return j.from(yo(t.x,t.y))},sq=function(t,n){return yo(n.left-t.left,n.top-t.top)},fq=Object.freeze({__proto__:null,getData:cq,getDelta:sq}),lq=function(t,n,e){return[La(Wu(),function(o,r){var i=r.event.raw;if(0===i.button){r.stop();var u=function(){return iq(o,j.some(s),t,n)},a=WE(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),rq(o,t,n,fq,e)}},s=JY(o,t.blockerClass,aq(c)),f=function(){e(o),qY(o,s)};f()}})]},dq=e(e([],QY,!0),[yf("dragger",{handlers:uq(lq)})],!1),mq=function(t){return Pa([La(Hu(),t.forceDrop),La(Nu(),t.drop),La(Lu(),t.drop),La(zu(),function(n,e){t.move(e.event)})])},gq=function(t){var n=t[0];return j.some(yo(n.clientX,n.clientY))},pq=function(t){var n=t.raw,e=n.touches;return 1===e.length?gq(e):j.none()},vq=function(t,n){return yo(n.left-t.left,n.top-t.top)},hq=Object.freeze({__proto__:null,getData:pq,getDelta:vq}),bq=function(t,n,e){var o=ld(),r=function(e){iq(e,o.get(),t,n),o.clear()};return[La(Hu(),function(i,u){u.stop();var a=function(){return r(i)},c={drop:a,delayDrop:T,forceDrop:a,move:function(e){rq(i,t,n,hq,e)}},s=JY(i,t.blockerClass,mq(c));o.set(s);var f=function(){e(i),qY(i,s)};f()}),La(zu(),function(e,o){o.stop(),rq(e,t,n,hq,o.event)}),La(Nu(),function(t,n){n.stop(),r(t)}),La(Lu(),r)]},yq=e(e([],QY,!0),[yf("dragger",{handlers:uq(bq)})],!1),xq=function(t,n,o){return e(e([],lq(t,n,o),!0),bq(t,n,o),!0)},wq=e(e([],QY,!0),[yf("dragger",{handlers:uq(xq)})],!1),Sq=dq,kq=yq,Cq=wq,Oq=Object.freeze({__proto__:null,mouse:Sq,touch:kq,mouseOrTouch:Cq}),_q=function(){var t=j.none(),n=j.none(),e=function(){t=j.none(),n=j.none()},o=function(n,e){var o=t.map(function(t){return n.getDelta(t,e)});return t=j.some(e),o},r=function(t,n){return t.getData(n).bind(function(n){return o(t,n)})},i=function(t){n=j.some(t)},u=function(){return n},a=A({});return Rc({readState:a,reset:e,update:r,getStartData:u,setStartData:i})},Tq=Object.freeze({__proto__:null,init:_q}),Eq=Cl({branchKey:"mode",branches:Oq,name:"dragging",active:{events:function(t,n){var e=t.dragger;return e.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:j.from(t.extra)}}},state:Tq,apis:jY}),Dq=40,Bq=Dq/2,Aq=function(t,n,e,o,r,i){return t.fold(function(){return Eq.snap({sensor:BY(e-Bq,o-Bq),range:yo(r,i),output:BY(j.some(e),j.some(o)),extra:{td:n}})},function(t){var r=e-Bq,i=o-Bq,u=Dq,a=Dq,c=t.element.dom.getBoundingClientRect();return Eq.snap({sensor:BY(r,i),range:yo(u,a),output:BY(j.some(e-c.width/2),j.some(o-c.height/2)),extra:{td:n}})})},Mq=function(t,n,e){var o=function(t,n){return t.exists(function(t){return he(t,n)})};return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,r){var i=r.td;o(n.get(),i)||(n.set(i),e(i))},mustSnap:!0}},Fq=function(t){return MS(AS.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:xl([Eq.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),YB.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},Rq=function(t,n){var e=du([]),o=du([]),r=du(!1),i=ld(),u=ld(),a=function(t){var e=ar(t);return Aq(m.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(){return tt(e.get(),function(t){return a(t)})},s=function(t){var e=ar(t);return Aq(g.getOpt(n),t,e.right,e.bottom,e.width,e.height)},f=function(){return tt(o.get(),function(t){return s(t)})},l=Mq(c,i,function(n){u.get().each(function(e){t.fire("TableSelectorChange",{start:n,finish:e})})}),d=Mq(f,u,function(n){i.get().each(function(e){t.fire("TableSelectorChange",{start:e,finish:n})})}),m=Fq(l),g=Fq(d),p=Vs(m.asSpec()),v=Vs(g.asSpec()),h=function(n,e,o,r){var i=e.dom.getBoundingClientRect();fo(n.element,"display");var u=Ce(fn.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&eo(n.element,"display","none")},b=function(t,n,e,o){var r=e(n);Eq.snapTo(t,r);var i=function(t){return t[o]<0},u=function(t,n){return t[o]>n};h(t,n,i,u)},y=function(t){return b(p,t,a,"top")},x=function(){return i.get().each(y)},w=function(t){return b(v,t,s,"bottom")},S=function(){return u.get().each(w)};fe().deviceType.isTouch()&&(t.on("TableSelectionChange",function(t){r.get()||($g(n,p),$g(n,v),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each(function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),y(t.start),w(t.finish)})}),t.on("ResizeEditor ResizeWindow ScrollContent",function(){x(),S()}),t.on("TableSelectionClear",function(){r.get()&&(tp(p),tp(v),r.set(!1)),i.clear(),u.clear()}))},Iq=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},Vq=function(t,n,e){n.delimiter||(n.delimiter="");var o=function(o){var r=o||[],i=tt(r,function(n,o){return AS.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:xl([x_.button(e.isDisabled),p_()])})}),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}};return ut(i.slice(1),function(t,n){var e=t;return e.push(u),e.push(n),e},[i[0]])},r=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!Iq(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:xl([Px.config({mode:"flow",selector:"div[role=button]"}),jh.config({disabled:e.isDisabled}),p_(),CD.config({}),Yx.config({}),Kx("elementPathEvents",[$a(function(n,e){t.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return Px.focusIn(n)}),t.on("NodeChange",function(t){var e=r(t.parents);e.length>0?Yx.set(n,o(e)):Yx.set(n,[])})})])]),components:[]}};(function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"})(NU||(NU={}));var Pq=function(t,n,e,o,r){var i={};return i.height=sG(o+n.top,_O(t),EO(t)),e===NU.Both&&(i.width=sG(r+n.left,OO(t),TO(t))),i},Hq=function(t,n,e){var o=fn.fromDom(t.getContainer()),r=Pq(t,n,e,po(o),_o(o));Ot(r,function(t,n){return eo(o,n,cG(t))}),CT(t)},zq=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?NU.None:"both"===e?NU.Both:NU.Vertical},Nq=function(t,n,e,o){var r=20,i=yo(e*r,o*r);return Hq(t,i,n),j.some(!0)},Lq=function(t,n){var e=zq(t);return e===NU.None?j.none():j.some(jS("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[Eq.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return Hq(t,r,e)},blockerClass:"tox-blocker"}),Px.config({mode:"special",onLeft:function(){return Nq(t,e,-1,0)},onRight:function(){return Nq(t,e,1,0)},onUp:function(){return Nq(t,e,0,-1)},onDown:function(){return Nq(t,e,0,1)}}),CD.config({}),rw.config({})]},n.icons))},Wq=function(t,n){var e,o=function(t,e,o){return Yx.set(t,[Ms(n.translate(["{0} "+o,e[o]]))])};return AS.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:xl([x_.button(n.isDisabled),p_(),CD.config({}),Yx.config({}),av.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Kx("wordcount-events",[tc(function(t){var n=av.getValue(t),e="words"===n.mode?"characters":"words";av.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)}),$a(function(n){t.on("wordCountUpdate",function(t){var e=av.getValue(n).mode;av.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)})})])]),eventOrder:(e={},e[fa()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})},Uq=function(t,n){var e=function(){var t=FS.translate(["Powered by {0}","Tiny"]),n='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+t+'">'+t+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:n}}},o=function(){var o=[];return t.getParam("elementpath",!0,"boolean")&&o.push(Vq(t,{},n)),t.hasPlugin("wordcount")&&o.push(Wq(t,n)),t.getParam("branding",!0,"boolean")&&o.push(e()),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]},r=function(){var e=o(),r=Lq(t,n);return e.concat(r.toArray())};return{dom:{tag:"div",classes:["tox-statusbar"]},components:r()}},jq=function(t){var n,e=t.inline,o=e?bG:uG,r=QO(t)?LN:Xz,i=j.none(),u=fe(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),f="tox-platform-touch",l=s?[f]:[],d=jO(t),m=JO(t),g=FS.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:(n={},n[jd]=d?Xl.BottomToTop:Xl.TopToBottom,n)},v=function(){return i.bind(fU.getHeader)},h=function(){return r.isDocked(v)},b=function(){eo(Q.element,"width",document.body.clientWidth+"px")},y=function(){var t=he(Ge(),m)&&"grid"===io(m,"display"),n={dom:z({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(l)},g),behaviours:xl([Gg.config({useFixed:function(){return h()}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:Pa([La(xa(),b)])};return Br(n,t?e:{})},x=Vs(y()),w=function(){return dr.value(x)},S=MS({dom:{tag:"div",classes:["tox-anchorbar"]}}),k=function(){return i.bind(function(t){return S.getOpt(t)}).getOrDie("Could not find a anchor bar element")},C=function(){return i.bind(function(t){return fU.getToolbar(t)}).getOrDie("Could not find more toolbar element")},O=function(){return i.bind(function(t){return fU.getThrobber(t)}).getOrDie("Could not find throbber element")},_=Tz(x,t,k),E=fU.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:_,onEscape:function(){t.focus()}}),D=zO(t),B=fU.parts.toolbar(z({dom:{tag:"div",classes:["tox-toolbar"]},getSink:w,providers:_.shared.providers,onEscape:function(){t.focus()},type:D,lazyToolbar:C,lazyHeader:function(){return v().getOrDie("Could not find header element")}},p)),A=fU.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:_.shared.providers,onEscape:function(){t.focus()},type:D}),M=fU.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),F=fU.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),R=fU.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:_}),I=t.getParam("statusbar",!0,"boolean"),V=I&&!e?j.some(Uq(t,_.shared.providers)):j.none(),P={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[M,F]},H=PO(t),N=IO(t),L=RO(t),W=function(){return H?[A]:N?[B]:[]},U=fU.parts.header({dom:z({tag:"div",classes:["tox-editor-header"]},p),components:ft([L?[E]:[],W(),KO(t)?[]:[S.asSpec()]]),sticky:QO(t),editor:t,sharedBackstage:_.shared}),G=ft([d?[]:[U],e?[]:[P],d?[U]:[]]),X={dom:{tag:"div",classes:["tox-editor-container"]},components:G},Y=ft([[X],e?[]:V.toArray(),[R]]),q=$O(t),K=z(z({role:"application"},FS.isRtl()?{dir:"rtl"}:{}),q?{"aria-hidden":"true"}:{}),J=Vs(fU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(c),styles:z({visibility:"hidden"},q?{opacity:"0",border:"0"}:{}),attributes:K},components:Y,behaviours:xl([p_(),jh.config({disableClass:"tox-tinymce--disabled"}),Px.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));i=j.some(J),t.shortcuts.add("alt+F9","focus menubar",function(){fU.focusMenubar(J)}),t.shortcuts.add("alt+F10","focus toolbar",function(){fU.focusToolbar(J)}),t.addCommand("ToggleToolbarDrawer",function(){fU.toggleToolbarDrawer(J)}),t.addQueryStateHandler("ToggleToolbarDrawer",function(){return fU.isToolbarDrawerToggled(J)});var $=pD(J),Q=pD(x);Ez(t,$,Q);var Z=function(){var t={broadcastAll:Q.broadcast,broadcastOn:Q.broadcastOn,register:T};return{channels:t}},tt=function(){var n=cG(lG(t)),e=cG(mG(t));return t.inline||(so("div","width",e)&&eo(J.element,"width",e),so("div","height",n)?eo(J.element,"height",n):eo(J.element,"height","200px")),n},nt=function(){r.setup(t,_.shared,v),IX(t,_),vY(t,w,_),IL(t),cW(t,O,_.shared),_t(WO(t),function(n,e){t.ui.registry.addGroupToolbarButton(e,n)});var n=t.ui.registry.getAll(),e=n.buttons,i=n.menuItems,u=n.contextToolbars,a=n.sidebars,c=VO(t),s={menuItems:i,menus:n_(t),menubar:e_(t),toolbar:c.getOrThunk(function(){return o_(t)}),allowToolbarGroups:D===qk.floating,buttons:e,sidebar:a};iX(t,u,x,{backstage:_}),Rq(t,x);var f=t.getElement(),l=tt(),d={mothership:$,uiMothership:Q,outerContainer:J},m={targetNode:f,height:l};return o.render(t,d,s,_,m)};return{mothership:$,uiMothership:Q,backstage:_,renderUI:nt,getUi:Z}},Gq=function(t,n){var e=j.from(Je(t,"id")).fold(function(){var t=mc("dialog-describe");return qe(n,"id",t),t},M);qe(t,"aria-describedby",e)},Xq=function(t,n){var e=$e(t,"id").fold(function(){var t=mc("dialog-label");return qe(n,"id",t),t},M);qe(t,"aria-labelledby",e)},Yq=A([Pi("lazySink"),qi("dragBlockClass"),cu("getBounds",cr),eu("useTabstopAt",P),eu("eventOrder",{}),cv("modalBehaviours",[Px]),vf("onExecute"),bf("onEscape")]),qq={sketch:M},Kq=A([Wv({name:"draghandle",overrides:function(t,n){return{behaviours:xl([Eq.config({mode:"mouse",getTarget:function(t){return Us(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Nv({schema:[Pi("dom")],name:"title"}),Nv({factory:qq,schema:[Pi("dom")],name:"close"}),Nv({factory:qq,schema:[Pi("dom")],name:"body"}),Wv({factory:qq,schema:[Pi("dom")],name:"footer"}),Lv({factory:{sketch:function(t,n){return z(z({},t),{dom:n.dom,components:n.components})}},schema:[eu("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),eu("components",[])],name:"blocker"})]),Jq=function(t,n,e,o){var r,i=ld(),u=function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(z(z({},r),{components:r.components.concat([Ps(n)]),behaviours:xl([rw.config({}),Kx("dialog-blocker-events",[Ja(Yu(),function(){Px.focusIn(n)})])])}));$g(e,u),Px.focusIn(n)},a=function(t){i.clear(),Oe(t.element).each(function(n){t.getSystem().getByDom(n).each(function(t){tp(t)})})},c=function(n){return eh(n,t,"body")},s=function(n){return eh(n,t,"footer")},f=function(t,n){$L.block(t,n)},l=function(t){$L.unblock(t)},d=mc("modal-events"),m=z(z({},t.eventOrder),(r={},r[wa()]=[d].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:u,hide:a,getBody:c,getFooter:s,setIdle:l,setBusy:f},eventOrder:m,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:fv(t.modalBehaviours,[Yx.config({}),Px.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),$L.config({getRoot:i.get}),Kx(d,[$a(function(n){Xq(n.element,eh(n,t,"title").element),Gq(n.element,eh(n,t,"body").element)})])])}},$q=xh({name:"ModalDialog",configFields:Yq(),partFields:Kq(),factory:Jq,apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),Qq=ci([Ni("type"),Ni("name")].concat(zC)),Zq=bi,tK=[Ri("name","name",Fr(function(){return mc("button-name")}),hi),$i("icon"),uu("align","end",["start","end"]),au("primary",!1),au("disabled",!1)],nK=e(e([],tK,!0),[Ni("text")],!1),eK=e([Li("type",["submit","cancel","custom"])],nK,!0),oK=e([Li("type",["menu"]),$i("text"),$i("tooltip"),$i("icon"),Yi("items",Qq)],tK,!0),rK=Mi("type",{submit:eK,cancel:eK,custom:eK,menu:oK}),iK=[Ni("type"),Ni("text"),Li("level",["info","warn","error","success"]),Ni("icon"),eu("url","")],uK=ci(iK),aK=function(t){return[Ni("type"),t]},cK=[Ni("type"),Ni("text"),au("disabled",!1),au("primary",!1),Ri("name","name",Fr(function(){return mc("button-name")}),hi),$i("icon"),au("borderless",!1)],sK=ci(cK),fK=[Ni("type"),Ni("name"),Ni("label"),au("disabled",!1)],lK=ci(fK),dK=bi,mK=[Ni("type"),Ni("name")],gK=mK.concat([$i("label")]),pK=gK.concat([eu("columns","auto")]),vK=ci(pK),hK=mi([Ni("value"),Ni("text"),Ni("icon")]),bK=gK,yK=ci(bK),xK=hi,wK=gK,SK=ci(wK),kK=hi,CK=mK.concat([iu("tag","textarea"),Ni("scriptId"),Ni("scriptUrl"),su("settings",void 0)]),OK=mK.concat([iu("tag","textarea"),Ui("init")]),_K=Oi(function(t){return Ei("customeditor.old",ai(OK),t).orThunk(function(){return Ei("customeditor.new",ai(CK),t)})}),TK=hi,EK=gK,DK=ci(EK),BK=Ci(),AK=function(t){return[Ni("type"),zi("columns"),t]},MK=[Ni("type"),Ni("html"),uu("presets","presentation",["presentation","document"])],FK=ci(MK),RK=gK.concat([au("sandboxed",!0)]),IK=ci(RK),VK=hi,PK=gK.concat([Hi("currentState",ci([Pi("blob"),Ni("url")]))]),HK=ci(PK),zK=gK.concat([$i("inputMode"),$i("placeholder"),au("maximized",!1),au("disabled",!1)]),NK=ci(zK),LK=hi,WK=function(t){return[Ni("type"),Ni("label"),t]},UK=[Ni("text"),Ni("value")],jK=[Ni("text"),Yi("items",Fi("items",function(){return GK}))],GK=fi([ci(UK),ci(jK)]),XK=gK.concat([Yi("items",GK),au("disabled",!1)]),YK=ci(XK),qK=hi,KK=gK.concat([Xi("items",[Ni("text"),Ni("value")]),ru("size",1),au("disabled",!1)]),JK=ci(KK),$K=hi,QK=gK.concat([au("constrain",!0),au("disabled",!1)]),ZK=ci(QK),tJ=ci([Ni("width"),Ni("height")]),nJ=[Ni("type"),Yi("header",hi),Yi("cells",si(hi))],eJ=ci(nJ),oJ=gK.concat([$i("placeholder"),au("maximized",!1),au("disabled",!1)]),rJ=ci(oJ),iJ=hi,uJ=gK.concat([uu("filetype","file",["image","media","file"]),eu("disabled",!1)]),aJ=ci(uJ),cJ=ci([Ni("value"),eu("meta",{})]),sJ=function(t){return Ri("items","items",Mr(),si(Oi(function(n){return Ei("Checking item of "+t,fJ,n).fold(function(t){return dr.error(Ai(t))},function(t){return dr.value(t)})})))},fJ=ii(function(){return ki("type",{alertbanner:uK,bar:ci(aK(sJ("bar"))),button:sK,checkbox:lK,colorinput:yK,colorpicker:SK,dropzone:DK,grid:ci(AK(sJ("grid"))),iframe:IK,input:NK,listbox:YK,selectbox:JK,sizeinput:ZK,textarea:rJ,urlinput:aJ,customeditor:_K,htmlpanel:FK,imagetools:HK,collection:vK,label:ci(WK(sJ("label"))),table:eJ,panel:dJ})}),lJ=[Ni("type"),eu("classes",[]),Yi("items",fJ)],dJ=ci(lJ),mJ=[Ri("name","name",Fr(function(){return mc("tab-name")}),hi),Ni("title"),Yi("items",fJ)],gJ=[Ni("type"),Xi("tabs",mJ)],pJ=ci(gJ),vJ=nK,hJ=rK,bJ=ci([Ni("title"),Hi("body",ki("type",{panel:dJ,tabpanel:pJ})),iu("size","normal"),Yi("buttons",hJ),eu("initialData",{}),cu("onAction",T),cu("onChange",T),cu("onSubmit",T),cu("onClose",T),cu("onCancel",T),eu("onTabChange",T)]),yJ=function(t){return Ei("dialog",bJ,t)},xJ=ci(e([Li("type",["cancel","custom"])],vJ,!0)),wJ=ci([Ni("title"),Ni("url"),Ji("height"),Ji("width"),Zi("buttons",xJ),cu("onAction",T),cu("onCancel",T),cu("onClose",T),cu("onMessage",T)]),SJ=function(t){return Ei("dialog",wJ,t)},kJ=function(t){return h(t)?[t].concat(lt(Ft(t),kJ)):b(t)?lt(t,kJ):[]},CJ=function(t){return v(t.type)&&v(t.name)},OJ={checkbox:dK,colorinput:xK,colorpicker:kK,dropzone:BK,input:LK,iframe:VK,sizeinput:tJ,selectbox:$K,listbox:qK,size:tJ,textarea:iJ,urlinput:cJ,customeditor:TK,collection:hK,togglemenuitem:Zq},_J=function(t){return j.from(OJ[t.type])},TJ=function(t){return rt(kJ(t),CJ)},EJ=function(t){var n=TJ(t),e=lt(n,function(t){return _J(t).fold(function(){return[]},function(n){return[Hi(t.name,n)]})});return ci(e)},DJ=function(t){var n=Di(yJ(t)),e=EJ(t),o=t.initialData;return{internalDialog:n,dataValidator:e,initialData:o}},BJ={open:function(t,n){var e=DJ(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){var e=Di(SJ(n));return t(e)},redial:function(t){return DJ(t)}},AJ=function(t){var n=[],e={};return Ot(t,function(t,o){t.fold(function(){n.push(o)},function(t){e[o]=t})}),n.length>0?dr.error(n):dr.value(e)},MJ=function(t,n){var e=MS(zF.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:tt(t.items,function(t){return fH(e,t,n)})}}));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:xl([Px.config({mode:"acyclic",useTabstopAt:R(kR)}),JF.memento(e),dR.memento(e,{postprocess:function(t){return AJ(t).fold(function(t){return console.error(t),{}},M)}})])}},FJ=function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Ow(t.action),behaviours:fv(t.tabButtonBehaviours,[rw.config({}),Px.config({mode:"execution",useSpace:!0,useEnter:!0}),av.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}},RJ=yh({name:"TabButton",configFields:[eu("uid",void 0),Pi("value"),Ri("dom","dom",Vr(function(){return{attributes:{role:"tab",id:mc("aria"),"aria-selected":"false"}}}),gi()),qi("action"),eu("domModification",{}),cv("tabButtonBehaviours",[rw,Px,av]),Pi("view")],factory:FJ}),IJ=A([Pi("tabs"),Pi("dom"),eu("clickToDismiss",!1),cv("tabbarBehaviours",[fb,Px]),mf(["tabClass","selectedClass"])]),VJ=Uv({factory:RJ,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){fb.dehighlight(t,n),Ma(t,Ea(),{tabbar:t,button:n})},e=function(t,n){fb.highlight(t,n),Ma(t,Ta(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=fb.isHighlighted(r,o),u=i&&t.clickToDismiss?n:i?T:e;u(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),PJ=A([VJ]),HJ=function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:fv(t.tabbarBehaviours,[fb.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){qe(n.element,"aria-selected","true")},onDehighlight:function(t,n){qe(n.element,"aria-selected","false")}}),Px.config({mode:"flow",getInitial:function(t){return fb.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}},zJ=xh({name:"Tabbar",configFields:IJ(),partFields:PJ(),factory:HJ}),NJ=function(t,n){return{uid:t.uid,dom:t.dom,behaviours:fv(t.tabviewBehaviours,[Yx.config({})]),domModification:{attributes:{role:"tabpanel"}}}},LJ=yh({name:"Tabview",configFields:[cv("tabviewBehaviours",[Yx])],factory:NJ}),WJ=A([eu("selectFirst",!0),pf("onChangeTab"),pf("onDismissTab"),eu("tabs",[]),cv("tabSectionBehaviours",[])]),UJ=Nv({factory:zJ,schema:[Pi("dom"),Gi("markers",[Pi("tabClass"),Pi("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),jJ=Nv({factory:LJ,name:"tabview"}),GJ=A([UJ,jJ]),XJ=function(t,n,e,o){var r=function(n){var e=av.getValue(n);nh(n,t,"tabview").each(function(o){var r=ct(t.tabs,function(t){return t.value===e});r.each(function(e){var r=e.view();$e(n.element,"id").each(function(t){qe(o.element,"aria-labelledby",t)}),Yx.set(o,r),t.onChangeTab(o,n,r)})})},i=function(n,e){nh(n,t,"tabbar").each(function(t){e(t).each(Fa)})};return{uid:t.uid,dom:t.dom,components:n,behaviours:sv(t.tabSectionBehaviours),events:Pa(ft([t.selectFirst?[$a(function(t,n){i(t,fb.getFirst)})]:[],[La(Ta(),function(t,n){var e=n.event.button;r(e)}),La(Ea(),function(n,e){var o=e.event.button;t.onDismissTab(n,o)})]])),apis:{getViewItems:function(n){return nh(n,t,"tabview").map(function(t){return Yx.contents(t)}).getOr([])},showTab:function(t,n){var e=function(t){var e=fb.getCandidates(t),o=ct(e,function(t){return av.getValue(t)===n});return o.filter(function(n){return!fb.isHighlighted(t,n)})};i(t,e)}}}},YJ=xh({name:"TabSection",configFields:WJ(),partFields:GJ(),factory:XJ,apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),qJ=function(t,n,e){return tt(t,function(o,r){Yx.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return Yx.set(e,[]),i.height})},KJ=function(t){return yt(ht(t,function(t,n){return t>n?-1:t<n?1:0}))},JJ=function(t,n,e){var o,r=ke(t).dom,i=Us(t,".tox-dialog-wrap").getOr(t),u="fixed"===io(i,"position");o=u?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var a=po(n),c=n.dom.offsetLeft>=e.dom.offsetLeft+_o(e),s=c?Math.max(po(e),a):a,f=parseInt(io(t,"margin-top"),10)||0,l=parseInt(io(t,"margin-bottom"),10)||0,d=po(t)+f+l,m=d-s;return o-m},$J=function(t,n){yt(t).each(function(t){return YJ.showTab(n,t.value)})},QJ=function(t,n){eo(t,"height",n+"px"),fe().browser.isIE()?fo(t,"flex-basis"):eo(t,"flex-basis",n+"px")},ZJ=function(t,n,e){Us(t,'[role="dialog"]').each(function(t){Gs(t,'[role="tablist"]').each(function(o){e.get().map(function(e){return eo(n,"height","0"),eo(n,"flex-basis","0"),Math.min(e,JJ(t,n,o))}).each(function(t){QJ(n,t)})})})},t$=function(t){return Gs(t,'[role="tabpanel"]')},n$=function(t){var n,e,o,r=(n=ld(),e=[$a(function(e){var o=e.element;t$(o).each(function(r){eo(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each(function(e){var o=qJ(t,r,e),i=KJ(o);i.fold(n.clear,n.set)}),ZJ(o,r,n),fo(r,"visibility"),$J(t,e),DS.requestAnimationFrame(function(){ZJ(o,r,n)})})}),La(xa(),function(t){var e=t.element;t$(e).each(function(t){ZJ(e,t,n)})}),La(ND,function(t,e){var o=t.element;t$(o).each(function(t){var e=Fl(Pe(t));eo(t,"visibility","hidden");var r=ao(t,"height").map(function(t){return parseInt(t,10)});fo(t,"height"),fo(t,"flex-basis");var i=t.dom.getBoundingClientRect().height,u=r.forall(function(t){return i>t});u?(n.set(i),ZJ(o,t,n)):r.each(function(n){QJ(t,n)}),fo(t,"visibility"),e.each(Bl)})})],o=!1,{extraEvents:e,selectFirst:o}),i=function(){var t=[],n=!0;return{extraEvents:t,selectFirst:n}}();return{smartTabHeight:r,naiveTabHeight:i}},e$="send-data-to-section",o$="send-data-to-view",r$=function(t,n){var e=du({}),o=function(t){var n=av.getValue(t),o=AJ(n).getOr({}),r=e.get(),i=Br(r,o);e.set(i)},r=function(t){var n=e.get();av.setValue(t,n)},i=du(null),u=tt(t.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[zF.sketch(function(e){return{dom:{tag:"div",classes:["tox-form"]},components:tt(t.items,function(t){return fH(e,t,n)}),formBehaviours:xl([Px.config({mode:"acyclic",useTabstopAt:R(kR)}),Kx("TabView.form.events",[$a(r),Qa(o)]),_l.config({channels:ku([{key:e$,value:{onReceive:o}},{key:o$,value:{onReceive:r}}])})])}})]}}}),a=n$(u).smartTabHeight;return YJ.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=av.getValue(n);Ma(t,zD,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[YJ.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[zJ.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:xl([CD.config({})])}),YJ.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:xl([Kx("tabpanel",a.extraEvents),Px.config({
mode:"acyclic"}),Oh.config({find:function(t){return yt(YJ.getViewItems(t))}}),av.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([e$],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([o$],{})}}})])})},i$=mc("update-dialog"),u$=mc("update-title"),a$=mc("update-body"),c$=mc("update-footer"),s$=mc("body-send-message"),f$=function(t,n,e,o){var r=function(t){switch(t.body.type){case"tabpanel":return[r$(t.body,e)];default:return[MJ(t.body,e)]}},i=function(t,n){return j.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:z(z({},n.map(function(t){return{id:t}}).getOr({})),o?u:{})},components:[],behaviours:xl([JF.childAt(0),Cj.config({channel:a$,updateState:i,renderComponents:r,initialData:t})])}},l$=function(t,n,e,o){return f$(t,j.some(n),e,o)},d$=function(t,n){var e=f$(t,j.none(),n,!1);return $q.parts.body(e)},m$=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[xR({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:xl([CD.config({}),rw.config({})])})]}],behaviours:xl([Px.config({mode:"acyclic",useTabstopAt:R(kR)})])};return $q.parts.body(n)},g$=D_.deviceType.isTouch(),p$=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},v$=function(t,n){return $q.parts.close(AS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:xl([CD.config({})])}))},h$=function(){return $q.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},b$=function(t,n){return $q.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:tW("<p>"+n.translate(t)+"</p>")}]}]})},y$=function(t){return $q.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},x$=function(t,n){return[gD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),gD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},w$=function(t){var n,o="tox-dialog",r=o+"-wrap",i=r+"__backdrop",u=o+"__disable-scroll";return $q.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),j.some(!0)},useTabstopAt:function(t){return!kR(t)},dom:{tag:"div",classes:[o].concat(t.extraClasses),styles:z({position:"relative"},t.extraStyles)},components:e([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:tW('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:g$?[i,i+"--opaque"]:[i]}}]}},dragBlockClass:r,modalBehaviours:xl(e([rw.config({}),Kx("dialog-events",t.dialogEvents.concat([Ja(Yu(),function(t,n){Px.focusIn(t)})])),Kx("scroll-lock",[$a(function(){gs(Ge(),u)}),Qa(function(){vs(Ge(),u)})])],t.extraBehaviours,!0)),eventOrder:z((n={},n[fa()]=["dialog-events"],n[wa()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[Sa()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},S$=function(t){return AS.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[jS("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){Aa(t,RD)}})},k$=function(t,n,e){var o=function(t){return[Ms(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:z({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:xl([Cj.config({channel:u$,renderComponents:o})])}},C$=function(){return{dom:tW('<div class="tox-dialog__draghandle"></div>')}},O$=function(t,n,e){return gD.sketch({dom:tW('<div class="tox-dialog__header"></div>'),components:[k$(t,j.some(n),e),C$(),S$(e)],containerBehaviours:xl([Eq.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Xs(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},_$=function(t,n){var e=$q.parts.title(k$(t,j.none(),n)),o=$q.parts.draghandle(C$()),r=$q.parts.close(S$(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return gD.sketch({dom:tW('<div class="tox-dialog__header"></div>'),components:i})},T$=function(t,n){return _$({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},E$=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:tW('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},D$=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){$q.setBusy(t(),function(t,o){return E$(e.message,o,n)})},onUnblock:function(){$q.setIdle(t())}}},B$=function(t,n,o,r){var i,u=function(t,n){return j.some(n)};return Vs(w$(z(z({},t),{lazySink:r.shared.getSink,extraBehaviours:e([Cj.config({channel:i$,updateState:u,initialData:n}),dR.memory({})],t.extraBehaviours,!0),onEscape:function(t){Aa(t,RD)},dialogEvents:o,eventOrder:(i={},i[sa()]=[Cj.name(),_l.name()],i[wa()]=["scroll-lock",Cj.name(),"messages","dialog-events","alloy.base.behaviour"],i[Sa()]=["alloy.base.behaviour","dialog-events","messages",Cj.name(),"scroll-lock"],i)})))},A$=function(t){var n=function(t){var n=tt(t.items,function(t){var n=du(!1);return z(z({},t),{storage:n})});return z(z({},t),{items:n})};return tt(t,function(t){return"menu"===t.type?n(t):t})},M$=function(t){return ut(t,function(t,n){if("menu"===n.type){var e=n;return ut(e.items,function(t,n){return t[n.name]=n.storage,t},t)}return t},{})},F$=function(t,n){return[Ya(Yu(),SR),t(FD,function(t,e){n.onClose(),e.onClose()}),t(RD,function(t,n,e,o){n.onCancel(t),Aa(o,FD)}),La(HD,function(t,e){return n.onUnblock()}),La(PD,function(t,e){return n.onBlock(e.event)})]},R$=function(t,n){var o=function(n,e){return La(n,function(n,o){r(n,function(r,i){e(t(),r,o.event,n)})})},r=function(t,n){Cj.getState(t).get().each(function(e){n(e,t)})};return e(e([],F$(o,n),!0),[o(ID,function(t,n,e){n.onAction(t,{name:e.name})})],!1)},I$=function(t,n,o){var r=function(n,e){return La(n,function(n,o){i(n,function(r,i){e(t(),r,o.event,n)})})},i=function(t,n){Cj.getState(t).get().each(function(e){n(e.internalDialog,t)})};return e(e([],F$(r,n),!0),[r(VD,function(t,n){return n.onSubmit(t)}),r(MD,function(t,n,e){n.onChange(t,{name:e.name})}),r(ID,function(t,n,e,r){var i=function(){return Px.focusIn(r)},u=function(t){return Qe(t,"disabled")||$e(t,"aria-disabled").exists(function(t){return"true"===t})},a=Pe(r.element),c=Fl(a);n.onAction(t,{name:e.name,value:e.value}),Fl(a).fold(i,function(t){u(t)?i():c.exists(function(n){return xe(t,n)&&u(n)})?i():o().toOptional().filter(function(n){return!xe(n.element,t)}).each(i)})}),r(zD,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),Qa(function(n){var e=t();av.setValue(n,e.getData())})],!1)},V$={initUrlDialog:R$,initDialog:I$},P$=function(t,n){return sV(t,t.type,n)},H$=function(t,n,e){return ct(n,function(t){return t.name===e}).bind(function(n){return n.memento.getOpt(t)})},z$=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),o=ot(e,function(t){return"start"===t.align}),r=function(t,n){return gD.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:tt(n,function(t){return t.memento.asSpec()})})},i=r("start",o.pass),u=r("end",o.fail);return[i,u]},N$=function(t,n){var e=function(t,e){var o=tt(e.buttons,function(t){var e=MS(P$(t,n));return{name:t.name,align:t.align,memento:e}}),r=function(t,n){return H$(t,o,n)};return j.some({lookupByName:r,footerButtons:o})};return{dom:tW('<div class="tox-dialog__footer"></div>'),components:[],behaviours:xl([Cj.config({channel:c$,initialData:t,updateState:e,renderComponents:z$})])}},L$=function(t,n){return N$(t,n)},W$=function(t,n){return $q.parts.footer(N$(t,n))},U$=function(t,n){var e=t.getRoot();if(e.getSystem().isConnected()){var o=Oh.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return zF.getField(o,n).fold(function(){var e=t.getFooter(),r=Cj.getState(e);return r.get().bind(function(t){return t.lookupByName(o,n)})},function(t){return j.some(t)})}return j.none()},j$=function(t,n){var e=t.getRoot();return Cj.getState(e).get().map(function(t){return Di(Ei("data",t.dataValidator,n))}).getOr(n)},G$=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r=function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=av.getValue(o),i=_t(e,function(t){return t.get()});return z(z({},r),i)},i=function(n){o(function(o){var r=g.getData(),i=z(z({},r),n),u=j$(t,i),a=t.getFormWrapper();av.setValue(a,u),Ot(e,function(t,n){It(i,n)&&t.set(i[n])})})},u=function(n){U$(t,n).each(jh.disable)},a=function(n){U$(t,n).each(jh.enable)},c=function(n){U$(t,n).each(rw.focus)},s=function(t){if(!v(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o(function(n){Ma(n,PD,{message:t})})},f=function(){o(function(t){Aa(t,HD)})},l=function(n){o(function(e){var o=t.getBody(),r=Cj.getState(o);r.get().exists(function(t){return t.isTabPanel()})&&Oh.getCurrent(o).each(function(t){YJ.showTab(t,n)})})},d=function(t){o(function(e){var o=n(t);e.getSystem().broadcastOn([i$],o),e.getSystem().broadcastOn([u$],o.internalDialog),e.getSystem().broadcastOn([a$],o.internalDialog),e.getSystem().broadcastOn([c$],o.internalDialog),g.setData(o.initialData)})},m=function(){o(function(t){Aa(t,FD)})},g={getData:r,setData:i,disable:u,enable:a,focus:c,block:s,unblock:f,showTab:l,redial:d,close:m};return g},X$=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}},Y$=function(t,n,e){var o,r=T$(t.internalDialog.title,e),i=d$({body:t.internalDialog.body},e),u=A$(t.internalDialog.buttons),a=M$(u),c=W$({buttons:u},e),s=V$.initDialog(function(){return g},D$(function(){return d},e.shared.providers,n),e.shared.getSink),f=X$(t.internalDialog.size),l={header:r,body:i,footer:j.some(c),extraClasses:f,extraBehaviours:[],extraStyles:{}},d=B$(l,t,s,e),m=(o=function(){var t=$q.getBody(d);return Oh.getCurrent(t).getOr(t)},{getRoot:A(d),getBody:function(){return $q.getBody(d)},getFooter:function(){return $q.getFooter(d)},getFormWrapper:o}),g=G$(m,n.redial,a);return{dialog:d,instanceApi:g}},q$=function(t,n,e,o){var r,i,u=mc("dialog-label"),a=mc("dialog-content"),c=function(t,n){return j.some(n)},s=MS(O$({title:t.internalDialog.title,draggable:!0},u,e.shared.providers)),f=MS(l$({body:t.internalDialog.body},a,e,o)),l=A$(t.internalDialog.buttons),d=M$(l),m=MS(L$({buttons:l},e)),g=V$.initDialog(function(){return v},{onBlock:function(t){$L.block(p,function(n,o){return E$(t.message,o,e.shared.providers)})},onUnblock:function(){$L.unblock(p)},onClose:function(){return n.closeWindow()}},e.shared.getSink),p=Vs({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=a,r)},eventOrder:(i={},i[sa()]=[Cj.name(),_l.name()],i[fa()]=["execute-on-form"],i[wa()]=["reflecting","execute-on-form"],i),behaviours:xl([Px.config({mode:"cyclic",onEscape:function(t){return Aa(t,FD),j.some(!0)},useTabstopAt:function(t){return!kR(t)&&("button"!==vn(t)||"disabled"!==Je(t,"disabled"))}}),Cj.config({channel:i$,updateState:c,initialData:t}),rw.config({}),Kx("execute-on-form",g.concat([Ja(Yu(),function(t,n){Px.focusIn(t)})])),$L.config({getRoot:function(){return j.some(p)}}),Yx.config({}),dR.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),v=G$({getRoot:A(p),getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var t=f.get(p);return Oh.getCurrent(t).getOr(t)}},n.redial,d);return{dialog:p,instanceApi:v}},K$=tinymce.util.Tools.resolve("tinymce.util.URI"),J$=function(t){var n=function(n){t.getSystem().isConnected()&&n(t)},e=function(t){if(!v(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n(function(n){Ma(n,PD,{message:t})})},o=function(){n(function(t){Aa(t,HD)})},r=function(){n(function(t){Aa(t,FD)})},i=function(t){n(function(n){n.getSystem().broadcastOn([s$],t)})};return{block:e,unblock:o,close:r,sendMessage:i}},$$=["insertContent","setContent","execCommand","close","block","unblock"],Q$=function(t){return h(t)&&-1!==$$.indexOf(t.mceAction)},Z$=function(t){return!Q$(t)&&h(t)&&It(t,"mceAction")},tQ=function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!x(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}},nQ=function(t,n,e,o){var r,i=T$(t.title,o),u=m$(t),a=t.buttons.bind(function(t){return 0===t.length?j.none():j.some(W$({buttons:t},o))}),c=V$.initUrlDialog(function(){return h},D$(function(){return v},o.shared.providers,n)),s=z(z({},t.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),t.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),f=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],l=new K$(t.url,{base_uri:new K$(window.location.href)}),d=l.protocol+"://"+l.host+(l.port?":"+l.port:""),m=sd(),g=[Kx("messages",[$a(function(){var n=md(fn.fromDom(window),"message",function(n){if(l.isSameOrigin(new K$(n.raw.origin))){var o=n.raw.data;Q$(o)?tQ(e,h,o):Z$(o)&&t.onMessage(h,o)}});m.set(n)}),Qa(m.clear)]),_l.config({channels:(r={},r[s$]={onReceive:function(t,n){Gs(t.element,"iframe").each(function(t){var e=t.dom.contentWindow;e.postMessage(n,d)})}},r)})],p={header:i,body:u,footer:a,extraClasses:f,extraBehaviours:g,extraStyles:s},v=B$(p,t,c,o),h=J$(v);return{dialog:v,instanceApi:h}},eQ=function(t){var n=t.backstage.shared,e=function(e,o){var r=function(){$q.hide(c),o()},i=MS(sV({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:j.none()},"cancel",t.backstage)),u=h$(),a=v$(r,n.providers),c=Vs(w$({lazySink:function(){return n.getSink()},header:p$(u,a),body:b$(e,n.providers),footer:j.some(y$(x$([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[La(RD,r)],eventOrder:{}}));$q.show(c);var s=i.get(c);rw.focus(s)};return{open:e}},oQ=function(t){var n=t.backstage.shared,e=function(e,o){var r=function(t){$q.hide(s),o(t)},i=MS(sV({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:j.none()},"submit",t.backstage)),u=sV({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:j.none()},"cancel",t.backstage),a=h$(),c=v$(function(){return r(!1)},n.providers),s=Vs(w$({lazySink:function(){return n.getSink()},header:p$(a,c),body:b$(e,n.providers),footer:j.some(y$(x$([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[La(RD,function(){return r(!1)}),La(VD,function(){return r(!0)})],eventOrder:{}}));$q.show(s);var f=i.get(s);rw.focus(f)};return{open:e}},rQ=function(t,n){return Di(Ei("data",n,t))},iQ=function(t){return LE(t,".tox-alert-dialog")||LE(t,".tox-confirm-dialog")},uQ=function(t,n,e){return n&&e?[]:[ON.config({contextual:{lazyContext:function(){return j.some(ur(fn.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},aQ=function(t){var n=t.backstage,o=t.editor,r=QO(o),i=eQ(t),u=oQ(t),a=function(t,e,o){return void 0!==e&&"toolbar"===e.inline?l(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?l(t,n.shared.anchors.cursor(),o,e.ariaAttrs):f(t,o)},c=function(t,n){return s(t,n)},s=function(t,e){var r=function(t){var r=nQ(t,{closeWindow:function(){$q.hide(r.dialog),e(r.instanceApi)}},o,n);return $q.show(r.dialog),r.instanceApi};return BJ.openUrl(r,t)},f=function(t,e){var o=function(t,o,r){var i=o,u={dataValidator:r,initialData:i,internalDialog:t},a=Y$(u,{redial:BJ.redial,closeWindow:function(){$q.hide(a.dialog),e(a.instanceApi)}},n);return $q.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return BJ.open(o,t)},l=function(t,i,u,a){var c=function(t,c,s){var f=rQ(c,s),l=ld(),d=n.shared.header.isPositionedAtTop(),m={dataValidator:s,initialData:f,internalDialog:t},g=function(){return l.on(function(t){sS.reposition(t),ON.refresh(t)})},p=q$(m,{redial:BJ.redial,closeWindow:function(){l.on(sS.hide),o.off("ResizeEditor",g),l.clear(),u(p.instanceApi)}},n,a),v=Vs(sS.sketch(z(z({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},d?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:xl(e([Kx("window-Receptionist-inline-events",[La(ka(),function(t,n){Aa(p.dialog,RD)})])],uQ(o,r,d),!0)),isExtraPart:function(t,n){return iQ(n)}})));return l.set(v),sS.showWithin(v,Ps(p.dialog),{anchor:i},j.some(Ge())),r&&d||(ON.refresh(v),o.on("ResizeEditor",g)),p.instanceApi.setData(f),Px.focusIn(p.dialog),p.instanceApi};return BJ.open(c,t)},d=function(t,n){u.open(t,function(t){n(t)})},m=function(t,n){i.open(t,function(){n()})},g=function(t){t.close()};return{open:a,openUrl:c,alert:m,close:g,confirm:d}};c()})();